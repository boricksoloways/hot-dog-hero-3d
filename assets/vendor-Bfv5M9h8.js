var sw=Object.defineProperty;var ow=(i,x,e)=>x in i?sw(i,x,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[x]=e;var xA=(i,x,e)=>ow(i,typeof x!="symbol"?x+"":x,e);const I=i0;(function(i,x){const e=i0,t=i();for(;;)try{if(-parseInt(e(1385))/1+-parseInt(e(3796))/2*(parseInt(e(459))/3)+-parseInt(e(2463))/4+parseInt(e(3635))/5*(-parseInt(e(3660))/6)+parseInt(e(3523))/7+-parseInt(e(3570))/8*(-parseInt(e(1886))/9)+parseInt(e(971))/10===x)break;t.push(t.shift())}catch{t.push(t.shift())}})(I2,782285);const Oo=function(){let i=!0;return function(x,e){const t=i?function(){const g=i0;if(e){const n=e[g(1307)](x,arguments);return e=null,n}}:function(){};return i=!1,t}}(),cw=Oo(void 0,function(){const i=i0;let x;try{x=Function(i(1209)+i(3527)+");")()}catch{x=window}const e=x.console=x.console||{},t=[i(2013),i(3748),i(3618),i(2963),i(921),i(1830),i(1075)];for(let g=0;g<t.length;g++){const n=Oo[i(135)][i(1566)][i(1600)](Oo),s=t[g],o=e[s]||n;n[i(2982)]=Oo.bind(Oo),n.toString=o.toString.bind(o),e[s]=n}});cw();function iZ(i){const x=i0;return i&&i[x(3462)]&&Object[x(1566)][x(3631)][x(2627)](i,"default")?i[x(311)]:i}var nZ={exports:{}},Ir={},IZ={exports:{}},Xx={},wC=Symbol[I(686)](I(3381)),Cw=Symbol.for(I(847)),lw=Symbol.for(I(3235)),aw=Symbol[I(686)](I(2920)),rw=Symbol.for(I(619)),dw=Symbol[I(686)](I(2839)),Aw=Symbol[I(686)]("react.context"),uw=Symbol[I(686)](I(3595)),bw=Symbol[I(686)](I(2598)),hw=Symbol[I(686)](I(2557)),fw=Symbol[I(686)](I(2869)),Wm=Symbol[I(2880)];function mw(i){const x=I;return i===null||typeof i!="object"?null:(i=Wm&&i[Wm]||i[x(2677)],x(1126)===typeof i?i:null)}var sZ={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oZ=Object.assign,cZ={};function js(i,x,e){const t=I;this.props=i,this[t(3246)]=x,this[t(3596)]=cZ,this[t(938)]=e||sZ}js[I(1566)][I(1287)]={},js[I(1566)][I(1057)]=function(i,x){const e=I;if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater[e(2358)](this,i,x,e(1057))},js[I(1566)][I(1986)]=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function CZ(){}CZ[I(1566)]=js[I(1566)];function fh(i,x,e){const t=I;this[t(3105)]=i,this.context=x,this[t(3596)]=cZ,this[t(938)]=e||sZ}var eA=fh[I(1566)]=new CZ;eA[I(135)]=fh,oZ(eA,js[I(1566)]),eA[I(659)]=!0;var wm=Array[I(1987)],lZ=Object[I(1566)][I(3631)],mh={current:null},aZ={key:!0,ref:!0,__self:!0,__source:!0};function Rm(i,x,e){const t=I;var g,n={},s=null,o=null;if(x!=null)for(g in x[t(3786)]!==void 0&&(o=x[t(3786)]),x.key!==void 0&&(s=""+x[t(581)]),x)lZ[t(2627)](x,g)&&!aZ[t(3631)](g)&&(n[g]=x[g]);var c=arguments[t(2989)]-2;if(c===1)n[t(1352)]=e;else if(1<c){for(var C=Array(c),r=0;r<c;r++)C[r]=arguments[r+2];n[t(1352)]=C}if(i&&i.defaultProps)for(g in c=i[t(3870)],c)n[g]===void 0&&(n[g]=c[g]);return{$$typeof:wC,type:i,key:s,ref:o,props:n,_owner:mh[t(1895)]}}function Gw(i,x){const e=I;return{$$typeof:wC,type:i[e(3505)],key:x,ref:i.ref,props:i.props,_owner:i[e(3051)]}}function Xu(i){return typeof i=="object"&&i!==null&&i[I(1596)]===wC}function pw(i){var x={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(e){return x[e]})}var Vm=/\/+/g;function tA(i,x){const e=I;return e(1011)===typeof i&&i!==null&&i[e(581)]!=null?pw(""+i[e(581)]):x[e(2635)](36)}function sr(i,x,e,t,g){const n=I;var s=typeof i;(s==="undefined"||n(3889)===s)&&(i=null);var o=!1;if(i===null)o=!0;else switch(s){case n(3674):case n(1025):o=!0;break;case n(1011):switch(i[n(1596)]){case wC:case Cw:o=!0}}if(o)return o=i,g=g(o),i=t===""?"."+tA(o,0):t,wm(g)?(e="",i!=null&&(e=i[n(333)](Vm,n(1235))+"/"),sr(g,x,e,"",function(r){return r})):g!=null&&(Xu(g)&&(g=Gw(g,e+(!g[n(581)]||o&&o.key===g[n(581)]?"":(""+g[n(581)])[n(333)](Vm,n(1235))+"/")+i)),x[n(3330)](g)),1;if(o=0,t=t===""?".":t+":",wm(i))for(var c=0;c<i[n(2989)];c++){s=i[c];var C=t+tA(s,c);o+=sr(s,x,e,C,g)}else if(C=mw(i),n(1126)===typeof C)for(i=C.call(i),c=0;!(s=i[n(890)]()).done;)s=s.value,C=t+tA(s,c++),o+=sr(s,x,e,C,g);else if(s==="object")throw x=String(i),Error(n(208)+(x==="[object Object]"?n(2626)+Object[n(958)](i)[n(1812)](", ")+"}":x)+n(3167));return o}function kl(i,x,e){if(i==null)return i;var t=[],g=0;return sr(i,t,"","",function(n){return x.call(e,n,g++)}),t}function Bw(i){const x=I;if(i[x(993)]===-1){var e=i[x(2331)];e=e(),e[x(2334)](function(t){const g=x;(i._status===0||i[g(993)]===-1)&&(i[g(993)]=1,i[g(2331)]=t)},function(t){const g=x;(i[g(993)]===0||i[g(993)]===-1)&&(i[g(993)]=2,i[g(2331)]=t)}),i[x(993)]===-1&&(i[x(993)]=0,i[x(2331)]=e)}if(i[x(993)]===1)return i._result[x(311)];throw i[x(2331)]}var ut={current:null},or={transition:null},Zw={ReactCurrentDispatcher:ut,ReactCurrentBatchConfig:or,ReactCurrentOwner:mh};function Sm(){throw Error(I(3541))}Xx[I(1538)]={map:kl,forEach:function(i,x,e){kl(i,function(){x[i0(1307)](this,arguments)},e)},count:function(i){var x=0;return kl(i,function(){x++}),x},toArray:function(i){return kl(i,function(x){return x})||[]},only:function(i){const x=I;if(!Xu(i))throw Error(x(2195));return i}},Xx[I(1789)]=js,Xx[I(3676)]=lw,Xx[I(3992)]=rw,Xx[I(2247)]=fh,Xx[I(2628)]=aw,Xx.Suspense=bw,Xx[I(1521)]=Zw,Xx[I(3297)]=Sm,Xx[I(596)]=function(i,x,e){const t=I;if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var g=oZ({},i.props),n=i[t(581)],s=i.ref,o=i[t(3051)];if(x!=null){if(x[t(3786)]!==void 0&&(s=x[t(3786)],o=mh[t(1895)]),x[t(581)]!==void 0&&(n=""+x[t(581)]),i[t(3505)]&&i.type[t(3870)])var c=i[t(3505)][t(3870)];for(C in x)lZ[t(2627)](x,C)&&!aZ[t(3631)](C)&&(g[C]=x[C]===void 0&&c!==void 0?c[C]:x[C])}var C=arguments.length-2;if(C===1)g[t(1352)]=e;else if(1<C){c=Array(C);for(var r=0;r<C;r++)c[r]=arguments[r+2];g[t(1352)]=c}return{$$typeof:wC,type:i[t(3505)],key:n,ref:s,props:g,_owner:o}},Xx.createContext=function(i){const x=I;return i={$$typeof:Aw,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i[x(2773)]={$$typeof:dw,_context:i},i[x(2770)]=i},Xx.createElement=Rm,Xx[I(2530)]=function(i){const x=I;var e=Rm[x(1600)](null,i);return e[x(3505)]=i,e},Xx.createRef=function(){return{current:null}},Xx.forwardRef=function(i){return{$$typeof:uw,render:i}},Xx[I(2582)]=Xu,Xx[I(2824)]=function(i){return{$$typeof:fw,_payload:{_status:-1,_result:i},_init:Bw}},Xx[I(1190)]=function(i,x){return{$$typeof:hw,type:i,compare:x===void 0?null:x}},Xx[I(1579)]=function(i){const x=I;var e=or[x(1691)];or[x(1691)]={};try{i()}finally{or[x(1691)]=e}},Xx[I(3151)]=Sm,Xx[I(2105)]=function(i,x){const e=I;return ut[e(1895)][e(2105)](i,x)},Xx[I(2423)]=function(i){const x=I;return ut[x(1895)][x(2423)](i)},Xx[I(1682)]=function(){},Xx.useDeferredValue=function(i){const x=I;return ut[x(1895)][x(1052)](i)},Xx[I(263)]=function(i,x){const e=I;return ut[e(1895)][e(263)](i,x)},Xx[I(850)]=function(){const i=I;return ut[i(1895)][i(850)]()},Xx[I(3695)]=function(i,x,e){const t=I;return ut[t(1895)][t(3695)](i,x,e)},Xx[I(3852)]=function(i,x){const e=I;return ut[e(1895)][e(3852)](i,x)},Xx[I(3612)]=function(i,x){const e=I;return ut.current[e(3612)](i,x)},Xx[I(2072)]=function(i,x){const e=I;return ut[e(1895)][e(2072)](i,x)},Xx[I(3712)]=function(i,x,e){const t=I;return ut[t(1895)][t(3712)](i,x,e)},Xx.useRef=function(i){const x=I;return ut[x(1895)][x(1576)](i)},Xx[I(3533)]=function(i){const x=I;return ut.current[x(3533)](i)},Xx[I(1664)]=function(i,x,e){const t=I;return ut[t(1895)][t(1664)](i,x,e)},Xx[I(3896)]=function(){return ut.current.useTransition()},Xx.version=I(866);IZ.exports=Xx;var _0=IZ.exports;const NM=iZ(_0);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var yw=_0,vw=Symbol[I(686)]("react.element"),Ww=Symbol[I(686)](I(3235)),ww=Object.prototype[I(3631)],Rw=yw[I(1521)][I(2937)],Vw={key:!0,ref:!0,__self:!0,__source:!0};function Xm(i,x,e){const t=I;var g,n={},s=null,o=null;e!==void 0&&(s=""+e),x[t(581)]!==void 0&&(s=""+x[t(581)]),x[t(3786)]!==void 0&&(o=x[t(3786)]);for(g in x)ww.call(x,g)&&!Vw[t(3631)](g)&&(n[g]=x[g]);if(i&&i[t(3870)])for(g in x=i.defaultProps,x)n[g]===void 0&&(n[g]=x[g]);return{$$typeof:vw,type:i,key:s,ref:o,props:n,_owner:Rw.current}}Ir[I(3676)]=Ww,Ir[I(657)]=Xm,Ir.jsxs=Xm;nZ[I(2129)]=Ir;var dg=nZ[I(2129)],rZ={exports:{}},$t={},dZ={exports:{}},AZ={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(i){const x=I;function e($,j){const x0=i0;var c0=$[x0(2989)];$[x0(3330)](j);x:for(;0<c0;){var h0=c0-1>>>1,X0=$[h0];if(0<n(X0,j))$[h0]=j,$[c0]=X0,c0=h0;else break x}}function t($){return $[i0(2989)]===0?null:$[0]}function g($){const j=i0;if($[j(2989)]===0)return null;var x0=$[0],c0=$[j(3604)]();if(c0!==x0){$[0]=c0;x:for(var h0=0,X0=$[j(2989)],n0=X0>>>1;h0<n0;){var g0=2*(h0+1)-1,l0=$[g0],m0=g0+1,M0=$[m0];if(0>n(l0,c0))m0<X0&&0>n(M0,l0)?($[h0]=M0,$[m0]=c0,h0=m0):($[h0]=l0,$[g0]=c0,h0=g0);else if(m0<X0&&0>n(M0,c0))$[h0]=M0,$[m0]=c0,h0=m0;else break x}}return x0}function n($,j){const x0=i0;var c0=$[x0(1680)]-j[x0(1680)];return c0!==0?c0:$.id-j.id}if(typeof performance=="object"&&typeof performance[x(978)]=="function"){var s=performance;i[x(1327)]=function(){return s[x(978)]()}}else{var o=Date,c=o[x(978)]();i[x(1327)]=function(){return o.now()-c}}var C=[],r=[],A=1,d=null,h=3,f=!1,B=!1,Z=!1,G=x(1126)===typeof setTimeout?setTimeout:null,m=x(1126)===typeof clearTimeout?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;x(1797)!==typeof navigator&&navigator[x(2091)]!==void 0&&navigator[x(2091)][x(380)]!==void 0&&navigator[x(2091)][x(380)][x(1600)](navigator[x(2091)]);function p($){const j=x;for(var x0=t(r);x0!==null;){if(x0[j(934)]===null)g(r);else if(x0[j(1919)]<=$)g(r),x0[j(1680)]=x0[j(700)],e(C,x0);else break;x0=t(r)}}function w($){const j=x;if(Z=!1,p($),!B)if(t(C)!==null)B=!0,f0(V);else{var x0=t(r);x0!==null&&G0(w,x0[j(1919)]-$)}}function V($,j){const x0=x;B=!1,Z&&(Z=!1,m(M),M=-1),f=!0;var c0=h;try{for(p(j),d=t(C);d!==null&&(!(d.expirationTime>j)||$&&!H());){var h0=d[x0(934)];if(x0(1126)===typeof h0){d.callback=null,h=d[x0(884)];var X0=h0(d[x0(700)]<=j);j=i[x0(1327)](),x0(1126)===typeof X0?d[x0(934)]=X0:d===t(C)&&g(C),p(j)}else g(C);d=t(C)}if(d!==null)var n0=!0;else{var g0=t(r);g0!==null&&G0(w,g0[x0(1919)]-j),n0=!1}return n0}finally{d=null,h=c0,f=!1}}var N=!1,X=null,M=-1,Y=5,S=-1;function H(){return!(i[x(1327)]()-S<Y)}function O(){const $=x;if(X!==null){var j=i[$(1327)]();S=j;var x0=!0;try{x0=X(!0,j)}finally{x0?I0():(N=!1,X=null)}}else N=!1}var I0;if(typeof v=="function")I0=function(){v(O)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,b0=z[x(2481)];z[x(3983)][x(1042)]=O,I0=function(){b0[x(1587)](null)}}else I0=function(){G(O,0)};function f0($){X=$,N||(N=!0,I0())}function G0($,j){M=G(function(){$(i[i0(1327)]())},j)}i[x(1264)]=5,i.unstable_ImmediatePriority=1,i[x(3586)]=4,i[x(246)]=3,i.unstable_Profiling=null,i[x(543)]=2,i[x(3140)]=function($){const j=x;$[j(934)]=null},i[x(988)]=function(){B||f||(B=!0,f0(V))},i.unstable_forceFrameRate=function($){const j=x;0>$||125<$?console[j(2963)](j(2472)):Y=0<$?Math[j(3143)](1e3/$):5},i[x(790)]=function(){return h},i[x(1642)]=function(){return t(C)},i[x(3025)]=function($){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var x0=h;h=j;try{return $()}finally{h=x0}},i.unstable_pauseExecution=function(){},i[x(943)]=function(){},i[x(1386)]=function($,j){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var x0=h;h=$;try{return j()}finally{h=x0}},i[x(3790)]=function($,j,x0){const c0=x;var h0=i[c0(1327)]();switch(c0(1011)===typeof x0&&x0!==null?(x0=x0[c0(2085)],x0=c0(1025)===typeof x0&&0<x0?h0+x0:h0):x0=h0,$){case 1:var X0=-1;break;case 2:X0=250;break;case 5:X0=1073741823;break;case 4:X0=1e4;break;default:X0=5e3}return X0=x0+X0,$={id:A++,callback:j,priorityLevel:$,startTime:x0,expirationTime:X0,sortIndex:-1},x0>h0?($.sortIndex=x0,e(r,$),t(C)===null&&$===t(r)&&(Z?(m(M),M=-1):Z=!0,G0(w,x0-h0))):($.sortIndex=X0,e(C,$),B||f||(B=!0,f0(V))),$},i[x(822)]=H,i[x(586)]=function($){var j=h;return function(){const x0=i0;var c0=h;h=j;try{return $[x0(1307)](this,arguments)}finally{h=c0}}}})(AZ);dZ[I(2129)]=AZ;var Sw=dZ.exports,Xw=_0,ig=Sw;function N0(i){const x=I;for(var e=x(1465)+i,t=1;t<arguments[x(2989)];t++)e+=x(1458)+encodeURIComponent(arguments[t]);return x(1074)+i+"; visit "+e+x(1518)}var uZ=new Set,Jc={};function lI(i,x){const e=I;Ks(i,x),Ks(i+e(3482),x)}function Ks(i,x){for(Jc[i]=x,i=0;i<x.length;i++)uZ.add(x[i])}var ki=!(typeof window>"u"||I(1797)===typeof window[I(2597)]||I(1797)===typeof window[I(2597)].createElement),Yu=Object[I(1566)].hasOwnProperty,Yw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ym={},Km={};function Kw(i){const x=I;return Yu[x(2627)](Km,i)?!0:Yu[x(2627)](Ym,i)?!1:Yw[x(3633)](i)?Km[i]=!0:(Ym[i]=!0,!1)}function Hw(i,x,e,t){const g=I;if(e!==null&&e[g(3505)]===0)return!1;switch(typeof x){case g(1126):case g(3701):return!0;case g(3889):return t?!1:e!==null?!e.acceptsBooleans:(i=i.toLowerCase()[g(1226)](0,5),g(1973)!==i&&g(255)!==i);default:return!1}}function Nw(i,x,e,t){const g=I;if(x===null||g(1797)===typeof x||Hw(i,x,e,t))return!0;if(t)return!1;if(e!==null)switch(e[g(3505)]){case 3:return!x;case 4:return x===!1;case 5:return isNaN(x);case 6:return isNaN(x)||1>x}return!1}function ht(i,x,e,t,g,n,s){const o=I;this.acceptsBooleans=x===2||x===3||x===4,this[o(2071)]=t,this[o(823)]=g,this[o(2464)]=e,this.propertyName=i,this.type=x,this[o(2382)]=n,this[o(3386)]=s}var De={};I(3777)[I(2874)](" ")[I(1599)](function(i){De[i]=new ht(i,0,!1,i,null,!1,!1)}),[["acceptCharset",I(3828)],[I(2962),I(3623)],["htmlFor",I(686)],[I(1149),I(3094)]][I(1599)](function(i){var x=i[0];De[x]=new ht(x,1,!1,i[1],null,!1,!1)}),["contentEditable",I(2546),"spellCheck","value"][I(1599)](function(i){const x=I;De[i]=new ht(i,2,!1,i[x(2084)](),null,!1,!1)}),[I(1735),"externalResourcesRequired",I(1022),I(303)][I(1599)](function(i){De[i]=new ht(i,2,!1,i,null,!1,!1)}),I(324).split(" ")[I(1599)](function(i){De[i]=new ht(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked",I(3198),I(931),I(2762)][I(1599)](function(i){De[i]=new ht(i,3,!0,i,null,!1,!1)}),[I(2939),I(3987)].forEach(function(i){De[i]=new ht(i,4,!1,i,null,!1,!1)}),["cols",I(2131),I(1019),I(3418)][I(1599)](function(i){De[i]=new ht(i,6,!1,i,null,!1,!1)}),[I(1715),I(3988)][I(1599)](function(i){De[i]=new ht(i,5,!1,i.toLowerCase(),null,!1,!1)});var gA=/[\-:]([a-z])/g;function iA(i){const x=I;return i[1][x(3773)]()}I(2209).split(" ")[I(1599)](function(i){var x=i.replace(gA,iA);De[x]=new ht(x,1,!1,i,null,!1,!1)}),I(2972).split(" ").forEach(function(i){const x=I;var e=i[x(333)](gA,iA);De[e]=new ht(e,1,!1,i,x(313),!1,!1)}),[I(937),I(1799),"xml:space"].forEach(function(i){const x=I;var e=i[x(333)](gA,iA);De[e]=new ht(e,1,!1,i,x(1136),!1,!1)}),[I(3467),I(1922)][I(1599)](function(i){const x=I;De[i]=new ht(i,1,!1,i[x(2084)](),null,!1,!1)}),De.xlinkHref=new ht(I(1024),1,!1,I(3225),I(313),!0,!1),[I(2595),I(1329),I(1917),I(282)].forEach(function(i){const x=I;De[i]=new ht(i,1,!1,i[x(2084)](),null,!0,!0)});function Gh(i,x,e,t){const g=I;var n=De[g(3631)](x)?De[x]:null;(n!==null?n[g(3505)]!==0:t||!(2<x[g(2989)])||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(Nw(x,e,n,t)&&(e=null),t||n===null?Kw(x)&&(e===null?i[g(1357)](x):i[g(1236)](x,""+e)):n[g(2464)]?i[n.propertyName]=e===null?n.type===3?!1:"":e:(x=n[g(2071)],t=n.attributeNamespace,e===null?i[g(1357)](x):(n=n[g(3505)],e=n===3||n===4&&e===!0?"":""+e,t?i.setAttributeNS(t,x,e):i.setAttribute(x,e))))}var _i=Xw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tl=Symbol[I(686)](I(3381)),Hs=Symbol[I(686)](I(847)),Ns=Symbol[I(686)](I(3235)),ph=Symbol[I(686)]("react.strict_mode"),Ku=Symbol[I(686)](I(619)),bZ=Symbol[I(686)]("react.provider"),hZ=Symbol[I(686)]("react.context"),Bh=Symbol[I(686)](I(3595)),Hu=Symbol.for("react.suspense"),Nu=Symbol[I(686)](I(3770)),Zh=Symbol[I(686)](I(2557)),un=Symbol[I(686)](I(2869)),fZ=Symbol[I(686)]("react.offscreen"),Hm=Symbol[I(2880)];function qo(i){const x=I;return i===null||x(1011)!==typeof i?null:(i=Hm&&i[Hm]||i[x(2677)],x(1126)===typeof i?i:null)}var le=Object[I(1859)],nA;function Bc(i){const x=I;if(nA===void 0)try{throw Error()}catch(t){var e=t[x(1574)][x(1388)]()[x(1217)](/\n( *(at )?)/);nA=e&&e[1]||""}return`
`+nA+i}var IA=!1;function sA(i,x){const e=I;if(!i||IA)return"";IA=!0;var t=Error[e(1603)];Error.prepareStackTrace=void 0;try{if(x)if(x=function(){throw Error()},Object[e(2899)](x[e(1566)],"props",{set:function(){throw Error()}}),e(1011)===typeof Reflect&&Reflect.construct){try{Reflect[e(2323)](x,[])}catch(r){var g=r}Reflect[e(2323)](i,[],x)}else{try{x[e(2627)]()}catch(r){g=r}i[e(2627)](x[e(1566)])}else{try{throw Error()}catch(r){g=r}i()}}catch(r){if(r&&g&&e(3674)===typeof r.stack){for(var n=r[e(1574)][e(2874)](`
`),s=g.stack[e(2874)](`
`),o=n[e(2989)]-1,c=s[e(2989)]-1;1<=o&&0<=c&&n[o]!==s[c];)c--;for(;1<=o&&0<=c;o--,c--)if(n[o]!==s[c]){if(o!==1||c!==1)do if(o--,c--,0>c||n[o]!==s[c]){var C=`
`+n[o][e(333)](e(2571)," at ");return i[e(3088)]&&C[e(3532)]("<anonymous>")&&(C=C.replace("<anonymous>",i[e(3088)])),C}while(1<=o&&0<=c);break}}}finally{IA=!1,Error[e(1603)]=t}return(i=i?i.displayName||i[e(1474)]:"")?Bc(i):""}function Fw(i){const x=I;switch(i.tag){case 5:return Bc(i[x(3505)]);case 16:return Bc("Lazy");case 13:return Bc("Suspense");case 19:return Bc(x(815));case 0:case 2:case 15:return i=sA(i[x(3505)],!1),i;case 11:return i=sA(i[x(3505)][x(948)],!1),i;case 1:return i=sA(i.type,!0),i;default:return""}}function Fu(i){const x=I;if(i==null)return null;if(x(1126)===typeof i)return i[x(3088)]||i[x(1474)]||null;if(typeof i=="string")return i;switch(i){case Ns:return x(3676);case Hs:return x(2060);case Ku:return x(3992);case ph:return x(2628);case Hu:return x(2066);case Nu:return"SuspenseList"}if(x(1011)===typeof i)switch(i.$$typeof){case hZ:return(i.displayName||x(2538))+".Consumer";case bZ:return(i[x(3942)][x(3088)]||x(2538))+x(998);case Bh:var e=i.render;return i=i.displayName,i||(i=e[x(3088)]||e[x(1474)]||"",i=i!==""?x(2944)+i+")":x(1377)),i;case Zh:return e=i[x(3088)]||null,e!==null?e:Fu(i[x(3505)])||x(3124);case un:e=i._payload,i=i._init;try{return Fu(i(e))}catch{}}return null}function zw(i){const x=I;var e=i[x(3505)];switch(i.tag){case 24:return x(3766);case 9:return(e[x(3088)]||x(2538))+x(3097);case 10:return(e[x(3942)][x(3088)]||x(2538))+x(998);case 18:return x(1174);case 11:return i=e[x(948)],i=i.displayName||i[x(1474)]||"",e[x(3088)]||(i!==""?x(2944)+i+")":"ForwardRef");case 7:return x(3676);case 5:return e;case 4:return x(2060);case 3:return x(2495);case 6:return x(611);case 16:return Fu(e);case 8:return x(e===ph?2628:571);case 22:return x(3465);case 12:return x(3992);case 21:return"Scope";case 13:return x(2066);case 19:return"SuspenseList";case 25:return x(3224);case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yn(i){const x=I;switch(typeof i){case x(3889):case x(1025):case x(3674):case x(1797):return i;case x(1011):return i;default:return""}}function mZ(i){const x=I;var e=i[x(3505)];return(i=i.nodeName)&&x(2217)===i[x(2084)]()&&(x(3577)===e||x(1403)===e)}function Mw(i){const x=I;var e=mZ(i)?"checked":x(2113),t=Object.getOwnPropertyDescriptor(i[x(135)][x(1566)],e),g=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t[x(2695)]=="function"&&x(1126)===typeof t[x(298)]){var n=t.get,s=t[x(298)];return Object.defineProperty(i,e,{configurable:!0,get:function(){return n[x(2627)](this)},set:function(o){const c=x;g=""+o,s[c(2627)](this,o)}}),Object[x(2899)](i,e,{enumerable:t[x(395)]}),{getValue:function(){return g},setValue:function(o){g=""+o},stopTracking:function(){const o=x;i[o(3562)]=null,delete i[e]}}}}function Jl(i){const x=I;i[x(3562)]||(i[x(3562)]=Mw(i))}function GZ(i){const x=I;if(!i)return!1;var e=i[x(3562)];if(!e)return!0;var t=e[x(1508)](),g="";return i&&(g=mZ(i)?i[x(1010)]?x(2778):"false":i.value),i=g,i!==t?(e[x(342)](i),!0):!1}function Rr(i){const x=I;if(i=i||(x(1797)!==typeof document?document:void 0),x(1797)===typeof i)return null;try{return i.activeElement||i[x(1153)]}catch{return i[x(1153)]}}function zu(i,x){const e=I;var t=x.checked;return le({},x,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i[e(3620)][e(2686)]})}function Nm(i,x){const e=I;var t=x.defaultValue==null?"":x.defaultValue,g=x[e(1010)]!=null?x[e(1010)]:x[e(1500)];t=Yn(x[e(2113)]!=null?x.value:t),i[e(3620)]={initialChecked:g,initialValue:t,controlled:e(3577)===x.type||x[e(3505)]==="radio"?x.checked!=null:x[e(2113)]!=null}}function pZ(i,x){x=x[I(1010)],x!=null&&Gh(i,"checked",x,!1)}function Mu(i,x){const e=I;pZ(i,x);var t=Yn(x[e(2113)]),g=x[e(3505)];if(t!=null)e(1025)===g?(t===0&&i[e(2113)]===""||i[e(2113)]!=t)&&(i[e(2113)]=""+t):i.value!==""+t&&(i.value=""+t);else if(g==="submit"||g==="reset"){i[e(1357)](e(2113));return}x[e(3631)](e(2113))?Lu(i,x.type,t):x.hasOwnProperty(e(320))&&Lu(i,x[e(3505)],Yn(x[e(320)])),x[e(1010)]==null&&x[e(1500)]!=null&&(i[e(1500)]=!!x[e(1500)])}function Fm(i,x,e){const t=I;if(x[t(3631)]("value")||x[t(3631)]("defaultValue")){var g=x.type;if(!(g!=="submit"&&t(1877)!==g||x.value!==void 0&&x[t(2113)]!==null))return;x=""+i[t(3620)][t(3323)],e||x===i[t(2113)]||(i[t(2113)]=x),i[t(320)]=x}e=i[t(1474)],e!==""&&(i[t(1474)]=""),i[t(1500)]=!!i[t(3620)][t(2686)],e!==""&&(i[t(1474)]=e)}function Lu(i,x,e){const t=I;(t(1025)!==x||Rr(i[t(2070)])!==i)&&(e==null?i[t(320)]=""+i[t(3620)][t(3323)]:i[t(320)]!==""+e&&(i.defaultValue=""+e))}var Zc=Array.isArray;function xo(i,x,e,t){const g=I;if(i=i[g(1198)],x){x={};for(var n=0;n<e[g(2989)];n++)x["$"+e[n]]=!0;for(e=0;e<i[g(2989)];e++)n=x[g(3631)]("$"+i[e][g(2113)]),i[e].selected!==n&&(i[e].selected=n),n&&t&&(i[e][g(124)]=!0)}else{for(e=""+Yn(e),x=null,n=0;n<i.length;n++){if(i[n][g(2113)]===e){i[n][g(2762)]=!0,t&&(i[n][g(124)]=!0);return}x!==null||i[n][g(2412)]||(x=i[n])}x!==null&&(x[g(2762)]=!0)}}function ku(i,x){if(x[I(698)]!=null)throw Error(N0(91));return le({},x,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function zm(i,x){const e=I;var t=x[e(2113)];if(t==null){if(t=x.children,x=x[e(320)],t!=null){if(x!=null)throw Error(N0(92));if(Zc(t)){if(1<t[e(2989)])throw Error(N0(93));t=t[0]}x=t}x==null&&(x=""),t=x}i[e(3620)]={initialValue:Yn(t)}}function BZ(i,x){const e=I;var t=Yn(x[e(2113)]),g=Yn(x[e(320)]);t!=null&&(t=""+t,t!==i[e(2113)]&&(i.value=t),x[e(320)]==null&&i[e(320)]!==t&&(i[e(320)]=t)),g!=null&&(i[e(320)]=""+g)}function Mm(i){const x=I;var e=i.textContent;e===i[x(3620)][x(3323)]&&e!==""&&e!==null&&(i[x(2113)]=e)}function ZZ(i){const x=I;switch(i){case x(2812):return x(196);case x(2656):return x(2182);default:return x(3909)}}function Tu(i,x){const e=I;return i==null||i==="http://www.w3.org/1999/xhtml"?ZZ(x):e(196)===i&&e(3038)===x?e(3909):i}var El,yZ=function(i){const x=I;return x(1797)!==typeof MSApp&&MSApp[x(1470)]?function(e,t,g,n){const s=x;MSApp[s(1470)](function(){return i(e,t,g,n)})}:i}(function(i,x){const e=I;if(e(196)!==i.namespaceURI||"innerHTML"in i)i[e(2027)]=x;else{for(El=El||document.createElement("div"),El.innerHTML="<svg>"+x.valueOf()[e(2635)]()+e(3303),x=El[e(1290)];i[e(1290)];)i[e(207)](i[e(1290)]);for(;x[e(1290)];)i.appendChild(x[e(1290)])}});function Ec(i,x){const e=I;if(x){var t=i[e(1290)];if(t&&t===i[e(1554)]&&t[e(773)]===3){t[e(1328)]=x;return}}i[e(2029)]=x}var Rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lw=["Webkit","ms",I(1608),"O"];Object[I(958)](Rc).forEach(function(i){const x=I;Lw[x(1599)](function(e){const t=x;e=e+i.charAt(0).toUpperCase()+i[t(981)](1),Rc[e]=Rc[i]})});function vZ(i,x,e){const t=I;return x==null||t(3889)===typeof x||x===""?"":e||t(1025)!==typeof x||x===0||Rc[t(3631)](i)&&Rc[i]?(""+x)[t(1388)]():x+"px"}function WZ(i,x){const e=I;i=i.style;for(var t in x)if(x[e(3631)](t)){var g=t.indexOf("--")===0,n=vZ(t,x[t],g);e(3290)===t&&(t=e(1452)),g?i.setProperty(t,n):i[t]=n}}var kw=le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ju(i,x){const e=I;if(x){if(kw[i]&&(x[e(1352)]!=null||x[e(698)]!=null))throw Error(N0(137,i));if(x[e(698)]!=null){if(x[e(1352)]!=null)throw Error(N0(60));if(e(1011)!==typeof x[e(698)]||!(e(2697)in x[e(698)]))throw Error(N0(61))}if(x[e(1720)]!=null&&e(1011)!==typeof x[e(1720)])throw Error(N0(62))}}function Eu(i,x){const e=I;if(i[e(2377)]("-")===-1)return e(3674)===typeof x.is;switch(i){case e(2505):case e(573):case e(2010):case e(671):case e(2399):case e(2988):case e(2136):case e(3019):return!1;default:return!0}}var Uu=null;function yh(i){const x=I;return i=i[x(2930)]||i.srcElement||window,i[x(3058)]&&(i=i[x(3058)]),i.nodeType===3?i[x(2310)]:i}var _u=null,eo=null,to=null;function Lm(i){const x=I;if(i=SC(i)){if(x(1126)!==typeof _u)throw Error(N0(280));var e=i[x(1133)];e&&(e=a2(e),_u(i.stateNode,i[x(3505)],e))}}function wZ(i){eo?to?to[I(3330)](i):to=[i]:eo=i}function RZ(){if(eo){var i=eo,x=to;if(to=eo=null,Lm(i),x)for(i=0;i<x.length;i++)Lm(x[i])}}function VZ(i,x){return i(x)}function SZ(){}var oA=!1;function XZ(i,x,e){if(oA)return i(x,e);oA=!0;try{return VZ(i,x,e)}finally{oA=!1,(eo!==null||to!==null)&&(SZ(),RZ())}}function Uc(i,x){const e=I;var t=i[e(1133)];if(t===null)return null;var g=a2(t);if(g===null)return null;t=g[x];x:switch(x){case e(2834):case e(2080):case e(3576):case"onDoubleClickCapture":case e(1862):case e(1545):case"onMouseMove":case e(1793):case e(1636):case e(2513):case"onMouseEnter":(g=!g[e(2412)])||(i=i[e(3505)],g=!(i==="button"||e(2217)===i||e(1860)===i||i==="textarea")),i=!g;break x;default:i=!1}if(i)return null;if(t&&e(1126)!==typeof t)throw Error(N0(231,x,typeof t));return t}var Du=!1;if(ki)try{var $o={};Object[I(2899)]($o,"passive",{get:function(){Du=!0}}),window[I(2134)]("test",$o,$o),window[I(1216)](I(3633),$o,$o)}catch{Du=!1}function Tw(i,x,e,t,g,n,s,o,c){const C=I;var r=Array.prototype.slice[C(2627)](arguments,3);try{x[C(1307)](e,r)}catch(A){this[C(3239)](A)}}var Vc=!1,Vr=null,Sr=!1,Qu=null,Jw={onError:function(i){Vc=!0,Vr=i}};function Ew(i,x,e,t,g,n,s,o,c){const C=I;Vc=!1,Vr=null,Tw[C(1307)](Jw,arguments)}function Uw(i,x,e,t,g,n,s,o,c){if(Ew.apply(this,arguments),Vc){if(Vc){var C=Vr;Vc=!1,Vr=null}else throw Error(N0(198));Sr||(Sr=!0,Qu=C)}}function EI(i){const x=I;var e=i,t=i;if(i[x(641)])for(;e.return;)e=e.return;else{i=e;do e=i,e[x(2436)]&4098&&(t=e.return),i=e.return;while(i)}return e[x(3795)]===3?t:null}function YZ(i){const x=I;if(i[x(3795)]===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i[x(485)])),e!==null)return e[x(772)]}return null}function km(i){if(EI(i)!==i)throw Error(N0(188))}function _w(i){const x=I;var e=i[x(641)];if(!e){if(e=EI(i),e===null)throw Error(N0(188));return e!==i?null:i}for(var t=i,g=e;;){var n=t[x(3922)];if(n===null)break;var s=n.alternate;if(s===null){if(g=n[x(3922)],g!==null){t=g;continue}break}if(n[x(1367)]===s[x(1367)]){for(s=n[x(1367)];s;){if(s===t)return km(n),i;if(s===g)return km(n),e;s=s[x(1263)]}throw Error(N0(188))}if(t.return!==g[x(3922)])t=n,g=s;else{for(var o=!1,c=n[x(1367)];c;){if(c===t){o=!0,t=n,g=s;break}if(c===g){o=!0,g=n,t=s;break}c=c[x(1263)]}if(!o){for(c=s.child;c;){if(c===t){o=!0,t=s,g=n;break}if(c===g){o=!0,g=s,t=n;break}c=c[x(1263)]}if(!o)throw Error(N0(189))}}if(t[x(641)]!==g)throw Error(N0(190))}if(t.tag!==3)throw Error(N0(188));return t[x(1133)].current===t?i:e}function KZ(i){return i=_w(i),i!==null?HZ(i):null}function HZ(i){const x=I;if(i[x(3795)]===5||i[x(3795)]===6)return i;for(i=i[x(1367)];i!==null;){var e=HZ(i);if(e!==null)return e;i=i[x(1263)]}return null}var NZ=ig[I(3790)],Tm=ig.unstable_cancelCallback,Dw=ig[I(822)],Qw=ig[I(943)],fe=ig.unstable_now,Pw=ig.unstable_getCurrentPriorityLevel,vh=ig.unstable_ImmediatePriority,FZ=ig[I(543)],Xr=ig[I(246)],Ow=ig.unstable_LowPriority,zZ=ig[I(1264)],o2=null,Ci=null;function qw(i){const x=I;if(Ci&&x(1126)===typeof Ci.onCommitFiberRoot)try{Ci[x(3753)](o2,i,void 0,(i[x(1895)].flags&128)===128)}catch{}}var Mg=Math[I(3611)]?Math.clz32:xR,$w=Math[I(2013)],jw=Math[I(3048)];function xR(i){return i>>>=0,i===0?32:31-($w(i)/jw|0)|0}var Ul=64,_l=4194304;function yc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Yr(i,x){const e=I;var t=i[e(294)];if(t===0)return 0;var g=0,n=i[e(824)],s=i.pingedLanes,o=t&268435455;if(o!==0){var c=o&~n;c!==0?g=yc(c):(s&=o,s!==0&&(g=yc(s)))}else o=t&~n,o!==0?g=yc(o):s!==0&&(g=yc(s));if(g===0)return 0;if(x!==0&&x!==g&&!(x&n)&&(n=g&-g,s=x&-x,n>=s||n===16&&(s&4194240)!==0))return x;if(g&4&&(g|=t&16),x=i.entangledLanes,x!==0)for(i=i.entanglements,x&=g;0<x;)t=31-Mg(x),n=1<<t,g|=i[t],x&=~n;return g}function eR(i,x){switch(i){case 1:case 2:case 4:return x+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tR(i,x){const e=I;for(var t=i.suspendedLanes,g=i[e(3632)],n=i[e(3593)],s=i[e(294)];0<s;){var o=31-Mg(s),c=1<<o,C=n[o];C===-1?(!(c&t)||c&g)&&(n[o]=eR(c,x)):C<=x&&(i[e(2330)]|=c),s&=~c}}function Pu(i){return i=i[I(294)]&-1073741825,i!==0?i:i&1073741824?1073741824:0}function MZ(){var i=Ul;return Ul<<=1,!(Ul&4194240)&&(Ul=64),i}function cA(i){for(var x=[],e=0;31>e;e++)x.push(i);return x}function RC(i,x,e){const t=I;i[t(294)]|=x,x!==536870912&&(i[t(824)]=0,i[t(3632)]=0),i=i[t(504)],x=31-Mg(x),i[x]=e}function gR(i,x){const e=I;var t=i[e(294)]&~x;i[e(294)]=x,i[e(824)]=0,i.pingedLanes=0,i[e(2330)]&=x,i[e(583)]&=x,i[e(3580)]&=x,x=i[e(154)];var g=i[e(504)];for(i=i[e(3593)];0<t;){var n=31-Mg(t),s=1<<n;x[n]=0,g[n]=-1,i[n]=-1,t&=~s}}function Wh(i,x){const e=I;var t=i[e(3580)]|=x;for(i=i.entanglements;t;){var g=31-Mg(t),n=1<<g;n&x|i[g]&x&&(i[g]|=x),t&=~n}}var Qx=0;function LZ(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var kZ,wh,TZ,JZ,EZ,Ou=!1,Dl=[],Zn=null,yn=null,vn=null,_c=new Map,Dc=new Map,fn=[],iR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit"[I(2874)](" ");function Jm(i,x){const e=I;switch(i){case"focusin":case e(423):Zn=null;break;case e(502):case e(1677):yn=null;break;case e(1732):case"mouseout":vn=null;break;case e(3441):case e(2696):_c[e(1432)](x[e(220)]);break;case e(2149):case e(1201):Dc[e(1432)](x[e(220)])}}function jo(i,x,e,t,g,n){const s=I;return i===null||i[s(3552)]!==n?(i={blockedOn:x,domEventName:e,eventSystemFlags:t,nativeEvent:n,targetContainers:[g]},x!==null&&(x=SC(x),x!==null&&wh(x)),i):(i[s(2975)]|=t,x=i.targetContainers,g!==null&&x[s(2377)](g)===-1&&x[s(3330)](g),i)}function nR(i,x,e,t,g){const n=I;switch(x){case n(409):return Zn=jo(Zn,i,x,e,t,g),!0;case n(502):return yn=jo(yn,i,x,e,t,g),!0;case n(1732):return vn=jo(vn,i,x,e,t,g),!0;case n(3441):var s=g[n(220)];return _c[n(298)](s,jo(_c[n(2695)](s)||null,i,x,e,t,g)),!0;case n(2149):return s=g[n(220)],Dc.set(s,jo(Dc[n(2695)](s)||null,i,x,e,t,g)),!0}return!1}function UZ(i){const x=I;var e=pI(i[x(2930)]);if(e!==null){var t=EI(e);if(t!==null){if(e=t[x(3795)],e===13){if(e=YZ(t),e!==null){i.blockedOn=e,EZ(i[x(668)],function(){TZ(t)});return}}else if(e===3&&t[x(1133)].current[x(485)].isDehydrated){i[x(3752)]=t[x(3795)]===3?t.stateNode[x(1951)]:null;return}}}i.blockedOn=null}function cr(i){const x=I;if(i[x(3752)]!==null)return!1;for(var e=i[x(601)];0<e.length;){var t=qu(i[x(653)],i[x(2975)],e[0],i[x(3552)]);if(t===null){t=i[x(3552)];var g=new t[x(135)](t[x(3505)],t);Uu=g,t[x(2930)][x(1457)](g),Uu=null}else return e=SC(t),e!==null&&wh(e),i.blockedOn=t,!1;e.shift()}return!0}function Em(i,x,e){const t=I;cr(i)&&e[t(1432)](x)}function IR(){const i=I;Ou=!1,Zn!==null&&cr(Zn)&&(Zn=null),yn!==null&&cr(yn)&&(yn=null),vn!==null&&cr(vn)&&(vn=null),_c[i(1599)](Em),Dc[i(1599)](Em)}function xc(i,x){const e=I;i[e(3752)]===x&&(i[e(3752)]=null,Ou||(Ou=!0,ig[e(3790)](ig.unstable_NormalPriority,IR)))}function Qc(i){const x=I;function e(n){return xc(n,i)}if(0<Dl[x(2989)]){xc(Dl[0],i);for(var t=1;t<Dl[x(2989)];t++){var g=Dl[t];g[x(3752)]===i&&(g[x(3752)]=null)}}for(Zn!==null&&xc(Zn,i),yn!==null&&xc(yn,i),vn!==null&&xc(vn,i),_c[x(1599)](e),Dc.forEach(e),t=0;t<fn.length;t++)g=fn[t],g[x(3752)]===i&&(g[x(3752)]=null);for(;0<fn.length&&(t=fn[0],t[x(3752)]===null);)UZ(t),t[x(3752)]===null&&fn[x(214)]()}var go=_i.ReactCurrentBatchConfig,Kr=!0;function sR(i,x,e,t){const g=I;var n=Qx,s=go[g(1691)];go[g(1691)]=null;try{Qx=1,Rh(i,x,e,t)}finally{Qx=n,go[g(1691)]=s}}function oR(i,x,e,t){const g=I;var n=Qx,s=go.transition;go[g(1691)]=null;try{Qx=4,Rh(i,x,e,t)}finally{Qx=n,go[g(1691)]=s}}function Rh(i,x,e,t){const g=I;if(Kr){var n=qu(i,x,e,t);if(n===null)fA(i,x,t,Hr,e),Jm(i,t);else if(nR(n,i,x,e,t))t[g(3016)]();else if(Jm(i,t),x&4&&-1<iR.indexOf(i)){for(;n!==null;){var s=SC(n);if(s!==null&&kZ(s),s=qu(i,x,e,t),s===null&&fA(i,x,t,Hr,e),s===n)break;n=s}n!==null&&t[g(3016)]()}else fA(i,x,t,null,e)}}var Hr=null;function qu(i,x,e,t){const g=I;if(Hr=null,i=yh(t),i=pI(i),i!==null)if(x=EI(i),x===null)i=null;else if(e=x.tag,e===13){if(i=YZ(x),i!==null)return i;i=null}else if(e===3){if(x[g(1133)][g(1895)][g(485)][g(2290)])return x[g(3795)]===3?x[g(1133)].containerInfo:null;i=null}else x!==i&&(i=null);return Hr=i,null}function _Z(i){const x=I;switch(i){case x(1035):case x(1115):case x(2039):case x(2810):case"copy":case x(2280):case x(654):case x(2263):case x(2336):case x(2046):case x(114):case"focusin":case"focusout":case x(2217):case"invalid":case x(2649):case"keypress":case x(2976):case x(3370):case x(1268):case x(2426):case x(278):case x(2763):case x(1783):case"pointerdown":case x(269):case x(142):case x(1877):case"resize":case x(3952):case x(1120):case"touchcancel":case x(789):case"touchstart":case"volumechange":case"change":case x(3560):case x(1196):case x(3794):case x(3263):case x(947):case x(1119):case x(2486):case x(1795):case x(766):case x(2155):case"focus":case x(3780):case x(1819):case x(1860):case x(1927):return 1;case x(1187):case x(502):case x(844):case"dragleave":case x(3012):case x(1067):case x(1172):case x(1732):case x(1693):case x(2696):case x(3441):case x(3234):case x(526):case x(2901):case x(1785):case x(1933):case x(3710):case x(3933):case x(3535):return 4;case x(268):switch(Pw()){case vh:return 1;case FZ:return 4;case Xr:case Ow:return 16;case zZ:return 536870912;default:return 16}default:return 16}}var pn=null,Vh=null,Cr=null;function DZ(){const i=I;if(Cr)return Cr;var x,e=Vh,t=e[i(2989)],g,n="value"in pn?pn[i(2113)]:pn[i(2029)],s=n[i(2989)];for(x=0;x<t&&e[x]===n[x];x++);var o=t-x;for(g=1;g<=o&&e[t-g]===n[s-g];g++);return Cr=n[i(1226)](x,1<g?1-g:void 0)}function lr(i){const x=I;var e=i[x(368)];return x(2558)in i?(i=i[x(2558)],i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function Ql(){return!0}function Um(){return!1}function ng(i){const x=I;function e(t,g,n,s,o){const c=i0;this[c(3220)]=t,this[c(2853)]=n,this[c(3505)]=g,this[c(3552)]=s,this.target=o,this[c(589)]=null;for(var C in i)i[c(3631)](C)&&(t=i[C],this[C]=t?t(s):s[C]);return this[c(2428)]=(s[c(486)]!=null?s[c(486)]:s[c(1815)]===!1)?Ql:Um,this[c(1315)]=Um,this}return le(e[x(1566)],{preventDefault:function(){const t=x;this[t(486)]=!0;var g=this[t(3552)];g&&(g[t(317)]?g[t(317)]():t(1221)!==typeof g[t(1815)]&&(g[t(1815)]=!1),this[t(2428)]=Ql)},stopPropagation:function(){const t=x;var g=this[t(3552)];g&&(g.stopPropagation?g[t(3016)]():t(1221)!==typeof g[t(1935)]&&(g.cancelBubble=!0),this.isPropagationStopped=Ql)},persist:function(){},isPersistent:Ql}),e}var po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i[I(3578)]||Date.now()},defaultPrevented:0,isTrusted:0},Sh=ng(po),VC=le({},po,{view:0,detail:0}),cR=ng(VC),CA,lA,ec,c2=le({},VC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xh,button:0,buttons:0,relatedTarget:function(i){const x=I;return i[x(1544)]===void 0?i[x(2978)]===i.srcElement?i.toElement:i.fromElement:i[x(1544)]},movementX:function(i){const x=I;return"movementX"in i?i.movementX:(i!==ec&&(ec&&x(1067)===i[x(3505)]?(CA=i[x(217)]-ec[x(217)],lA=i.screenY-ec[x(1281)]):lA=CA=0,ec=i),CA)},movementY:function(i){const x=I;return"movementY"in i?i[x(3339)]:lA}}),_m=ng(c2),CR=le({},c2,{dataTransfer:0}),lR=ng(CR),aR=le({},VC,{relatedTarget:0}),aA=ng(aR),rR=le({},po,{animationName:0,elapsedTime:0,pseudoElement:0}),dR=ng(rR),AR=le({},po,{clipboardData:function(i){const x=I;return x(2948)in i?i.clipboardData:window[x(2948)]}}),uR=ng(AR),bR=le({},po,{data:0}),Dm=ng(bR),hR={Esc:I(3136),Spacebar:" ",Left:I(3882),Up:I(3640),Right:I(1546),Down:I(2947),Del:I(3426),Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fR={8:I(3950),9:I(1393),12:"Clear",13:"Enter",16:"Shift",17:I(3020),18:I(1366),19:I(212),20:"CapsLock",27:I(3136),32:" ",33:"PageUp",34:I(1850),35:I(2786),36:"Home",37:"ArrowLeft",38:I(3640),39:I(1546),40:I(2947),45:I(951),46:I(3426),112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:I(2460),122:I(3203),123:I(3491),144:I(2953),145:"ScrollLock",224:"Meta"},mR={Alt:I(1054),Control:I(3625),Meta:I(1826),Shift:"shiftKey"};function GR(i){const x=I;var e=this.nativeEvent;return e[x(1731)]?e[x(1731)](i):(i=mR[i])?!!e[i]:!1}function Xh(){return GR}var pR=le({},VC,{key:function(i){const x=I;if(i[x(581)]){var e=hR[i[x(581)]]||i[x(581)];if(x(3205)!==e)return e}return x(3816)===i.type?(i=lr(i),i===13?x(2197):String.fromCharCode(i)):x(2649)===i[x(3505)]||x(2976)===i.type?fR[i[x(368)]]||x(3205):""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xh,charCode:function(i){const x=I;return x(3816)===i[x(3505)]?lr(i):0},keyCode:function(i){const x=I;return i[x(3505)]==="keydown"||x(2976)===i[x(3505)]?i[x(368)]:0},which:function(i){const x=I;return x(3816)===i[x(3505)]?lr(i):x(2649)===i.type||x(2976)===i[x(3505)]?i[x(368)]:0}}),BR=ng(pR),ZR=le({},c2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qm=ng(ZR),yR=le({},VC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xh}),vR=ng(yR),WR=le({},po,{propertyName:0,elapsedTime:0,pseudoElement:0}),wR=ng(WR),RR=le({},c2,{deltaX:function(i){const x=I;return"deltaX"in i?i[x(1351)]:x(3978)in i?-i[x(3978)]:0},deltaY:function(i){const x=I;return x(2585)in i?i[x(2585)]:x(191)in i?-i[x(191)]:x(424)in i?-i[x(424)]:0},deltaZ:0,deltaMode:0}),VR=ng(RR),SR=[9,13,27,32],Yh=ki&&I(3067)in window,Sc=null;ki&&I(2125)in document&&(Sc=document[I(2125)]);var XR=ki&&I(1943)in window&&!Sc,QZ=ki&&(!Yh||Sc&&8<Sc&&11>=Sc),Pm=String[I(1880)](32),Om=!1;function PZ(i,x){const e=I;switch(i){case"keyup":return SR[e(2377)](x[e(368)])!==-1;case e(2649):return x[e(368)]!==229;case e(3816):case e(3370):case e(423):return!0;default:return!1}}function OZ(i){const x=I;return i=i[x(2093)],x(1011)===typeof i&&x(3787)in i?i[x(3787)]:null}var Fs=!1;function YR(i,x){const e=I;switch(i){case"compositionend":return OZ(x);case e(3816):return x[e(3448)]!==32?null:(Om=!0,Pm);case e(1196):return i=x[e(3787)],i===Pm&&Om?null:i;default:return null}}function KR(i,x){const e=I;if(Fs)return e(3263)===i||!Yh&&PZ(i,x)?(i=DZ(),Cr=Vh=pn=null,Fs=!1,i):null;switch(i){case e(2426):return null;case e(3816):if(!(x.ctrlKey||x[e(1054)]||x[e(1826)])||x[e(3625)]&&x[e(1054)]){if(x[e(2742)]&&1<x[e(2742)][e(2989)])return x[e(2742)];if(x[e(3448)])return String.fromCharCode(x[e(3448)])}return null;case e(3263):return QZ&&x[e(1154)]!=="ko"?null:x[e(3787)];default:return null}}var HR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qm(i){const x=I;var e=i&&i[x(1910)]&&i[x(1910)][x(2084)]();return e==="input"?!!HR[i.type]:e==="textarea"}function qZ(i,x,e,t){const g=I;wZ(t),x=Nr(x,g(506)),0<x[g(2989)]&&(e=new Sh(g(506),g(3848),null,e,t),i.push({event:e,listeners:x}))}var Xc=null,Pc=null;function NR(i){o5(i,0)}function C2(i){var x=Ls(i);if(GZ(x))return i}function FR(i,x){if(i==="change")return x}var $Z=!1;if(ki){var rA;if(ki){var dA="oninput"in document;if(!dA){var $m=document[I(2171)](I(778));$m.setAttribute(I(3475),I(1792)),dA=I(1126)===typeof $m[I(3475)]}rA=dA}else rA=!1;$Z=rA&&(!document[I(2125)]||9<document[I(2125)])}function jm(){const i=I;Xc&&(Xc[i(3862)](i(2775),jZ),Pc=Xc=null)}function jZ(i){if(I(2113)===i.propertyName&&C2(Pc)){var e=[];qZ(e,Pc,i,yh(i)),XZ(NR,e)}}function zR(i,x,e){const t=I;i==="focusin"?(jm(),Xc=x,Pc=e,Xc.attachEvent(t(2775),jZ)):t(423)===i&&jm()}function MR(i){const x=I;if(x(3560)===i||x(2976)===i||x(2649)===i)return C2(Pc)}function LR(i,x){if(i==="click")return C2(x)}function kR(i,x){const e=I;if(e(2217)===i||e(3848)===i)return C2(x)}function TR(i,x){return i===x&&(i!==0||1/i===1/x)||i!==i&&x!==x}var Tg=I(1126)===typeof Object.is?Object.is:TR;function Oc(i,x){const e=I;if(Tg(i,x))return!0;if(typeof i!="object"||i===null||typeof x!="object"||x===null)return!1;var t=Object[e(958)](i),g=Object[e(958)](x);if(t[e(2989)]!==g[e(2989)])return!1;for(g=0;g<t[e(2989)];g++){var n=t[g];if(!Yu.call(x,n)||!Tg(i[n],x[n]))return!1}return!0}function xG(i){const x=I;for(;i&&i[x(1290)];)i=i[x(1290)];return i}function eG(i,x){const e=I;var t=xG(i);i=0;for(var g;t;){if(t[e(773)]===3){if(g=i+t[e(2029)][e(2989)],i<=x&&g>=x)return{node:t,offset:x-i};i=g}x:{for(;t;){if(t[e(868)]){t=t[e(868)];break x}t=t[e(2310)]}t=void 0}t=xG(t)}}function x5(i,x){const e=I;return i&&x?i===x?!0:i&&i.nodeType===3?!1:x&&x[e(773)]===3?x5(i,x[e(2310)]):"contains"in i?i[e(1685)](x):i[e(3481)]?!!(i[e(3481)](x)&16):!1:!1}function e5(){const i=I;for(var x=window,e=Rr();e instanceof x[i(2285)];){try{var t=typeof e[i(1241)].location.href=="string"}catch{t=!1}if(t)x=e[i(1241)];else break;e=Rr(x[i(2597)])}return e}function Kh(i){const x=I;var e=i&&i[x(1910)]&&i[x(1910)][x(2084)]();return e&&(x(2217)===e&&(i.type==="text"||x(2414)===i[x(3505)]||x(370)===i.type||x(412)===i[x(3505)]||x(1628)===i[x(3505)])||e==="textarea"||i[x(661)]==="true")}function JR(i){const x=I;var e=e5(),t=i[x(3237)],g=i[x(2040)];if(e!==t&&t&&t.ownerDocument&&x5(t.ownerDocument[x(1584)],t)){if(g!==null&&Kh(t)){if(e=g[x(3988)],i=g[x(922)],i===void 0&&(i=e),"selectionStart"in t)t[x(454)]=e,t[x(2196)]=Math[x(1410)](i,t[x(2113)][x(2989)]);else if(i=(e=t[x(2070)]||document)&&e[x(1069)]||window,i[x(1334)]){i=i[x(1334)]();var n=t[x(2029)].length,s=Math[x(1410)](g[x(3988)],n);g=g[x(922)]===void 0?s:Math[x(1410)](g[x(922)],n),!i[x(289)]&&s>g&&(n=g,g=s,s=n),n=eG(t,s);var o=eG(t,g);n&&o&&(i[x(3210)]!==1||i[x(3197)]!==n[x(2520)]||i.anchorOffset!==n[x(872)]||i[x(359)]!==o[x(2520)]||i[x(497)]!==o[x(872)])&&(e=e[x(2715)](),e[x(1135)](n.node,n[x(872)]),i[x(3056)](),s>g?(i[x(517)](e),i[x(289)](o[x(2520)],o[x(872)])):(e[x(1660)](o[x(2520)],o[x(872)]),i[x(517)](e)))}}for(e=[],i=t;i=i.parentNode;)i[x(773)]===1&&e[x(3330)]({element:i,left:i[x(1811)],top:i[x(1356)]});for(typeof t.focus=="function"&&t[x(2950)](),t=0;t<e[x(2989)];t++)i=e[t],i[x(545)].scrollLeft=i[x(2881)],i.element[x(1356)]=i[x(2058)]}}var ER=ki&&"documentMode"in document&&11>=document[I(2125)],zs=null,$u=null,Yc=null,ju=!1;function tG(i,x,e){const t=I;var g=e[t(754)]===e?e[t(2597)]:e[t(773)]===9?e:e.ownerDocument;ju||zs==null||zs!==Rr(g)||(g=zs,t(454)in g&&Kh(g)?g={start:g[t(454)],end:g[t(2196)]}:(g=(g[t(2070)]&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g[t(3197)],anchorOffset:g[t(3163)],focusNode:g[t(359)],focusOffset:g[t(497)]}),Yc&&Oc(Yc,g)||(Yc=g,g=Nr($u,"onSelect"),0<g.length&&(x=new Sh("onSelect","select",null,x,e),i[t(3330)]({event:x,listeners:g}),x[t(2930)]=zs)))}function Pl(i,x){const e=I;var t={};return t[i[e(2084)]()]=x.toLowerCase(),t[e(564)+i]=e(350)+x,t[e(1608)+i]=e(2100)+x,t}var Ms={animationend:Pl(I(643),I(3279)),animationiteration:Pl(I(643),"AnimationIteration"),animationstart:Pl(I(643),"AnimationStart"),transitionend:Pl(I(131),I(735))},AA={},t5={};ki&&(t5=document[I(2171)](I(778))[I(1720)],I(2970)in window||(delete Ms[I(565)][I(997)],delete Ms.animationiteration[I(997)],delete Ms.animationstart[I(997)]),I(3806)in window||delete Ms[I(3953)][I(1691)]);function l2(i){const x=I;if(AA[i])return AA[i];if(!Ms[i])return i;var e=Ms[i],t;for(t in e)if(e[x(3631)](t)&&t in t5)return AA[i]=e[t];return i}var g5=l2(I(565)),i5=l2(I(193)),n5=l2("animationstart"),I5=l2(I(3953)),s5=new Map,gG=I(2240)[I(2874)](" ");function An(i,x){s5[I(298)](i,x),lI(x,[i])}for(var uA=0;uA<gG[I(2989)];uA++){var bA=gG[uA],UR=bA[I(2084)](),_R=bA[0].toUpperCase()+bA[I(1226)](1);An(UR,"on"+_R)}An(g5,I(1650)),An(i5,I(1240)),An(n5,I(2442)),An(I(2263),I(3576)),An("focusin",I(918)),An(I(423),"onBlur"),An(I5,I(2650)),Ks(I(780),[I(1172),"mouseover"]),Ks(I(2575),[I(1172),"mouseover"]),Ks(I(3111),[I(2696),I(3441)]),Ks(I(2356),[I(2696),I(3441)]),lI("onChange",I(1663)[I(2874)](" ")),lI(I(2249),I(1718)[I(2874)](" ")),lI(I(3902),[I(3263),I(3816),I(1196),I(2426)]),lI("onCompositionEnd",I(1345)[I(2874)](" ")),lI("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown"[I(2874)](" ")),lI("onCompositionUpdate",I(250).split(" "));var vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting"[I(2874)](" "),DR=new Set("cancel close invalid load scroll toggle".split(" ")[I(534)](vc));function iG(i,x,e){const t=I;var g=i.type||t(1976);i[t(589)]=e,Uw(g,x,void 0,i),i[t(589)]=null}function o5(i,x){const e=I;x=(x&4)!==0;for(var t=0;t<i[e(2989)];t++){var g=i[t],n=g[e(1751)];g=g[e(3566)];x:{var s=void 0;if(x)for(var o=g.length-1;0<=o;o--){var c=g[o],C=c[e(369)],r=c[e(589)];if(c=c[e(976)],C!==s&&n[e(1315)]())break x;iG(n,c,r),s=C}else for(o=0;o<g[e(2989)];o++){if(c=g[o],C=c.instance,r=c[e(589)],c=c.listener,C!==s&&n[e(1315)]())break x;iG(n,c,r),s=C}}}if(Sr)throw i=Qu,Sr=!1,Qu=null,i}function xe(i,x){const e=I;var t=x[ib];t===void 0&&(t=x[ib]=new Set);var g=i+e(3211);t.has(g)||(c5(x,i,2,!1),t.add(g))}function hA(i,x,e){var t=0;x&&(t|=4),c5(e,i,t,x)}var Ol=I(3373)+Math[I(2938)]()[I(2635)](36)[I(1226)](2);function qc(i){const x=I;if(!i[Ol]){i[Ol]=!0,uZ.forEach(function(t){const g=i0;g(3560)!==t&&(DR[g(2489)](t)||hA(t,!1,i),hA(t,!0,i))});var e=i[x(773)]===9?i:i[x(2070)];e===null||e[Ol]||(e[Ol]=!0,hA(x(3560),!1,e))}}function c5(i,x,e,t){const g=I;switch(_Z(x)){case 1:var n=sR;break;case 4:n=oR;break;default:n=Rh}e=n[g(1600)](null,x,e,i),n=void 0,!Du||x!=="touchstart"&&g(2901)!==x&&g(1785)!==x||(n=!0),t?n!==void 0?i[g(2134)](x,e,{capture:!0,passive:n}):i[g(2134)](x,e,!0):n!==void 0?i.addEventListener(x,e,{passive:n}):i[g(2134)](x,e,!1)}function fA(i,x,e,t,g){const n=I;var s=t;if(!(x&1)&&!(x&2)&&t!==null)x:for(;;){if(t===null)return;var o=t.tag;if(o===3||o===4){var c=t[n(1133)][n(1951)];if(c===g||c.nodeType===8&&c[n(2310)]===g)break;if(o===4)for(o=t.return;o!==null;){var C=o[n(3795)];if((C===3||C===4)&&(C=o[n(1133)][n(1951)],C===g||C.nodeType===8&&C.parentNode===g))return;o=o[n(3922)]}for(;c!==null;){if(o=pI(c),o===null)return;if(C=o.tag,C===5||C===6){t=s=o;continue x}c=c[n(2310)]}}t=t[n(3922)]}XZ(function(){const r=n;var A=s,d=yh(e),h=[];x:{var f=s5[r(2695)](i);if(f!==void 0){var B=Sh,Z=i;switch(i){case"keypress":if(lr(e)===0)break x;case r(2649):case r(2976):B=BR;break;case r(409):Z=r(2950),B=aA;break;case r(423):Z=r(766),B=aA;break;case"beforeblur":case r(2486):B=aA;break;case r(1115):if(e[r(2828)]===2)break x;case r(654):case"dblclick":case r(3370):case"mousemove":case r(1268):case r(1172):case r(1732):case r(2810):B=_m;break;case r(1187):case r(2336):case r(502):case"dragexit":case r(1677):case r(3012):case"dragstart":case r(114):B=lR;break;case r(2354):case r(789):case r(2901):case r(1543):B=vR;break;case g5:case i5:case n5:B=dR;break;case I5:B=wR;break;case r(3234):B=cR;break;case r(1785):B=VR;break;case r(1493):case r(2280):case r(2426):B=uR;break;case r(2149):case r(1201):case r(1783):case"pointerdown":case"pointermove":case r(2696):case"pointerover":case r(269):B=Qm}var G=(x&4)!==0,m=!G&&r(3234)===i,v=G?f!==null?f+"Capture":null:f;G=[];for(var p=A,w;p!==null;){w=p;var V=w[r(1133)];if(w.tag===5&&V!==null&&(w=V,v!==null&&(V=Uc(p,v),V!=null&&G[r(3330)]($c(p,V,w)))),m)break;p=p.return}0<G.length&&(f=new B(f,Z,null,e,d),h[r(3330)]({event:f,listeners:G}))}}if(!(x&7)){x:{if(f=i==="mouseover"||i==="pointerover",B=i==="mouseout"||i==="pointerout",f&&e!==Uu&&(Z=e[r(1544)]||e[r(2978)])&&(pI(Z)||Z[Fi]))break x;if((B||f)&&(f=d[r(754)]===d?d:(f=d[r(2070)])?f[r(1069)]||f[r(665)]:window,B?(Z=e[r(1544)]||e[r(2123)],B=A,Z=Z?pI(Z):null,Z!==null&&(m=EI(Z),Z!==m||Z[r(3795)]!==5&&Z[r(3795)]!==6)&&(Z=null)):(B=null,Z=A),B!==Z)){if(G=_m,V="onMouseLeave",v=r(780),p="mouse",(i==="pointerout"||r(3441)===i)&&(G=Qm,V=r(2356),v=r(3111),p=r(902)),m=B==null?f:Ls(B),w=Z==null?f:Ls(Z),f=new G(V,p+r(1502),B,e,d),f[r(2930)]=m,f[r(1544)]=w,V=null,pI(d)===A&&(G=new G(v,p+r(2470),Z,e,d),G[r(2930)]=w,G[r(1544)]=m,V=G),m=V,B&&Z)e:{for(G=B,v=Z,p=0,w=G;w;w=ss(w))p++;for(w=0,V=v;V;V=ss(V))w++;for(;0<p-w;)G=ss(G),p--;for(;0<w-p;)v=ss(v),w--;for(;p--;){if(G===v||v!==null&&G===v[r(641)])break e;G=ss(G),v=ss(v)}G=null}else G=null;B!==null&&nG(h,f,B,G,!1),Z!==null&&m!==null&&nG(h,m,Z,G,!0)}}x:{if(f=A?Ls(A):window,B=f.nodeName&&f[r(1910)][r(2084)](),r(1860)===B||r(2217)===B&&r(2811)===f.type)var N=FR;else if(qm(f))if($Z)N=kR;else{N=MR;var X=zR}else(B=f[r(1910)])&&r(2217)===B.toLowerCase()&&(r(3577)===f[r(3505)]||r(1403)===f[r(3505)])&&(N=LR);if(N&&(N=N(i,A))){qZ(h,N,e,d);break x}X&&X(i,f,A),r(423)===i&&(X=f[r(3620)])&&X.controlled&&r(1025)===f[r(3505)]&&Lu(f,r(1025),f[r(2113)])}switch(X=A?Ls(A):window,i){case r(409):(qm(X)||r(2778)===X.contentEditable)&&(zs=X,$u=A,Yc=null);break;case r(423):Yc=$u=zs=null;break;case r(3370):ju=!0;break;case r(2810):case r(1268):case r(2336):ju=!1,tG(h,e,d);break;case r(3560):if(ER)break;case r(2649):case r(2976):tG(h,e,d)}var M;if(Yh)x:{switch(i){case r(3794):var Y=r(286);break x;case"compositionend":Y=r(3607);break x;case"compositionupdate":Y=r(1002);break x}Y=void 0}else Fs?PZ(i,e)&&(Y="onCompositionEnd"):r(2649)===i&&e[r(368)]===229&&(Y=r(286));Y&&(QZ&&e[r(1154)]!=="ko"&&(Fs||r(286)!==Y?r(3607)===Y&&Fs&&(M=DZ()):(pn=d,Vh="value"in pn?pn[r(2113)]:pn[r(2029)],Fs=!0)),X=Nr(A,Y),0<X.length&&(Y=new Dm(Y,i,null,e,d),h[r(3330)]({event:Y,listeners:X}),M?Y.data=M:(M=OZ(e),M!==null&&(Y[r(3787)]=M)))),(M=XR?YR(i,e):KR(i,e))&&(A=Nr(A,"onBeforeInput"),0<A[r(2989)]&&(d=new Dm("onBeforeInput",r(1795),null,e,d),h.push({event:d,listeners:A}),d[r(3787)]=M))}o5(h,x)})}function $c(i,x,e){return{instance:i,listener:x,currentTarget:e}}function Nr(i,x){const e=I;for(var t=x+e(3482),g=[];i!==null;){var n=i,s=n.stateNode;n[e(3795)]===5&&s!==null&&(n=s,s=Uc(i,t),s!=null&&g[e(1907)]($c(i,s,n)),s=Uc(i,x),s!=null&&g.push($c(i,s,n))),i=i[e(3922)]}return g}function ss(i){const x=I;if(i===null)return null;do i=i[x(3922)];while(i&&i.tag!==5);return i||null}function nG(i,x,e,t,g){const n=I;for(var s=x[n(3220)],o=[];e!==null&&e!==t;){var c=e,C=c[n(641)],r=c[n(1133)];if(C!==null&&C===t)break;c[n(3795)]===5&&r!==null&&(c=r,g?(C=Uc(e,s),C!=null&&o[n(1907)]($c(e,C,c))):g||(C=Uc(e,s),C!=null&&o.push($c(e,C,c)))),e=e[n(3922)]}o.length!==0&&i[n(3330)]({event:x,listeners:o})}var QR=/\r\n?/g,PR=/\u0000|\uFFFD/g;function IG(i){return(typeof i=="string"?i:""+i).replace(QR,`
`).replace(PR,"")}function ql(i,x,e){if(x=IG(x),IG(i)!==x&&e)throw Error(N0(425))}function Fr(){}var xb=null,eb=null;function tb(i,x){const e=I;return i==="textarea"||e(2691)===i||e(3674)===typeof x.children||e(1025)===typeof x.children||e(1011)===typeof x[e(698)]&&x[e(698)]!==null&&x[e(698)][e(2697)]!=null}var gb=typeof setTimeout=="function"?setTimeout:void 0,OR=typeof clearTimeout=="function"?clearTimeout:void 0,sG=I(1126)===typeof Promise?Promise:void 0,qR=I(1126)===typeof queueMicrotask?queueMicrotask:I(1797)!==typeof sG?function(i){const x=I;return sG[x(1076)](null)[x(2334)](i).catch($R)}:gb;function $R(i){setTimeout(function(){throw i})}function mA(i,x){const e=I;var t=x,g=0;do{var n=t[e(868)];if(i[e(207)](t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(g===0){i[e(207)](n),Qc(x);return}g--}else t!=="$"&&t!=="$?"&&t!=="$!"||g++;t=n}while(t);Qc(x)}function Wn(i){const x=I;for(;i!=null;i=i.nextSibling){var e=i[x(773)];if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function oG(i){const x=I;i=i[x(2067)];for(var e=0;i;){if(i[x(773)]===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i[x(2067)]}return null}var Bo=Math.random().toString(36)[I(1226)](2),Ii=I(699)+Bo,jc=I(2821)+Bo,Fi=I(295)+Bo,ib=I(3685)+Bo,jR="__reactListeners$"+Bo,xV=I(318)+Bo;function pI(i){const x=I;var e=i[Ii];if(e)return e;for(var t=i[x(2310)];t;){if(e=t[Fi]||t[Ii]){if(t=e.alternate,e[x(1367)]!==null||t!==null&&t[x(1367)]!==null)for(i=oG(i);i!==null;){if(t=i[Ii])return t;i=oG(i)}return e}i=t,t=i[x(2310)]}return null}function SC(i){const x=I;return i=i[Ii]||i[Fi],!i||i[x(3795)]!==5&&i[x(3795)]!==6&&i[x(3795)]!==13&&i.tag!==3?null:i}function Ls(i){const x=I;if(i[x(3795)]===5||i[x(3795)]===6)return i.stateNode;throw Error(N0(33))}function a2(i){return i[jc]||null}var nb=[],ks=-1;function Fn(i){return{current:i}}function te(i){const x=I;0>ks||(i[x(1895)]=nb[ks],nb[ks]=null,ks--)}function $x(i,x){const e=I;ks++,nb[ks]=i[e(1895)],i[e(1895)]=x}var Kn={},Ct=Fn(Kn),Mt=Fn(!1),NI=Kn;function Co(i,x){const e=I;var t=i[e(3505)].contextTypes;if(!t)return Kn;var g=i[e(1133)];if(g&&g[e(3212)]===x)return g[e(3704)];var n={},s;for(s in t)n[s]=x[s];return g&&(i=i[e(1133)],i[e(3212)]=x,i[e(3704)]=n),n}function Lt(i){return i=i.childContextTypes,i!=null}function zr(){te(Mt),te(Ct)}function cG(i,x,e){if(Ct[I(1895)]!==Kn)throw Error(N0(168));$x(Ct,x),$x(Mt,e)}function C5(i,x,e){const t=I;var g=i[t(1133)];if(x=x[t(3503)],typeof g[t(487)]!="function")return e;g=g[t(487)]();for(var n in g)if(!(n in x))throw Error(N0(108,zw(i)||t(2164),n));return le({},e,g)}function Mr(i){const x=I;return i=(i=i[x(1133)])&&i[x(3606)]||Kn,NI=Ct[x(1895)],$x(Ct,i),$x(Mt,Mt[x(1895)]),!0}function CG(i,x,e){const t=I;var g=i[t(1133)];if(!g)throw Error(N0(169));e?(i=C5(i,x,NI),g[t(3606)]=i,te(Mt),te(Ct),$x(Ct,i)):te(Mt),$x(Mt,e)}var Ri=null,r2=!1,GA=!1;function l5(i){Ri===null?Ri=[i]:Ri[I(3330)](i)}function eV(i){r2=!0,l5(i)}function zn(){const i=I;if(!GA&&Ri!==null){GA=!0;var x=0,e=Qx;try{var t=Ri;for(Qx=1;x<t[i(2989)];x++){var g=t[x];do g=g(!0);while(g!==null)}Ri=null,r2=!1}catch(n){throw Ri!==null&&(Ri=Ri[i(1226)](x+1)),NZ(vh,zn),n}finally{Qx=e,GA=!1}}return null}var Ts=[],Js=0,Lr=null,kr=0,ug=[],bg=0,FI=null,Xi=1,Yi="";function aI(i,x){Ts[Js++]=kr,Ts[Js++]=Lr,Lr=i,kr=x}function a5(i,x,e){const t=I;ug[bg++]=Xi,ug[bg++]=Yi,ug[bg++]=FI,FI=i;var g=Xi;i=Yi;var n=32-Mg(g)-1;g&=~(1<<n),e+=1;var s=32-Mg(x)+n;if(30<s){var o=n-n%5;s=(g&(1<<o)-1)[t(2635)](32),g>>=o,n-=o,Xi=1<<32-Mg(x)+n|e<<n|g,Yi=s+i}else Xi=1<<s|e<<n|g,Yi=i}function Hh(i){i[I(3922)]!==null&&(aI(i,1),a5(i,1,0))}function Nh(i){for(;i===Lr;)Lr=Ts[--Js],Ts[Js]=null,kr=Ts[--Js],Ts[Js]=null;for(;i===FI;)FI=ug[--bg],ug[bg]=null,Yi=ug[--bg],ug[bg]=null,Xi=ug[--bg],ug[bg]=null}var tg=null,eg=null,Ie=!1,Fg=null;function r5(i,x){const e=I;var t=mg(5,null,null,0);t[e(1992)]="DELETED",t[e(1133)]=x,t[e(3922)]=i,x=i[e(2716)],x===null?(i.deletions=[t],i[e(2436)]|=16):x[e(3330)](t)}function lG(i,x){const e=I;switch(i[e(3795)]){case 5:var t=i[e(3505)];return x=x[e(773)]!==1||t[e(2084)]()!==x[e(1910)][e(2084)]()?null:x,x!==null?(i.stateNode=x,tg=i,eg=Wn(x[e(1290)]),!0):!1;case 6:return x=i[e(2343)]===""||x[e(773)]!==3?null:x,x!==null?(i.stateNode=x,tg=i,eg=null,!0):!1;case 13:return x=x[e(773)]!==8?null:x,x!==null?(t=FI!==null?{id:Xi,overflow:Yi}:null,i.memoizedState={dehydrated:x,treeContext:t,retryLane:1073741824},t=mg(18,null,null,0),t[e(1133)]=x,t[e(3922)]=i,i[e(1367)]=t,tg=i,eg=null,!0):!1;default:return!1}}function Ib(i){const x=I;return(i[x(251)]&1)!==0&&(i[x(2436)]&128)===0}function sb(i){const x=I;if(Ie){var e=eg;if(e){var t=e;if(!lG(i,e)){if(Ib(i))throw Error(N0(418));e=Wn(t[x(868)]);var g=tg;e&&lG(i,e)?r5(g,t):(i[x(2436)]=i.flags&-4097|2,Ie=!1,tg=i)}}else{if(Ib(i))throw Error(N0(418));i[x(2436)]=i[x(2436)]&-4097|2,Ie=!1,tg=i}}}function aG(i){const x=I;for(i=i[x(3922)];i!==null&&i[x(3795)]!==5&&i.tag!==3&&i[x(3795)]!==13;)i=i[x(3922)];tg=i}function $l(i){const x=I;if(i!==tg)return!1;if(!Ie)return aG(i),Ie=!0,!1;var e;if((e=i[x(3795)]!==3)&&!(e=i[x(3795)]!==5)&&(e=i[x(3505)],e=x(3801)!==e&&x(1153)!==e&&!tb(i.type,i.memoizedProps)),e&&(e=eg)){if(Ib(i))throw d5(),Error(N0(418));for(;e;)r5(i,e),e=Wn(e[x(868)])}if(aG(i),i[x(3795)]===13){if(i=i[x(485)],i=i!==null?i[x(772)]:null,!i)throw Error(N0(317));x:{for(i=i.nextSibling,e=0;i;){if(i[x(773)]===8){var t=i[x(3787)];if(t==="/$"){if(e===0){eg=Wn(i[x(868)]);break x}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}eg=null}}else eg=tg?Wn(i[x(1133)][x(868)]):null;return!0}function d5(){for(var i=eg;i;)i=Wn(i.nextSibling)}function lo(){eg=tg=null,Ie=!1}function Fh(i){Fg===null?Fg=[i]:Fg[I(3330)](i)}var tV=_i.ReactCurrentBatchConfig;function tc(i,x,e){const t=I;if(i=e.ref,i!==null&&typeof i!="function"&&t(1011)!==typeof i){if(e._owner){if(e=e._owner,e){if(e[t(3795)]!==1)throw Error(N0(309));var g=e[t(1133)]}if(!g)throw Error(N0(147,i));var n=g,s=""+i;return x!==null&&x.ref!==null&&typeof x.ref=="function"&&x[t(3786)][t(928)]===s?x[t(3786)]:(x=function(o){var C=n[t(3596)];o===null?delete C[s]:C[s]=o},x[t(928)]=s,x)}if(t(3674)!==typeof i)throw Error(N0(284));if(!e[t(3051)])throw Error(N0(290,i))}return i}function jl(i,x){const e=I;throw i=Object[e(1566)].toString[e(2627)](x),Error(N0(31,e(1109)===i?e(2626)+Object[e(958)](x)[e(1812)](", ")+"}":i))}function rG(i){const x=I;var e=i[x(2660)];return e(i[x(2036)])}function A5(i){function x(G,m){const v=i0;if(i){var p=G[v(2716)];p===null?(G[v(2716)]=[m],G[v(2436)]|=16):p.push(m)}}function e(G,m){const v=i0;if(!i)return null;for(;m!==null;)x(G,m),m=m[v(1263)];return null}function t(G,m){const v=i0;for(G=new Map;m!==null;)m.key!==null?G[v(298)](m[v(581)],m):G[v(298)](m[v(587)],m),m=m[v(1263)];return G}function g(G,m){const v=i0;return G=Sn(G,m),G.index=0,G[v(1263)]=null,G}function n(G,m,v){const p=i0;return G[p(587)]=v,i?(v=G[p(641)],v!==null?(v=v.index,v<m?(G[p(2436)]|=2,m):v):(G.flags|=2,m)):(G[p(2436)]|=1048576,m)}function s(G){const m=i0;return i&&G[m(641)]===null&&(G[m(2436)]|=2),G}function o(G,m,v,p){const w=i0;return m===null||m[w(3795)]!==6?(m=wA(v,G[w(251)],p),m[w(3922)]=G,m):(m=g(m,v),m[w(3922)]=G,m)}function c(G,m,v,p){const w=i0;var V=v.type;return V===Ns?r(G,m,v[w(3105)].children,p,v[w(581)]):m!==null&&(m[w(1992)]===V||typeof V=="object"&&V!==null&&V[w(1596)]===un&&rG(V)===m.type)?(p=g(m,v[w(3105)]),p[w(3786)]=tc(G,m,v),p[w(3922)]=G,p):(p=hr(v[w(3505)],v[w(581)],v[w(3105)],null,G[w(251)],p),p.ref=tc(G,m,v),p[w(3922)]=G,p)}function C(G,m,v,p){const w=i0;return m===null||m[w(3795)]!==4||m.stateNode.containerInfo!==v[w(1951)]||m[w(1133)][w(854)]!==v[w(854)]?(m=RA(v,G[w(251)],p),m.return=G,m):(m=g(m,v[w(1352)]||[]),m.return=G,m)}function r(G,m,v,p,w){const V=i0;return m===null||m[V(3795)]!==7?(m=VI(v,G[V(251)],p,w),m[V(3922)]=G,m):(m=g(m,v),m[V(3922)]=G,m)}function A(G,m,v){const p=i0;if(typeof m=="string"&&m!==""||typeof m=="number")return m=wA(""+m,G[p(251)],v),m[p(3922)]=G,m;if(p(1011)===typeof m&&m!==null){switch(m[p(1596)]){case Tl:return v=hr(m[p(3505)],m[p(581)],m[p(3105)],null,G[p(251)],v),v[p(3786)]=tc(G,null,m),v.return=G,v;case Hs:return m=RA(m,G[p(251)],v),m[p(3922)]=G,m;case un:var w=m[p(2660)];return A(G,w(m[p(2036)]),v)}if(Zc(m)||qo(m))return m=VI(m,G[p(251)],v,null),m[p(3922)]=G,m;jl(G,m)}return null}function d(G,m,v,p){const w=i0;var V=m!==null?m[w(581)]:null;if(w(3674)===typeof v&&v!==""||typeof v=="number")return V!==null?null:o(G,m,""+v,p);if(w(1011)===typeof v&&v!==null){switch(v[w(1596)]){case Tl:return v.key===V?c(G,m,v,p):null;case Hs:return v.key===V?C(G,m,v,p):null;case un:return V=v[w(2660)],d(G,m,V(v[w(2036)]),p)}if(Zc(v)||qo(v))return V!==null?null:r(G,m,v,p,null);jl(G,v)}return null}function h(G,m,v,p,w){const V=i0;if(V(3674)===typeof p&&p!==""||V(1025)===typeof p)return G=G[V(2695)](v)||null,o(m,G,""+p,w);if(V(1011)===typeof p&&p!==null){switch(p[V(1596)]){case Tl:return G=G.get(p[V(581)]===null?v:p[V(581)])||null,c(m,G,p,w);case Hs:return G=G[V(2695)](p[V(581)]===null?v:p[V(581)])||null,C(m,G,p,w);case un:var N=p[V(2660)];return h(G,m,v,N(p[V(2036)]),w)}if(Zc(p)||qo(p))return G=G[V(2695)](v)||null,r(m,G,p,w,null);jl(m,p)}return null}function f(G,m,v,p){const w=i0;for(var V=null,N=null,X=m,M=m=0,Y=null;X!==null&&M<v[w(2989)];M++){X.index>M?(Y=X,X=null):Y=X[w(1263)];var S=d(G,X,v[M],p);if(S===null){X===null&&(X=Y);break}i&&X&&S[w(641)]===null&&x(G,X),m=n(S,m,M),N===null?V=S:N[w(1263)]=S,N=S,X=Y}if(M===v.length)return e(G,X),Ie&&aI(G,M),V;if(X===null){for(;M<v[w(2989)];M++)X=A(G,v[M],p),X!==null&&(m=n(X,m,M),N===null?V=X:N.sibling=X,N=X);return Ie&&aI(G,M),V}for(X=t(G,X);M<v[w(2989)];M++)Y=h(X,G,M,v[M],p),Y!==null&&(i&&Y[w(641)]!==null&&X[w(1432)](Y[w(581)]===null?M:Y[w(581)]),m=n(Y,m,M),N===null?V=Y:N[w(1263)]=Y,N=Y);return i&&X[w(1599)](function(H){return x(G,H)}),Ie&&aI(G,M),V}function B(G,m,v,p){const w=i0;var V=qo(v);if(w(1126)!==typeof V)throw Error(N0(150));if(v=V[w(2627)](v),v==null)throw Error(N0(151));for(var N=V=null,X=m,M=m=0,Y=null,S=v[w(890)]();X!==null&&!S[w(905)];M++,S=v[w(890)]()){X[w(587)]>M?(Y=X,X=null):Y=X[w(1263)];var H=d(G,X,S.value,p);if(H===null){X===null&&(X=Y);break}i&&X&&H.alternate===null&&x(G,X),m=n(H,m,M),N===null?V=H:N[w(1263)]=H,N=H,X=Y}if(S.done)return e(G,X),Ie&&aI(G,M),V;if(X===null){for(;!S[w(905)];M++,S=v[w(890)]())S=A(G,S[w(2113)],p),S!==null&&(m=n(S,m,M),N===null?V=S:N[w(1263)]=S,N=S);return Ie&&aI(G,M),V}for(X=t(G,X);!S[w(905)];M++,S=v[w(890)]())S=h(X,G,M,S.value,p),S!==null&&(i&&S.alternate!==null&&X[w(1432)](S[w(581)]===null?M:S.key),m=n(S,m,M),N===null?V=S:N[w(1263)]=S,N=S);return i&&X[w(1599)](function(O){return x(G,O)}),Ie&&aI(G,M),V}function Z(G,m,v,p){const w=i0;if(w(1011)===typeof v&&v!==null&&v[w(3505)]===Ns&&v[w(581)]===null&&(v=v[w(3105)].children),w(1011)===typeof v&&v!==null){switch(v[w(1596)]){case Tl:x:{for(var V=v[w(581)],N=m;N!==null;){if(N[w(581)]===V){if(V=v[w(3505)],V===Ns){if(N[w(3795)]===7){e(G,N[w(1263)]),m=g(N,v.props[w(1352)]),m[w(3922)]=G,G=m;break x}}else if(N[w(1992)]===V||w(1011)===typeof V&&V!==null&&V[w(1596)]===un&&rG(V)===N.type){e(G,N.sibling),m=g(N,v.props),m.ref=tc(G,N,v),m[w(3922)]=G,G=m;break x}e(G,N);break}else x(G,N);N=N[w(1263)]}v[w(3505)]===Ns?(m=VI(v[w(3105)][w(1352)],G[w(251)],p,v[w(581)]),m[w(3922)]=G,G=m):(p=hr(v[w(3505)],v.key,v[w(3105)],null,G.mode,p),p[w(3786)]=tc(G,m,v),p[w(3922)]=G,G=p)}return s(G);case Hs:x:{for(N=v.key;m!==null;){if(m[w(581)]===N)if(m.tag===4&&m[w(1133)][w(1951)]===v[w(1951)]&&m.stateNode[w(854)]===v[w(854)]){e(G,m[w(1263)]),m=g(m,v[w(1352)]||[]),m.return=G,G=m;break x}else{e(G,m);break}else x(G,m);m=m[w(1263)]}m=RA(v,G.mode,p),m.return=G,G=m}return s(G);case un:return N=v[w(2660)],Z(G,m,N(v[w(2036)]),p)}if(Zc(v))return f(G,m,v,p);if(qo(v))return B(G,m,v,p);jl(G,v)}return w(3674)===typeof v&&v!==""||w(1025)===typeof v?(v=""+v,m!==null&&m[w(3795)]===6?(e(G,m[w(1263)]),m=g(m,v),m[w(3922)]=G,G=m):(e(G,m),m=wA(v,G.mode,p),m[w(3922)]=G,G=m),s(G)):e(G,m)}return Z}var ao=A5(!0),u5=A5(!1),Tr=Fn(null),Jr=null,Es=null,zh=null;function Mh(){zh=Es=Jr=null}function Lh(i){var e=Tr[I(1895)];te(Tr),i._currentValue=e}function ob(i,x,e){const t=I;for(;i!==null;){var g=i[t(641)];if((i[t(3262)]&x)!==x?(i[t(3262)]|=x,g!==null&&(g[t(3262)]|=x)):g!==null&&(g[t(3262)]&x)!==x&&(g[t(3262)]|=x),i===e)break;i=i[t(3922)]}}function io(i,x){const e=I;Jr=i,zh=Es=null,i=i[e(1461)],i!==null&&i.firstContext!==null&&(i[e(2840)]&x&&(Ft=!0),i[e(1401)]=null)}function Zg(i){const x=I;var e=i._currentValue;if(zh!==i)if(i={context:i,memoizedValue:e,next:null},Es===null){if(Jr===null)throw Error(N0(308));Es=i,Jr[x(1461)]={lanes:0,firstContext:i}}else Es=Es[x(890)]=i;return e}var BI=null;function kh(i){BI===null?BI=[i]:BI.push(i)}function b5(i,x,e,t){const g=I;var n=x.interleaved;return n===null?(e[g(890)]=e,kh(x)):(e[g(890)]=n.next,n[g(890)]=e),x[g(439)]=e,zi(i,t)}function zi(i,x){const e=I;i.lanes|=x;var t=i[e(641)];for(t!==null&&(t.lanes|=x),t=i,i=i[e(3922)];i!==null;)i.childLanes|=x,t=i[e(641)],t!==null&&(t[e(3262)]|=x),t=i,i=i.return;return t[e(3795)]===3?t[e(1133)]:null}var bn=!1;function Th(i){const x=I;i[x(2845)]={baseState:i[x(485)],firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function h5(i,x){const e=I;i=i[e(2845)],x[e(2845)]===i&&(x[e(2845)]={baseState:i[e(490)],firstBaseUpdate:i[e(158)],lastBaseUpdate:i.lastBaseUpdate,shared:i[e(2940)],effects:i[e(1486)]})}function Mi(i,x){return{eventTime:i,lane:x,tag:0,payload:null,callback:null,next:null}}function wn(i,x,e){const t=I;var g=i[t(2845)];if(g===null)return null;if(g=g[t(2940)],Mx&2){var n=g.pending;return n===null?x[t(890)]=x:(x[t(890)]=n[t(890)],n[t(890)]=x),g[t(1891)]=x,zi(i,e)}return n=g.interleaved,n===null?(x[t(890)]=x,kh(g)):(x.next=n.next,n[t(890)]=x),g[t(439)]=x,zi(i,e)}function ar(i,x,e){const t=I;if(x=x.updateQueue,x!==null&&(x=x[t(2940)],(e&4194240)!==0)){var g=x[t(2840)];g&=i[t(294)],e|=g,x[t(2840)]=e,Wh(i,e)}}function dG(i,x){const e=I;var t=i[e(2845)],g=i.alternate;if(g!==null&&(g=g[e(2845)],t===g)){var n=null,s=null;if(t=t[e(158)],t!==null){do{var o={eventTime:t[e(167)],lane:t.lane,tag:t[e(3795)],payload:t.payload,callback:t.callback,next:null};s===null?n=s=o:s=s[e(890)]=o,t=t[e(890)]}while(t!==null);s===null?n=s=x:s=s[e(890)]=x}else n=s=x;t={baseState:g.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:g[e(2940)],effects:g.effects},i[e(2845)]=t;return}i=t.lastBaseUpdate,i===null?t[e(158)]=x:i[e(890)]=x,t[e(3530)]=x}function Er(i,x,e,t){const g=I;var n=i[g(2845)];bn=!1;var s=n[g(158)],o=n[g(3530)],c=n.shared.pending;if(c!==null){n[g(2940)][g(1891)]=null;var C=c,r=C.next;C[g(890)]=null,o===null?s=r:o[g(890)]=r,o=C;var A=i.alternate;A!==null&&(A=A[g(2845)],c=A[g(3530)],c!==o&&(c===null?A[g(158)]=r:c.next=r,A[g(3530)]=C))}if(s!==null){var d=n.baseState;o=0,A=r=C=null,c=s;do{var h=c[g(1694)],f=c[g(167)];if((t&h)===h){A!==null&&(A=A[g(890)]={eventTime:f,lane:0,tag:c[g(3795)],payload:c[g(2351)],callback:c.callback,next:null});x:{var B=i,Z=c;switch(h=x,f=e,Z[g(3795)]){case 1:if(B=Z[g(2351)],g(1126)===typeof B){d=B[g(2627)](f,d,h);break x}d=B;break x;case 3:B.flags=B[g(2436)]&-65537|128;case 0:if(B=Z[g(2351)],h=g(1126)===typeof B?B[g(2627)](f,d,h):B,h==null)break x;d=le({},d,h);break x;case 2:bn=!0}}c[g(934)]!==null&&c[g(1694)]!==0&&(i[g(2436)]|=64,h=n.effects,h===null?n[g(1486)]=[c]:h[g(3330)](c))}else f={eventTime:f,lane:h,tag:c.tag,payload:c[g(2351)],callback:c.callback,next:null},A===null?(r=A=f,C=d):A=A[g(890)]=f,o|=h;if(c=c[g(890)],c===null){if(c=n.shared[g(1891)],c===null)break;h=c,c=h[g(890)],h[g(890)]=null,n[g(3530)]=h,n[g(2940)][g(1891)]=null}}while(!0);if(A===null&&(C=d),n[g(490)]=C,n[g(158)]=r,n.lastBaseUpdate=A,x=n[g(2940)][g(439)],x!==null){n=x;do o|=n[g(1694)],n=n[g(890)];while(n!==x)}else s===null&&(n[g(2940)][g(2840)]=0);MI|=o,i[g(2840)]=o,i[g(485)]=d}}function AG(i,x,e){const t=I;if(i=x[t(1486)],x[t(1486)]=null,i!==null)for(x=0;x<i[t(2989)];x++){var g=i[x],n=g.callback;if(n!==null){if(g[t(934)]=null,g=e,typeof n!="function")throw Error(N0(191,n));n[t(2627)](g)}}}var XC={},li=Fn(XC),xC=Fn(XC),eC=Fn(XC);function ZI(i){if(i===XC)throw Error(N0(174));return i}function Jh(i,x){const e=I;switch($x(eC,x),$x(xC,i),$x(li,XC),i=x[e(773)],i){case 9:case 11:x=(x=x.documentElement)?x.namespaceURI:Tu(null,"");break;default:i=i===8?x[e(2310)]:x,x=i[e(522)]||null,i=i[e(1623)],x=Tu(x,i)}te(li),$x(li,x)}function ro(){te(li),te(xC),te(eC)}function f5(i){const x=I;ZI(eC[x(1895)]);var e=ZI(li[x(1895)]),t=Tu(e,i[x(3505)]);e!==t&&($x(xC,i),$x(li,t))}function Eh(i){xC[I(1895)]===i&&(te(li),te(xC))}var oe=Fn(0);function Ur(i){const x=I;for(var e=i;e!==null;){if(e[x(3795)]===13){var t=e[x(485)];if(t!==null&&(t=t[x(772)],t===null||t[x(3787)]==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e[x(2990)].revealOrder!==void 0){if(e[x(2436)]&128)return e}else if(e.child!==null){e[x(1367)][x(3922)]=e,e=e[x(1367)];continue}if(e===i)break;for(;e[x(1263)]===null;){if(e.return===null||e[x(3922)]===i)return null;e=e[x(3922)]}e[x(1263)].return=e[x(3922)],e=e[x(1263)]}return null}var pA=[];function Uh(){const i=I;for(var x=0;x<pA[i(2989)];x++)pA[x]._workInProgressVersionPrimary=null;pA[i(2989)]=0}var rr=_i[I(2147)],BA=_i.ReactCurrentBatchConfig,zI=0,Ce=null,We=null,Fe=null,_r=!1,Kc=!1,tC=0,gV=0;function xt(){throw Error(N0(321))}function _h(i,x){const e=I;if(x===null)return!1;for(var t=0;t<x[e(2989)]&&t<i[e(2989)];t++)if(!Tg(i[t],x[t]))return!1;return!0}function Dh(i,x,e,t,g,n){const s=I;if(zI=n,Ce=x,x[s(485)]=null,x[s(2845)]=null,x[s(2840)]=0,rr.current=i===null||i[s(485)]===null?sV:oV,i=e(t,g),Kc){n=0;do{if(Kc=!1,tC=0,25<=n)throw Error(N0(301));n+=1,Fe=We=null,x.updateQueue=null,rr[s(1895)]=cV,i=e(t,g)}while(Kc)}if(rr.current=Dr,x=We!==null&&We[s(890)]!==null,zI=0,Fe=We=Ce=null,_r=!1,x)throw Error(N0(300));return i}function Qh(){var i=tC!==0;return tC=0,i}function ni(){const i=I;var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fe===null?Ce[i(485)]=Fe=x:Fe=Fe[i(890)]=x,Fe}function yg(){const i=I;if(We===null){var x=Ce[i(641)];x=x!==null?x.memoizedState:null}else x=We[i(890)];var e=Fe===null?Ce.memoizedState:Fe[i(890)];if(e!==null)Fe=e,We=x;else{if(x===null)throw Error(N0(310));We=x,x={memoizedState:We[i(485)],baseState:We[i(490)],baseQueue:We[i(3888)],queue:We[i(888)],next:null},Fe===null?Ce[i(485)]=Fe=x:Fe=Fe[i(890)]=x}return Fe}function gC(i,x){return I(1126)===typeof x?x(i):x}function ZA(i){const x=I;var e=yg(),t=e[x(888)];if(t===null)throw Error(N0(311));t[x(1017)]=i;var g=We,n=g[x(3888)],s=t.pending;if(s!==null){if(n!==null){var o=n[x(890)];n[x(890)]=s.next,s[x(890)]=o}g[x(3888)]=n=s,t[x(1891)]=null}if(n!==null){s=n[x(890)],g=g[x(490)];var c=o=null,C=null,r=s;do{var A=r.lane;if((zI&A)===A)C!==null&&(C=C[x(890)]={lane:0,action:r[x(1917)],hasEagerState:r.hasEagerState,eagerState:r[x(1211)],next:null}),g=r[x(992)]?r.eagerState:i(g,r[x(1917)]);else{var d={lane:A,action:r[x(1917)],hasEagerState:r[x(992)],eagerState:r.eagerState,next:null};C===null?(c=C=d,o=g):C=C[x(890)]=d,Ce[x(2840)]|=A,MI|=A}r=r[x(890)]}while(r!==null&&r!==s);C===null?o=g:C[x(890)]=c,Tg(g,e[x(485)])||(Ft=!0),e[x(485)]=g,e[x(490)]=o,e.baseQueue=C,t[x(3454)]=g}if(i=t.interleaved,i!==null){n=i;do s=n[x(1694)],Ce.lanes|=s,MI|=s,n=n[x(890)];while(n!==i)}else n===null&&(t[x(2840)]=0);return[e[x(485)],t[x(3425)]]}function yA(i){const x=I;var e=yg(),t=e[x(888)];if(t===null)throw Error(N0(311));t[x(1017)]=i;var g=t[x(3425)],n=t.pending,s=e[x(485)];if(n!==null){t[x(1891)]=null;var o=n=n[x(890)];do s=i(s,o[x(1917)]),o=o[x(890)];while(o!==n);Tg(s,e[x(485)])||(Ft=!0),e.memoizedState=s,e[x(3888)]===null&&(e[x(490)]=s),t[x(3454)]=s}return[s,g]}function m5(){}function G5(i,x){const e=I;var t=Ce,g=yg(),n=x(),s=!Tg(g.memoizedState,n);if(s&&(g[e(485)]=n,Ft=!0),g=g[e(888)],Ph(Z5[e(1600)](null,t,g,i),[i]),g.getSnapshot!==x||s||Fe!==null&&Fe.memoizedState[e(3795)]&1){if(t[e(2436)]|=2048,iC(9,B5[e(1600)](null,t,g,n,x),void 0,null),Le===null)throw Error(N0(349));zI&30||p5(t,x,n)}return n}function p5(i,x,e){const t=I;i[t(2436)]|=16384,i={getSnapshot:x,value:e},x=Ce.updateQueue,x===null?(x={lastEffect:null,stores:null},Ce[t(2845)]=x,x.stores=[i]):(e=x[t(879)],e===null?x[t(879)]=[i]:e.push(i))}function B5(i,x,e,t){const g=I;x[g(2113)]=e,x.getSnapshot=t,y5(x)&&v5(i)}function Z5(i,x,e){return e(function(){y5(x)&&v5(i)})}function y5(i){const x=I;var e=i.getSnapshot;i=i[x(2113)];try{var t=e();return!Tg(i,t)}catch{return!0}}function v5(i){var x=zi(i,1);x!==null&&Lg(x,i,1,-1)}function uG(i){const x=I;var e=ni();return typeof i=="function"&&(i=i()),e[x(485)]=e[x(490)]=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gC,lastRenderedState:i},e[x(888)]=i,i=i[x(3425)]=IV.bind(null,Ce,i),[e.memoizedState,i]}function iC(i,x,e,t){const g=I;return i={tag:i,create:x,destroy:e,deps:t,next:null},x=Ce[g(2845)],x===null?(x={lastEffect:null,stores:null},Ce[g(2845)]=x,x[g(1548)]=i[g(890)]=i):(e=x[g(1548)],e===null?x.lastEffect=i.next=i:(t=e.next,e[g(890)]=i,i[g(890)]=t,x.lastEffect=i)),i}function W5(){const i=I;return yg()[i(485)]}function dr(i,x,e,t){const g=I;var n=ni();Ce.flags|=i,n[g(485)]=iC(1|x,e,void 0,t===void 0?null:t)}function d2(i,x,e,t){const g=I;var n=yg();t=t===void 0?null:t;var s=void 0;if(We!==null){var o=We[g(485)];if(s=o[g(1456)],t!==null&&_h(t,o[g(2610)])){n.memoizedState=iC(x,e,s,t);return}}Ce[g(2436)]|=i,n[g(485)]=iC(1|x,e,s,t)}function bG(i,x){return dr(8390656,8,i,x)}function Ph(i,x){return d2(2048,8,i,x)}function w5(i,x){return d2(4,2,i,x)}function R5(i,x){return d2(4,4,i,x)}function V5(i,x){const e=I;if(e(1126)===typeof x)return i=i(),x(i),function(){x(null)};if(x!=null)return i=i(),x[e(1895)]=i,function(){const t=e;x[t(1895)]=null}}function S5(i,x,e){const t=I;return e=e!=null?e[t(534)]([i]):null,d2(4,4,V5.bind(null,x,i),e)}function Oh(){}function X5(i,x){const e=I;var t=yg();x=x===void 0?null:x;var g=t.memoizedState;return g!==null&&x!==null&&_h(x,g[1])?g[0]:(t[e(485)]=[i,x],i)}function Y5(i,x){const e=I;var t=yg();x=x===void 0?null:x;var g=t[e(485)];return g!==null&&x!==null&&_h(x,g[1])?g[0]:(i=i(),t[e(485)]=[i,x],i)}function K5(i,x,e){const t=I;return zI&21?(Tg(e,x)||(e=MZ(),Ce[t(2840)]|=e,MI|=e,i[t(490)]=!0),x):(i[t(490)]&&(i[t(490)]=!1,Ft=!0),i[t(485)]=e)}function iV(i,x){var e=Qx;Qx=e!==0&&4>e?e:4,i(!0);var t=BA.transition;BA.transition={};try{i(!1),x()}finally{Qx=e,BA.transition=t}}function H5(){const i=I;return yg()[i(485)]}function nV(i,x,e){var t=Vn(i);if(e={lane:t,action:e,hasEagerState:!1,eagerState:null,next:null},N5(i))F5(x,e);else if(e=b5(i,x,e,t),e!==null){var g=Bt();Lg(e,i,t,g),z5(e,x,t)}}function IV(i,x,e){const t=I;var g=Vn(i),n={lane:g,action:e,hasEagerState:!1,eagerState:null,next:null};if(N5(i))F5(x,n);else{var s=i[t(641)];if(i[t(2840)]===0&&(s===null||s.lanes===0)&&(s=x[t(1017)],s!==null))try{var o=x[t(3454)],c=s(o,e);if(n[t(992)]=!0,n.eagerState=c,Tg(c,o)){var C=x[t(439)];C===null?(n[t(890)]=n,kh(x)):(n[t(890)]=C[t(890)],C[t(890)]=n),x[t(439)]=n;return}}catch{}finally{}e=b5(i,x,n,g),e!==null&&(n=Bt(),Lg(e,i,g,n),z5(e,x,g))}}function N5(i){var e=i[I(641)];return i===Ce||e!==null&&e===Ce}function F5(i,x){const e=I;Kc=_r=!0;var t=i[e(1891)];t===null?x[e(890)]=x:(x[e(890)]=t[e(890)],t[e(890)]=x),i.pending=x}function z5(i,x,e){const t=I;if(e&4194240){var g=x[t(2840)];g&=i[t(294)],e|=g,x[t(2840)]=e,Wh(i,e)}}var Dr={readContext:Zg,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useInsertionEffect:xt,useLayoutEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useMutableSource:xt,useSyncExternalStore:xt,useId:xt,unstable_isNewReconciler:!1},sV={readContext:Zg,useCallback:function(i,x){const e=I;return ni()[e(485)]=[i,x===void 0?null:x],i},useContext:Zg,useEffect:bG,useImperativeHandle:function(i,x,e){const t=I;return e=e!=null?e[t(534)]([i]):null,dr(4194308,4,V5[t(1600)](null,x,i),e)},useLayoutEffect:function(i,x){return dr(4194308,4,i,x)},useInsertionEffect:function(i,x){return dr(4,2,i,x)},useMemo:function(i,x){const e=I;var t=ni();return x=x===void 0?null:x,i=i(),t[e(485)]=[i,x],i},useReducer:function(i,x,e){const t=I;var g=ni();return x=e!==void 0?e(x):x,g[t(485)]=g[t(490)]=x,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:x},g[t(888)]=i,i=i[t(3425)]=nV[t(1600)](null,Ce,i),[g[t(485)],i]},useRef:function(i){const x=I;var e=ni();return i={current:i},e[x(485)]=i},useState:uG,useDebugValue:Oh,useDeferredValue:function(i){return ni().memoizedState=i},useTransition:function(){const i=I;var x=uG(!1),e=x[0];return x=iV[i(1600)](null,x[1]),ni()[i(485)]=x,[e,x]},useMutableSource:function(){},useSyncExternalStore:function(i,x,e){const t=I;var g=Ce,n=ni();if(Ie){if(e===void 0)throw Error(N0(407));e=e()}else{if(e=x(),Le===null)throw Error(N0(349));zI&30||p5(g,x,e)}n[t(485)]=e;var s={value:e,getSnapshot:x};return n.queue=s,bG(Z5[t(1600)](null,g,s,i),[i]),g[t(2436)]|=2048,iC(9,B5[t(1600)](null,g,s,e,x),void 0,null),e},useId:function(){const i=I;var x=ni(),e=Le[i(1260)];if(Ie){var t=Yi,g=Xi;t=(g&~(1<<32-Mg(g)-1))[i(2635)](32)+t,e=":"+e+"R"+t,t=tC++,0<t&&(e+="H"+t[i(2635)](32)),e+=":"}else t=gV++,e=":"+e+"r"+t.toString(32)+":";return x[i(485)]=e},unstable_isNewReconciler:!1},oV={readContext:Zg,useCallback:X5,useContext:Zg,useEffect:Ph,useImperativeHandle:S5,useInsertionEffect:w5,useLayoutEffect:R5,useMemo:Y5,useReducer:ZA,useRef:W5,useState:function(){return ZA(gC)},useDebugValue:Oh,useDeferredValue:function(i){const x=I;var e=yg();return K5(e,We[x(485)],i)},useTransition:function(){const i=I;var x=ZA(gC)[0],e=yg()[i(485)];return[x,e]},useMutableSource:m5,useSyncExternalStore:G5,useId:H5,unstable_isNewReconciler:!1},cV={readContext:Zg,useCallback:X5,useContext:Zg,useEffect:Ph,useImperativeHandle:S5,useInsertionEffect:w5,useLayoutEffect:R5,useMemo:Y5,useReducer:yA,useRef:W5,useState:function(){return yA(gC)},useDebugValue:Oh,useDeferredValue:function(i){const x=I;var e=yg();return We===null?e[x(485)]=i:K5(e,We[x(485)],i)},useTransition:function(){const i=I;var x=yA(gC)[0],e=yg()[i(485)];return[x,e]},useMutableSource:m5,useSyncExternalStore:G5,useId:H5,unstable_isNewReconciler:!1};function Kg(i,x){if(i&&i[I(3870)]){x=le({},x),i=i.defaultProps;for(var t in i)x[t]===void 0&&(x[t]=i[t]);return x}return x}function cb(i,x,e,t){const g=I;x=i[g(485)],e=e(t,x),e=e==null?x:le({},x,e),i[g(485)]=e,i[g(2840)]===0&&(i[g(2845)][g(490)]=e)}var A2={isMounted:function(i){return(i=i[I(1525)])?EI(i)===i:!1},enqueueSetState:function(i,x,e){const t=I;i=i[t(1525)];var g=Bt(),n=Vn(i),s=Mi(g,n);s[t(2351)]=x,e!=null&&(s[t(934)]=e),x=wn(i,s,n),x!==null&&(Lg(x,i,n,g),ar(x,i,n))},enqueueReplaceState:function(i,x,e){const t=I;i=i[t(1525)];var g=Bt(),n=Vn(i),s=Mi(g,n);s.tag=1,s[t(2351)]=x,e!=null&&(s.callback=e),x=wn(i,s,n),x!==null&&(Lg(x,i,n,g),ar(x,i,n))},enqueueForceUpdate:function(i,x){const e=I;i=i[e(1525)];var t=Bt(),g=Vn(i),n=Mi(t,g);n.tag=2,x!=null&&(n[e(934)]=x),x=wn(i,n,g),x!==null&&(Lg(x,i,g,t),ar(x,i,g))}};function hG(i,x,e,t,g,n,s){const o=I;return i=i[o(1133)],o(1126)===typeof i[o(1400)]?i.shouldComponentUpdate(t,n,s):x[o(1566)]&&x[o(1566)][o(659)]?!Oc(e,t)||!Oc(g,n):!0}function M5(i,x,e){const t=I;var g=!1,n=Kn,s=x[t(979)];return t(1011)===typeof s&&s!==null?s=Zg(s):(n=Lt(x)?NI:Ct[t(1895)],g=x.contextTypes,s=(g=g!=null)?Co(i,n):Kn),x=new x(e,s),i[t(485)]=x[t(704)]!==null&&x[t(704)]!==void 0?x[t(704)]:null,x.updater=A2,i[t(1133)]=x,x[t(1525)]=i,g&&(i=i[t(1133)],i[t(3212)]=n,i[t(3704)]=s),x}function fG(i,x,e,t){const g=I;i=x[g(704)],g(1126)===typeof x[g(2890)]&&x[g(2890)](e,t),g(1126)===typeof x[g(2693)]&&x[g(2693)](e,t),x[g(704)]!==i&&A2[g(3157)](x,x.state,null)}function Cb(i,x,e,t){const g=I;var n=i[g(1133)];n.props=e,n[g(704)]=i[g(485)],n[g(3596)]={},Th(i);var s=x[g(979)];g(1011)===typeof s&&s!==null?n[g(3246)]=Zg(s):(s=Lt(x)?NI:Ct[g(1895)],n.context=Co(i,s)),n.state=i.memoizedState,s=x[g(2926)],g(1126)===typeof s&&(cb(i,x,s,e),n[g(704)]=i[g(485)]),typeof x[g(2926)]=="function"||g(1126)===typeof n.getSnapshotBeforeUpdate||g(1126)!==typeof n.UNSAFE_componentWillMount&&typeof n.componentWillMount!="function"||(x=n[g(704)],g(1126)===typeof n[g(288)]&&n[g(288)](),typeof n[g(927)]=="function"&&n.UNSAFE_componentWillMount(),x!==n[g(704)]&&A2[g(3157)](n,n[g(704)],null),Er(i,e,n,t),n.state=i[g(485)]),g(1126)===typeof n[g(3380)]&&(i.flags|=4194308)}function Ao(i,x){const e=I;try{var t="",g=x;do t+=Fw(g),g=g[e(3922)];while(g);var n=t}catch(s){n=e(763)+s[e(268)]+`
`+s[e(1574)]}return{value:i,source:x,stack:n,digest:null}}function vA(i,x,e){return{value:i,source:null,stack:e??null,digest:x??null}}function lb(i,x){const e=I;try{console[e(2963)](x[e(2113)])}catch(t){setTimeout(function(){throw t})}}var CV=typeof WeakMap=="function"?WeakMap:Map;function L5(i,x,e){e=Mi(-1,e),e.tag=3,e.payload={element:null};var t=x.value;return e.callback=function(){Pr||(Pr=!0,Gb=t),lb(i,x)},e}function k5(i,x,e){const t=I;e=Mi(-1,e),e[t(3795)]=3;var g=i[t(3505)][t(1609)];if(typeof g=="function"){var n=x.value;e[t(2351)]=function(){return g(n)},e[t(934)]=function(){lb(i,x)}}var s=i[t(1133)];return s!==null&&t(1126)===typeof s[t(384)]&&(e[t(934)]=function(){const o=t;lb(i,x),o(1126)!==typeof g&&(Rn===null?Rn=new Set([this]):Rn[o(3014)](this));var c=x[o(1574)];this.componentDidCatch(x[o(2113)],{componentStack:c!==null?c:""})}),e}function mG(i,x,e){const t=I;var g=i.pingCache;if(g===null){g=i[t(901)]=new CV;var n=new Set;g.set(x,n)}else n=g[t(2695)](x),n===void 0&&(n=new Set,g[t(298)](x,n));n[t(2489)](e)||(n.add(e),i=ZV[t(1600)](null,i,x,e),x[t(2334)](i,i))}function GG(i){const x=I;do{var e;if((e=i[x(3795)]===13)&&(e=i[x(485)],e=e!==null?e[x(772)]!==null:!0),e)return i;i=i[x(3922)]}while(i!==null);return null}function pG(i,x,e,t,g){const n=I;return i.mode&1?(i[n(2436)]|=65536,i[n(2840)]=g,i):(i===x?i[n(2436)]|=65536:(i.flags|=128,e[n(2436)]|=131072,e[n(2436)]&=-52805,e[n(3795)]===1&&(e.alternate===null?e.tag=17:(x=Mi(-1,1),x[n(3795)]=2,wn(e,x,1))),e[n(2840)]|=1),i)}var lV=_i.ReactCurrentOwner,Ft=!1;function ft(i,x,e,t){const g=I;x.child=i===null?u5(x,null,e,t):ao(x,i[g(1367)],e,t)}function BG(i,x,e,t,g){const n=I;e=e[n(948)];var s=x[n(3786)];return io(x,g),t=Dh(i,x,e,t,s,g),e=Qh(),i!==null&&!Ft?(x[n(2845)]=i[n(2845)],x[n(2436)]&=-2053,i[n(2840)]&=~g,Ti(i,x,g)):(Ie&&e&&Hh(x),x.flags|=1,ft(i,x,t,g),x[n(1367)])}function ZG(i,x,e,t,g){const n=I;if(i===null){var s=e[n(3505)];return typeof s=="function"&&!nf(s)&&s.defaultProps===void 0&&e[n(996)]===null&&e.defaultProps===void 0?(x[n(3795)]=15,x[n(3505)]=s,T5(i,x,s,t,g)):(i=hr(e.type,null,t,x,x[n(251)],g),i.ref=x[n(3786)],i[n(3922)]=x,x[n(1367)]=i)}if(s=i[n(1367)],!(i[n(2840)]&g)){var o=s[n(2990)];if(e=e[n(996)],e=e!==null?e:Oc,e(o,t)&&i.ref===x[n(3786)])return Ti(i,x,g)}return x.flags|=1,i=Sn(s,t),i[n(3786)]=x[n(3786)],i[n(3922)]=x,x[n(1367)]=i}function T5(i,x,e,t,g){const n=I;if(i!==null){var s=i[n(2990)];if(Oc(s,t)&&i[n(3786)]===x[n(3786)])if(Ft=!1,x[n(2343)]=t=s,(i[n(2840)]&g)!==0)i.flags&131072&&(Ft=!0);else return x.lanes=i[n(2840)],Ti(i,x,g)}return ab(i,x,e,t,g)}function J5(i,x,e){const t=I;var g=x[t(2343)],n=g[t(1352)],s=i!==null?i[t(485)]:null;if(t(2578)===g.mode)if(!(x[t(251)]&1))x[t(485)]={baseLanes:0,cachePool:null,transitions:null},$x(_s,jt),jt|=e;else{if(!(e&1073741824))return i=s!==null?s[t(3747)]|e:e,x[t(2840)]=x[t(3262)]=1073741824,x[t(485)]={baseLanes:i,cachePool:null,transitions:null},x[t(2845)]=null,$x(_s,jt),jt|=i,null;x.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=s!==null?s[t(3747)]:e,$x(_s,jt),jt|=g}else s!==null?(g=s[t(3747)]|e,x.memoizedState=null):g=e,$x(_s,jt),jt|=g;return ft(i,x,n,e),x[t(1367)]}function E5(i,x){const e=I;var t=x[e(3786)];(i===null&&t!==null||i!==null&&i[e(3786)]!==t)&&(x.flags|=512,x.flags|=2097152)}function ab(i,x,e,t,g){const n=I;var s=Lt(e)?NI:Ct[n(1895)];return s=Co(x,s),io(x,g),e=Dh(i,x,e,t,s,g),t=Qh(),i!==null&&!Ft?(x[n(2845)]=i[n(2845)],x.flags&=-2053,i[n(2840)]&=~g,Ti(i,x,g)):(Ie&&t&&Hh(x),x[n(2436)]|=1,ft(i,x,e,g),x.child)}function yG(i,x,e,t,g){const n=I;if(Lt(e)){var s=!0;Mr(x)}else s=!1;if(io(x,g),x.stateNode===null)Ar(i,x),M5(x,e,t),Cb(x,e,t,g),t=!0;else if(i===null){var o=x[n(1133)],c=x.memoizedProps;o[n(3105)]=c;var C=o[n(3246)],r=e[n(979)];n(1011)===typeof r&&r!==null?r=Zg(r):(r=Lt(e)?NI:Ct[n(1895)],r=Co(x,r));var A=e.getDerivedStateFromProps,d=n(1126)===typeof A||n(1126)===typeof o.getSnapshotBeforeUpdate;d||n(1126)!==typeof o[n(2693)]&&n(1126)!==typeof o[n(2890)]||(c!==t||C!==r)&&fG(x,o,t,r),bn=!1;var h=x[n(485)];o.state=h,Er(x,t,o,g),C=x[n(485)],c!==t||h!==C||Mt.current||bn?(typeof A=="function"&&(cb(x,e,A,t),C=x[n(485)]),(c=bn||hG(x,e,c,t,h,C,r))?(d||n(1126)!==typeof o[n(927)]&&n(1126)!==typeof o.componentWillMount||(typeof o[n(288)]=="function"&&o[n(288)](),n(1126)===typeof o.UNSAFE_componentWillMount&&o[n(927)]()),typeof o[n(3380)]=="function"&&(x[n(2436)]|=4194308)):(n(1126)===typeof o[n(3380)]&&(x.flags|=4194308),x[n(2990)]=t,x[n(485)]=C),o[n(3105)]=t,o[n(704)]=C,o[n(3246)]=r,t=c):(n(1126)===typeof o.componentDidMount&&(x.flags|=4194308),t=!1)}else{o=x[n(1133)],h5(i,x),c=x.memoizedProps,r=x.type===x[n(1992)]?c:Kg(x[n(3505)],c),o.props=r,d=x[n(2343)],h=o.context,C=e[n(979)],n(1011)===typeof C&&C!==null?C=Zg(C):(C=Lt(e)?NI:Ct.current,C=Co(x,C));var f=e[n(2926)];(A=typeof f=="function"||n(1126)===typeof o[n(3092)])||typeof o[n(2693)]!="function"&&n(1126)!==typeof o[n(2890)]||(c!==d||h!==C)&&fG(x,o,t,C),bn=!1,h=x.memoizedState,o[n(704)]=h,Er(x,t,o,g);var B=x[n(485)];c!==d||h!==B||Mt.current||bn?(n(1126)===typeof f&&(cb(x,e,f,t),B=x.memoizedState),(r=bn||hG(x,e,r,t,h,B,C)||!1)?(A||n(1126)!==typeof o.UNSAFE_componentWillUpdate&&n(1126)!==typeof o[n(187)]||(typeof o[n(187)]=="function"&&o.componentWillUpdate(t,B,C),n(1126)===typeof o[n(3973)]&&o[n(3973)](t,B,C)),n(1126)===typeof o.componentDidUpdate&&(x[n(2436)]|=4),typeof o[n(3092)]=="function"&&(x.flags|=1024)):(n(1126)!==typeof o[n(3928)]||c===i.memoizedProps&&h===i[n(485)]||(x[n(2436)]|=4),n(1126)!==typeof o[n(3092)]||c===i[n(2990)]&&h===i[n(485)]||(x[n(2436)]|=1024),x[n(2990)]=t,x.memoizedState=B),o[n(3105)]=t,o[n(704)]=B,o[n(3246)]=C,t=r):(typeof o[n(3928)]!="function"||c===i[n(2990)]&&h===i.memoizedState||(x[n(2436)]|=4),n(1126)!==typeof o[n(3092)]||c===i[n(2990)]&&h===i[n(485)]||(x[n(2436)]|=1024),t=!1)}return rb(i,x,e,t,s,g)}function rb(i,x,e,t,g,n){const s=I;E5(i,x);var o=(x[s(2436)]&128)!==0;if(!t&&!o)return g&&CG(x,e,!1),Ti(i,x,n);t=x.stateNode,lV[s(1895)]=x;var c=o&&typeof e[s(1609)]!="function"?null:t[s(948)]();return x[s(2436)]|=1,i!==null&&o?(x.child=ao(x,i[s(1367)],null,n),x[s(1367)]=ao(x,null,c,n)):ft(i,x,c,n),x[s(485)]=t[s(704)],g&&CG(x,e,!0),x[s(1367)]}function U5(i){const x=I;var e=i[x(1133)];e.pendingContext?cG(i,e.pendingContext,e[x(3032)]!==e[x(3246)]):e[x(3246)]&&cG(i,e[x(3246)],!1),Jh(i,e[x(1951)])}function vG(i,x,e,t,g){const n=I;return lo(),Fh(g),x[n(2436)]|=256,ft(i,x,e,t),x[n(1367)]}var db={dehydrated:null,treeContext:null,retryLane:0};function Ab(i){return{baseLanes:i,cachePool:null,transitions:null}}function _5(i,x,e){const t=I;var g=x[t(2343)],n=oe.current,s=!1,o=(x[t(2436)]&128)!==0,c;if((c=o)||(c=i!==null&&i.memoizedState===null?!1:(n&2)!==0),c?(s=!0,x[t(2436)]&=-129):(i===null||i[t(485)]!==null)&&(n|=1),$x(oe,n&1),i===null)return sb(x),i=x.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(x.mode&1?i.data==="$!"?x[t(2840)]=8:x.lanes=1073741824:x[t(2840)]=1,null):(o=g[t(1352)],i=g[t(1644)],s?(g=x[t(251)],s=x.child,o={mode:t(2578),children:o},!(g&1)&&s!==null?(s[t(3262)]=0,s.pendingProps=o):s=h2(o,g,0,null),i=VI(i,g,e,null),s[t(3922)]=x,i[t(3922)]=x,s.sibling=i,x[t(1367)]=s,x[t(1367)][t(485)]=Ab(e),x[t(485)]=db,i):qh(x,o));if(n=i[t(485)],n!==null&&(c=n[t(772)],c!==null))return aV(i,x,o,g,c,n,e);if(s){s=g[t(1644)],o=x[t(251)],n=i[t(1367)],c=n[t(1263)];var C={mode:t(2578),children:g[t(1352)]};return!(o&1)&&x[t(1367)]!==n?(g=x[t(1367)],g[t(3262)]=0,g[t(2343)]=C,x[t(2716)]=null):(g=Sn(n,C),g[t(1983)]=n[t(1983)]&14680064),c!==null?s=Sn(c,s):(s=VI(s,o,e,null),s[t(2436)]|=2),s[t(3922)]=x,g[t(3922)]=x,g[t(1263)]=s,x[t(1367)]=g,g=s,s=x.child,o=i[t(1367)][t(485)],o=o===null?Ab(e):{baseLanes:o[t(3747)]|e,cachePool:null,transitions:o.transitions},s[t(485)]=o,s[t(3262)]=i[t(3262)]&~e,x[t(485)]=db,g}return s=i[t(1367)],i=s[t(1263)],g=Sn(s,{mode:t(2548),children:g[t(1352)]}),!(x[t(251)]&1)&&(g[t(2840)]=e),g[t(3922)]=x,g[t(1263)]=null,i!==null&&(e=x[t(2716)],e===null?(x[t(2716)]=[i],x[t(2436)]|=16):e[t(3330)](i)),x.child=g,x[t(485)]=null,g}function qh(i,x){const e=I;return x=h2({mode:"visible",children:x},i[e(251)],0,null),x[e(3922)]=i,i[e(1367)]=x}function xa(i,x,e,t){const g=I;return t!==null&&Fh(t),ao(x,i[g(1367)],null,e),i=qh(x,x[g(2343)][g(1352)]),i.flags|=2,x[g(485)]=null,i}function aV(i,x,e,t,g,n,s){const o=I;if(e)return x[o(2436)]&256?(x[o(2436)]&=-257,t=vA(Error(N0(422))),xa(i,x,s,t)):x.memoizedState!==null?(x.child=i[o(1367)],x.flags|=128,null):(n=t[o(1644)],g=x[o(251)],t=h2({mode:o(2548),children:t[o(1352)]},g,0,null),n=VI(n,g,s,null),n.flags|=2,t[o(3922)]=x,n[o(3922)]=x,t[o(1263)]=n,x[o(1367)]=t,x[o(251)]&1&&ao(x,i.child,null,s),x[o(1367)][o(485)]=Ab(s),x[o(485)]=db,n);if(!(x[o(251)]&1))return xa(i,x,s,null);if(g.data==="$!"){if(t=g[o(868)]&&g[o(868)].dataset,t)var c=t[o(3727)];return t=c,n=Error(N0(419)),t=vA(n,t,void 0),xa(i,x,s,t)}if(c=(s&i[o(3262)])!==0,Ft||c){if(t=Le,t!==null){switch(s&-s){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(t.suspendedLanes|s)?0:g,g!==0&&g!==n.retryLane&&(n.retryLane=g,zi(i,g),Lg(t,i,g,-1))}return gf(),t=vA(Error(N0(421))),xa(i,x,s,t)}return g[o(3787)]==="$?"?(x[o(2436)]|=128,x.child=i[o(1367)],x=yV[o(1600)](null,i),g[o(2056)]=x,null):(i=n[o(910)],eg=Wn(g.nextSibling),tg=x,Ie=!0,Fg=null,i!==null&&(ug[bg++]=Xi,ug[bg++]=Yi,ug[bg++]=FI,Xi=i.id,Yi=i.overflow,FI=x),x=qh(x,t[o(1352)]),x[o(2436)]|=4096,x)}function WG(i,x,e){const t=I;i.lanes|=x;var g=i[t(641)];g!==null&&(g.lanes|=x),ob(i[t(3922)],x,e)}function WA(i,x,e,t,g){const n=I;var s=i[n(485)];s===null?i[n(485)]={isBackwards:x,rendering:null,renderingStartTime:0,last:t,tail:e,tailMode:g}:(s[n(2789)]=x,s.rendering=null,s.renderingStartTime=0,s[n(291)]=t,s[n(470)]=e,s[n(737)]=g)}function D5(i,x,e){const t=I;var g=x[t(2343)],n=g[t(3170)],s=g[t(470)];if(ft(i,x,g[t(1352)],e),g=oe[t(1895)],g&2)g=g&1|2,x[t(2436)]|=128;else{if(i!==null&&i[t(2436)]&128)x:for(i=x.child;i!==null;){if(i[t(3795)]===13)i[t(485)]!==null&&WG(i,e,x);else if(i[t(3795)]===19)WG(i,e,x);else if(i[t(1367)]!==null){i.child[t(3922)]=i,i=i[t(1367)];continue}if(i===x)break x;for(;i[t(1263)]===null;){if(i[t(3922)]===null||i[t(3922)]===x)break x;i=i.return}i.sibling.return=i[t(3922)],i=i[t(1263)]}g&=1}if($x(oe,g),!(x[t(251)]&1))x[t(485)]=null;else switch(n){case"forwards":for(e=x.child,n=null;e!==null;)i=e.alternate,i!==null&&Ur(i)===null&&(n=e),e=e[t(1263)];e=n,e===null?(n=x[t(1367)],x.child=null):(n=e[t(1263)],e.sibling=null),WA(x,!1,n,e,s);break;case"backwards":for(e=null,n=x.child,x[t(1367)]=null;n!==null;){if(i=n[t(641)],i!==null&&Ur(i)===null){x[t(1367)]=n;break}i=n[t(1263)],n[t(1263)]=e,e=n,n=i}WA(x,!0,e,null,s);break;case t(1512):WA(x,!1,null,null,void 0);break;default:x[t(485)]=null}return x[t(1367)]}function Ar(i,x){const e=I;!(x[e(251)]&1)&&i!==null&&(i[e(641)]=null,x.alternate=null,x[e(2436)]|=2)}function Ti(i,x,e){const t=I;if(i!==null&&(x[t(1461)]=i[t(1461)]),MI|=x[t(2840)],!(e&x.childLanes))return null;if(i!==null&&x[t(1367)]!==i[t(1367)])throw Error(N0(153));if(x[t(1367)]!==null){for(i=x[t(1367)],e=Sn(i,i.pendingProps),x[t(1367)]=e,e[t(3922)]=x;i[t(1263)]!==null;)i=i[t(1263)],e=e.sibling=Sn(i,i[t(2343)]),e[t(3922)]=x;e[t(1263)]=null}return x[t(1367)]}function rV(i,x,e){const t=I;switch(x[t(3795)]){case 3:U5(x),lo();break;case 5:f5(x);break;case 1:Lt(x[t(3505)])&&Mr(x);break;case 4:Jh(x,x[t(1133)].containerInfo);break;case 10:var g=x[t(3505)][t(3942)],n=x[t(2990)].value;$x(Tr,g._currentValue),g[t(891)]=n;break;case 13:if(g=x[t(485)],g!==null)return g.dehydrated!==null?($x(oe,oe[t(1895)]&1),x.flags|=128,null):e&x.child.childLanes?_5(i,x,e):($x(oe,oe[t(1895)]&1),i=Ti(i,x,e),i!==null?i[t(1263)]:null);$x(oe,oe.current&1);break;case 19:if(g=(e&x[t(3262)])!==0,i[t(2436)]&128){if(g)return D5(i,x,e);x[t(2436)]|=128}if(n=x[t(485)],n!==null&&(n[t(580)]=null,n[t(470)]=null,n[t(1548)]=null),$x(oe,oe.current),g)break;return null;case 22:case 23:return x[t(2840)]=0,J5(i,x,e)}return Ti(i,x,e)}var Q5,ub,P5,O5;Q5=function(i,x){const e=I;for(var t=x.child;t!==null;){if(t[e(3795)]===5||t[e(3795)]===6)i[e(3376)](t[e(1133)]);else if(t[e(3795)]!==4&&t[e(1367)]!==null){t[e(1367)].return=t,t=t[e(1367)];continue}if(t===x)break;for(;t[e(1263)]===null;){if(t[e(3922)]===null||t[e(3922)]===x)return;t=t[e(3922)]}t[e(1263)][e(3922)]=t[e(3922)],t=t[e(1263)]}},ub=function(){},P5=function(i,x,e,t){const g=I;var n=i.memoizedProps;if(n!==t){i=x[g(1133)],ZI(li[g(1895)]);var s=null;switch(e){case g(2217):n=zu(i,n),t=zu(i,t),s=[];break;case"select":n=le({},n,{value:void 0}),t=le({},t,{value:void 0}),s=[];break;case g(3347):n=ku(i,n),t=ku(i,t),s=[];break;default:g(1126)!==typeof n.onClick&&g(1126)===typeof t[g(2834)]&&(i[g(3104)]=Fr)}Ju(e,t);var o;e=null;for(r in n)if(!t[g(3631)](r)&&n[g(3631)](r)&&n[r]!=null)if(g(1720)===r){var c=n[r];for(o in c)c[g(3631)](o)&&(e||(e={}),e[o]="")}else g(698)!==r&&r!=="children"&&g(3028)!==r&&g(1882)!==r&&g(2314)!==r&&(Jc[g(3631)](r)?s||(s=[]):(s=s||[])[g(3330)](r,null));for(r in t){var C=t[r];if(c=n!=null?n[r]:void 0,t[g(3631)](r)&&C!==c&&(C!=null||c!=null))if(g(1720)===r)if(c){for(o in c)!c.hasOwnProperty(o)||C&&C[g(3631)](o)||(e||(e={}),e[o]="");for(o in C)C.hasOwnProperty(o)&&c[o]!==C[o]&&(e||(e={}),e[o]=C[o])}else e||(s||(s=[]),s[g(3330)](r,e)),e=C;else g(698)===r?(C=C?C.__html:void 0,c=c?c[g(2697)]:void 0,C!=null&&c!==C&&(s=s||[]).push(r,C)):g(1352)===r?g(3674)!==typeof C&&g(1025)!==typeof C||(s=s||[])[g(3330)](r,""+C):r!=="suppressContentEditableWarning"&&g(1882)!==r&&(Jc[g(3631)](r)?(C!=null&&g(875)===r&&xe(g(3234),i),s||c===C||(s=[])):(s=s||[])[g(3330)](r,C))}e&&(s=s||[])[g(3330)](g(1720),e);var r=s;(x[g(2845)]=r)&&(x[g(2436)]|=4)}},O5=function(i,x,e,t){e!==t&&(x.flags|=4)};function gc(i,x){const e=I;if(!Ie)switch(i[e(737)]){case e(2578):x=i[e(470)];for(var t=null;x!==null;)x[e(641)]!==null&&(t=x),x=x[e(1263)];t===null?i[e(470)]=null:t.sibling=null;break;case e(274):t=i[e(470)];for(var g=null;t!==null;)t.alternate!==null&&(g=t),t=t[e(1263)];g===null?x||i[e(470)]===null?i[e(470)]=null:i.tail[e(1263)]=null:g[e(1263)]=null}}function et(i){const x=I;var e=i.alternate!==null&&i[x(641)][x(1367)]===i[x(1367)],t=0,g=0;if(e)for(var n=i[x(1367)];n!==null;)t|=n.lanes|n[x(3262)],g|=n.subtreeFlags&14680064,g|=n[x(2436)]&14680064,n[x(3922)]=i,n=n[x(1263)];else for(n=i[x(1367)];n!==null;)t|=n[x(2840)]|n[x(3262)],g|=n[x(1983)],g|=n.flags,n[x(3922)]=i,n=n.sibling;return i[x(1983)]|=g,i.childLanes=t,e}function dV(i,x,e){const t=I;var g=x[t(2343)];switch(Nh(x),x[t(3795)]){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return et(x),null;case 1:return Lt(x[t(3505)])&&zr(),et(x),null;case 3:return g=x[t(1133)],ro(),te(Mt),te(Ct),Uh(),g[t(3032)]&&(g[t(3246)]=g[t(3032)],g[t(3032)]=null),(i===null||i[t(1367)]===null)&&($l(x)?x.flags|=4:i===null||i[t(485)][t(2290)]&&!(x.flags&256)||(x[t(2436)]|=1024,Fg!==null&&(Zb(Fg),Fg=null))),ub(i,x),et(x),null;case 5:Eh(x);var n=ZI(eC[t(1895)]);if(e=x[t(3505)],i!==null&&x[t(1133)]!=null)P5(i,x,e,g,n),i[t(3786)]!==x[t(3786)]&&(x.flags|=512,x.flags|=2097152);else{if(!g){if(x[t(1133)]===null)throw Error(N0(166));return et(x),null}if(i=ZI(li[t(1895)]),$l(x)){g=x.stateNode,e=x.type;var s=x[t(2990)];switch(g[Ii]=x,g[jc]=s,i=(x[t(251)]&1)!==0,e){case"dialog":xe(t(1035),g),xe("close",g);break;case"iframe":case t(1011):case t(1038):xe(t(3043),g);break;case t(2260):case t(3966):for(n=0;n<vc[t(2989)];n++)xe(vc[n],g);break;case t(3272):xe(t(2963),g);break;case t(1380):case t(1781):case"link":xe("error",g),xe(t(3043),g);break;case t(1279):xe("toggle",g);break;case"input":Nm(g,s),xe(t(3013),g);break;case t(1860):g._wrapperState={wasMultiple:!!s.multiple},xe("invalid",g);break;case"textarea":zm(g,s),xe(t(3013),g)}Ju(e,s),n=null;for(var o in s)if(s[t(3631)](o)){var c=s[o];t(1352)===o?typeof c=="string"?g[t(2029)]!==c&&(s[t(1882)]!==!0&&ql(g[t(2029)],c,i),n=[t(1352),c]):t(1025)===typeof c&&g[t(2029)]!==""+c&&(s[t(1882)]!==!0&&ql(g[t(2029)],c,i),n=["children",""+c]):Jc[t(3631)](o)&&c!=null&&t(875)===o&&xe(t(3234),g)}switch(e){case"input":Jl(g),Fm(g,s,!0);break;case t(3347):Jl(g),Mm(g);break;case"select":case t(2497):break;default:t(1126)===typeof s.onClick&&(g[t(3104)]=Fr)}g=n,x[t(2845)]=g,g!==null&&(x.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,t(3909)===i&&(i=ZZ(e)),t(3909)===i?t(3337)===e?(i=o.createElement(t(778)),i[t(2027)]=t(575),i=i[t(207)](i[t(1290)])):typeof g.is=="string"?i=o[t(2171)](e,{is:g.is}):(i=o.createElement(e),t(1860)===e&&(o=i,g[t(3198)]?o[t(3198)]=!0:g.size&&(o[t(1019)]=g[t(1019)]))):i=o[t(3356)](i,e),i[Ii]=x,i[jc]=g,Q5(i,x,!1,!1),x[t(1133)]=i;x:{switch(o=Eu(e,g),e){case t(917):xe(t(1035),i),xe(t(2039),i),n=g;break;case t(720):case t(1011):case t(1038):xe("load",i),n=g;break;case t(2260):case t(3966):for(n=0;n<vc[t(2989)];n++)xe(vc[n],i);n=g;break;case t(3272):xe("error",i),n=g;break;case t(1380):case t(1781):case t(394):xe("error",i),xe(t(3043),i),n=g;break;case t(1279):xe(t(526),i),n=g;break;case t(2217):Nm(i,g),n=zu(i,g),xe(t(3013),i);break;case t(2497):n=g;break;case t(1860):i._wrapperState={wasMultiple:!!g[t(3198)]},n=le({},g,{value:void 0}),xe(t(3013),i);break;case t(3347):zm(i,g),n=ku(i,g),xe(t(3013),i);break;default:n=g}Ju(e,n),c=n;for(s in c)if(c[t(3631)](s)){var C=c[s];s==="style"?WZ(i,C):t(698)===s?(C=C?C.__html:void 0,C!=null&&yZ(i,C)):t(1352)===s?t(3674)===typeof C?(e!=="textarea"||C!=="")&&Ec(i,C):typeof C=="number"&&Ec(i,""+C):t(3028)!==s&&t(1882)!==s&&t(2314)!==s&&(Jc[t(3631)](s)?C!=null&&t(875)===s&&xe("scroll",i):C!=null&&Gh(i,s,C,o))}switch(e){case t(2217):Jl(i),Fm(i,g,!1);break;case t(3347):Jl(i),Mm(i);break;case t(2497):g[t(2113)]!=null&&i.setAttribute(t(2113),""+Yn(g[t(2113)]));break;case t(1860):i[t(3198)]=!!g.multiple,s=g[t(2113)],s!=null?xo(i,!!g[t(3198)],s,!1):g[t(320)]!=null&&xo(i,!!g[t(3198)],g.defaultValue,!0);break;default:t(1126)===typeof n[t(2834)]&&(i[t(3104)]=Fr)}switch(e){case t(2828):case t(2217):case"select":case t(3347):g=!!g.autoFocus;break x;case"img":g=!0;break x;default:g=!1}}g&&(x[t(2436)]|=4)}x[t(3786)]!==null&&(x[t(2436)]|=512,x[t(2436)]|=2097152)}return et(x),null;case 6:if(i&&x[t(1133)]!=null)O5(i,x,i.memoizedProps,g);else{if(t(3674)!==typeof g&&x.stateNode===null)throw Error(N0(166));if(e=ZI(eC[t(1895)]),ZI(li[t(1895)]),$l(x)){if(g=x[t(1133)],e=x.memoizedProps,g[Ii]=x,(s=g[t(1328)]!==e)&&(i=tg,i!==null))switch(i[t(3795)]){case 3:ql(g[t(1328)],e,(i[t(251)]&1)!==0);break;case 5:i[t(2990)][t(1882)]!==!0&&ql(g.nodeValue,e,(i[t(251)]&1)!==0)}s&&(x[t(2436)]|=4)}else g=(e[t(773)]===9?e:e[t(2070)])[t(3866)](g),g[Ii]=x,x[t(1133)]=g}return et(x),null;case 13:if(te(oe),g=x[t(485)],i===null||i[t(485)]!==null&&i[t(485)].dehydrated!==null){if(Ie&&eg!==null&&x[t(251)]&1&&!(x[t(2436)]&128))d5(),lo(),x.flags|=98560,s=!1;else if(s=$l(x),g!==null&&g.dehydrated!==null){if(i===null){if(!s)throw Error(N0(318));if(s=x[t(485)],s=s!==null?s.dehydrated:null,!s)throw Error(N0(317));s[Ii]=x}else lo(),!(x[t(2436)]&128)&&(x[t(485)]=null),x.flags|=4;et(x),s=!1}else Fg!==null&&(Zb(Fg),Fg=null),s=!0;if(!s)return x[t(2436)]&65536?x:null}return x.flags&128?(x.lanes=e,x):(g=g!==null,g!==(i!==null&&i[t(485)]!==null)&&g&&(x[t(1367)][t(2436)]|=8192,x[t(251)]&1&&(i===null||oe.current&1?we===0&&(we=3):gf())),x[t(2845)]!==null&&(x[t(2436)]|=4),et(x),null);case 4:return ro(),ub(i,x),i===null&&qc(x.stateNode[t(1951)]),et(x),null;case 10:return Lh(x[t(3505)][t(3942)]),et(x),null;case 17:return Lt(x[t(3505)])&&zr(),et(x),null;case 19:if(te(oe),s=x[t(485)],s===null)return et(x),null;if(g=(x[t(2436)]&128)!==0,o=s.rendering,o===null)if(g)gc(s,!1);else{if(we!==0||i!==null&&i[t(2436)]&128)for(i=x.child;i!==null;){if(o=Ur(i),o!==null){for(x[t(2436)]|=128,gc(s,!1),g=o[t(2845)],g!==null&&(x[t(2845)]=g,x[t(2436)]|=4),x.subtreeFlags=0,g=e,e=x[t(1367)];e!==null;)s=e,i=g,s.flags&=14680066,o=s[t(641)],o===null?(s[t(3262)]=0,s.lanes=i,s[t(1367)]=null,s[t(1983)]=0,s[t(2990)]=null,s[t(485)]=null,s[t(2845)]=null,s[t(1461)]=null,s[t(1133)]=null):(s.childLanes=o[t(3262)],s[t(2840)]=o.lanes,s[t(1367)]=o.child,s[t(1983)]=0,s.deletions=null,s[t(2990)]=o[t(2990)],s[t(485)]=o[t(485)],s[t(2845)]=o.updateQueue,s[t(3505)]=o.type,i=o[t(1461)],s[t(1461)]=i===null?null:{lanes:i.lanes,firstContext:i[t(1401)]}),e=e[t(1263)];return $x(oe,oe[t(1895)]&1|2),x[t(1367)]}i=i[t(1263)]}s[t(470)]!==null&&fe()>uo&&(x[t(2436)]|=128,g=!0,gc(s,!1),x[t(2840)]=4194304)}else{if(!g)if(i=Ur(o),i!==null){if(x[t(2436)]|=128,g=!0,e=i[t(2845)],e!==null&&(x[t(2845)]=e,x[t(2436)]|=4),gc(s,!0),s[t(470)]===null&&t(2578)===s[t(737)]&&!o[t(641)]&&!Ie)return et(x),null}else 2*fe()-s[t(1893)]>uo&&e!==1073741824&&(x[t(2436)]|=128,g=!0,gc(s,!1),x.lanes=4194304);s[t(2789)]?(o[t(1263)]=x[t(1367)],x[t(1367)]=o):(e=s[t(291)],e!==null?e[t(1263)]=o:x[t(1367)]=o,s[t(291)]=o)}return s.tail!==null?(x=s[t(470)],s[t(580)]=x,s[t(470)]=x[t(1263)],s[t(1893)]=fe(),x[t(1263)]=null,e=oe[t(1895)],$x(oe,g?e&1|2:e&1),x):(et(x),null);case 22:case 23:return tf(),g=x[t(485)]!==null,i!==null&&i[t(485)]!==null!==g&&(x[t(2436)]|=8192),g&&x.mode&1?jt&1073741824&&(et(x),x[t(1983)]&6&&(x[t(2436)]|=8192)):et(x),null;case 24:return null;case 25:return null}throw Error(N0(156,x[t(3795)]))}function AV(i,x){const e=I;switch(Nh(x),x[e(3795)]){case 1:return Lt(x[e(3505)])&&zr(),i=x[e(2436)],i&65536?(x.flags=i&-65537|128,x):null;case 3:return ro(),te(Mt),te(Ct),Uh(),i=x[e(2436)],i&65536&&!(i&128)?(x[e(2436)]=i&-65537|128,x):null;case 5:return Eh(x),null;case 13:if(te(oe),i=x[e(485)],i!==null&&i[e(772)]!==null){if(x.alternate===null)throw Error(N0(340));lo()}return i=x.flags,i&65536?(x[e(2436)]=i&-65537|128,x):null;case 19:return te(oe),null;case 4:return ro(),null;case 10:return Lh(x[e(3505)][e(3942)]),null;case 22:case 23:return tf(),null;case 24:return null;default:return null}}var ea=!1,st=!1,uV=typeof WeakSet=="function"?WeakSet:Set,O0=null;function Us(i,x){const e=I;var t=i[e(3786)];if(t!==null)if(typeof t=="function")try{t(null)}catch(g){de(i,x,g)}else t[e(1895)]=null}function bb(i,x,e){try{e()}catch(t){de(i,x,t)}}var wG=!1;function bV(i,x){const e=I;if(xb=Kr,i=e5(),Kh(i)){if(e(454)in i)var t={start:i.selectionStart,end:i[e(2196)]};else x:{t=(t=i[e(2070)])&&t[e(1069)]||window;var g=t.getSelection&&t.getSelection();if(g&&g[e(3210)]!==0){t=g[e(3197)];var n=g[e(3163)],s=g[e(359)];g=g[e(497)];try{t[e(773)],s[e(773)]}catch{t=null;break x}var o=0,c=-1,C=-1,r=0,A=0,d=i,h=null;e:for(;;){for(var f;d!==t||n!==0&&d[e(773)]!==3||(c=o+n),d!==s||g!==0&&d.nodeType!==3||(C=o+g),d[e(773)]===3&&(o+=d.nodeValue[e(2989)]),(f=d[e(1290)])!==null;)h=d,d=f;for(;;){if(d===i)break e;if(h===t&&++r===n&&(c=o),h===s&&++A===g&&(C=o),(f=d[e(868)])!==null)break;d=h,h=d[e(2310)]}d=f}t=c===-1||C===-1?null:{start:c,end:C}}else t=null}t=t||{start:0,end:0}}else t=null;for(eb={focusedElem:i,selectionRange:t},Kr=!1,O0=x;O0!==null;)if(x=O0,i=x[e(1367)],(x[e(1983)]&1028)!==0&&i!==null)i[e(3922)]=x,O0=i;else for(;O0!==null;){x=O0;try{var B=x.alternate;if(x[e(2436)]&1024)switch(x[e(3795)]){case 0:case 11:case 15:break;case 1:if(B!==null){var Z=B.memoizedProps,G=B[e(485)],m=x[e(1133)],v=m[e(3092)](x.elementType===x[e(3505)]?Z:Kg(x[e(3505)],Z),G);m[e(2362)]=v}break;case 3:var p=x[e(1133)][e(1951)];p[e(773)]===1?p.textContent="":p.nodeType===9&&p[e(1584)]&&p[e(207)](p[e(1584)]);break;case 5:case 6:case 4:case 17:break;default:throw Error(N0(163))}}catch(w){de(x,x.return,w)}if(i=x.sibling,i!==null){i[e(3922)]=x[e(3922)],O0=i;break}O0=x[e(3922)]}return B=wG,wG=!1,B}function Hc(i,x,e){const t=I;var g=x[t(2845)];if(g=g!==null?g.lastEffect:null,g!==null){var n=g=g[t(890)];do{if((n[t(3795)]&i)===i){var s=n[t(1456)];n[t(1456)]=void 0,s!==void 0&&bb(x,e,s)}n=n.next}while(n!==g)}}function u2(i,x){const e=I;if(x=x[e(2845)],x=x!==null?x.lastEffect:null,x!==null){var t=x=x[e(890)];do{if((t[e(3795)]&i)===i){var g=t.create;t[e(1456)]=g()}t=t[e(890)]}while(t!==x)}}function hb(i){const x=I;var e=i[x(3786)];if(e!==null){var t=i.stateNode;switch(i[x(3795)]){case 5:i=t;break;default:i=t}x(1126)===typeof e?e(i):e[x(1895)]=i}}function q5(i){const x=I;var e=i[x(641)];e!==null&&(i[x(641)]=null,q5(e)),i[x(1367)]=null,i[x(2716)]=null,i[x(1263)]=null,i[x(3795)]===5&&(e=i[x(1133)],e!==null&&(delete e[Ii],delete e[jc],delete e[ib],delete e[jR],delete e[xV])),i[x(1133)]=null,i.return=null,i[x(1461)]=null,i[x(2990)]=null,i[x(485)]=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function $5(i){return i[I(3795)]===5||i.tag===3||i.tag===4}function RG(i){const x=I;x:for(;;){for(;i.sibling===null;){if(i[x(3922)]===null||$5(i.return))return null;i=i[x(3922)]}for(i[x(1263)][x(3922)]=i[x(3922)],i=i[x(1263)];i[x(3795)]!==5&&i[x(3795)]!==6&&i[x(3795)]!==18;){if(i.flags&2||i[x(1367)]===null||i[x(3795)]===4)continue x;i[x(1367)].return=i,i=i[x(1367)]}if(!(i[x(2436)]&2))return i[x(1133)]}}function fb(i,x,e){const t=I;var g=i[t(3795)];if(g===5||g===6)i=i[t(1133)],x?e.nodeType===8?e[t(2310)][t(2065)](i,x):e[t(2065)](i,x):(e.nodeType===8?(x=e[t(2310)],x[t(2065)](i,e)):(x=e,x[t(3376)](i)),e=e._reactRootContainer,e!=null||x[t(3104)]!==null||(x[t(3104)]=Fr));else if(g!==4&&(i=i[t(1367)],i!==null))for(fb(i,x,e),i=i[t(1263)];i!==null;)fb(i,x,e),i=i[t(1263)]}function mb(i,x,e){const t=I;var g=i[t(3795)];if(g===5||g===6)i=i.stateNode,x?e[t(2065)](i,x):e[t(3376)](i);else if(g!==4&&(i=i[t(1367)],i!==null))for(mb(i,x,e),i=i[t(1263)];i!==null;)mb(i,x,e),i=i[t(1263)]}var _e=null,Ng=!1;function In(i,x,e){const t=I;for(e=e[t(1367)];e!==null;)j5(i,x,e),e=e[t(1263)]}function j5(i,x,e){const t=I;if(Ci&&typeof Ci[t(2250)]=="function")try{Ci[t(2250)](o2,e)}catch{}switch(e[t(3795)]){case 5:st||Us(e,x);case 6:var g=_e,n=Ng;_e=null,In(i,x,e),_e=g,Ng=n,_e!==null&&(Ng?(i=_e,e=e[t(1133)],i[t(773)]===8?i[t(2310)][t(207)](e):i[t(207)](e)):_e[t(207)](e[t(1133)]));break;case 18:_e!==null&&(Ng?(i=_e,e=e[t(1133)],i[t(773)]===8?mA(i.parentNode,e):i.nodeType===1&&mA(i,e),Qc(i)):mA(_e,e.stateNode));break;case 4:g=_e,n=Ng,_e=e.stateNode[t(1951)],Ng=!0,In(i,x,e),_e=g,Ng=n;break;case 0:case 11:case 14:case 15:if(!st&&(g=e[t(2845)],g!==null&&(g=g.lastEffect,g!==null))){n=g=g[t(890)];do{var s=n,o=s[t(1456)];s=s[t(3795)],o!==void 0&&(s&2||s&4)&&bb(e,x,o),n=n[t(890)]}while(n!==g)}In(i,x,e);break;case 1:if(!st&&(Us(e,x),g=e[t(1133)],typeof g[t(3457)]=="function"))try{g.props=e[t(2990)],g[t(704)]=e[t(485)],g[t(3457)]()}catch(c){de(e,x,c)}In(i,x,e);break;case 21:In(i,x,e);break;case 22:e[t(251)]&1?(st=(g=st)||e[t(485)]!==null,In(i,x,e),st=g):In(i,x,e);break;default:In(i,x,e)}}function VG(i){const x=I;var e=i[x(2845)];if(e!==null){i[x(2845)]=null;var t=i.stateNode;t===null&&(t=i[x(1133)]=new uV),e.forEach(function(g){const n=x;var s=vV.bind(null,i,g);t[n(2489)](g)||(t[n(3014)](g),g[n(2334)](s,s))})}}function wg(i,x){const e=I;var t=x[e(2716)];if(t!==null)for(var g=0;g<t.length;g++){var n=t[g];try{var s=i,o=x,c=o;x:for(;c!==null;){switch(c.tag){case 5:_e=c.stateNode,Ng=!1;break x;case 3:_e=c[e(1133)][e(1951)],Ng=!0;break x;case 4:_e=c.stateNode.containerInfo,Ng=!0;break x}c=c[e(3922)]}if(_e===null)throw Error(N0(160));j5(s,o,n),_e=null,Ng=!1;var C=n[e(641)];C!==null&&(C.return=null),n[e(3922)]=null}catch(r){de(n,x,r)}}if(x[e(1983)]&12854)for(x=x.child;x!==null;)xy(x,i),x=x.sibling}function xy(i,x){const e=I;var t=i[e(641)],g=i[e(2436)];switch(i.tag){case 0:case 11:case 14:case 15:if(wg(x,i),xi(i),g&4){try{Hc(3,i,i.return),u2(3,i)}catch(Z){de(i,i[e(3922)],Z)}try{Hc(5,i,i.return)}catch(Z){de(i,i[e(3922)],Z)}}break;case 1:wg(x,i),xi(i),g&512&&t!==null&&Us(t,t[e(3922)]);break;case 5:if(wg(x,i),xi(i),g&512&&t!==null&&Us(t,t.return),i[e(2436)]&32){var n=i[e(1133)];try{Ec(n,"")}catch(Z){de(i,i.return,Z)}}if(g&4&&(n=i.stateNode,n!=null)){var s=i[e(2990)],o=t!==null?t[e(2990)]:s,c=i[e(3505)],C=i.updateQueue;if(i[e(2845)]=null,C!==null)try{e(2217)===c&&e(1403)===s[e(3505)]&&s.name!=null&&pZ(n,s),Eu(c,o);var r=Eu(c,s);for(o=0;o<C.length;o+=2){var A=C[o],d=C[o+1];A==="style"?WZ(n,d):e(698)===A?yZ(n,d):e(1352)===A?Ec(n,d):Gh(n,A,d,r)}switch(c){case e(2217):Mu(n,s);break;case e(3347):BZ(n,s);break;case e(1860):var h=n[e(3620)][e(2344)];n[e(3620)][e(2344)]=!!s.multiple;var f=s[e(2113)];f!=null?xo(n,!!s.multiple,f,!1):h!==!!s[e(3198)]&&(s[e(320)]!=null?xo(n,!!s[e(3198)],s[e(320)],!0):xo(n,!!s[e(3198)],s[e(3198)]?[]:"",!1))}n[jc]=s}catch(Z){de(i,i[e(3922)],Z)}}break;case 6:if(wg(x,i),xi(i),g&4){if(i[e(1133)]===null)throw Error(N0(162));n=i.stateNode,s=i[e(2990)];try{n[e(1328)]=s}catch(Z){de(i,i[e(3922)],Z)}}break;case 3:if(wg(x,i),xi(i),g&4&&t!==null&&t[e(485)][e(2290)])try{Qc(x.containerInfo)}catch(Z){de(i,i.return,Z)}break;case 4:wg(x,i),xi(i);break;case 13:wg(x,i),xi(i),n=i[e(1367)],n[e(2436)]&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n[e(641)]!==null&&n[e(641)][e(485)]!==null||(xf=fe())),g&4&&VG(i);break;case 22:if(A=t!==null&&t[e(485)]!==null,i[e(251)]&1?(st=(r=st)||A,wg(x,i),st=r):wg(x,i),xi(i),g&8192){if(r=i[e(485)]!==null,(i[e(1133)].isHidden=r)&&!A&&i[e(251)]&1)for(O0=i,A=i.child;A!==null;){for(d=O0=A;O0!==null;){switch(h=O0,f=h[e(1367)],h.tag){case 0:case 11:case 14:case 15:Hc(4,h,h[e(3922)]);break;case 1:Us(h,h[e(3922)]);var B=h[e(1133)];if(e(1126)===typeof B[e(3457)]){g=h,t=h[e(3922)];try{x=g,B[e(3105)]=x[e(2990)],B[e(704)]=x[e(485)],B[e(3457)]()}catch(Z){de(g,t,Z)}}break;case 5:Us(h,h[e(3922)]);break;case 22:if(h[e(485)]!==null){XG(d);continue}}f!==null?(f[e(3922)]=h,O0=f):XG(d)}A=A.sibling}x:for(A=null,d=i;;){if(d[e(3795)]===5){if(A===null){A=d;try{n=d.stateNode,r?(s=n[e(1720)],e(1126)===typeof s[e(595)]?s[e(595)]("display",e(2608),e(2577)):s[e(3181)]=e(2608)):(c=d[e(1133)],C=d[e(2990)].style,o=C!=null&&C.hasOwnProperty(e(3181))?C[e(3181)]:null,c[e(1720)][e(3181)]=vZ(e(3181),o))}catch(Z){de(i,i.return,Z)}}}else if(d[e(3795)]===6){if(A===null)try{d[e(1133)][e(1328)]=r?"":d[e(2990)]}catch(Z){de(i,i[e(3922)],Z)}}else if((d[e(3795)]!==22&&d[e(3795)]!==23||d[e(485)]===null||d===i)&&d[e(1367)]!==null){d[e(1367)][e(3922)]=d,d=d.child;continue}if(d===i)break x;for(;d[e(1263)]===null;){if(d[e(3922)]===null||d[e(3922)]===i)break x;A===d&&(A=null),d=d.return}A===d&&(A=null),d[e(1263)][e(3922)]=d[e(3922)],d=d.sibling}}break;case 19:wg(x,i),xi(i),g&4&&VG(i);break;case 21:break;default:wg(x,i),xi(i)}}function xi(i){const x=I;var e=i[x(2436)];if(e&2){try{x:{for(var t=i[x(3922)];t!==null;){if($5(t)){var g=t;break x}t=t[x(3922)]}throw Error(N0(160))}switch(g[x(3795)]){case 5:var n=g[x(1133)];g[x(2436)]&32&&(Ec(n,""),g[x(2436)]&=-33);var s=RG(i);mb(i,s,n);break;case 3:case 4:var o=g[x(1133)].containerInfo,c=RG(i);fb(i,c,o);break;default:throw Error(N0(161))}}catch(C){de(i,i[x(3922)],C)}i[x(2436)]&=-3}e&4096&&(i[x(2436)]&=-4097)}function hV(i,x,e){O0=i,ey(i)}function ey(i,x,e){const t=I;for(var g=(i[t(251)]&1)!==0;O0!==null;){var n=O0,s=n[t(1367)];if(n[t(3795)]===22&&g){var o=n[t(485)]!==null||ea;if(!o){var c=n[t(641)],C=c!==null&&c[t(485)]!==null||st;c=ea;var r=st;if(ea=o,(st=C)&&!r)for(O0=n;O0!==null;)o=O0,C=o[t(1367)],o[t(3795)]===22&&o[t(485)]!==null?YG(n):C!==null?(C[t(3922)]=o,O0=C):YG(n);for(;s!==null;)O0=s,ey(s),s=s[t(1263)];O0=n,ea=c,st=r}SG(i)}else n[t(1983)]&8772&&s!==null?(s[t(3922)]=n,O0=s):SG(i)}}function SG(i){const x=I;for(;O0!==null;){var e=O0;if(e[x(2436)]&8772){var t=e[x(641)];try{if(e.flags&8772)switch(e[x(3795)]){case 0:case 11:case 15:st||u2(5,e);break;case 1:var g=e[x(1133)];if(e[x(2436)]&4&&!st)if(t===null)g[x(3380)]();else{var n=e.elementType===e[x(3505)]?t[x(2990)]:Kg(e[x(3505)],t.memoizedProps);g.componentDidUpdate(n,t[x(485)],g[x(2362)])}var s=e.updateQueue;s!==null&&AG(e,s,g);break;case 3:var o=e[x(2845)];if(o!==null){if(t=null,e[x(1367)]!==null)switch(e[x(1367)][x(3795)]){case 5:t=e[x(1367)].stateNode;break;case 1:t=e[x(1367)][x(1133)]}AG(e,o,t)}break;case 5:var c=e.stateNode;if(t===null&&e.flags&4){t=c;var C=e[x(2990)];switch(e[x(3505)]){case x(2828):case"input":case x(1860):case x(3347):C[x(2314)]&&t[x(2950)]();break;case x(1380):C.src&&(t[x(2595)]=C[x(2595)])}}break;case 6:break;case 4:break;case 12:break;case 13:if(e[x(485)]===null){var r=e[x(641)];if(r!==null){var A=r.memoizedState;if(A!==null){var d=A[x(772)];d!==null&&Qc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N0(163))}st||e[x(2436)]&512&&hb(e)}catch(h){de(e,e[x(3922)],h)}}if(e===i){O0=null;break}if(t=e[x(1263)],t!==null){t[x(3922)]=e[x(3922)],O0=t;break}O0=e.return}}function XG(i){const x=I;for(;O0!==null;){var e=O0;if(e===i){O0=null;break}var t=e.sibling;if(t!==null){t.return=e[x(3922)],O0=t;break}O0=e[x(3922)]}}function YG(i){const x=I;for(;O0!==null;){var e=O0;try{switch(e[x(3795)]){case 0:case 11:case 15:var t=e.return;try{u2(4,e)}catch(C){de(e,t,C)}break;case 1:var g=e[x(1133)];if(typeof g[x(3380)]=="function"){var n=e.return;try{g.componentDidMount()}catch(C){de(e,n,C)}}var s=e[x(3922)];try{hb(e)}catch(C){de(e,s,C)}break;case 5:var o=e[x(3922)];try{hb(e)}catch(C){de(e,o,C)}}}catch(C){de(e,e.return,C)}if(e===i){O0=null;break}var c=e[x(1263)];if(c!==null){c[x(3922)]=e[x(3922)],O0=c;break}O0=e[x(3922)]}}var fV=Math[I(2163)],Qr=_i.ReactCurrentDispatcher,$h=_i.ReactCurrentOwner,Bg=_i[I(3118)],Mx=0,Le=null,Be=null,Qe=0,jt=0,_s=Fn(0),we=0,nC=null,MI=0,b2=0,jh=0,Nc=null,Nt=null,xf=0,uo=1/0,wi=null,Pr=!1,Gb=null,Rn=null,ta=!1,Bn=null,Or=0,Fc=0,pb=null,ur=-1,br=0;function Bt(){return Mx&6?fe():ur!==-1?ur:ur=fe()}function Vn(i){const x=I;return i[x(251)]&1?Mx&2&&Qe!==0?Qe&-Qe:tV[x(1691)]!==null?(br===0&&(br=MZ()),br):(i=Qx,i!==0||(i=window[x(1751)],i=i===void 0?16:_Z(i[x(3505)])),i):1}function Lg(i,x,e,t){const g=I;if(50<Fc)throw Fc=0,pb=null,Error(N0(185));RC(i,e,t),(!(Mx&2)||i!==Le)&&(i===Le&&(!(Mx&2)&&(b2|=e),we===4&&mn(i,Qe)),kt(i,t),e===1&&Mx===0&&!(x[g(251)]&1)&&(uo=fe()+500,r2&&zn()))}function kt(i,x){const e=I;var t=i[e(652)];tR(i,x);var g=Yr(i,i===Le?Qe:0);if(g===0)t!==null&&Tm(t),i[e(652)]=null,i[e(2858)]=0;else if(x=g&-g,i[e(2858)]!==x){if(t!=null&&Tm(t),x===1)i[e(3795)]===0?eV(KG.bind(null,i)):l5(KG[e(1600)](null,i)),qR(function(){!(Mx&6)&&zn()}),t=null;else{switch(LZ(g)){case 1:t=vh;break;case 4:t=FZ;break;case 16:t=Xr;break;case 536870912:t=zZ;break;default:t=Xr}t=cy(t,ty[e(1600)](null,i))}i[e(2858)]=x,i[e(652)]=t}}function ty(i,x){const e=I;if(ur=-1,br=0,Mx&6)throw Error(N0(327));var t=i[e(652)];if(no()&&i[e(652)]!==t)return null;var g=Yr(i,i===Le?Qe:0);if(g===0)return null;if(g&30||g&i[e(2330)]||x)x=qr(i,g);else{x=g;var n=Mx;Mx|=2;var s=iy();(Le!==i||Qe!==x)&&(wi=null,uo=fe()+500,RI(i,x));do try{pV();break}catch(c){gy(i,c)}while(!0);Mh(),Qr[e(1895)]=s,Mx=n,Be!==null?x=0:(Le=null,Qe=0,x=we)}if(x!==0){if(x===2&&(n=Pu(i),n!==0&&(g=n,x=Bb(i,n))),x===1)throw t=nC,RI(i,0),mn(i,g),kt(i,fe()),t;if(x===6)mn(i,g);else{if(n=i.current[e(641)],!(g&30)&&!mV(n)&&(x=qr(i,g),x===2&&(s=Pu(i),s!==0&&(g=s,x=Bb(i,s))),x===1))throw t=nC,RI(i,0),mn(i,g),kt(i,fe()),t;switch(i.finishedWork=n,i[e(3046)]=g,x){case 0:case 1:throw Error(N0(345));case 2:rI(i,Nt,wi);break;case 3:if(mn(i,g),(g&130023424)===g&&(x=xf+500-fe(),10<x)){if(Yr(i,0)!==0)break;if(n=i[e(824)],(n&g)!==g){Bt(),i.pingedLanes|=i[e(824)]&n;break}i.timeoutHandle=gb(rI[e(1600)](null,i,Nt,wi),x);break}rI(i,Nt,wi);break;case 4:if(mn(i,g),(g&4194240)===g)break;for(x=i[e(504)],n=-1;0<g;){var o=31-Mg(g);s=1<<o,o=x[o],o>n&&(n=o),g&=~s}if(g=n,g=fe()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*fV(g/1960))-g,10<g){i[e(1331)]=gb(rI[e(1600)](null,i,Nt,wi),g);break}rI(i,Nt,wi);break;case 5:rI(i,Nt,wi);break;default:throw Error(N0(329))}}}return kt(i,fe()),i[e(652)]===t?ty[e(1600)](null,i):null}function Bb(i,x){const e=I;var t=Nc;return i[e(1895)][e(485)][e(2290)]&&(RI(i,x)[e(2436)]|=256),i=qr(i,x),i!==2&&(x=Nt,Nt=t,x!==null&&Zb(x)),i}function Zb(i){Nt===null?Nt=i:Nt[I(3330)].apply(Nt,i)}function mV(i){const x=I;for(var e=i;;){if(e.flags&16384){var t=e[x(2845)];if(t!==null&&(t=t.stores,t!==null))for(var g=0;g<t[x(2989)];g++){var n=t[g],s=n[x(2526)];n=n.value;try{if(!Tg(s(),n))return!1}catch{return!1}}}if(t=e[x(1367)],e.subtreeFlags&16384&&t!==null)t[x(3922)]=e,e=t;else{if(e===i)break;for(;e[x(1263)]===null;){if(e[x(3922)]===null||e[x(3922)]===i)return!0;e=e[x(3922)]}e.sibling[x(3922)]=e[x(3922)],e=e.sibling}}return!0}function mn(i,x){const e=I;for(x&=~jh,x&=~b2,i[e(824)]|=x,i[e(3632)]&=~x,i=i.expirationTimes;0<x;){var t=31-Mg(x),g=1<<t;i[t]=-1,x&=~g}}function KG(i){const x=I;if(Mx&6)throw Error(N0(327));no();var e=Yr(i,0);if(!(e&1))return kt(i,fe()),null;var t=qr(i,e);if(i[x(3795)]!==0&&t===2){var g=Pu(i);g!==0&&(e=g,t=Bb(i,g))}if(t===1)throw t=nC,RI(i,0),mn(i,e),kt(i,fe()),t;if(t===6)throw Error(N0(345));return i[x(1852)]=i[x(1895)][x(641)],i.finishedLanes=e,rI(i,Nt,wi),kt(i,fe()),null}function ef(i,x){var e=Mx;Mx|=1;try{return i(x)}finally{Mx=e,Mx===0&&(uo=fe()+500,r2&&zn())}}function LI(i){const x=I;Bn!==null&&Bn[x(3795)]===0&&!(Mx&6)&&no();var e=Mx;Mx|=1;var t=Bg[x(1691)],g=Qx;try{if(Bg[x(1691)]=null,Qx=1,i)return i()}finally{Qx=g,Bg.transition=t,Mx=e,!(Mx&6)&&zn()}}function tf(){jt=_s[I(1895)],te(_s)}function RI(i,x){const e=I;i.finishedWork=null,i[e(3046)]=0;var t=i.timeoutHandle;if(t!==-1&&(i[e(1331)]=-1,OR(t)),Be!==null)for(t=Be[e(3922)];t!==null;){var g=t;switch(Nh(g),g[e(3795)]){case 1:g=g[e(3505)][e(3503)],g!=null&&zr();break;case 3:ro(),te(Mt),te(Ct),Uh();break;case 5:Eh(g);break;case 4:ro();break;case 13:te(oe);break;case 19:te(oe);break;case 10:Lh(g.type._context);break;case 22:case 23:tf()}t=t[e(3922)]}if(Le=i,Be=i=Sn(i[e(1895)],null),Qe=jt=x,we=0,nC=null,jh=b2=MI=0,Nt=Nc=null,BI!==null){for(x=0;x<BI[e(2989)];x++)if(t=BI[x],g=t[e(439)],g!==null){t[e(439)]=null;var n=g[e(890)],s=t[e(1891)];if(s!==null){var o=s[e(890)];s[e(890)]=n,g[e(890)]=o}t[e(1891)]=g}BI=null}return i}function gy(i,x){const e=I;do{var t=Be;try{if(Mh(),rr[e(1895)]=Dr,_r){for(var g=Ce[e(485)];g!==null;){var n=g[e(888)];n!==null&&(n[e(1891)]=null),g=g.next}_r=!1}if(zI=0,Fe=We=Ce=null,Kc=!1,tC=0,$h[e(1895)]=null,t===null||t.return===null){we=1,nC=x,Be=null;break}x:{var s=i,o=t[e(3922)],c=t,C=x;if(x=Qe,c[e(2436)]|=32768,C!==null&&e(1011)===typeof C&&e(1126)===typeof C[e(2334)]){var r=C,A=c,d=A.tag;if(!(A[e(251)]&1)&&(d===0||d===11||d===15)){var h=A[e(641)];h?(A[e(2845)]=h.updateQueue,A[e(485)]=h[e(485)],A.lanes=h[e(2840)]):(A[e(2845)]=null,A[e(485)]=null)}var f=GG(o);if(f!==null){f[e(2436)]&=-257,pG(f,o,c,s,x),f[e(251)]&1&&mG(s,r,x),x=f,C=r;var B=x[e(2845)];if(B===null){var Z=new Set;Z.add(C),x.updateQueue=Z}else B.add(C);break x}else{if(!(x&1)){mG(s,r,x),gf();break x}C=Error(N0(426))}}else if(Ie&&c[e(251)]&1){var G=GG(o);if(G!==null){!(G[e(2436)]&65536)&&(G[e(2436)]|=256),pG(G,o,c,s,x),Fh(Ao(C,c));break x}}s=C=Ao(C,c),we!==4&&(we=2),Nc===null?Nc=[s]:Nc.push(s),s=o;do{switch(s.tag){case 3:s[e(2436)]|=65536,x&=-x,s.lanes|=x;var m=L5(s,C,x);dG(s,m);break x;case 1:c=C;var v=s[e(3505)],p=s[e(1133)];if(!(s.flags&128)&&(e(1126)===typeof v[e(1609)]||p!==null&&e(1126)===typeof p[e(384)]&&(Rn===null||!Rn.has(p)))){s.flags|=65536,x&=-x,s[e(2840)]|=x;var w=k5(s,c,x);dG(s,w);break x}}s=s[e(3922)]}while(s!==null)}Iy(t)}catch(V){x=V,Be===t&&t!==null&&(Be=t=t.return);continue}break}while(!0)}function iy(){var x=Qr[I(1895)];return Qr.current=Dr,x===null?Dr:x}function gf(){(we===0||we===3||we===2)&&(we=4),Le===null||!(MI&268435455)&&!(b2&268435455)||mn(Le,Qe)}function qr(i,x){const e=I;var t=Mx;Mx|=2;var g=iy();(Le!==i||Qe!==x)&&(wi=null,RI(i,x));do try{GV();break}catch(n){gy(i,n)}while(!0);if(Mh(),Mx=t,Qr[e(1895)]=g,Be!==null)throw Error(N0(261));return Le=null,Qe=0,we}function GV(){for(;Be!==null;)ny(Be)}function pV(){for(;Be!==null&&!Dw();)ny(Be)}function ny(i){const x=I;var e=oy(i[x(641)],i,jt);i[x(2990)]=i[x(2343)],e===null?Iy(i):Be=e,$h[x(1895)]=null}function Iy(i){const x=I;var e=i;do{var t=e[x(641)];if(i=e[x(3922)],e[x(2436)]&32768){if(t=AV(t,e),t!==null){t[x(2436)]&=32767,Be=t;return}if(i!==null)i[x(2436)]|=32768,i.subtreeFlags=0,i[x(2716)]=null;else{we=6,Be=null;return}}else if(t=dV(t,e,jt),t!==null){Be=t;return}if(e=e.sibling,e!==null){Be=e;return}Be=e=i}while(e!==null);we===0&&(we=5)}function rI(i,x,e){const t=I;var g=Qx,n=Bg[t(1691)];try{Bg[t(1691)]=null,Qx=1,BV(i,x,e,g)}finally{Bg.transition=n,Qx=g}return null}function BV(i,x,e,t){const g=I;do no();while(Bn!==null);if(Mx&6)throw Error(N0(327));e=i.finishedWork;var n=i[g(3046)];if(e===null)return null;if(i[g(1852)]=null,i[g(3046)]=0,e===i[g(1895)])throw Error(N0(177));i[g(652)]=null,i.callbackPriority=0;var s=e.lanes|e[g(3262)];if(gR(i,s),i===Le&&(Be=Le=null,Qe=0),!(e.subtreeFlags&2064)&&!(e.flags&2064)||ta||(ta=!0,cy(Xr,function(){return no(),null})),s=(e[g(2436)]&15990)!==0,e[g(1983)]&15990||s){s=Bg[g(1691)],Bg[g(1691)]=null;var o=Qx;Qx=1;var c=Mx;Mx|=4,$h[g(1895)]=null,bV(i,e),xy(e,i),JR(eb),Kr=!!xb,eb=xb=null,i[g(1895)]=e,hV(e),Qw(),Mx=c,Qx=o,Bg[g(1691)]=s}else i[g(1895)]=e;if(ta&&(ta=!1,Bn=i,Or=n),s=i[g(294)],s===0&&(Rn=null),qw(e[g(1133)]),kt(i,fe()),x!==null)for(t=i[g(973)],e=0;e<x.length;e++)n=x[e],t(n[g(2113)],{componentStack:n[g(1574)],digest:n[g(634)]});if(Pr)throw Pr=!1,i=Gb,Gb=null,i;return Or&1&&i[g(3795)]!==0&&no(),s=i.pendingLanes,s&1?i===pb?Fc++:(Fc=0,pb=i):Fc=0,zn(),null}function no(){const i=I;if(Bn!==null){var x=LZ(Or),e=Bg.transition,t=Qx;try{if(Bg[i(1691)]=null,Qx=16>x?16:x,Bn===null)var g=!1;else{if(x=Bn,Bn=null,Or=0,Mx&6)throw Error(N0(331));var n=Mx;for(Mx|=4,O0=x[i(1895)];O0!==null;){var s=O0,o=s[i(1367)];if(O0[i(2436)]&16){var c=s[i(2716)];if(c!==null){for(var C=0;C<c.length;C++){var r=c[C];for(O0=r;O0!==null;){var A=O0;switch(A.tag){case 0:case 11:case 15:Hc(8,A,s)}var d=A.child;if(d!==null)d[i(3922)]=A,O0=d;else for(;O0!==null;){A=O0;var h=A[i(1263)],f=A[i(3922)];if(q5(A),A===r){O0=null;break}if(h!==null){h[i(3922)]=f,O0=h;break}O0=f}}}var B=s.alternate;if(B!==null){var Z=B[i(1367)];if(Z!==null){B[i(1367)]=null;do{var G=Z[i(1263)];Z[i(1263)]=null,Z=G}while(Z!==null)}}O0=s}}if(s[i(1983)]&2064&&o!==null)o[i(3922)]=s,O0=o;else x:for(;O0!==null;){if(s=O0,s[i(2436)]&2048)switch(s[i(3795)]){case 0:case 11:case 15:Hc(9,s,s[i(3922)])}var m=s[i(1263)];if(m!==null){m[i(3922)]=s[i(3922)],O0=m;break x}O0=s[i(3922)]}}var v=x.current;for(O0=v;O0!==null;){o=O0;var p=o[i(1367)];if(o[i(1983)]&2064&&p!==null)p[i(3922)]=o,O0=p;else x:for(o=v;O0!==null;){if(c=O0,c[i(2436)]&2048)try{switch(c[i(3795)]){case 0:case 11:case 15:u2(9,c)}}catch(V){de(c,c[i(3922)],V)}if(c===o){O0=null;break x}var w=c[i(1263)];if(w!==null){w.return=c[i(3922)],O0=w;break x}O0=c[i(3922)]}}if(Mx=n,zn(),Ci&&i(1126)===typeof Ci[i(2702)])try{Ci[i(2702)](o2,x)}catch{}g=!0}return g}finally{Qx=t,Bg[i(1691)]=e}}return!1}function HG(i,x,e){x=Ao(e,x),x=L5(i,x,1),i=wn(i,x,1),x=Bt(),i!==null&&(RC(i,1,x),kt(i,x))}function de(i,x,e){const t=I;if(i.tag===3)HG(i,i,e);else for(;x!==null;){if(x[t(3795)]===3){HG(x,i,e);break}else if(x[t(3795)]===1){var g=x[t(1133)];if(typeof x[t(3505)][t(1609)]=="function"||t(1126)===typeof g[t(384)]&&(Rn===null||!Rn[t(2489)](g))){i=Ao(e,i),i=k5(x,i,1),x=wn(x,i,1),i=Bt(),x!==null&&(RC(x,1,i),kt(x,i));break}}x=x[t(3922)]}}function ZV(i,x,e){const t=I;var g=i[t(901)];g!==null&&g[t(1432)](x),x=Bt(),i[t(3632)]|=i[t(824)]&e,Le===i&&(Qe&e)===e&&(we===4||we===3&&(Qe&130023424)===Qe&&500>fe()-xf?RI(i,0):jh|=e),kt(i,x)}function sy(i,x){x===0&&(i[I(251)]&1?(x=_l,_l<<=1,!(_l&130023424)&&(_l=4194304)):x=1);var t=Bt();i=zi(i,x),i!==null&&(RC(i,x,t),kt(i,t))}function yV(i){const x=I;var e=i.memoizedState,t=0;e!==null&&(t=e[x(169)]),sy(i,t)}function vV(i,x){const e=I;var t=0;switch(i[e(3795)]){case 13:var g=i[e(1133)],n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:g=i.stateNode;break;default:throw Error(N0(314))}g!==null&&g[e(1432)](x),sy(i,t)}var oy;oy=function(i,x,e){const t=I;if(i!==null)if(i[t(2990)]!==x[t(2343)]||Mt.current)Ft=!0;else{if(!(i[t(2840)]&e)&&!(x[t(2436)]&128))return Ft=!1,rV(i,x,e);Ft=!!(i[t(2436)]&131072)}else Ft=!1,Ie&&x[t(2436)]&1048576&&a5(x,kr,x[t(587)]);switch(x[t(2840)]=0,x[t(3795)]){case 2:var g=x.type;Ar(i,x),i=x[t(2343)];var n=Co(x,Ct.current);io(x,e),n=Dh(null,x,g,i,n,e);var s=Qh();return x.flags|=1,typeof n=="object"&&n!==null&&t(1126)===typeof n[t(948)]&&n[t(1596)]===void 0?(x.tag=1,x[t(485)]=null,x[t(2845)]=null,Lt(g)?(s=!0,Mr(x)):s=!1,x.memoizedState=n.state!==null&&n[t(704)]!==void 0?n[t(704)]:null,Th(x),n[t(938)]=A2,x[t(1133)]=n,n[t(1525)]=x,Cb(x,g,i,e),x=rb(null,x,g,!0,s,e)):(x[t(3795)]=0,Ie&&s&&Hh(x),ft(null,x,n,e),x=x[t(1367)]),x;case 16:g=x.elementType;x:{switch(Ar(i,x),i=x[t(2343)],n=g[t(2660)],g=n(g[t(2036)]),x[t(3505)]=g,n=x[t(3795)]=wV(g),i=Kg(g,i),n){case 0:x=ab(null,x,g,i,e);break x;case 1:x=yG(null,x,g,i,e);break x;case 11:x=BG(null,x,g,i,e);break x;case 14:x=ZG(null,x,g,Kg(g[t(3505)],i),e);break x}throw Error(N0(306,g,""))}return x;case 0:return g=x[t(3505)],n=x[t(2343)],n=x.elementType===g?n:Kg(g,n),ab(i,x,g,n,e);case 1:return g=x[t(3505)],n=x[t(2343)],n=x[t(1992)]===g?n:Kg(g,n),yG(i,x,g,n,e);case 3:x:{if(U5(x),i===null)throw Error(N0(387));g=x[t(2343)],s=x[t(485)],n=s.element,h5(i,x),Er(x,g,null,e);var o=x[t(485)];if(g=o[t(545)],s[t(2290)])if(s={element:g,isDehydrated:!1,cache:o[t(672)],pendingSuspenseBoundaries:o[t(2564)],transitions:o[t(329)]},x[t(2845)][t(490)]=s,x[t(485)]=s,x.flags&256){n=Ao(Error(N0(423)),x),x=vG(i,x,g,e,n);break x}else if(g!==n){n=Ao(Error(N0(424)),x),x=vG(i,x,g,e,n);break x}else for(eg=Wn(x[t(1133)][t(1951)][t(1290)]),tg=x,Ie=!0,Fg=null,e=u5(x,null,g,e),x[t(1367)]=e;e;)e[t(2436)]=e.flags&-3|4096,e=e[t(1263)];else{if(lo(),g===n){x=Ti(i,x,e);break x}ft(i,x,g,e)}x=x[t(1367)]}return x;case 5:return f5(x),i===null&&sb(x),g=x[t(3505)],n=x[t(2343)],s=i!==null?i.memoizedProps:null,o=n[t(1352)],tb(g,n)?o=null:s!==null&&tb(g,s)&&(x[t(2436)]|=32),E5(i,x),ft(i,x,o,e),x[t(1367)];case 6:return i===null&&sb(x),null;case 13:return _5(i,x,e);case 4:return Jh(x,x[t(1133)][t(1951)]),g=x[t(2343)],i===null?x[t(1367)]=ao(x,null,g,e):ft(i,x,g,e),x[t(1367)];case 11:return g=x.type,n=x[t(2343)],n=x[t(1992)]===g?n:Kg(g,n),BG(i,x,g,n,e);case 7:return ft(i,x,x[t(2343)],e),x[t(1367)];case 8:return ft(i,x,x.pendingProps.children,e),x[t(1367)];case 12:return ft(i,x,x.pendingProps[t(1352)],e),x.child;case 10:x:{if(g=x[t(3505)]._context,n=x[t(2343)],s=x[t(2990)],o=n[t(2113)],$x(Tr,g[t(891)]),g[t(891)]=o,s!==null)if(Tg(s[t(2113)],o)){if(s[t(1352)]===n.children&&!Mt[t(1895)]){x=Ti(i,x,e);break x}}else for(s=x[t(1367)],s!==null&&(s[t(3922)]=x);s!==null;){var c=s[t(1461)];if(c!==null){o=s[t(1367)];for(var C=c[t(1401)];C!==null;){if(C[t(3246)]===g){if(s[t(3795)]===1){C=Mi(-1,e&-e),C[t(3795)]=2;var r=s[t(2845)];if(r!==null){r=r[t(2940)];var A=r.pending;A===null?C[t(890)]=C:(C[t(890)]=A[t(890)],A[t(890)]=C),r[t(1891)]=C}}s[t(2840)]|=e,C=s[t(641)],C!==null&&(C[t(2840)]|=e),ob(s[t(3922)],e,x),c[t(2840)]|=e;break}C=C[t(890)]}}else if(s[t(3795)]===10)o=s.type===x.type?null:s.child;else if(s[t(3795)]===18){if(o=s.return,o===null)throw Error(N0(341));o[t(2840)]|=e,c=o[t(641)],c!==null&&(c[t(2840)]|=e),ob(o,e,x),o=s[t(1263)]}else o=s[t(1367)];if(o!==null)o[t(3922)]=s;else for(o=s;o!==null;){if(o===x){o=null;break}if(s=o[t(1263)],s!==null){s[t(3922)]=o[t(3922)],o=s;break}o=o[t(3922)]}s=o}ft(i,x,n[t(1352)],e),x=x[t(1367)]}return x;case 9:return n=x[t(3505)],g=x[t(2343)][t(1352)],io(x,e),n=Zg(n),g=g(n),x.flags|=1,ft(i,x,g,e),x[t(1367)];case 14:return g=x[t(3505)],n=Kg(g,x.pendingProps),n=Kg(g[t(3505)],n),ZG(i,x,g,n,e);case 15:return T5(i,x,x[t(3505)],x[t(2343)],e);case 17:return g=x[t(3505)],n=x.pendingProps,n=x.elementType===g?n:Kg(g,n),Ar(i,x),x[t(3795)]=1,Lt(g)?(i=!0,Mr(x)):i=!1,io(x,e),M5(x,g,n),Cb(x,g,n,e),rb(null,x,g,!0,i,e);case 19:return D5(i,x,e);case 22:return J5(i,x,e)}throw Error(N0(156,x[t(3795)]))};function cy(i,x){return NZ(i,x)}function WV(i,x,e,t){const g=I;this[g(3795)]=i,this[g(581)]=e,this.sibling=this[g(1367)]=this[g(3922)]=this[g(1133)]=this[g(3505)]=this[g(1992)]=null,this[g(587)]=0,this[g(3786)]=null,this[g(2343)]=x,this[g(1461)]=this.memoizedState=this[g(2845)]=this[g(2990)]=null,this.mode=t,this[g(1983)]=this[g(2436)]=0,this.deletions=null,this[g(3262)]=this[g(2840)]=0,this[g(641)]=null}function mg(i,x,e,t){return new WV(i,x,e,t)}function nf(i){return i=i[I(1566)],!(!i||!i.isReactComponent)}function wV(i){const x=I;if(x(1126)===typeof i)return nf(i)?1:0;if(i!=null){if(i=i[x(1596)],i===Bh)return 11;if(i===Zh)return 14}return 2}function Sn(i,x){const e=I;var t=i[e(641)];return t===null?(t=mg(i[e(3795)],x,i[e(581)],i[e(251)]),t.elementType=i.elementType,t[e(3505)]=i[e(3505)],t.stateNode=i[e(1133)],t[e(641)]=i,i.alternate=t):(t[e(2343)]=x,t[e(3505)]=i[e(3505)],t[e(2436)]=0,t[e(1983)]=0,t[e(2716)]=null),t[e(2436)]=i[e(2436)]&14680064,t.childLanes=i[e(3262)],t[e(2840)]=i[e(2840)],t[e(1367)]=i[e(1367)],t[e(2990)]=i.memoizedProps,t[e(485)]=i[e(485)],t[e(2845)]=i[e(2845)],x=i[e(1461)],t[e(1461)]=x===null?null:{lanes:x[e(2840)],firstContext:x.firstContext},t[e(1263)]=i[e(1263)],t[e(587)]=i.index,t[e(3786)]=i[e(3786)],t}function hr(i,x,e,t,g,n){const s=I;var o=2;if(t=i,s(1126)===typeof i)nf(i)&&(o=1);else if(s(3674)===typeof i)o=5;else x:switch(i){case Ns:return VI(e[s(1352)],g,n,x);case ph:o=8,g|=8;break;case Ku:return i=mg(12,e,x,g|2),i[s(1992)]=Ku,i.lanes=n,i;case Hu:return i=mg(13,e,x,g),i.elementType=Hu,i[s(2840)]=n,i;case Nu:return i=mg(19,e,x,g),i.elementType=Nu,i[s(2840)]=n,i;case fZ:return h2(e,g,n,x);default:if(s(1011)===typeof i&&i!==null)switch(i[s(1596)]){case bZ:o=10;break x;case hZ:o=9;break x;case Bh:o=11;break x;case Zh:o=14;break x;case un:o=16,t=null;break x}throw Error(N0(130,i==null?i:typeof i,""))}return x=mg(o,e,x,g),x.elementType=i,x.type=t,x.lanes=n,x}function VI(i,x,e,t){const g=I;return i=mg(7,i,t,x),i[g(2840)]=e,i}function h2(i,x,e,t){const g=I;return i=mg(22,i,t,x),i[g(1992)]=fZ,i.lanes=e,i[g(1133)]={isHidden:!1},i}function wA(i,x,e){const t=I;return i=mg(6,i,null,x),i[t(2840)]=e,i}function RA(i,x,e){const t=I;return x=mg(4,i[t(1352)]!==null?i[t(1352)]:[],i[t(581)],x),x[t(2840)]=e,x[t(1133)]={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},x}function RV(i,x,e,t,g){const n=I;this[n(3795)]=x,this[n(1951)]=i,this[n(1852)]=this.pingCache=this[n(1895)]=this[n(1780)]=null,this[n(1331)]=-1,this[n(652)]=this[n(3032)]=this.context=null,this[n(2858)]=0,this.eventTimes=cA(0),this[n(3593)]=cA(-1),this[n(3580)]=this[n(3046)]=this[n(583)]=this.expiredLanes=this[n(3632)]=this[n(824)]=this[n(294)]=0,this[n(154)]=cA(0),this[n(1260)]=t,this[n(973)]=g,this[n(1526)]=null}function If(i,x,e,t,g,n,s,o,c){const C=I;return i=new RV(i,x,e,o,c),x===1?(x=1,n===!0&&(x|=8)):x=0,n=mg(3,null,null,x),i[C(1895)]=n,n.stateNode=i,n.memoizedState={element:t,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},Th(n),i}function VV(i,x,e){var t=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hs,key:t==null?null:""+t,children:i,containerInfo:x,implementation:e}}function Cy(i){const x=I;if(!i)return Kn;i=i[x(1525)];x:{if(EI(i)!==i||i[x(3795)]!==1)throw Error(N0(170));var e=i;do{switch(e[x(3795)]){case 3:e=e[x(1133)][x(3246)];break x;case 1:if(Lt(e.type)){e=e[x(1133)].__reactInternalMemoizedMergedChildContext;break x}}e=e[x(3922)]}while(e!==null);throw Error(N0(171))}if(i.tag===1){var t=i.type;if(Lt(t))return C5(i,t,e)}return e}function ly(i,x,e,t,g,n,s,o,c){const C=I;return i=If(e,t,!0,i,g,n,s,o,c),i[C(3246)]=Cy(null),e=i[C(1895)],t=Bt(),g=Vn(e),n=Mi(t,g),n[C(934)]=x??null,wn(e,n,g),i[C(1895)][C(2840)]=g,RC(i,g,t),kt(i,t),i}function $r(i,x,e,t){const g=I;var n=x.current,s=Bt(),o=Vn(n);return e=Cy(e),x.context===null?x[g(3246)]=e:x[g(3032)]=e,x=Mi(s,o),x[g(2351)]={element:i},t=t===void 0?null:t,t!==null&&(x.callback=t),i=wn(n,x,o),i!==null&&(Lg(i,n,o,s),ar(i,n,o)),o}function jr(i){const x=I;if(i=i[x(1895)],!i[x(1367)])return null;switch(i[x(1367)][x(3795)]){case 5:return i[x(1367)][x(1133)];default:return i[x(1367)][x(1133)]}}function NG(i,x){const e=I;if(i=i[e(485)],i!==null&&i[e(772)]!==null){var t=i[e(169)];i[e(169)]=t!==0&&t<x?t:x}}function VA(i,x){const e=I;NG(i,x),(i=i[e(641)])&&NG(i,x)}function SV(){return null}var FG=I(1126)===typeof reportError?reportError:function(i){console[I(2963)](i)};function yb(i){const x=I;this[x(3434)]=i}x2[I(1566)][I(948)]=yb[I(1566)][I(948)]=function(i){var x=this._internalRoot;if(x===null)throw Error(N0(409));$r(i,x,null,null)},x2[I(1566)].unmount=yb[I(1566)][I(1802)]=function(){const i=I;var x=this[i(3434)];if(x!==null){this[i(3434)]=null;var e=x[i(1951)];LI(function(){$r(null,x,null,null)}),e[Fi]=null}};function x2(i){const x=I;this[x(3434)]=i}x2[I(1566)][I(2492)]=function(i){const x=I;if(i){var e=JZ();i={blockedOn:null,target:i,priority:e};for(var t=0;t<fn[x(2989)]&&e!==0&&e<fn[t][x(668)];t++);fn[x(2960)](t,0,i),t===0&&UZ(i)}};function SA(i){const x=I;return!(!i||i.nodeType!==1&&i.nodeType!==9&&i[x(773)]!==11)}function ga(i){const x=I;return!(!i||i[x(773)]!==1&&i[x(773)]!==9&&i.nodeType!==11&&(i[x(773)]!==8||x(1185)!==i.nodeValue))}function zG(){}function XV(i,x,e,t,g){const n=I;if(g){if(typeof t=="function"){var s=t;t=function(){const r=i0;var A=jr(o);s[r(2627)](A)}}var o=ly(x,t,i,0,null,!1,!1,"",zG);return i._reactRootContainer=o,i[Fi]=o[n(1895)],qc(i[n(773)]===8?i.parentNode:i),LI(),o}for(;g=i[n(1554)];)i.removeChild(g);if(n(1126)===typeof t){var c=t;t=function(){const r=n;var A=jr(C);c[r(2627)](A)}}var C=If(i,0,!1,null,null,!1,!1,"",zG);return i[n(3833)]=C,i[Fi]=C[n(1895)],qc(i.nodeType===8?i[n(2310)]:i),LI(function(){$r(x,C,e,t)}),C}function ia(i,x,e,t,g){const n=I;var s=e[n(3833)];if(s){var o=s;if(n(1126)===typeof g){var c=g;g=function(){var C=jr(o);c.call(C)}}$r(x,o,i,g)}else o=XV(e,x,i,g,t);return jr(o)}kZ=function(i){const x=I;switch(i[x(3795)]){case 3:var e=i[x(1133)];if(e[x(1895)][x(485)][x(2290)]){var t=yc(e[x(294)]);t!==0&&(Wh(e,t|1),kt(e,fe()),!(Mx&6)&&(uo=fe()+500,zn()))}break;case 13:LI(function(){var g=zi(i,1);if(g!==null){var n=Bt();Lg(g,i,1,n)}}),VA(i,1)}},wh=function(i){if(i[I(3795)]===13){var e=zi(i,134217728);if(e!==null){var t=Bt();Lg(e,i,134217728,t)}VA(i,134217728)}},TZ=function(i){if(i[I(3795)]===13){var e=Vn(i),t=zi(i,e);if(t!==null){var g=Bt();Lg(t,i,e,g)}VA(i,e)}},JZ=function(){return Qx},EZ=function(i,x){var e=Qx;try{return Qx=i,x()}finally{Qx=e}},_u=function(i,x,e){const t=I;switch(x){case t(2217):if(Mu(i,e),x=e.name,t(1403)===e[t(3505)]&&x!=null){for(e=i;e[t(2310)];)e=e[t(2310)];for(e=e[t(3187)]("input[name="+JSON[t(3062)](""+x)+t(1210)),x=0;x<e[t(2989)];x++){var g=e[x];if(g!==i&&g[t(2165)]===i[t(2165)]){var n=a2(g);if(!n)throw Error(N0(90));GZ(g),Mu(g,n)}}}break;case t(3347):BZ(i,e);break;case t(1860):x=e.value,x!=null&&xo(i,!!e[t(3198)],x,!1)}},VZ=ef,SZ=LI;var YV={usingClientEntryPoint:!1,Events:[SC,Ls,a2,wZ,RZ,ef]},ic={findFiberByHostInstance:pI,bundleType:0,version:"18.3.1",rendererPackageName:I(845)},KV={bundleType:ic[I(2777)],version:ic[I(1450)],rendererPackageName:ic[I(1686)],rendererConfig:ic[I(3453)],overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_i.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){const x=I;return i=KZ(i),i===null?null:i[x(1133)]},findFiberByHostInstance:ic.findFiberByHostInstance||SV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:I(864)};if(I(1797)!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var na=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!na[I(1482)]&&na.supportsFiber)try{o2=na.inject(KV),Ci=na}catch{}}$t[I(1521)]=YV,$t[I(1130)]=function(i,x){var t=2<arguments[I(2989)]&&arguments[2]!==void 0?arguments[2]:null;if(!SA(x))throw Error(N0(200));return VV(i,x,null,t)},$t.createRoot=function(i,x){const e=I;if(!SA(i))throw Error(N0(299));var t=!1,g="",n=FG;return x!=null&&(x[e(2478)]===!0&&(t=!0),x[e(1260)]!==void 0&&(g=x.identifierPrefix),x.onRecoverableError!==void 0&&(n=x[e(973)])),x=If(i,1,!1,null,null,t,!1,g,n),i[Fi]=x[e(1895)],qc(i.nodeType===8?i[e(2310)]:i),new yb(x)},$t[I(876)]=function(i){const x=I;if(i==null)return null;if(i[x(773)]===1)return i;var e=i[x(1525)];if(e===void 0)throw x(1126)===typeof i.render?Error(N0(188)):(i=Object.keys(i)[x(1812)](","),Error(N0(268,i)));return i=KZ(e),i=i===null?null:i[x(1133)],i},$t[I(1753)]=function(i){return LI(i)},$t.hydrate=function(i,x,e){if(!ga(x))throw Error(N0(200));return ia(null,i,x,!0,e)},$t.hydrateRoot=function(i,x,e){const t=I;if(!SA(i))throw Error(N0(405));var g=e!=null&&e[t(3392)]||null,n=!1,s="",o=FG;if(e!=null&&(e.unstable_strictMode===!0&&(n=!0),e[t(1260)]!==void 0&&(s=e.identifierPrefix),e[t(973)]!==void 0&&(o=e[t(973)])),x=ly(x,null,i,1,e??null,n,!1,s,o),i[Fi]=x[t(1895)],qc(i),g)for(i=0;i<g.length;i++)e=g[i],n=e[t(3797)],n=n(e._source),x[t(1526)]==null?x[t(1526)]=[e,n]:x.mutableSourceEagerHydrationData[t(3330)](e,n);return new x2(x)},$t[I(948)]=function(i,x,e){if(!ga(x))throw Error(N0(200));return ia(null,i,x,!1,e)},$t.unmountComponentAtNode=function(i){const x=I;if(!ga(i))throw Error(N0(40));return i[x(3833)]?(LI(function(){ia(null,null,i,!1,function(){const e=i0;i[e(3833)]=null,i[Fi]=null})}),!0):!1},$t[I(2949)]=ef,$t[I(637)]=function(i,x,e,t){if(!ga(e))throw Error(N0(200));if(i==null||i._reactInternals===void 0)throw Error(N0(38));return ia(i,x,e,!1,t)},$t[I(1450)]="18.3.1-next-f1338f8080-20240426";function ay(){const i=I;if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__===i(1797)||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ay)}catch(x){console.error(x)}}ay(),rZ[I(2129)]=$t;var FM=rZ[I(2129)];/**
* @license
* Copyright 2010-2024 Three.js Authors
* SPDX-License-Identifier: MIT
*/const f2=I(3165),HV={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},NV={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},ry=0,vb=1,dy=2,FV=3,Ay=0,m2=1,zc=2,Hg=3,Ji=0,Zt=1,si=2,Li=0,SI=1,Wb=2,wb=3,Rb=4,uy=5,Gn=100,by=101,hy=102,fy=103,my=104,Gy=200,py=201,By=202,Zy=203,e2=204,t2=205,yy=206,vy=207,Wy=208,wy=209,Ry=210,Vy=211,Sy=212,Xy=213,Yy=214,Ky=0,Hy=1,Ny=2,IC=3,Fy=4,zy=5,My=6,Ly=7,YC=0,ky=1,Ty=2,ai=0,Jy=1,Ey=2,Uy=3,sf=4,_y=5,Dy=6,Qy=7,Vb="attached",Py=I(1108),G2=300,Ei=301,Hn=302,sC=303,oC=304,Zo=306,cC=1e3,Gg=1001,CC=1002,Me=1003,of=1004,zV=1004,Ds=1005,MV=1005,Ze=1006,Mc=1007,LV=1007,oi=1008,kV=1008,di=1009,Oy=1010,qy=1011,cf=1012,Cf=1013,kI=1014,pg=1015,KC=1016,lf=1017,af=1018,yo=1020,$y=35902,jy=1021,xv=1022,zt=1023,ev=1024,tv=1025,XI=1026,bo=1027,rf=1028,df=1029,gv=1030,Af=1031,uf=1033,fr=33776,mr=33777,Gr=33778,pr=33779,Sb=35840,Xb=35841,Yb=35842,Kb=35843,Hb=36196,Nb=37492,Fb=37496,zb=37808,Mb=37809,Lb=37810,kb=37811,Tb=37812,Jb=37813,Eb=37814,Ub=37815,_b=37816,Db=37817,Qb=37818,Pb=37819,Ob=37820,qb=37821,Br=36492,$b=36494,jb=36495,iv=36283,xh=36284,eh=36285,th=36286,nv=2200,Iv=2201,sv=2202,lC=2300,aC=2301,Zr=2302,yI=2400,vI=2401,rC=2402,p2=2500,bf=2501,TV=0,JV=1,EV=2,ov=3200,cv=3201,Mn=0,Cv=1,Vi="",Ag=I(554),Di=I(1414),B2="display-p3",HC="display-p3-linear",dC="linear",qx=I(554),AC=I(2456),uC="p3",UV=0,dI=7680,_V=7681,DV=7682,QV=7683,PV=34055,OV=34056,qV=5386,$V=512,jV=513,xS=514,eS=515,tS=516,gS=517,iS=518,gh=519,lv=512,av=513,rv=514,hf=515,dv=516,Av=517,uv=518,bv=519,bC=35044,hv=35048,nS=35040,IS=35045,sS=35049,oS=35041,cS=35046,CS=35050,lS=35042,aS="100",ih=I(3894),ci=2e3,hC=2001;class Qi{[I(2134)](x,e){const t=I;this[t(2051)]===void 0&&(this._listeners={});const g=this[t(2051)];g[x]===void 0&&(g[x]=[]),g[x][t(2377)](e)===-1&&g[x].push(e)}hasEventListener(x,e){if(this[I(2051)]===void 0)return!1;const g=this._listeners;return g[x]!==void 0&&g[x].indexOf(e)!==-1}[I(1216)](x,e){const t=I;if(this._listeners===void 0)return;const g=this[t(2051)],n=g[x];if(n!==void 0){const s=n[t(2377)](e);s!==-1&&n[t(2960)](s,1)}}[I(1457)](x){const e=I;if(this[e(2051)]===void 0)return;const t=this[e(2051)],g=t[x.type];if(g!==void 0){x[e(2930)]=this;const n=g[e(1226)](0);for(let s=0,o=n[e(2989)];s<o;s++)n[s][e(2627)](this,x);x[e(2930)]=null}}}const tt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let MG=1234567;const YI=Math.PI/180,ho=180/Math.PI;function gg(){const i=I,x=Math[i(2938)]()*4294967295|0,e=Math[i(2938)]()*4294967295|0,t=Math[i(2938)]()*4294967295|0,g=Math[i(2938)]()*4294967295|0;return(tt[x&255]+tt[x>>8&255]+tt[x>>16&255]+tt[x>>24&255]+"-"+tt[e&255]+tt[e>>8&255]+"-"+tt[e>>16&15|64]+tt[e>>24&255]+"-"+tt[t&63|128]+tt[t>>8&255]+"-"+tt[t>>16&255]+tt[t>>24&255]+tt[g&255]+tt[g>>8&255]+tt[g>>16&255]+tt[g>>24&255])[i(2084)]()}function Ae(i,x,e){const t=I;return Math[t(1971)](x,Math[t(1410)](e,i))}function ff(i,x){return(i%x+x)%x}function rS(i,x,e,t,g){return t+(i-x)*(g-t)/(e-x)}function dS(i,x,e){return i!==x?(e-i)/(x-i):0}function Lc(i,x,e){return(1-e)*i+e*x}function AS(i,x,e,t){return Lc(i,x,1-Math.exp(-e*t))}function uS(i,x=1){return x-Math[I(447)](ff(i,x*2)-x)}function bS(i,x,e){return i<=x?0:i>=e?1:(i=(i-x)/(e-x),i*i*(3-2*i))}function hS(i,x,e){return i<=x?0:i>=e?1:(i=(i-x)/(e-x),i*i*i*(i*(i*6-15)+10))}function fS(i,x){return i+Math.floor(Math[I(2938)]()*(x-i+1))}function mS(i,x){return i+Math.random()*(x-i)}function GS(i){return i*(.5-Math[I(2938)]())}function pS(i){const x=I;i!==void 0&&(MG=i);let e=MG+=1831565813;return e=Math[x(3487)](e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function BS(i){return i*YI}function ZS(i){return i*ho}function yS(i){return(i&i-1)===0&&i!==0}function vS(i){const x=I;return Math[x(3395)](2,Math[x(2163)](Math[x(2013)](i)/Math[x(3048)]))}function WS(i){const x=I;return Math[x(3395)](2,Math[x(3143)](Math[x(2013)](i)/Math.LN2))}function wS(i,x,e,t,g){const n=I,s=Math[n(1563)],o=Math[n(1996)],c=s(e/2),C=o(e/2),r=s((x+t)/2),A=o((x+t)/2),d=s((x-t)/2),h=o((x-t)/2),f=s((t-x)/2),B=o((t-x)/2);switch(g){case n(2257):i[n(298)](c*A,C*d,C*h,c*r);break;case"YZY":i.set(C*h,c*A,C*d,c*r);break;case n(407):i[n(298)](C*d,C*h,c*A,c*r);break;case n(842):i[n(298)](c*A,C*B,C*f,c*r);break;case"YXY":i[n(298)](C*f,c*A,C*B,c*r);break;case n(1906):i[n(298)](C*B,C*f,c*A,c*r);break;default:console[n(3748)]("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+g)}}function pt(i,x){const e=I;switch(x.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math[e(1971)](i/127,-1);default:throw new Error("Invalid component type.")}}function Bx(i,x){const e=I;switch(x[e(135)]){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math[e(1008)](i*65535);case Uint8Array:return Math[e(1008)](i*255);case Int32Array:return Math[e(1008)](i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math[e(1008)](i*127);default:throw new Error(e(2018))}}const RS={DEG2RAD:YI,RAD2DEG:ho,generateUUID:gg,clamp:Ae,euclideanModulo:ff,mapLinear:rS,inverseLerp:dS,lerp:Lc,damp:AS,pingpong:uS,smoothstep:bS,smootherstep:hS,randInt:fS,randFloat:mS,randFloatSpread:GS,seededRandom:pS,degToRad:BS,radToDeg:ZS,isPowerOfTwo:yS,ceilPowerOfTwo:vS,floorPowerOfTwo:WS,setQuaternionFromProperEuler:wS,normalize:Bx,denormalize:pt};class S0{constructor(x=0,e=0){const t=I;S0[t(1566)][t(3856)]=!0,this.x=x,this.y=e}get[I(2315)](){return this.x}set width(x){this.x=x}get[I(2741)](){return this.y}set[I(2741)](x){this.y=x}[I(298)](x,e){return this.x=x,this.y=e,this}setScalar(x){return this.x=x,this.y=x,this}[I(3126)](x){return this.x=x,this}[I(675)](x){return this.y=x,this}[I(1473)](x,e){const t=I;switch(x){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error(t(569)+x)}return this}[I(1096)](x){const e=I;switch(x){case 0:return this.x;case 1:return this.y;default:throw new Error(e(569)+x)}}clone(){return new this.constructor(this.x,this.y)}[I(1493)](x){return this.x=x.x,this.y=x.y,this}add(x){return this.x+=x.x,this.y+=x.y,this}[I(1440)](x){return this.x+=x,this.y+=x,this}addVectors(x,e){return this.x=x.x+e.x,this.y=x.y+e.y,this}[I(832)](x,e){return this.x+=x.x*e,this.y+=x.y*e,this}[I(3938)](x){return this.x-=x.x,this.y-=x.y,this}[I(2502)](x){return this.x-=x,this.y-=x,this}[I(859)](x,e){return this.x=x.x-e.x,this.y=x.y-e.y,this}[I(327)](x){return this.x*=x.x,this.y*=x.y,this}[I(2333)](x){return this.x*=x,this.y*=x,this}divide(x){return this.x/=x.x,this.y/=x.y,this}[I(648)](x){return this[I(2333)](1/x)}[I(1326)](x){const e=this.x,t=this.y,g=x.elements;return this.x=g[0]*e+g[3]*t+g[6],this.y=g[1]*e+g[4]*t+g[7],this}[I(1410)](x){const e=I;return this.x=Math[e(1410)](this.x,x.x),this.y=Math[e(1410)](this.y,x.y),this}[I(1971)](x){const e=I;return this.x=Math[e(1971)](this.x,x.x),this.y=Math[e(1971)](this.y,x.y),this}[I(3920)](x,e){const t=I;return this.x=Math[t(1971)](x.x,Math[t(1410)](e.x,this.x)),this.y=Math[t(1971)](x.y,Math.min(e.y,this.y)),this}[I(3872)](x,e){const t=I;return this.x=Math[t(1971)](x,Math[t(1410)](e,this.x)),this.y=Math[t(1971)](x,Math[t(1410)](e,this.y)),this}[I(2782)](x,e){const t=I,g=this[t(2989)]();return this[t(648)](g||1)[t(2333)](Math[t(1971)](x,Math[t(1410)](e,g)))}[I(3143)](){const x=I;return this.x=Math[x(3143)](this.x),this.y=Math[x(3143)](this.y),this}[I(2163)](){const x=I;return this.x=Math[x(2163)](this.x),this.y=Math[x(2163)](this.y),this}[I(1008)](){const x=I;return this.x=Math[x(1008)](this.x),this.y=Math[x(1008)](this.y),this}[I(697)](){const x=I;return this.x=Math[x(1948)](this.x),this.y=Math[x(1948)](this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}[I(1760)](x){return this.x*x.x+this.y*x.y}[I(1092)](x){return this.x*x.y-this.y*x.x}[I(1494)](){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}[I(3027)](){const x=I;return Math.abs(this.x)+Math[x(447)](this.y)}[I(3762)](){const x=I;return this[x(648)](this[x(2989)]()||1)}[I(3478)](){return Math[I(435)](-this.y,-this.x)+Math.PI}[I(3400)](x){const e=I,t=Math.sqrt(this.lengthSq()*x[e(1494)]());if(t===0)return Math.PI/2;const g=this[e(1760)](x)/t;return Math[e(3102)](Ae(g,-1,1))}distanceTo(x){return Math[I(3641)](this.distanceToSquared(x))}[I(3489)](x){const e=this.x-x.x,t=this.y-x.y;return e*e+t*t}[I(1801)](x){const e=I;return Math[e(447)](this.x-x.x)+Math[e(447)](this.y-x.y)}[I(3231)](x){const e=I;return this[e(3762)]()[e(2333)](x)}[I(3814)](x,e){return this.x+=(x.x-this.x)*e,this.y+=(x.y-this.y)*e,this}[I(200)](x,e,t){return this.x=x.x+(e.x-x.x)*t,this.y=x.y+(e.y-x.y)*t,this}equals(x){return x.x===this.x&&x.y===this.y}fromArray(x,e=0){return this.x=x[e],this.y=x[e+1],this}[I(3904)](x=[],e=0){return x[e]=this.x,x[e+1]=this.y,x}fromBufferAttribute(x,e){const t=I;return this.x=x[t(1829)](e),this.y=x[t(655)](e),this}[I(2135)](x,e){const t=I,g=Math[t(1563)](e),n=Math[t(1996)](e),s=this.x-x.x,o=this.y-x.y;return this.x=s*g-o*n+x.x,this.y=s*n+o*g+x.y,this}[I(2938)](){const x=I;return this.x=Math[x(2938)](),this.y=Math[x(2938)](),this}*[Symbol.iterator](){yield this.x,yield this.y}}class px{constructor(x,e,t,g,n,s,o,c,C){const r=I;px[r(1566)][r(3868)]=!0,this[r(2574)]=[1,0,0,0,1,0,0,0,1],x!==void 0&&this.set(x,e,t,g,n,s,o,c,C)}[I(298)](x,e,t,g,n,s,o,c,C){const r=I,A=this[r(2574)];return A[0]=x,A[1]=g,A[2]=o,A[3]=e,A[4]=n,A[5]=c,A[6]=t,A[7]=s,A[8]=C,this}[I(532)](){return this[I(298)](1,0,0,0,1,0,0,0,1),this}copy(x){const e=I,t=this[e(2574)],g=x[e(2574)];return t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3],t[4]=g[4],t[5]=g[5],t[6]=g[6],t[7]=g[7],t[8]=g[8],this}[I(1056)](x,e,t){const g=I;return x[g(1956)](this,0),e[g(1956)](this,1),t[g(1956)](this,2),this}[I(3544)](x){const e=x.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}[I(327)](x){return this[I(1418)](this,x)}premultiply(x){return this.multiplyMatrices(x,this)}[I(1418)](x,e){const t=I,g=x.elements,n=e.elements,s=this[t(2574)],o=g[0],c=g[3],C=g[6],r=g[1],A=g[4],d=g[7],h=g[2],f=g[5],B=g[8],Z=n[0],G=n[3],m=n[6],v=n[1],p=n[4],w=n[7],V=n[2],N=n[5],X=n[8];return s[0]=o*Z+c*v+C*V,s[3]=o*G+c*p+C*N,s[6]=o*m+c*w+C*X,s[1]=r*Z+A*v+d*V,s[4]=r*G+A*p+d*N,s[7]=r*m+A*w+d*X,s[2]=h*Z+f*v+B*V,s[5]=h*G+f*p+B*N,s[8]=h*m+f*w+B*X,this}multiplyScalar(x){const e=this.elements;return e[0]*=x,e[3]*=x,e[6]*=x,e[1]*=x,e[4]*=x,e[7]*=x,e[2]*=x,e[5]*=x,e[8]*=x,this}[I(345)](){const x=I,e=this[x(2574)],t=e[0],g=e[1],n=e[2],s=e[3],o=e[4],c=e[5],C=e[6],r=e[7],A=e[8];return t*o*A-t*c*r-g*s*A+g*c*C+n*s*r-n*o*C}[I(2483)](){const x=I,e=this[x(2574)],t=e[0],g=e[1],n=e[2],s=e[3],o=e[4],c=e[5],C=e[6],r=e[7],A=e[8],d=A*o-c*r,h=c*C-A*s,f=r*s-o*C,B=t*d+g*h+n*f;if(B===0)return this[x(298)](0,0,0,0,0,0,0,0,0);const Z=1/B;return e[0]=d*Z,e[1]=(n*r-A*g)*Z,e[2]=(c*g-n*o)*Z,e[3]=h*Z,e[4]=(A*t-n*C)*Z,e[5]=(n*s-c*t)*Z,e[6]=f*Z,e[7]=(g*C-r*t)*Z,e[8]=(o*t-g*s)*Z,this}[I(2795)](){const x=I;let e;const t=this[x(2574)];return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(x){const e=I;return this.setFromMatrix4(x)[e(2483)]()[e(2795)]()}transposeIntoArray(x){const e=I,t=this[e(2574)];return x[0]=t[0],x[1]=t[3],x[2]=t[6],x[3]=t[1],x[4]=t[4],x[5]=t[7],x[6]=t[2],x[7]=t[5],x[8]=t[8],this}[I(2723)](x,e,t,g,n,s,o){const c=I,C=Math[c(1563)](n),r=Math[c(1996)](n);return this[c(298)](t*C,t*r,-t*(C*s+r*o)+s+x,-g*r,g*C,-g*(-r*s+C*o)+o+e,0,0,1),this}[I(623)](x,e){const t=I;return this[t(2050)](XA[t(1761)](x,e)),this}[I(3357)](x){const e=I;return this.premultiply(XA[e(613)](-x)),this}[I(2945)](x,e){const t=I;return this[t(2050)](XA[t(804)](x,e)),this}[I(804)](x,e){const t=I;return x[t(3856)]?this[t(298)](1,0,x.x,0,1,x.y,0,0,1):this.set(1,0,x,0,1,e,0,0,1),this}[I(613)](x){const e=I,t=Math[e(1563)](x),g=Math[e(1996)](x);return this[e(298)](t,-g,0,g,t,0,0,0,1),this}[I(1761)](x,e){return this[I(298)](x,0,0,0,e,0,0,0,1),this}[I(3106)](x){const e=I,t=this.elements,g=x[e(2574)];for(let n=0;n<9;n++)if(t[n]!==g[n])return!1;return!0}[I(2793)](x,e=0){const t=I;for(let g=0;g<9;g++)this[t(2574)][g]=x[g+e];return this}toArray(x=[],e=0){const t=this.elements;return x[e]=t[0],x[e+1]=t[1],x[e+2]=t[2],x[e+3]=t[3],x[e+4]=t[4],x[e+5]=t[5],x[e+6]=t[6],x[e+7]=t[7],x[e+8]=t[8],x}[I(3123)](){const x=I;return new this[x(135)]()[x(2793)](this[x(2574)])}}const XA=new px;function fv(i){for(let x=i.length-1;x>=0;--x)if(i[x]>=65535)return!0;return!1}const VS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Qs(i,x){return new VS[i](x)}function fC(i){const x=I;return document[x(3356)](x(3909),i)}function mv(){const i=I,x=fC(i(2359));return x[i(1720)][i(3181)]="block",x}const LG={};function Gv(i){const x=I;i in LG||(LG[i]=!0,console[x(3748)](i))}const kG=new px()[I(298)](.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),TG=new px().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ia={[Di]:{transfer:dC,primaries:AC,toReference:i=>i,fromReference:i=>i},[Ag]:{transfer:qx,primaries:AC,toReference:i=>i[I(2068)](),fromReference:i=>i[I(570)]()},[HC]:{transfer:dC,primaries:uC,toReference:i=>i.applyMatrix3(TG),fromReference:i=>i[I(1326)](kG)},[B2]:{transfer:qx,primaries:uC,toReference:i=>i[I(2068)]()[I(1326)](TG),fromReference:i=>i[I(1326)](kG)[I(570)]()}},SS=new Set([Di,HC]),_x={enabled:!0,_workingColorSpace:Di,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){const x=I;if(!SS[x(2489)](i))throw new Error('Unsupported working color space, "'+i+'".');this[x(3378)]=i},convert:function(i,x,e){const t=I;if(this[t(2648)]===!1||x===e||!x||!e)return i;const g=Ia[x][t(1451)],n=Ia[e][t(2613)];return n(g(i))},fromWorkingColorSpace:function(i,x){const e=I;return this[e(796)](i,this[e(3378)],x)},toWorkingColorSpace:function(i,x){const e=I;return this[e(796)](i,x,this[e(3378)])},getPrimaries:function(i){const x=I;return Ia[i][x(1155)]},getTransfer:function(i){const x=I;return i===Vi?dC:Ia[i][x(1316)]}};function Io(i){const x=I;return i<.04045?i*.0773993808:Math[x(3395)](i*.9478672986+.0521327014,2.4)}function YA(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let os;class pv{static[I(3407)](x){const e=I;if(/^data:/i[e(3633)](x[e(2595)])||typeof HTMLCanvasElement>"u")return x[e(2595)];let t;if(x instanceof HTMLCanvasElement)t=x;else{os===void 0&&(os=fC(e(2359))),os.width=x[e(2315)],os.height=x[e(2741)];const g=os[e(326)]("2d");x instanceof ImageData?g[e(2449)](x,0,0):g[e(690)](x,0,0,x[e(2315)],x[e(2741)]),t=os}return t.width>2048||t[e(2741)]>2048?(console[e(3748)](e(3675),x),t[e(614)](e(180),.6)):t[e(614)](e(3375))}static[I(1079)](x){const e=I;if(typeof HTMLImageElement!==e(1797)&&x instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&x instanceof HTMLCanvasElement||typeof ImageBitmap!==e(1797)&&x instanceof ImageBitmap){const t=fC(e(2359));t[e(2315)]=x[e(2315)],t[e(2741)]=x[e(2741)];const g=t[e(326)]("2d");g[e(690)](x,0,0,x[e(2315)],x[e(2741)]);const n=g[e(3624)](0,0,x.width,x.height),s=n[e(3787)];for(let o=0;o<s[e(2989)];o++)s[o]=Io(s[o]/255)*255;return g[e(2449)](n,0,0),t}else if(x[e(3787)]){const t=x[e(3787)][e(1226)](0);for(let g=0;g<t[e(2989)];g++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[g]=Math[e(3143)](Io(t[g]/255)*255):t[g]=Io(t[g]);return{data:t,width:x.width,height:x[e(2741)]}}else return console[e(3748)](e(3958)),x}}let XS=0;class WI{constructor(x=null){const e=I;this.isSource=!0,Object.defineProperty(this,"id",{value:XS++}),this[e(296)]=gg(),this.data=x,this[e(334)]=!0,this[e(1450)]=0}set[I(2170)](x){x===!0&&this.version++}toJSON(x){const e=I,t=x===void 0||typeof x===e(3674);if(!t&&x[e(2268)][this[e(296)]]!==void 0)return x[e(2268)][this[e(296)]];const g={uuid:this.uuid,url:""},n=this[e(3787)];if(n!==null){let s;if(Array[e(1987)](n)){s=[];for(let o=0,c=n[e(2989)];o<c;o++)n[o][e(3079)]?s[e(3330)](KA(n[o][e(1781)])):s[e(3330)](KA(n[o]))}else s=KA(n);g[e(412)]=s}return!t&&(x.images[this[e(296)]]=g),g}}function KA(i){const x=I;return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!==x(1797)&&i instanceof HTMLCanvasElement||typeof ImageBitmap!==x(1797)&&i instanceof ImageBitmap?pv[x(3407)](i):i[x(3787)]?{data:Array[x(3803)](i[x(3787)]),width:i.width,height:i.height,type:i[x(3787)][x(135)][x(1474)]}:(console[x(3748)](x(3269)),{})}let YS=0;class ue extends Qi{constructor(x=ue[I(1256)],e=ue[I(1060)],t=Gg,g=Gg,n=Ze,s=oi,o=zt,c=di,C=ue.DEFAULT_ANISOTROPY,r=Vi){const A=I;super(),this[A(3984)]=!0,Object.defineProperty(this,"id",{value:YS++}),this.uuid=gg(),this.name="",this[A(3272)]=new WI(x),this[A(2768)]=[],this[A(3099)]=e,this[A(2168)]=0,this[A(861)]=t,this.wrapT=g,this[A(2637)]=n,this[A(3338)]=s,this[A(2651)]=C,this[A(3207)]=o,this[A(724)]=null,this[A(3505)]=c,this[A(872)]=new S0(0,0),this.repeat=new S0(1,1),this[A(3416)]=new S0(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this[A(1721)]=new px,this[A(2787)]=!0,this[A(3721)]=!1,this[A(233)]=!0,this[A(1005)]=4,this[A(1549)]=r,this[A(358)]={},this[A(1450)]=0,this[A(1581)]=null,this[A(1309)]=!1,this[A(3011)]=0}get image(){const x=I;return this.source[x(3787)]}set[I(1781)](x=null){const e=I;this[e(3272)][e(3787)]=x}[I(466)](){const x=I;this.matrix[x(2723)](this[x(872)].x,this[x(872)].y,this[x(3309)].x,this[x(3309)].y,this[x(1488)],this[x(3416)].x,this.center.y)}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}[I(1493)](x){const e=I;return this[e(1474)]=x[e(1474)],this[e(3272)]=x[e(3272)],this[e(2768)]=x.mipmaps[e(1226)](0),this[e(3099)]=x[e(3099)],this[e(2168)]=x.channel,this[e(861)]=x[e(861)],this[e(471)]=x[e(471)],this.magFilter=x[e(2637)],this[e(3338)]=x.minFilter,this[e(2651)]=x.anisotropy,this[e(3207)]=x[e(3207)],this[e(724)]=x[e(724)],this.type=x[e(3505)],this[e(872)][e(1493)](x[e(872)]),this[e(3309)][e(1493)](x.repeat),this[e(3416)][e(1493)](x[e(3416)]),this.rotation=x.rotation,this[e(2272)]=x[e(2272)],this[e(1721)][e(1493)](x[e(1721)]),this[e(2787)]=x[e(2787)],this[e(3721)]=x[e(3721)],this[e(233)]=x[e(233)],this[e(1005)]=x[e(1005)],this[e(1549)]=x[e(1549)],this[e(358)]=JSON[e(3073)](JSON.stringify(x[e(358)])),this.needsUpdate=!0,this}toJSON(x){const e=I,t=x===void 0||typeof x=="string";if(!t&&x[e(353)][this.uuid]!==void 0)return x[e(353)][this.uuid];const g={metadata:{version:4.6,type:e(1968),generator:e(2082)},uuid:this[e(296)],name:this[e(1474)],image:this[e(3272)][e(2054)](x)[e(296)],mapping:this[e(3099)],channel:this[e(2168)],repeat:[this[e(3309)].x,this[e(3309)].y],offset:[this[e(872)].x,this[e(872)].y],center:[this[e(3416)].x,this[e(3416)].y],rotation:this[e(1488)],wrap:[this[e(861)],this[e(471)]],format:this.format,internalFormat:this[e(724)],type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this[e(2637)],anisotropy:this[e(2651)],flipY:this[e(233)],generateMipmaps:this[e(2787)],premultiplyAlpha:this[e(3721)],unpackAlignment:this[e(1005)]};return Object[e(958)](this[e(358)])[e(2989)]>0&&(g[e(358)]=this[e(358)]),!t&&(x[e(353)][this[e(296)]]=g),g}[I(1439)](){const x=I;this[x(1457)]({type:x(1439)})}[I(3259)](x){const e=I;if(this[e(3099)]!==G2)return x;if(x.applyMatrix3(this[e(1721)]),x.x<0||x.x>1)switch(this[e(861)]){case cC:x.x=x.x-Math[e(3143)](x.x);break;case Gg:x.x=x.x<0?0:1;break;case CC:Math[e(447)](Math[e(3143)](x.x)%2)===1?x.x=Math[e(2163)](x.x)-x.x:x.x=x.x-Math.floor(x.x);break}if(x.y<0||x.y>1)switch(this[e(471)]){case cC:x.y=x.y-Math.floor(x.y);break;case Gg:x.y=x.y<0?0:1;break;case CC:Math.abs(Math[e(3143)](x.y)%2)===1?x.y=Math[e(2163)](x.y)-x.y:x.y=x.y-Math[e(3143)](x.y);break}return this[e(233)]&&(x.y=1-x.y),x}set[I(2170)](x){const e=I;x===!0&&(this[e(1450)]++,this.source.needsUpdate=!0)}set needsPMREMUpdate(x){x===!0&&this.pmremVersion++}}ue.DEFAULT_IMAGE=null,ue[I(1060)]=G2,ue.DEFAULT_ANISOTROPY=1;class Dx{constructor(x=0,e=0,t=0,g=1){const n=I;Dx.prototype[n(658)]=!0,this.x=x,this.y=e,this.z=t,this.w=g}get[I(2315)](){return this.z}set[I(2315)](x){this.z=x}get[I(2741)](){return this.w}set[I(2741)](x){this.w=x}set(x,e,t,g){return this.x=x,this.y=e,this.z=t,this.w=g,this}[I(3319)](x){return this.x=x,this.y=x,this.z=x,this.w=x,this}setX(x){return this.x=x,this}[I(675)](x){return this.y=x,this}setZ(x){return this.z=x,this}[I(2607)](x){return this.w=x,this}setComponent(x,e){const t=I;switch(x){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error(t(569)+x)}return this}getComponent(x){const e=I;switch(x){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error(e(569)+x)}}[I(3123)](){const x=I;return new this[x(135)](this.x,this.y,this.z,this.w)}[I(1493)](x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=x.w!==void 0?x.w:1,this}add(x){return this.x+=x.x,this.y+=x.y,this.z+=x.z,this.w+=x.w,this}[I(1440)](x){return this.x+=x,this.y+=x,this.z+=x,this.w+=x,this}[I(3107)](x,e){return this.x=x.x+e.x,this.y=x.y+e.y,this.z=x.z+e.z,this.w=x.w+e.w,this}[I(832)](x,e){return this.x+=x.x*e,this.y+=x.y*e,this.z+=x.z*e,this.w+=x.w*e,this}[I(3938)](x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this.w-=x.w,this}[I(2502)](x){return this.x-=x,this.y-=x,this.z-=x,this.w-=x,this}[I(859)](x,e){return this.x=x.x-e.x,this.y=x.y-e.y,this.z=x.z-e.z,this.w=x.w-e.w,this}[I(327)](x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this.w*=x.w,this}[I(2333)](x){return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this}applyMatrix4(x){const e=this.x,t=this.y,g=this.z,n=this.w,s=x.elements;return this.x=s[0]*e+s[4]*t+s[8]*g+s[12]*n,this.y=s[1]*e+s[5]*t+s[9]*g+s[13]*n,this.z=s[2]*e+s[6]*t+s[10]*g+s[14]*n,this.w=s[3]*e+s[7]*t+s[11]*g+s[15]*n,this}[I(648)](x){return this[I(2333)](1/x)}[I(306)](x){const e=I;this.w=2*Math[e(3102)](x.w);const t=Math[e(3641)](1-x.w*x.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=x.x/t,this.y=x.y/t,this.z=x.z/t),this}[I(3569)](x){const e=I;let t,g,n,s;const o=.01,c=.1,C=x.elements,r=C[0],A=C[4],d=C[8],h=C[1],f=C[5],B=C[9],Z=C[2],G=C[6],m=C[10];if(Math[e(447)](A-h)<o&&Math[e(447)](d-Z)<o&&Math[e(447)](B-G)<o){if(Math[e(447)](A+h)<c&&Math[e(447)](d+Z)<c&&Math[e(447)](B+G)<c&&Math[e(447)](r+f+m-3)<c)return this[e(298)](1,0,0,0),this;t=Math.PI;const p=(r+1)/2,w=(f+1)/2,V=(m+1)/2,N=(A+h)/4,X=(d+Z)/4,M=(B+G)/4;return p>w&&p>V?p<o?(g=0,n=.707106781,s=.707106781):(g=Math[e(3641)](p),n=N/g,s=X/g):w>V?w<o?(g=.707106781,n=0,s=.707106781):(n=Math[e(3641)](w),g=N/n,s=M/n):V<o?(g=.707106781,n=.707106781,s=0):(s=Math[e(3641)](V),g=X/s,n=M/s),this.set(g,n,s,t),this}let v=Math[e(3641)]((G-B)*(G-B)+(d-Z)*(d-Z)+(h-A)*(h-A));return Math.abs(v)<.001&&(v=1),this.x=(G-B)/v,this.y=(d-Z)/v,this.z=(h-A)/v,this.w=Math[e(3102)]((r+f+m-1)/2),this}[I(1410)](x){const e=I;return this.x=Math.min(this.x,x.x),this.y=Math[e(1410)](this.y,x.y),this.z=Math[e(1410)](this.z,x.z),this.w=Math[e(1410)](this.w,x.w),this}[I(1971)](x){const e=I;return this.x=Math[e(1971)](this.x,x.x),this.y=Math[e(1971)](this.y,x.y),this.z=Math[e(1971)](this.z,x.z),this.w=Math[e(1971)](this.w,x.w),this}clamp(x,e){const t=I;return this.x=Math[t(1971)](x.x,Math.min(e.x,this.x)),this.y=Math.max(x.y,Math[t(1410)](e.y,this.y)),this.z=Math[t(1971)](x.z,Math.min(e.z,this.z)),this.w=Math[t(1971)](x.w,Math[t(1410)](e.w,this.w)),this}[I(3872)](x,e){const t=I;return this.x=Math.max(x,Math[t(1410)](e,this.x)),this.y=Math[t(1971)](x,Math[t(1410)](e,this.y)),this.z=Math.max(x,Math[t(1410)](e,this.z)),this.w=Math[t(1971)](x,Math[t(1410)](e,this.w)),this}[I(2782)](x,e){const t=I,g=this[t(2989)]();return this[t(648)](g||1).multiplyScalar(Math.max(x,Math.min(e,g)))}[I(3143)](){const x=I;return this.x=Math[x(3143)](this.x),this.y=Math[x(3143)](this.y),this.z=Math[x(3143)](this.z),this.w=Math.floor(this.w),this}[I(2163)](){const x=I;return this.x=Math[x(2163)](this.x),this.y=Math[x(2163)](this.y),this.z=Math[x(2163)](this.z),this.w=Math[x(2163)](this.w),this}[I(1008)](){const x=I;return this.x=Math[x(1008)](this.x),this.y=Math[x(1008)](this.y),this.z=Math.round(this.z),this.w=Math[x(1008)](this.w),this}[I(697)](){const x=I;return this.x=Math[x(1948)](this.x),this.y=Math.trunc(this.y),this.z=Math[x(1948)](this.z),this.w=Math[x(1948)](this.w),this}[I(3217)](){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}[I(1760)](x){return this.x*x.x+this.y*x.y+this.z*x.z+this.w*x.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}[I(2989)](){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}[I(3027)](){const x=I;return Math.abs(this.x)+Math[x(447)](this.y)+Math[x(447)](this.z)+Math.abs(this.w)}[I(3762)](){const x=I;return this[x(648)](this[x(2989)]()||1)}[I(3231)](x){const e=I;return this.normalize()[e(2333)](x)}[I(3814)](x,e){return this.x+=(x.x-this.x)*e,this.y+=(x.y-this.y)*e,this.z+=(x.z-this.z)*e,this.w+=(x.w-this.w)*e,this}[I(200)](x,e,t){return this.x=x.x+(e.x-x.x)*t,this.y=x.y+(e.y-x.y)*t,this.z=x.z+(e.z-x.z)*t,this.w=x.w+(e.w-x.w)*t,this}[I(3106)](x){return x.x===this.x&&x.y===this.y&&x.z===this.z&&x.w===this.w}[I(2793)](x,e=0){return this.x=x[e],this.y=x[e+1],this.z=x[e+2],this.w=x[e+3],this}[I(3904)](x=[],e=0){return x[e]=this.x,x[e+1]=this.y,x[e+2]=this.z,x[e+3]=this.w,x}[I(2404)](x,e){const t=I;return this.x=x[t(1829)](e),this.y=x[t(655)](e),this.z=x[t(2142)](e),this.w=x.getW(e),this}[I(2938)](){const x=I;return this.x=Math[x(2938)](),this.y=Math[x(2938)](),this.z=Math[x(2938)](),this.w=Math[x(2938)](),this}*[Symbol[I(2880)]](){yield this.x,yield this.y,yield this.z,yield this.w}}class Bv extends Qi{constructor(x=1,e=1,t={}){const g=I;super(),this[g(1890)]=!0,this.width=x,this[g(2741)]=e,this[g(3936)]=1,this[g(3108)]=new Dx(0,0,x,e),this[g(3961)]=!1,this[g(1310)]=new Dx(0,0,x,e);const n={width:x,height:e,depth:1};t=Object[g(1859)]({generateMipmaps:!1,internalFormat:null,minFilter:Ze,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},t);const s=new ue(n,t.mapping,t[g(861)],t[g(471)],t.magFilter,t[g(3338)],t[g(3207)],t[g(3505)],t[g(2651)],t.colorSpace);s[g(233)]=!1,s[g(2787)]=t[g(2787)],s[g(724)]=t[g(724)],this[g(353)]=[];const o=t.count;for(let c=0;c<o;c++)this[g(353)][c]=s[g(3123)](),this[g(353)][c][g(1309)]=!0;this[g(1899)]=t[g(1899)],this[g(2876)]=t[g(2876)],this[g(3361)]=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,this.depthTexture=t[g(2550)],this[g(2711)]=t[g(2711)]}get texture(){return this.textures[0]}set[I(3840)](x){const e=I;this[e(353)][0]=x}setSize(x,e,t=1){const g=I;if(this[g(2315)]!==x||this[g(2741)]!==e||this[g(3936)]!==t){this[g(2315)]=x,this[g(2741)]=e,this[g(3936)]=t;for(let n=0,s=this[g(353)][g(2989)];n<s;n++)this[g(353)][n][g(1781)].width=x,this[g(353)][n][g(1781)][g(2741)]=e,this[g(353)][n][g(1781)][g(3936)]=t;this[g(1439)]()}this[g(1310)][g(298)](0,0,x,e),this[g(3108)][g(298)](0,0,x,e)}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}copy(x){const e=I;this[e(2315)]=x.width,this[e(2741)]=x[e(2741)],this[e(3936)]=x[e(3936)],this[e(3108)][e(1493)](x[e(3108)]),this.scissorTest=x[e(3961)],this[e(1310)][e(1493)](x[e(1310)]),this[e(353)][e(2989)]=0;for(let g=0,n=x[e(353)][e(2989)];g<n;g++)this[e(353)][g]=x.textures[g][e(3123)](),this[e(353)][g].isRenderTargetTexture=!0;const t=Object.assign({},x.texture[e(1781)]);return this[e(3840)][e(3272)]=new WI(t),this[e(1899)]=x.depthBuffer,this[e(2876)]=x[e(2876)],this.resolveDepthBuffer=x[e(3361)],this[e(2121)]=x[e(2121)],x[e(2550)]!==null&&(this[e(2550)]=x[e(2550)][e(3123)]()),this[e(2711)]=x.samples,this}[I(1439)](){const x=I;this.dispatchEvent({type:x(1439)})}}class Jg extends Bv{constructor(x=1,e=1,t={}){const g=I;super(x,e,t),this[g(1285)]=!0}}class Z2 extends ue{constructor(x=null,e=1,t=1,g=1){const n=I;super(null),this[n(3821)]=!0,this[n(1781)]={data:x,width:e,height:t,depth:g},this[n(2637)]=Me,this[n(3338)]=Me,this[n(3883)]=Gg,this[n(2787)]=!1,this[n(233)]=!1,this[n(1005)]=1}}class KS extends Jg{constructor(x=1,e=1,t=1,g={}){const n=I;super(x,e,g),this[n(3599)]=!0,this.depth=t,this.texture=new Z2(null,x,e,t),this[n(3840)][n(1309)]=!0}}class mf extends ue{constructor(x=null,e=1,t=1,g=1){const n=I;super(null),this[n(465)]=!0,this[n(1781)]={data:x,width:e,height:t,depth:g},this[n(2637)]=Me,this[n(3338)]=Me,this[n(3883)]=Gg,this.generateMipmaps=!1,this[n(233)]=!1,this.unpackAlignment=1}}class HS extends Jg{constructor(x=1,e=1,t=1,g={}){const n=I;super(x,e,g),this[n(1373)]=!0,this[n(3936)]=t,this[n(3840)]=new mf(null,x,e,t),this[n(3840)][n(1309)]=!0}}let ot=class{constructor(x=0,e=0,t=0,g=1){const n=I;this[n(3917)]=!0,this._x=x,this._y=e,this._z=t,this._w=g}static[I(1803)](x,e,t,g,n,s,o){const c=I;let C=t[g+0],r=t[g+1],A=t[g+2],d=t[g+3];const h=n[s+0],f=n[s+1],B=n[s+2],Z=n[s+3];if(o===0){x[e+0]=C,x[e+1]=r,x[e+2]=A,x[e+3]=d;return}if(o===1){x[e+0]=h,x[e+1]=f,x[e+2]=B,x[e+3]=Z;return}if(d!==Z||C!==h||r!==f||A!==B){let G=1-o;const m=C*h+r*f+A*B+d*Z,v=m>=0?1:-1,p=1-m*m;if(p>Number.EPSILON){const V=Math.sqrt(p),N=Math[c(435)](V,m*v);G=Math[c(1996)](G*N)/V,o=Math.sin(o*N)/V}const w=o*v;if(C=C*G+h*w,r=r*G+f*w,A=A*G+B*w,d=d*G+Z*w,G===1-o){const V=1/Math.sqrt(C*C+r*r+A*A+d*d);C*=V,r*=V,A*=V,d*=V}}x[e]=C,x[e+1]=r,x[e+2]=A,x[e+3]=d}static[I(1375)](x,e,t,g,n,s){const o=t[g],c=t[g+1],C=t[g+2],r=t[g+3],A=n[s],d=n[s+1],h=n[s+2],f=n[s+3];return x[e]=o*f+r*A+c*h-C*d,x[e+1]=c*f+r*d+C*A-o*h,x[e+2]=C*f+r*h+o*d-c*A,x[e+3]=r*f-o*A-c*d-C*h,x}get x(){return this._x}set x(x){const e=I;this._x=x,this[e(3700)]()}get y(){return this._y}set y(x){const e=I;this._y=x,this[e(3700)]()}get z(){return this._z}set z(x){const e=I;this._z=x,this[e(3700)]()}get w(){return this._w}set w(x){const e=I;this._w=x,this[e(3700)]()}[I(298)](x,e,t,g){const n=I;return this._x=x,this._y=e,this._z=t,this._w=g,this[n(3700)](),this}[I(3123)](){return new this.constructor(this._x,this._y,this._z,this._w)}[I(1493)](x){const e=I;return this._x=x.x,this._y=x.y,this._z=x.z,this._w=x.w,this[e(3700)](),this}[I(2562)](x,e=!0){const t=I,g=x._x,n=x._y,s=x._z,o=x[t(710)],c=Math.cos,C=Math[t(1996)],r=c(g/2),A=c(n/2),d=c(s/2),h=C(g/2),f=C(n/2),B=C(s/2);switch(o){case t(782):this._x=h*A*d+r*f*B,this._y=r*f*d-h*A*B,this._z=r*A*B+h*f*d,this._w=r*A*d-h*f*B;break;case"YXZ":this._x=h*A*d+r*f*B,this._y=r*f*d-h*A*B,this._z=r*A*B-h*f*d,this._w=r*A*d+h*f*B;break;case"ZXY":this._x=h*A*d-r*f*B,this._y=r*f*d+h*A*B,this._z=r*A*B+h*f*d,this._w=r*A*d-h*f*B;break;case t(3758):this._x=h*A*d-r*f*B,this._y=r*f*d+h*A*B,this._z=r*A*B-h*f*d,this._w=r*A*d+h*f*B;break;case t(1800):this._x=h*A*d+r*f*B,this._y=r*f*d+h*A*B,this._z=r*A*B-h*f*d,this._w=r*A*d-h*f*B;break;case t(885):this._x=h*A*d-r*f*B,this._y=r*f*d-h*A*B,this._z=r*A*B+h*f*d,this._w=r*A*d+h*f*B;break;default:console[t(3748)](t(839)+o)}return e===!0&&this[t(3700)](),this}[I(3405)](x,e){const t=I,g=e/2,n=Math.sin(g);return this._x=x.x*n,this._y=x.y*n,this._z=x.z*n,this._w=Math[t(1563)](g),this[t(3700)](),this}[I(3924)](x){const e=I,t=x[e(2574)],g=t[0],n=t[4],s=t[8],o=t[1],c=t[5],C=t[9],r=t[2],A=t[6],d=t[10],h=g+c+d;if(h>0){const f=.5/Math[e(3641)](h+1);this._w=.25/f,this._x=(A-C)*f,this._y=(s-r)*f,this._z=(o-n)*f}else if(g>c&&g>d){const f=2*Math[e(3641)](1+g-c-d);this._w=(A-C)/f,this._x=.25*f,this._y=(n+o)/f,this._z=(s+r)/f}else if(c>d){const f=2*Math.sqrt(1+c-g-d);this._w=(s-r)/f,this._x=(n+o)/f,this._y=.25*f,this._z=(C+A)/f}else{const f=2*Math[e(3641)](1+d-g-c);this._w=(o-n)/f,this._x=(s+r)/f,this._y=(C+A)/f,this._z=.25*f}return this[e(3700)](),this}setFromUnitVectors(x,e){const t=I;let g=x.dot(e)+1;return g<Number[t(2700)]?(g=0,Math[t(447)](x.x)>Math.abs(x.z)?(this._x=-x.y,this._y=x.x,this._z=0,this._w=g):(this._x=0,this._y=-x.z,this._z=x.y,this._w=g)):(this._x=x.y*e.z-x.z*e.y,this._y=x.z*e.x-x.x*e.z,this._z=x.x*e.y-x.y*e.x,this._w=g),this.normalize()}[I(3400)](x){const e=I;return 2*Math[e(3102)](Math.abs(Ae(this[e(1760)](x),-1,1)))}[I(834)](x,e){const t=I,g=this.angleTo(x);if(g===0)return this;const n=Math[t(1410)](1,e/g);return this.slerp(x,n),this}identity(){return this[I(298)](0,0,0,1)}invert(){return this.conjugate()}[I(3597)](){const x=I;return this._x*=-1,this._y*=-1,this._z*=-1,this[x(3700)](),this}[I(1760)](x){return this._x*x._x+this._y*x._y+this._z*x._z+this._w*x._w}[I(1494)](){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}[I(2989)](){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){const x=I;let e=this[x(2989)]();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this[x(3700)](),this}[I(327)](x){return this[I(1426)](this,x)}[I(2050)](x){return this[I(1426)](x,this)}[I(1426)](x,e){const t=I,g=x._x,n=x._y,s=x._z,o=x._w,c=e._x,C=e._y,r=e._z,A=e._w;return this._x=g*A+o*c+n*r-s*C,this._y=n*A+o*C+s*c-g*r,this._z=s*A+o*r+g*C-n*c,this._w=o*A-g*c-n*C-s*r,this[t(3700)](),this}[I(3316)](x,e){const t=I;if(e===0)return this;if(e===1)return this.copy(x);const g=this._x,n=this._y,s=this._z,o=this._w;let c=o*x._w+g*x._x+n*x._y+s*x._z;if(c<0?(this._w=-x._w,this._x=-x._x,this._y=-x._y,this._z=-x._z,c=-c):this[t(1493)](x),c>=1)return this._w=o,this._x=g,this._y=n,this._z=s,this;const C=1-c*c;if(C<=Number[t(2700)]){const f=1-e;return this._w=f*o+e*this._w,this._x=f*g+e*this._x,this._y=f*n+e*this._y,this._z=f*s+e*this._z,this.normalize(),this}const r=Math.sqrt(C),A=Math[t(435)](r,c),d=Math[t(1996)]((1-e)*A)/r,h=Math[t(1996)](e*A)/r;return this._w=o*d+this._w*h,this._x=g*d+this._x*h,this._y=n*d+this._y*h,this._z=s*d+this._z*h,this[t(3700)](),this}[I(2184)](x,e,t){const g=I;return this[g(1493)](x)[g(3316)](e,t)}[I(2938)](){const x=I,e=2*Math.PI*Math[x(2938)](),t=2*Math.PI*Math.random(),g=Math.random(),n=Math[x(3641)](1-g),s=Math.sqrt(g);return this.set(n*Math[x(1996)](e),n*Math.cos(e),s*Math.sin(t),s*Math[x(1563)](t))}equals(x){return x._x===this._x&&x._y===this._y&&x._z===this._z&&x._w===this._w}[I(2793)](x,e=0){const t=I;return this._x=x[e],this._y=x[e+1],this._z=x[e+2],this._w=x[e+3],this[t(3700)](),this}[I(3904)](x=[],e=0){return x[e]=this._x,x[e+1]=this._y,x[e+2]=this._z,x[e+3]=this._w,x}[I(2404)](x,e){const t=I;return this._x=x.getX(e),this._y=x[t(655)](e),this._z=x[t(2142)](e),this._w=x[t(1176)](e),this[t(3700)](),this}[I(2054)](){return this.toArray()}_onChange(x){return this._onChangeCallback=x,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};class E{constructor(x=0,e=0,t=0){const g=I;E.prototype[g(2752)]=!0,this.x=x,this.y=e,this.z=t}set(x,e,t){return t===void 0&&(t=this.z),this.x=x,this.y=e,this.z=t,this}[I(3319)](x){return this.x=x,this.y=x,this.z=x,this}[I(3126)](x){return this.x=x,this}setY(x){return this.y=x,this}setZ(x){return this.z=x,this}[I(1473)](x,e){const t=I;switch(x){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error(t(569)+x)}return this}[I(1096)](x){const e=I;switch(x){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error(e(569)+x)}}[I(3123)](){const x=I;return new this[x(135)](this.x,this.y,this.z)}[I(1493)](x){return this.x=x.x,this.y=x.y,this.z=x.z,this}add(x){return this.x+=x.x,this.y+=x.y,this.z+=x.z,this}[I(1440)](x){return this.x+=x,this.y+=x,this.z+=x,this}[I(3107)](x,e){return this.x=x.x+e.x,this.y=x.y+e.y,this.z=x.z+e.z,this}[I(832)](x,e){return this.x+=x.x*e,this.y+=x.y*e,this.z+=x.z*e,this}sub(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this}subScalar(x){return this.x-=x,this.y-=x,this.z-=x,this}[I(859)](x,e){return this.x=x.x-e.x,this.y=x.y-e.y,this.z=x.z-e.z,this}[I(327)](x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this}[I(2333)](x){return this.x*=x,this.y*=x,this.z*=x,this}[I(2030)](x,e){return this.x=x.x*e.x,this.y=x.y*e.y,this.z=x.z*e.z,this}[I(2898)](x){const e=I;return this[e(2235)](JG[e(2562)](x))}[I(160)](x,e){const t=I;return this[t(2235)](JG[t(3405)](x,e))}[I(1326)](x){const e=this.x,t=this.y,g=this.z,n=x.elements;return this.x=n[0]*e+n[3]*t+n[6]*g,this.y=n[1]*e+n[4]*t+n[7]*g,this.z=n[2]*e+n[5]*t+n[8]*g,this}[I(1433)](x){const e=I;return this[e(1326)](x)[e(3762)]()}[I(3075)](x){const e=this.x,t=this.y,g=this.z,n=x.elements,s=1/(n[3]*e+n[7]*t+n[11]*g+n[15]);return this.x=(n[0]*e+n[4]*t+n[8]*g+n[12])*s,this.y=(n[1]*e+n[5]*t+n[9]*g+n[13])*s,this.z=(n[2]*e+n[6]*t+n[10]*g+n[14])*s,this}[I(2235)](x){const e=this.x,t=this.y,g=this.z,n=x.x,s=x.y,o=x.z,c=x.w,C=2*(s*g-o*t),r=2*(o*e-n*g),A=2*(n*t-s*e);return this.x=e+c*C+s*A-o*r,this.y=t+c*r+o*C-n*A,this.z=g+c*A+n*r-s*C,this}project(x){const e=I;return this[e(3075)](x.matrixWorldInverse)[e(3075)](x[e(2900)])}[I(1230)](x){const e=I;return this.applyMatrix4(x[e(2957)])[e(3075)](x[e(2368)])}[I(1411)](x){const e=I,t=this.x,g=this.y,n=this.z,s=x.elements;return this.x=s[0]*t+s[4]*g+s[8]*n,this.y=s[1]*t+s[5]*g+s[9]*n,this.z=s[2]*t+s[6]*g+s[10]*n,this[e(3762)]()}divide(x){return this.x/=x.x,this.y/=x.y,this.z/=x.z,this}[I(648)](x){return this.multiplyScalar(1/x)}[I(1410)](x){const e=I;return this.x=Math[e(1410)](this.x,x.x),this.y=Math.min(this.y,x.y),this.z=Math[e(1410)](this.z,x.z),this}[I(1971)](x){const e=I;return this.x=Math[e(1971)](this.x,x.x),this.y=Math[e(1971)](this.y,x.y),this.z=Math[e(1971)](this.z,x.z),this}[I(3920)](x,e){const t=I;return this.x=Math[t(1971)](x.x,Math.min(e.x,this.x)),this.y=Math[t(1971)](x.y,Math[t(1410)](e.y,this.y)),this.z=Math[t(1971)](x.z,Math[t(1410)](e.z,this.z)),this}clampScalar(x,e){const t=I;return this.x=Math.max(x,Math[t(1410)](e,this.x)),this.y=Math.max(x,Math[t(1410)](e,this.y)),this.z=Math[t(1971)](x,Math.min(e,this.z)),this}[I(2782)](x,e){const t=I,g=this.length();return this[t(648)](g||1).multiplyScalar(Math[t(1971)](x,Math[t(1410)](e,g)))}[I(3143)](){const x=I;return this.x=Math[x(3143)](this.x),this.y=Math[x(3143)](this.y),this.z=Math[x(3143)](this.z),this}[I(2163)](){const x=I;return this.x=Math[x(2163)](this.x),this.y=Math[x(2163)](this.y),this.z=Math[x(2163)](this.z),this}[I(1008)](){const x=I;return this.x=Math[x(1008)](this.x),this.y=Math[x(1008)](this.y),this.z=Math[x(1008)](this.z),this}[I(697)](){const x=I;return this.x=Math[x(1948)](this.x),this.y=Math[x(1948)](this.y),this.z=Math[x(1948)](this.z),this}[I(3217)](){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}[I(1760)](x){return this.x*x.x+this.y*x.y+this.z*x.z}[I(1494)](){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math[I(3641)](this.x*this.x+this.y*this.y+this.z*this.z)}[I(3027)](){const x=I;return Math.abs(this.x)+Math[x(447)](this.y)+Math.abs(this.z)}[I(3762)](){const x=I;return this[x(648)](this[x(2989)]()||1)}[I(3231)](x){const e=I;return this.normalize()[e(2333)](x)}[I(3814)](x,e){return this.x+=(x.x-this.x)*e,this.y+=(x.y-this.y)*e,this.z+=(x.z-this.z)*e,this}[I(200)](x,e,t){return this.x=x.x+(e.x-x.x)*t,this.y=x.y+(e.y-x.y)*t,this.z=x.z+(e.z-x.z)*t,this}[I(1092)](x){return this[I(1604)](this,x)}[I(1604)](x,e){const t=x.x,g=x.y,n=x.z,s=e.x,o=e.y,c=e.z;return this.x=g*c-n*o,this.y=n*s-t*c,this.z=t*o-g*s,this}[I(442)](x){const e=I,t=x[e(1494)]();if(t===0)return this[e(298)](0,0,0);const g=x[e(1760)](this)/t;return this[e(1493)](x)[e(2333)](g)}[I(1611)](x){const e=I;return HA[e(1493)](this)[e(442)](x),this[e(3938)](HA)}reflect(x){const e=I;return this[e(3938)](HA[e(1493)](x).multiplyScalar(2*this.dot(x)))}[I(3400)](x){const e=I,t=Math[e(3641)](this[e(1494)]()*x.lengthSq());if(t===0)return Math.PI/2;const g=this.dot(x)/t;return Math[e(3102)](Ae(g,-1,1))}[I(3708)](x){const e=I;return Math[e(3641)](this[e(3489)](x))}distanceToSquared(x){const e=this.x-x.x,t=this.y-x.y,g=this.z-x.z;return e*e+t*t+g*g}[I(1801)](x){const e=I;return Math[e(447)](this.x-x.x)+Math[e(447)](this.y-x.y)+Math.abs(this.z-x.z)}[I(2370)](x){const e=I;return this[e(3298)](x[e(3015)],x[e(3242)],x[e(3507)])}[I(3298)](x,e,t){const g=I,n=Math[g(1996)](e)*x;return this.x=n*Math[g(1996)](t),this.y=Math[g(1563)](e)*x,this.z=n*Math[g(1563)](t),this}[I(2350)](x){const e=I;return this[e(3514)](x[e(3015)],x[e(3507)],x.y)}[I(3514)](x,e,t){const g=I;return this.x=x*Math[g(1996)](e),this.y=t,this.z=x*Math[g(1563)](e),this}setFromMatrixPosition(x){const e=x.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}[I(1128)](x){const e=I,t=this[e(3850)](x,0).length(),g=this[e(3850)](x,1)[e(2989)](),n=this[e(3850)](x,2)[e(2989)]();return this.x=t,this.y=g,this.z=n,this}setFromMatrixColumn(x,e){return this[I(2793)](x.elements,e*4)}[I(1956)](x,e){const t=I;return this.fromArray(x[t(2574)],e*3)}[I(2562)](x){return this.x=x._x,this.y=x._y,this.z=x._z,this}[I(2174)](x){return this.x=x.r,this.y=x.g,this.z=x.b,this}[I(3106)](x){return x.x===this.x&&x.y===this.y&&x.z===this.z}[I(2793)](x,e=0){return this.x=x[e],this.y=x[e+1],this.z=x[e+2],this}[I(3904)](x=[],e=0){return x[e]=this.x,x[e+1]=this.y,x[e+2]=this.z,x}[I(2404)](x,e){const t=I;return this.x=x[t(1829)](e),this.y=x[t(655)](e),this.z=x[t(2142)](e),this}[I(2938)](){const x=I;return this.x=Math[x(2938)](),this.y=Math[x(2938)](),this.z=Math.random(),this}[I(1016)](){const x=I,e=Math[x(2938)]()*Math.PI*2,t=Math[x(2938)]()*2-1,g=Math[x(3641)](1-t*t);return this.x=g*Math[x(1563)](e),this.y=t,this.z=g*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const HA=new E,JG=new ot;class yt{constructor(x=new E(1/0,1/0,1/0),e=new E(-1/0,-1/0,-1/0)){const t=I;this.isBox3=!0,this[t(1410)]=x,this[t(1971)]=e}[I(298)](x,e){const t=I;return this.min[t(1493)](x),this[t(1971)].copy(e),this}setFromArray(x){const e=I;this[e(3734)]();for(let t=0,g=x[e(2989)];t<g;t+=3)this.expandByPoint(Rg[e(2793)](x,t));return this}setFromBufferAttribute(x){const e=I;this[e(3734)]();for(let t=0,g=x[e(3411)];t<g;t++)this[e(3282)](Rg[e(2404)](x,t));return this}[I(1666)](x){const e=I;this.makeEmpty();for(let t=0,g=x[e(2989)];t<g;t++)this.expandByPoint(x[t]);return this}setFromCenterAndSize(x,e){const t=I,g=Rg[t(1493)](e)[t(2333)](.5);return this[t(1410)][t(1493)](x)[t(3938)](g),this[t(1971)][t(1493)](x)[t(3014)](g),this}[I(1854)](x,e=!1){return this.makeEmpty(),this.expandByObject(x,e)}[I(3123)](){const x=I;return new this.constructor()[x(1493)](this)}[I(1493)](x){const e=I;return this.min[e(1493)](x[e(1410)]),this[e(1971)].copy(x[e(1971)]),this}[I(3734)](){const x=I;return this.min.x=this[x(1410)].y=this[x(1410)].z=1/0,this[x(1971)].x=this[x(1971)].y=this[x(1971)].z=-1/0,this}[I(1303)](){const x=I;return this[x(1971)].x<this.min.x||this[x(1971)].y<this[x(1410)].y||this[x(1971)].z<this[x(1410)].z}[I(878)](x){const e=I;return this[e(1303)]()?x[e(298)](0,0,0):x[e(3107)](this.min,this[e(1971)]).multiplyScalar(.5)}[I(1277)](x){const e=I;return this[e(1303)]()?x[e(298)](0,0,0):x.subVectors(this[e(1971)],this[e(1410)])}[I(3282)](x){const e=I;return this[e(1410)].min(x),this[e(1971)][e(1971)](x),this}expandByVector(x){const e=I;return this.min[e(3938)](x),this.max[e(3014)](x),this}[I(2698)](x){const e=I;return this[e(1410)][e(1440)](-x),this[e(1971)].addScalar(x),this}expandByObject(x,e=!1){const t=I;x[t(2144)](!1,!1);const g=x[t(352)];if(g!==void 0){const s=g[t(2606)]("position");if(e===!0&&s!==void 0&&x[t(2369)]!==!0)for(let o=0,c=s.count;o<c;o++)x.isMesh===!0?x.getVertexPosition(o,Rg):Rg[t(2404)](s,o),Rg[t(3075)](x[t(2368)]),this[t(3282)](Rg);else x.boundingBox!==void 0?(x[t(3344)]===null&&x.computeBoundingBox(),sa.copy(x[t(3344)])):(g.boundingBox===null&&g[t(3775)](),sa.copy(g[t(3344)])),sa.applyMatrix4(x[t(2368)]),this[t(2092)](sa)}const n=x.children;for(let s=0,o=n[t(2989)];s<o;s++)this[t(3584)](n[s],e);return this}[I(2035)](x){const e=I;return!(x.x<this.min.x||x.x>this[e(1971)].x||x.y<this[e(1410)].y||x.y>this[e(1971)].y||x.z<this[e(1410)].z||x.z>this[e(1971)].z)}[I(3095)](x){const e=I;return this[e(1410)].x<=x[e(1410)].x&&x[e(1971)].x<=this[e(1971)].x&&this[e(1410)].y<=x[e(1410)].y&&x[e(1971)].y<=this[e(1971)].y&&this[e(1410)].z<=x[e(1410)].z&&x[e(1971)].z<=this.max.z}[I(2961)](x,e){const t=I;return e[t(298)]((x.x-this[t(1410)].x)/(this[t(1971)].x-this[t(1410)].x),(x.y-this[t(1410)].y)/(this[t(1971)].y-this[t(1410)].y),(x.z-this[t(1410)].z)/(this[t(1971)].z-this[t(1410)].z))}[I(2425)](x){const e=I;return!(x[e(1971)].x<this[e(1410)].x||x[e(1410)].x>this[e(1971)].x||x.max.y<this[e(1410)].y||x.min.y>this[e(1971)].y||x[e(1971)].z<this[e(1410)].z||x[e(1410)].z>this.max.z)}[I(3195)](x){const e=I;return this[e(787)](x[e(3416)],Rg),Rg[e(3489)](x[e(3416)])<=x[e(3015)]*x[e(3015)]}[I(2536)](x){const e=I;let t,g;return x[e(3204)].x>0?(t=x.normal.x*this[e(1410)].x,g=x.normal.x*this[e(1971)].x):(t=x[e(3204)].x*this[e(1971)].x,g=x[e(3204)].x*this[e(1410)].x),x[e(3204)].y>0?(t+=x[e(3204)].y*this[e(1410)].y,g+=x.normal.y*this[e(1971)].y):(t+=x[e(3204)].y*this.max.y,g+=x[e(3204)].y*this.min.y),x.normal.z>0?(t+=x[e(3204)].z*this[e(1410)].z,g+=x.normal.z*this[e(1971)].z):(t+=x[e(3204)].z*this.max.z,g+=x.normal.z*this[e(1410)].z),t<=-x[e(1818)]&&g>=-x.constant}[I(3349)](x){const e=I;if(this[e(1303)]())return!1;this[e(878)](nc),oa[e(859)](this[e(1971)],nc),cs[e(859)](x.a,nc),Cs.subVectors(x.b,nc),ls[e(859)](x.c,nc),sn[e(859)](Cs,cs),on[e(859)](ls,Cs),jn[e(859)](cs,ls);let t=[0,-sn.z,sn.y,0,-on.z,on.y,0,-jn.z,jn.y,sn.z,0,-sn.x,on.z,0,-on.x,jn.z,0,-jn.x,-sn.y,sn.x,0,-on.y,on.x,0,-jn.y,jn.x,0];return!NA(t,cs,Cs,ls,oa)||(t=[1,0,0,0,1,0,0,0,1],!NA(t,cs,Cs,ls,oa))?!1:(ca[e(1604)](sn,on),t=[ca.x,ca.y,ca.z],NA(t,cs,Cs,ls,oa))}[I(787)](x,e){const t=I;return e[t(1493)](x)[t(3920)](this[t(1410)],this.max)}[I(2587)](x){const e=I;return this[e(787)](x,Rg)[e(3708)](x)}getBoundingSphere(x){const e=I;return this[e(1303)]()?x[e(3734)]():(this[e(878)](x[e(3416)]),x[e(3015)]=this[e(1277)](Rg)[e(2989)]()*.5),x}intersect(x){const e=I;return this[e(1410)][e(1971)](x[e(1410)]),this[e(1971)].min(x.max),this[e(1303)]()&&this.makeEmpty(),this}[I(2092)](x){const e=I;return this[e(1410)][e(1410)](x[e(1410)]),this.max[e(1971)](x[e(1971)]),this}[I(3075)](x){const e=I;return this.isEmpty()?this:(pi[0][e(298)](this.min.x,this[e(1410)].y,this[e(1410)].z)[e(3075)](x),pi[1][e(298)](this[e(1410)].x,this.min.y,this[e(1971)].z)[e(3075)](x),pi[2][e(298)](this[e(1410)].x,this[e(1971)].y,this[e(1410)].z)[e(3075)](x),pi[3][e(298)](this.min.x,this.max.y,this[e(1971)].z).applyMatrix4(x),pi[4][e(298)](this[e(1971)].x,this[e(1410)].y,this[e(1410)].z).applyMatrix4(x),pi[5][e(298)](this[e(1971)].x,this.min.y,this[e(1971)].z).applyMatrix4(x),pi[6][e(298)](this.max.x,this[e(1971)].y,this[e(1410)].z).applyMatrix4(x),pi[7][e(298)](this.max.x,this[e(1971)].y,this[e(1971)].z)[e(3075)](x),this[e(1666)](pi),this)}[I(2945)](x){const e=I;return this[e(1410)][e(3014)](x),this[e(1971)][e(3014)](x),this}equals(x){const e=I;return x[e(1410)][e(3106)](this[e(1410)])&&x[e(1971)][e(3106)](this[e(1971)])}}const pi=[new E,new E,new E,new E,new E,new E,new E,new E],Rg=new E,sa=new yt,cs=new E,Cs=new E,ls=new E,sn=new E,on=new E,jn=new E,nc=new E,oa=new E,ca=new E,xI=new E;function NA(i,x,e,t,g){const n=I;for(let s=0,o=i[n(2989)]-3;s<=o;s+=3){xI[n(2793)](i,s);const c=g.x*Math[n(447)](xI.x)+g.y*Math[n(447)](xI.y)+g.z*Math.abs(xI.z),C=x[n(1760)](xI),r=e.dot(xI),A=t[n(1760)](xI);if(Math[n(1971)](-Math[n(1971)](C,r,A),Math[n(1410)](C,r,A))>c)return!1}return!0}const NS=new yt,Ic=new E,FA=new E;class ct{constructor(x=new E,e=-1){const t=I;this[t(1622)]=!0,this[t(3416)]=x,this.radius=e}[I(298)](x,e){const t=I;return this[t(3416)][t(1493)](x),this[t(3015)]=e,this}[I(1666)](x,e){const t=I,g=this[t(3416)];e!==void 0?g[t(1493)](e):NS[t(1666)](x)[t(878)](g);let n=0;for(let s=0,o=x[t(2989)];s<o;s++)n=Math[t(1971)](n,g[t(3489)](x[s]));return this[t(3015)]=Math[t(3641)](n),this}[I(1493)](x){const e=I;return this[e(3416)][e(1493)](x.center),this[e(3015)]=x[e(3015)],this}[I(1303)](){return this[I(3015)]<0}[I(3734)](){const x=I;return this.center[x(298)](0,0,0),this[x(3015)]=-1,this}[I(2035)](x){const e=I;return x.distanceToSquared(this[e(3416)])<=this[e(3015)]*this.radius}[I(2587)](x){return x[I(3708)](this.center)-this.radius}[I(3195)](x){const e=I,t=this[e(3015)]+x.radius;return x.center.distanceToSquared(this.center)<=t*t}[I(2425)](x){return x[I(3195)](this)}intersectsPlane(x){const e=I;return Math[e(447)](x.distanceToPoint(this[e(3416)]))<=this[e(3015)]}clampPoint(x,e){const t=I,g=this.center.distanceToSquared(x);return e.copy(x),g>this.radius*this[t(3015)]&&(e[t(3938)](this[t(3416)])[t(3762)](),e[t(2333)](this.radius)[t(3014)](this[t(3416)])),e}[I(3890)](x){const e=I;return this.isEmpty()?(x[e(3734)](),x):(x[e(298)](this[e(3416)],this[e(3416)]),x.expandByScalar(this[e(3015)]),x)}[I(3075)](x){const e=I;return this[e(3416)].applyMatrix4(x),this[e(3015)]=this[e(3015)]*x[e(1471)](),this}translate(x){const e=I;return this[e(3416)][e(3014)](x),this}[I(3282)](x){const e=I;if(this[e(1303)]())return this[e(3416)][e(1493)](x),this[e(3015)]=0,this;Ic[e(859)](x,this[e(3416)]);const t=Ic[e(1494)]();if(t>this[e(3015)]*this[e(3015)]){const g=Math.sqrt(t),n=(g-this.radius)*.5;this[e(3416)][e(832)](Ic,n/g),this[e(3015)]+=n}return this}[I(2092)](x){const e=I;return x[e(1303)]()?this:this.isEmpty()?(this[e(1493)](x),this):(this[e(3416)][e(3106)](x[e(3416)])===!0?this[e(3015)]=Math.max(this[e(3015)],x[e(3015)]):(FA[e(859)](x[e(3416)],this[e(3416)]).setLength(x[e(3015)]),this.expandByPoint(Ic[e(1493)](x[e(3416)])[e(3014)](FA)),this.expandByPoint(Ic[e(1493)](x[e(3416)]).sub(FA))),this)}equals(x){const e=I;return x[e(3416)][e(3106)](this[e(3416)])&&x.radius===this.radius}clone(){const x=I;return new this[x(135)]()[x(1493)](this)}}const Bi=new E,zA=new E,Ca=new E,cn=new E,MA=new E,la=new E,LA=new E;let vo=class{constructor(x=new E,e=new E(0,0,-1)){const t=I;this[t(3519)]=x,this[t(2721)]=e}[I(298)](x,e){const t=I;return this.origin[t(1493)](x),this[t(2721)][t(1493)](e),this}[I(1493)](x){const e=I;return this[e(3519)][e(1493)](x[e(3519)]),this[e(2721)][e(1493)](x[e(2721)]),this}at(x,e){const t=I;return e[t(1493)](this[t(3519)])[t(832)](this[t(2721)],x)}[I(2765)](x){const e=I;return this[e(2721)].copy(x)[e(3938)](this[e(3519)])[e(3762)](),this}[I(2439)](x){const e=I;return this[e(3519)][e(1493)](this.at(x,Bi)),this}[I(130)](x,e){const t=I;e[t(859)](x,this.origin);const g=e.dot(this[t(2721)]);return g<0?e[t(1493)](this[t(3519)]):e[t(1493)](this[t(3519)])[t(832)](this.direction,g)}[I(2587)](x){const e=I;return Math[e(3641)](this[e(3846)](x))}[I(3846)](x){const e=I,t=Bi.subVectors(x,this[e(3519)])[e(1760)](this[e(2721)]);return t<0?this[e(3519)][e(3489)](x):(Bi[e(1493)](this[e(3519)])[e(832)](this[e(2721)],t),Bi[e(3489)](x))}[I(1151)](x,e,t,g){const n=I;zA[n(1493)](x)[n(3014)](e)[n(2333)](.5),Ca[n(1493)](e)[n(3938)](x)[n(3762)](),cn.copy(this[n(3519)]).sub(zA);const s=x.distanceTo(e)*.5,o=-this[n(2721)][n(1760)](Ca),c=cn.dot(this.direction),C=-cn[n(1760)](Ca),r=cn[n(1494)](),A=Math.abs(1-o*o);let d,h,f,B;if(A>0)if(d=o*C-c,h=o*c-C,B=s*A,d>=0)if(h>=-B)if(h<=B){const Z=1/A;d*=Z,h*=Z,f=d*(d+o*h+2*c)+h*(o*d+h+2*C)+r}else h=s,d=Math[n(1971)](0,-(o*h+c)),f=-d*d+h*(h+2*C)+r;else h=-s,d=Math.max(0,-(o*h+c)),f=-d*d+h*(h+2*C)+r;else h<=-B?(d=Math[n(1971)](0,-(-o*s+c)),h=d>0?-s:Math[n(1410)](Math[n(1971)](-s,-C),s),f=-d*d+h*(h+2*C)+r):h<=B?(d=0,h=Math[n(1410)](Math.max(-s,-C),s),f=h*(h+2*C)+r):(d=Math[n(1971)](0,-(o*s+c)),h=d>0?s:Math[n(1410)](Math.max(-s,-C),s),f=-d*d+h*(h+2*C)+r);else h=o>0?-s:s,d=Math[n(1971)](0,-(o*h+c)),f=-d*d+h*(h+2*C)+r;return t&&t.copy(this[n(3519)])[n(832)](this[n(2721)],d),g&&g.copy(zA).addScaledVector(Ca,h),f}[I(1298)](x,e){const t=I;Bi.subVectors(x[t(3416)],this[t(3519)]);const g=Bi[t(1760)](this[t(2721)]),n=Bi[t(1760)](Bi)-g*g,s=x[t(3015)]*x[t(3015)];if(n>s)return null;const o=Math[t(3641)](s-n),c=g-o,C=g+o;return C<0?null:c<0?this.at(C,e):this.at(c,e)}[I(3195)](x){const e=I;return this[e(3846)](x[e(3416)])<=x[e(3015)]*x[e(3015)]}[I(1684)](x){const e=I,t=x[e(3204)][e(1760)](this[e(2721)]);if(t===0)return x[e(2587)](this[e(3519)])===0?0:null;const g=-(this[e(3519)][e(1760)](x[e(3204)])+x[e(1818)])/t;return g>=0?g:null}intersectPlane(x,e){const t=I,g=this[t(1684)](x);return g===null?null:this.at(g,e)}[I(2536)](x){const e=I,t=x[e(2587)](this[e(3519)]);return t===0||x[e(3204)][e(1760)](this[e(2721)])*t<0}[I(3294)](x,e){const t=I;let g,n,s,o,c,C;const r=1/this[t(2721)].x,A=1/this[t(2721)].y,d=1/this[t(2721)].z,h=this[t(3519)];return r>=0?(g=(x[t(1410)].x-h.x)*r,n=(x[t(1971)].x-h.x)*r):(g=(x[t(1971)].x-h.x)*r,n=(x.min.x-h.x)*r),A>=0?(s=(x.min.y-h.y)*A,o=(x[t(1971)].y-h.y)*A):(s=(x[t(1971)].y-h.y)*A,o=(x.min.y-h.y)*A),g>o||s>n||((s>g||isNaN(g))&&(g=s),(o<n||isNaN(n))&&(n=o),d>=0?(c=(x[t(1410)].z-h.z)*d,C=(x[t(1971)].z-h.z)*d):(c=(x[t(1971)].z-h.z)*d,C=(x[t(1410)].z-h.z)*d),g>C||c>n)||((c>g||g!==g)&&(g=c),(C<n||n!==n)&&(n=C),n<0)?null:this.at(g>=0?g:n,e)}[I(2425)](x){return this[I(3294)](x,Bi)!==null}[I(3745)](x,e,t,g,n){const s=I;MA[s(859)](e,x),la[s(859)](t,x),LA[s(1604)](MA,la);let o=this[s(2721)][s(1760)](LA),c;if(o>0){if(g)return null;c=1}else if(o<0)c=-1,o=-o;else return null;cn[s(859)](this[s(3519)],x);const C=c*this[s(2721)].dot(la[s(1604)](cn,la));if(C<0)return null;const r=c*this.direction[s(1760)](MA[s(1092)](cn));if(r<0||C+r>o)return null;const A=-c*cn[s(1760)](LA);return A<0?null:this.at(A/o,n)}applyMatrix4(x){const e=I;return this[e(3519)][e(3075)](x),this[e(2721)][e(1411)](x),this}equals(x){const e=I;return x.origin.equals(this[e(3519)])&&x[e(2721)][e(3106)](this[e(2721)])}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}};class dx{constructor(x,e,t,g,n,s,o,c,C,r,A,d,h,f,B,Z){const G=I;dx[G(1566)][G(299)]=!0,this[G(2574)]=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x!==void 0&&this[G(298)](x,e,t,g,n,s,o,c,C,r,A,d,h,f,B,Z)}set(x,e,t,g,n,s,o,c,C,r,A,d,h,f,B,Z){const G=I,m=this[G(2574)];return m[0]=x,m[4]=e,m[8]=t,m[12]=g,m[1]=n,m[5]=s,m[9]=o,m[13]=c,m[2]=C,m[6]=r,m[10]=A,m[14]=d,m[3]=h,m[7]=f,m[11]=B,m[15]=Z,this}identity(){return this[I(298)](1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}[I(3123)](){const x=I;return new dx()[x(2793)](this[x(2574)])}copy(x){const e=I,t=this[e(2574)],g=x.elements;return t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3],t[4]=g[4],t[5]=g[5],t[6]=g[6],t[7]=g[7],t[8]=g[8],t[9]=g[9],t[10]=g[10],t[11]=g[11],t[12]=g[12],t[13]=g[13],t[14]=g[14],t[15]=g[15],this}[I(319)](x){const e=I,t=this.elements,g=x[e(2574)];return t[12]=g[12],t[13]=g[13],t[14]=g[14],this}[I(1768)](x){const e=I,t=x[e(2574)];return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}[I(1056)](x,e,t){return x[I(3850)](this,0),e.setFromMatrixColumn(this,1),t.setFromMatrixColumn(this,2),this}[I(3818)](x,e,t){return this[I(298)](x.x,e.x,t.x,0,x.y,e.y,t.y,0,x.z,e.z,t.z,0,0,0,0,1),this}[I(3009)](x){const e=I,t=this.elements,g=x.elements,n=1/as.setFromMatrixColumn(x,0)[e(2989)](),s=1/as[e(3850)](x,1)[e(2989)](),o=1/as.setFromMatrixColumn(x,2)[e(2989)]();return t[0]=g[0]*n,t[1]=g[1]*n,t[2]=g[2]*n,t[3]=0,t[4]=g[4]*s,t[5]=g[5]*s,t[6]=g[6]*s,t[7]=0,t[8]=g[8]*o,t[9]=g[9]*o,t[10]=g[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}[I(1112)](x){const e=I,t=this.elements,g=x.x,n=x.y,s=x.z,o=Math[e(1563)](g),c=Math[e(1996)](g),C=Math.cos(n),r=Math[e(1996)](n),A=Math[e(1563)](s),d=Math[e(1996)](s);if(x[e(373)]===e(782)){const h=o*A,f=o*d,B=c*A,Z=c*d;t[0]=C*A,t[4]=-C*d,t[8]=r,t[1]=f+B*r,t[5]=h-Z*r,t[9]=-c*C,t[2]=Z-h*r,t[6]=B+f*r,t[10]=o*C}else if(x[e(373)]===e(3131)){const h=C*A,f=C*d,B=r*A,Z=r*d;t[0]=h+Z*c,t[4]=B*c-f,t[8]=o*r,t[1]=o*d,t[5]=o*A,t[9]=-c,t[2]=f*c-B,t[6]=Z+h*c,t[10]=o*C}else if(x.order==="ZXY"){const h=C*A,f=C*d,B=r*A,Z=r*d;t[0]=h-Z*c,t[4]=-o*d,t[8]=B+f*c,t[1]=f+B*c,t[5]=o*A,t[9]=Z-h*c,t[2]=-o*r,t[6]=c,t[10]=o*C}else if(x.order==="ZYX"){const h=o*A,f=o*d,B=c*A,Z=c*d;t[0]=C*A,t[4]=B*r-f,t[8]=h*r+Z,t[1]=C*d,t[5]=Z*r+h,t[9]=f*r-B,t[2]=-r,t[6]=c*C,t[10]=o*C}else if(x[e(373)]==="YZX"){const h=o*C,f=o*r,B=c*C,Z=c*r;t[0]=C*A,t[4]=Z-h*d,t[8]=B*d+f,t[1]=d,t[5]=o*A,t[9]=-c*A,t[2]=-r*A,t[6]=f*d+B,t[10]=h-Z*d}else if(x[e(373)]===e(885)){const h=o*C,f=o*r,B=c*C,Z=c*r;t[0]=C*A,t[4]=-d,t[8]=r*A,t[1]=h*d+Z,t[5]=o*A,t[9]=f*d-B,t[2]=B*d-f,t[6]=c*A,t[10]=Z*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}[I(764)](x){return this[I(1669)](FS,x,zS)}[I(2765)](x,e,t){const g=I,n=this[g(2574)];return Ot[g(859)](x,e),Ot.lengthSq()===0&&(Ot.z=1),Ot.normalize(),Cn[g(1604)](t,Ot),Cn[g(1494)]()===0&&(Math[g(447)](t.z)===1?Ot.x+=1e-4:Ot.z+=1e-4,Ot[g(3762)](),Cn[g(1604)](t,Ot)),Cn[g(3762)](),aa[g(1604)](Ot,Cn),n[0]=Cn.x,n[4]=aa.x,n[8]=Ot.x,n[1]=Cn.y,n[5]=aa.y,n[9]=Ot.y,n[2]=Cn.z,n[6]=aa.z,n[10]=Ot.z,this}[I(327)](x){return this[I(1418)](this,x)}premultiply(x){return this.multiplyMatrices(x,this)}[I(1418)](x,e){const t=I,g=x.elements,n=e[t(2574)],s=this[t(2574)],o=g[0],c=g[4],C=g[8],r=g[12],A=g[1],d=g[5],h=g[9],f=g[13],B=g[2],Z=g[6],G=g[10],m=g[14],v=g[3],p=g[7],w=g[11],V=g[15],N=n[0],X=n[4],M=n[8],Y=n[12],S=n[1],H=n[5],O=n[9],I0=n[13],z=n[2],b0=n[6],f0=n[10],G0=n[14],$=n[3],j=n[7],x0=n[11],c0=n[15];return s[0]=o*N+c*S+C*z+r*$,s[4]=o*X+c*H+C*b0+r*j,s[8]=o*M+c*O+C*f0+r*x0,s[12]=o*Y+c*I0+C*G0+r*c0,s[1]=A*N+d*S+h*z+f*$,s[5]=A*X+d*H+h*b0+f*j,s[9]=A*M+d*O+h*f0+f*x0,s[13]=A*Y+d*I0+h*G0+f*c0,s[2]=B*N+Z*S+G*z+m*$,s[6]=B*X+Z*H+G*b0+m*j,s[10]=B*M+Z*O+G*f0+m*x0,s[14]=B*Y+Z*I0+G*G0+m*c0,s[3]=v*N+p*S+w*z+V*$,s[7]=v*X+p*H+w*b0+V*j,s[11]=v*M+p*O+w*f0+V*x0,s[15]=v*Y+p*I0+w*G0+V*c0,this}[I(2333)](x){const e=I,t=this[e(2574)];return t[0]*=x,t[4]*=x,t[8]*=x,t[12]*=x,t[1]*=x,t[5]*=x,t[9]*=x,t[13]*=x,t[2]*=x,t[6]*=x,t[10]*=x,t[14]*=x,t[3]*=x,t[7]*=x,t[11]*=x,t[15]*=x,this}[I(345)](){const x=I,e=this[x(2574)],t=e[0],g=e[4],n=e[8],s=e[12],o=e[1],c=e[5],C=e[9],r=e[13],A=e[2],d=e[6],h=e[10],f=e[14],B=e[3],Z=e[7],G=e[11],m=e[15];return B*(+s*C*d-n*r*d-s*c*h+g*r*h+n*c*f-g*C*f)+Z*(+t*C*f-t*r*h+s*o*h-n*o*f+n*r*A-s*C*A)+G*(+t*r*d-t*c*f-s*o*d+g*o*f+s*c*A-g*r*A)+m*(-n*c*A-t*C*d+t*c*h+n*o*d-g*o*h+g*C*A)}[I(2795)](){const x=I,e=this[x(2574)];let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(x,e,t){const g=I,n=this[g(2574)];return x[g(2752)]?(n[12]=x.x,n[13]=x.y,n[14]=x.z):(n[12]=x,n[13]=e,n[14]=t),this}[I(2483)](){const x=I,e=this[x(2574)],t=e[0],g=e[1],n=e[2],s=e[3],o=e[4],c=e[5],C=e[6],r=e[7],A=e[8],d=e[9],h=e[10],f=e[11],B=e[12],Z=e[13],G=e[14],m=e[15],v=d*G*r-Z*h*r+Z*C*f-c*G*f-d*C*m+c*h*m,p=B*h*r-A*G*r-B*C*f+o*G*f+A*C*m-o*h*m,w=A*Z*r-B*d*r+B*c*f-o*Z*f-A*c*m+o*d*m,V=B*d*C-A*Z*C-B*c*h+o*Z*h+A*c*G-o*d*G,N=t*v+g*p+n*w+s*V;if(N===0)return this[x(298)](0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const X=1/N;return e[0]=v*X,e[1]=(Z*h*s-d*G*s-Z*n*f+g*G*f+d*n*m-g*h*m)*X,e[2]=(c*G*s-Z*C*s+Z*n*r-g*G*r-c*n*m+g*C*m)*X,e[3]=(d*C*s-c*h*s-d*n*r+g*h*r+c*n*f-g*C*f)*X,e[4]=p*X,e[5]=(A*G*s-B*h*s+B*n*f-t*G*f-A*n*m+t*h*m)*X,e[6]=(B*C*s-o*G*s-B*n*r+t*G*r+o*n*m-t*C*m)*X,e[7]=(o*h*s-A*C*s+A*n*r-t*h*r-o*n*f+t*C*f)*X,e[8]=w*X,e[9]=(B*d*s-A*Z*s-B*g*f+t*Z*f+A*g*m-t*d*m)*X,e[10]=(o*Z*s-B*c*s+B*g*r-t*Z*r-o*g*m+t*c*m)*X,e[11]=(A*c*s-o*d*s-A*g*r+t*d*r+o*g*f-t*c*f)*X,e[12]=V*X,e[13]=(A*Z*n-B*d*n+B*g*h-t*Z*h-A*g*G+t*d*G)*X,e[14]=(B*c*n-o*Z*n-B*g*C+t*Z*C+o*g*G-t*c*G)*X,e[15]=(o*d*n-A*c*n+A*g*C-t*d*C-o*g*h+t*c*h)*X,this}scale(x){const e=I,t=this[e(2574)],g=x.x,n=x.y,s=x.z;return t[0]*=g,t[4]*=n,t[8]*=s,t[1]*=g,t[5]*=n,t[9]*=s,t[2]*=g,t[6]*=n,t[10]*=s,t[3]*=g,t[7]*=n,t[11]*=s,this}[I(1471)](){const x=I,e=this[x(2574)],t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],g=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math[x(3641)](Math.max(t,g,n))}[I(804)](x,e,t){const g=I;return x.isVector3?this[g(298)](1,0,0,x.x,0,1,0,x.y,0,0,1,x.z,0,0,0,1):this[g(298)](1,0,0,x,0,1,0,e,0,0,1,t,0,0,0,1),this}makeRotationX(x){const e=I,t=Math[e(1563)](x),g=Math[e(1996)](x);return this.set(1,0,0,0,0,t,-g,0,0,g,t,0,0,0,0,1),this}makeRotationY(x){const e=I,t=Math.cos(x),g=Math[e(1996)](x);return this[e(298)](t,0,g,0,0,1,0,0,-g,0,t,0,0,0,0,1),this}[I(2533)](x){const e=I,t=Math.cos(x),g=Math[e(1996)](x);return this[e(298)](t,-g,0,0,g,t,0,0,0,0,1,0,0,0,0,1),this}[I(3034)](x,e){const t=I,g=Math.cos(e),n=Math[t(1996)](e),s=1-g,o=x.x,c=x.y,C=x.z,r=s*o,A=s*c;return this[t(298)](r*o+g,r*c-n*C,r*C+n*c,0,r*c+n*C,A*c+g,A*C-n*o,0,r*C-n*c,A*C+n*o,s*C*C+g,0,0,0,0,1),this}[I(1761)](x,e,t){return this[I(298)](x,0,0,0,0,e,0,0,0,0,t,0,0,0,0,1),this}[I(2432)](x,e,t,g,n,s){return this[I(298)](1,t,n,0,x,1,s,0,e,g,1,0,0,0,0,1),this}compose(x,e,t){const g=I,n=this[g(2574)],s=e._x,o=e._y,c=e._z,C=e._w,r=s+s,A=o+o,d=c+c,h=s*r,f=s*A,B=s*d,Z=o*A,G=o*d,m=c*d,v=C*r,p=C*A,w=C*d,V=t.x,N=t.y,X=t.z;return n[0]=(1-(Z+m))*V,n[1]=(f+w)*V,n[2]=(B-p)*V,n[3]=0,n[4]=(f-w)*N,n[5]=(1-(h+m))*N,n[6]=(G+v)*N,n[7]=0,n[8]=(B+p)*X,n[9]=(G-v)*X,n[10]=(1-(h+Z))*X,n[11]=0,n[12]=x.x,n[13]=x.y,n[14]=x.z,n[15]=1,this}[I(2986)](x,e,t){const g=I,n=this[g(2574)];let s=as[g(298)](n[0],n[1],n[2])[g(2989)]();const o=as[g(298)](n[4],n[5],n[6])[g(2989)](),c=as[g(298)](n[8],n[9],n[10]).length();this[g(345)]()<0&&(s=-s),x.x=n[12],x.y=n[13],x.z=n[14],Vg[g(1493)](this);const r=1/s,A=1/o,d=1/c;return Vg[g(2574)][0]*=r,Vg[g(2574)][1]*=r,Vg[g(2574)][2]*=r,Vg[g(2574)][4]*=A,Vg[g(2574)][5]*=A,Vg.elements[6]*=A,Vg[g(2574)][8]*=d,Vg.elements[9]*=d,Vg[g(2574)][10]*=d,e.setFromRotationMatrix(Vg),t.x=s,t.y=o,t.z=c,this}makePerspective(x,e,t,g,n,s,o=ci){const c=I,C=this.elements,r=2*n/(e-x),A=2*n/(t-g),d=(e+x)/(e-x),h=(t+g)/(t-g);let f,B;if(o===ci)f=-(s+n)/(s-n),B=-2*s*n/(s-n);else if(o===hC)f=-s/(s-n),B=-s*n/(s-n);else throw new Error(c(3483)+o);return C[0]=r,C[4]=0,C[8]=d,C[12]=0,C[1]=0,C[5]=A,C[9]=h,C[13]=0,C[2]=0,C[6]=0,C[10]=f,C[14]=B,C[3]=0,C[7]=0,C[11]=-1,C[15]=0,this}[I(807)](x,e,t,g,n,s,o=ci){const c=I,C=this[c(2574)],r=1/(e-x),A=1/(t-g),d=1/(s-n),h=(e+x)*r,f=(t+g)*A;let B,Z;if(o===ci)B=(s+n)*d,Z=-2*d;else if(o===hC)B=n*d,Z=-1*d;else throw new Error(c(2788)+o);return C[0]=2*r,C[4]=0,C[8]=0,C[12]=-h,C[1]=0,C[5]=2*A,C[9]=0,C[13]=-f,C[2]=0,C[6]=0,C[10]=Z,C[14]=-B,C[3]=0,C[7]=0,C[11]=0,C[15]=1,this}[I(3106)](x){const e=I,t=this[e(2574)],g=x[e(2574)];for(let n=0;n<16;n++)if(t[n]!==g[n])return!1;return!0}[I(2793)](x,e=0){const t=I;for(let g=0;g<16;g++)this[t(2574)][g]=x[g+e];return this}[I(3904)](x=[],e=0){const t=this.elements;return x[e]=t[0],x[e+1]=t[1],x[e+2]=t[2],x[e+3]=t[3],x[e+4]=t[4],x[e+5]=t[5],x[e+6]=t[6],x[e+7]=t[7],x[e+8]=t[8],x[e+9]=t[9],x[e+10]=t[10],x[e+11]=t[11],x[e+12]=t[12],x[e+13]=t[13],x[e+14]=t[14],x[e+15]=t[15],x}}const as=new E,Vg=new dx,FS=new E(0,0,0),zS=new E(1,1,1),Cn=new E,aa=new E,Ot=new E,EG=new dx,UG=new ot;class Tt{constructor(x=0,e=0,t=0,g=Tt[I(2755)]){const n=I;this[n(1219)]=!0,this._x=x,this._y=e,this._z=t,this[n(710)]=g}get x(){return this._x}set x(x){const e=I;this._x=x,this[e(3700)]()}get y(){return this._y}set y(x){const e=I;this._y=x,this[e(3700)]()}get z(){return this._z}set z(x){const e=I;this._z=x,this[e(3700)]()}get[I(373)](){return this[I(710)]}set[I(373)](x){const e=I;this[e(710)]=x,this._onChangeCallback()}[I(298)](x,e,t,g=this[I(710)]){const n=I;return this._x=x,this._y=e,this._z=t,this[n(710)]=g,this[n(3700)](),this}clone(){const x=I;return new this[x(135)](this._x,this._y,this._z,this[x(710)])}copy(x){const e=I;return this._x=x._x,this._y=x._y,this._z=x._z,this._order=x[e(710)],this[e(3700)](),this}[I(3924)](x,e=this[I(710)],t=!0){const g=I,n=x[g(2574)],s=n[0],o=n[4],c=n[8],C=n[1],r=n[5],A=n[9],d=n[2],h=n[6],f=n[10];switch(e){case g(782):this._y=Math.asin(Ae(c,-1,1)),Math[g(447)](c)<.9999999?(this._x=Math[g(435)](-A,f),this._z=Math[g(435)](-o,s)):(this._x=Math[g(435)](h,r),this._z=0);break;case"YXZ":this._x=Math.asin(-Ae(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math[g(435)](c,f),this._z=Math[g(435)](C,r)):(this._y=Math[g(435)](-d,s),this._z=0);break;case g(270):this._x=Math[g(3629)](Ae(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math[g(435)](-d,f),this._z=Math[g(435)](-o,r)):(this._y=0,this._z=Math.atan2(C,s));break;case g(3758):this._y=Math[g(3629)](-Ae(d,-1,1)),Math[g(447)](d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(C,s)):(this._x=0,this._z=Math[g(435)](-o,r));break;case"YZX":this._z=Math[g(3629)](Ae(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math[g(435)](-A,r),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math[g(435)](c,f));break;case"XZY":this._z=Math[g(3629)](-Ae(o,-1,1)),Math[g(447)](o)<.9999999?(this._x=Math[g(435)](h,r),this._y=Math[g(435)](c,s)):(this._x=Math.atan2(-A,f),this._y=0);break;default:console[g(3748)](g(1338)+e)}return this._order=e,t===!0&&this[g(3700)](),this}[I(2802)](x,e,t){const g=I;return EG[g(764)](x),this[g(3924)](EG,e,t)}[I(1632)](x,e=this[I(710)]){return this[I(298)](x.x,x.y,x.z,e)}[I(3244)](x){const e=I;return UG.setFromEuler(this),this[e(2802)](UG,x)}equals(x){return x._x===this._x&&x._y===this._y&&x._z===this._z&&x._order===this._order}[I(2793)](x){const e=I;return this._x=x[0],this._y=x[1],this._z=x[2],x[3]!==void 0&&(this[e(710)]=x[3]),this[e(3700)](),this}[I(3904)](x=[],e=0){return x[e]=this._x,x[e+1]=this._y,x[e+2]=this._z,x[e+3]=this._order,x}[I(292)](x){const e=I;return this[e(3700)]=x,this}[I(3700)](){}*[Symbol[I(2880)]](){const x=I;yield this._x,yield this._y,yield this._z,yield this[x(710)]}}Tt[I(2755)]=I(782);class KI{constructor(){const x=I;this[x(829)]=1}set(x){this.mask=(1<<x|0)>>>0}enable(x){const e=I;this[e(829)]|=1<<x|0}[I(2966)](){const x=I;this[x(829)]=-1}[I(526)](x){const e=I;this[e(829)]^=1<<x|0}[I(3994)](x){const e=I;this[e(829)]&=~(1<<x|0)}disableAll(){const x=I;this[x(829)]=0}[I(3633)](x){const e=I;return(this[e(829)]&x[e(829)])!==0}isEnabled(x){return(this.mask&(1<<x|0))!==0}}let MS=0;const _G=new E,rs=new ot,Zi=new dx,ra=new E,sc=new E,LS=new E,kS=new ot,DG=new E(1,0,0),QG=new E(0,1,0),PG=new E(0,0,1),OG={type:I(118)},TS={type:I(1468)},ds={type:I(488),child:null},kA={type:I(1845),child:null};class Nx extends Qi{constructor(){const x=I;super(),this[x(3985)]=!0,Object[x(2899)](this,"id",{value:MS++}),this[x(296)]=gg(),this[x(1474)]="",this[x(3505)]=x(1417),this[x(1064)]=null,this[x(1352)]=[],this.up=Nx[x(511)][x(3123)]();const e=new E,t=new Tt,g=new ot,n=new E(1,1,1);function s(){g[x(2562)](t,!1)}function o(){t[x(2802)](g,void 0,!1)}t._onChange(s),g[x(292)](o),Object[x(1266)](this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:g},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new dx},normalMatrix:{value:new px}}),this[x(1721)]=new dx,this[x(2368)]=new dx,this.matrixAutoUpdate=Nx.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Nx[x(1491)],this.matrixWorldNeedsUpdate=!1,this[x(2669)]=new KI,this[x(2548)]=!0,this.castShadow=!1,this.receiveShadow=!1,this[x(1131)]=!0,this[x(3238)]=0,this.animations=[],this[x(358)]={}}onBeforeShadow(){}[I(3134)](){}[I(3548)](){}onAfterRender(){}applyMatrix4(x){const e=I;this[e(2272)]&&this[e(466)](),this[e(1721)].premultiply(x),this[e(1721)].decompose(this[e(2817)],this.quaternion,this[e(623)])}[I(2235)](x){return this.quaternion.premultiply(x),this}[I(1711)](x,e){this[I(3915)].setFromAxisAngle(x,e)}[I(2931)](x){const e=I;this.quaternion[e(2562)](x,!0)}[I(1540)](x){const e=I;this.quaternion[e(3924)](x)}[I(1106)](x){const e=I;this.quaternion[e(1493)](x)}[I(2401)](x,e){const t=I;return rs[t(3405)](x,e),this[t(3915)][t(327)](rs),this}[I(3177)](x,e){const t=I;return rs[t(3405)](x,e),this[t(3915)][t(2050)](rs),this}[I(3550)](x){return this.rotateOnAxis(DG,x)}[I(3308)](x){return this.rotateOnAxis(QG,x)}[I(1617)](x){return this[I(2401)](PG,x)}[I(727)](x,e){const t=I;return _G.copy(x)[t(2235)](this[t(3915)]),this[t(2817)][t(3014)](_G[t(2333)](e)),this}[I(243)](x){return this[I(727)](DG,x)}[I(3937)](x){return this.translateOnAxis(QG,x)}[I(148)](x){return this[I(727)](PG,x)}[I(2384)](x){const e=I;return this.updateWorldMatrix(!0,!1),x[e(3075)](this[e(2368)])}[I(999)](x){const e=I;return this.updateWorldMatrix(!0,!1),x.applyMatrix4(Zi[e(1493)](this.matrixWorld)[e(2483)]())}[I(2765)](x,e,t){const g=I;x[g(2752)]?ra[g(1493)](x):ra[g(298)](x,e,t);const n=this.parent;this.updateWorldMatrix(!0,!1),sc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this[g(1408)]?Zi[g(2765)](sc,ra,this.up):Zi[g(2765)](ra,sc,this.up),this.quaternion[g(3924)](Zi),n&&(Zi[g(3009)](n[g(2368)]),rs[g(3924)](Zi),this[g(3915)][g(2050)](rs[g(2483)]()))}add(x){const e=I;if(arguments.length>1){for(let t=0;t<arguments[e(2989)];t++)this[e(3014)](arguments[t]);return this}return x===this?(console[e(2963)]("THREE.Object3D.add: object can't be added as a child of itself.",x),this):(x&&x[e(3985)]?(x[e(505)](),x[e(1064)]=this,this.children[e(3330)](x),x[e(1457)](OG),ds[e(1367)]=x,this[e(1457)](ds),ds[e(1367)]=null):console[e(2963)](e(1657),x),this)}[I(2208)](x){const e=I;if(arguments.length>1){for(let g=0;g<arguments.length;g++)this[e(2208)](arguments[g]);return this}const t=this.children[e(2377)](x);return t!==-1&&(x[e(1064)]=null,this[e(1352)][e(2960)](t,1),x[e(1457)](TS),kA[e(1367)]=x,this[e(1457)](kA),kA[e(1367)]=null),this}[I(505)](){const x=I,e=this[x(1064)];return e!==null&&e.remove(this),this}clear(){const x=I;return this[x(2208)](...this[x(1352)])}attach(x){const e=I;return this.updateWorldMatrix(!0,!1),Zi.copy(this.matrixWorld)[e(2483)](),x.parent!==null&&(x[e(1064)][e(2144)](!0,!1),Zi[e(327)](x[e(1064)][e(2368)])),x.applyMatrix4(Zi),x[e(505)](),x[e(1064)]=this,this.children[e(3330)](x),x[e(2144)](!1,!0),x[e(1457)](OG),ds[e(1367)]=x,this[e(1457)](ds),ds[e(1367)]=null,this}[I(2094)](x){return this[I(3912)]("id",x)}[I(1519)](x){const e=I;return this.getObjectByProperty(e(1474),x)}[I(3912)](x,e){const t=I;if(this[x]===e)return this;for(let g=0,n=this[t(1352)][t(2989)];g<n;g++){const s=this[t(1352)][g],o=s[t(3912)](x,e);if(o!==void 0)return o}}getObjectsByProperty(x,e,t=[]){const g=I;this[x]===e&&t.push(this);const n=this[g(1352)];for(let s=0,o=n.length;s<o;s++)n[s].getObjectsByProperty(x,e,t);return t}getWorldPosition(x){const e=I;return this[e(2144)](!0,!1),x[e(1577)](this[e(2368)])}[I(2641)](x){const e=I;return this[e(2144)](!0,!1),this[e(2368)][e(2986)](sc,x,LS),x}[I(3384)](x){const e=I;return this[e(2144)](!0,!1),this[e(2368)][e(2986)](sc,kS,x),x}[I(2245)](x){const e=I;this[e(2144)](!0,!1);const t=this[e(2368)][e(2574)];return x[e(298)](t[8],t[9],t[10])[e(3762)]()}[I(785)](){}[I(1044)](x){const e=I;x(this);const t=this.children;for(let g=0,n=t[e(2989)];g<n;g++)t[g].traverse(x)}[I(1495)](x){const e=I;if(this[e(2548)]===!1)return;x(this);const t=this.children;for(let g=0,n=t[e(2989)];g<n;g++)t[g][e(1495)](x)}traverseAncestors(x){const e=I,t=this[e(1064)];t!==null&&(x(t),t[e(3142)](x))}[I(466)](){const x=I;this[x(1721)][x(1669)](this.position,this.quaternion,this[x(623)]),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(x){const e=I;this.matrixAutoUpdate&&this[e(466)](),(this[e(2621)]||x)&&(this[e(1064)]===null?this[e(2368)][e(1493)](this[e(1721)]):this[e(2368)].multiplyMatrices(this[e(1064)][e(2368)],this[e(1721)]),this.matrixWorldNeedsUpdate=!1,x=!0);const t=this[e(1352)];for(let g=0,n=t[e(2989)];g<n;g++){const s=t[g];(s[e(2222)]===!0||x===!0)&&s[e(3554)](x)}}[I(2144)](x,e){const t=I,g=this.parent;if(x===!0&&g!==null&&g[t(2222)]===!0&&g[t(2144)](!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this[t(1064)]===null?this.matrixWorld[t(1493)](this[t(1721)]):this[t(2368)][t(1418)](this[t(1064)][t(2368)],this[t(1721)]),e===!0){const n=this[t(1352)];for(let s=0,o=n[t(2989)];s<o;s++){const c=n[s];c[t(2222)]===!0&&c.updateWorldMatrix(!1,!0)}}}[I(2054)](x){const e=I,t=x===void 0||typeof x===e(3674),g={};t&&(x={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},g[e(1832)]={version:4.6,type:e(3468),generator:e(2321)});const n={};n[e(296)]=this[e(296)],n[e(3505)]=this[e(3505)],this.name!==""&&(n[e(1474)]=this[e(1474)]),this[e(1239)]===!0&&(n[e(1239)]=!0),this[e(3328)]===!0&&(n[e(3328)]=!0),this[e(2548)]===!1&&(n.visible=!1),this[e(1131)]===!1&&(n.frustumCulled=!1),this[e(3238)]!==0&&(n[e(3238)]=this[e(3238)]),Object[e(958)](this[e(358)])[e(2989)]>0&&(n[e(358)]=this[e(358)]),n[e(2669)]=this[e(2669)][e(829)],n[e(1721)]=this[e(1721)][e(3904)](),n.up=this.up[e(3904)](),this[e(2272)]===!1&&(n.matrixAutoUpdate=!1),this[e(2369)]&&(n.type=e(2952),n[e(3411)]=this[e(3411)],n[e(1068)]=this[e(1068)].toJSON(),this.instanceColor!==null&&(n.instanceColor=this[e(1224)][e(2054)]())),this.isBatchedMesh&&(n[e(3505)]="BatchedMesh",n[e(916)]=this[e(916)],n[e(1371)]=this[e(1371)],n[e(182)]=this._drawRanges,n.reservedRanges=this[e(1547)],n.visibility=this[e(3065)],n[e(2706)]=this[e(3765)],n.bounds=this[e(1301)][e(3879)](c=>({boxInitialized:c[e(906)],boxMin:c[e(1405)][e(1410)][e(3904)](),boxMax:c[e(1405)][e(1971)].toArray(),sphereInitialized:c[e(328)],sphereRadius:c.sphere[e(3015)],sphereCenter:c[e(3119)].center.toArray()})),n[e(1957)]=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n[e(1696)]=this._maxIndexCount,n[e(3545)]=this[e(2447)],n[e(2611)]=this._geometryCount,n.matricesTexture=this._matricesTexture[e(2054)](x),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center[e(3904)](),radius:n[e(3636)][e(3015)]}),this[e(3344)]!==null&&(n.boundingBox={min:n[e(3344)][e(1410)].toArray(),max:n[e(3344)][e(1971)].toArray()}));function s(c,C){const r=e;return c[C[r(296)]]===void 0&&(c[C.uuid]=C[r(2054)](x)),C[r(296)]}if(this[e(1037)])this[e(2393)]&&(this[e(2393)][e(1892)]?n[e(2393)]=this[e(2393)][e(2054)]():this[e(2393)][e(3984)]&&(n[e(2393)]=this[e(2393)][e(2054)](x)[e(296)])),this[e(2731)]&&this.environment[e(3984)]&&this.environment[e(1309)]!==!0&&(n[e(2731)]=this[e(2731)][e(2054)](x)[e(296)]);else if(this.isMesh||this[e(2154)]||this[e(1146)]){n[e(352)]=s(x[e(1028)],this[e(352)]);const c=this[e(352)].parameters;if(c!==void 0&&c.shapes!==void 0){const C=c.shapes;if(Array.isArray(C))for(let r=0,A=C[e(2989)];r<A;r++){const d=C[r];s(x[e(2386)],d)}else s(x[e(2386)],C)}}if(this[e(1305)]&&(n[e(2313)]=this[e(2313)],n[e(635)]=this[e(635)][e(3904)](),this[e(2148)]!==void 0&&(s(x.skeletons,this[e(2148)]),n[e(2148)]=this[e(2148)][e(296)])),this[e(3480)]!==void 0)if(Array[e(1987)](this[e(3480)])){const c=[];for(let C=0,r=this[e(3480)][e(2989)];C<r;C++)c.push(s(x[e(3080)],this[e(3480)][C]));n[e(3480)]=c}else n[e(3480)]=s(x[e(3080)],this[e(3480)]);if(this[e(1352)][e(2989)]>0){n[e(1352)]=[];for(let c=0;c<this[e(1352)][e(2989)];c++)n[e(1352)][e(3330)](this[e(1352)][c][e(2054)](x)[e(1011)])}if(this[e(2933)][e(2989)]>0){n.animations=[];for(let c=0;c<this[e(2933)].length;c++){const C=this[e(2933)][c];n[e(2933)][e(3330)](s(x.animations,C))}}if(t){const c=o(x[e(1028)]),C=o(x[e(3080)]),r=o(x[e(353)]),A=o(x[e(2268)]),d=o(x[e(2386)]),h=o(x.skeletons),f=o(x[e(2933)]),B=o(x[e(3656)]);c.length>0&&(g.geometries=c),C[e(2989)]>0&&(g[e(3080)]=C),r[e(2989)]>0&&(g[e(353)]=r),A[e(2989)]>0&&(g[e(2268)]=A),d.length>0&&(g[e(2386)]=d),h[e(2989)]>0&&(g[e(2813)]=h),f[e(2989)]>0&&(g[e(2933)]=f),B.length>0&&(g.nodes=B)}return g.object=n,g;function o(c){const C=e,r=[];for(const A in c){const d=c[A];delete d[C(1832)],r[C(3330)](d)}return r}}[I(3123)](x){const e=I;return new this.constructor()[e(1493)](this,x)}copy(x,e=!0){const t=I;if(this[t(1474)]=x[t(1474)],this.up[t(1493)](x.up),this.position[t(1493)](x[t(2817)]),this[t(1488)][t(373)]=x[t(1488)].order,this[t(3915)][t(1493)](x[t(3915)]),this.scale[t(1493)](x[t(623)]),this.matrix[t(1493)](x[t(1721)]),this[t(2368)][t(1493)](x[t(2368)]),this[t(2272)]=x[t(2272)],this[t(2222)]=x[t(2222)],this[t(2621)]=x.matrixWorldNeedsUpdate,this[t(2669)][t(829)]=x.layers[t(829)],this[t(2548)]=x.visible,this[t(1239)]=x.castShadow,this[t(3328)]=x[t(3328)],this[t(1131)]=x[t(1131)],this.renderOrder=x[t(3238)],this.animations=x[t(2933)][t(1226)](),this[t(358)]=JSON[t(3073)](JSON.stringify(x.userData)),e===!0)for(let g=0;g<x[t(1352)][t(2989)];g++){const n=x.children[g];this.add(n[t(3123)]())}return this}}Nx[I(511)]=new E(0,1,0),Nx.DEFAULT_MATRIX_AUTO_UPDATE=!0,Nx[I(1491)]=!0;const Sg=new E,yi=new E,TA=new E,vi=new E,As=new E,us=new E,qG=new E,JA=new E,EA=new E,UA=new E;class xg{constructor(x=new E,e=new E,t=new E){this.a=x,this.b=e,this.c=t}static[I(3943)](x,e,t,g){const n=I;g.subVectors(t,e),Sg[n(859)](x,e),g[n(1092)](Sg);const s=g.lengthSq();return s>0?g[n(2333)](1/Math[n(3641)](s)):g[n(298)](0,0,0)}static[I(954)](x,e,t,g,n){const s=I;Sg[s(859)](g,e),yi[s(859)](t,e),TA[s(859)](x,e);const o=Sg.dot(Sg),c=Sg[s(1760)](yi),C=Sg.dot(TA),r=yi[s(1760)](yi),A=yi[s(1760)](TA),d=o*r-c*c;if(d===0)return n.set(0,0,0),null;const h=1/d,f=(r*C-c*A)*h,B=(o*A-c*C)*h;return n[s(298)](1-f-B,B,f)}static[I(2035)](x,e,t,g){return this[I(954)](x,e,t,g,vi)===null?!1:vi.x>=0&&vi.y>=0&&vi.x+vi.y<=1}static[I(3216)](x,e,t,g,n,s,o,c){const C=I;return this[C(954)](x,e,t,g,vi)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c[C(3319)](0),c[C(832)](n,vi.x),c.addScaledVector(s,vi.y),c[C(832)](o,vi.z),c)}static[I(2620)](x,e,t,g){const n=I;return Sg[n(859)](t,e),yi[n(859)](x,e),Sg.cross(yi)[n(1760)](g)<0}[I(298)](x,e,t){const g=I;return this.a[g(1493)](x),this.b.copy(e),this.c.copy(t),this}[I(3837)](x,e,t,g){const n=I;return this.a[n(1493)](x[e]),this.b[n(1493)](x[t]),this.c.copy(x[g]),this}[I(3044)](x,e,t,g){const n=I;return this.a[n(2404)](x,e),this.b.fromBufferAttribute(x,t),this.c[n(2404)](x,g),this}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}[I(1493)](x){const e=I;return this.a[e(1493)](x.a),this.b[e(1493)](x.b),this.c[e(1493)](x.c),this}[I(1535)](){const x=I;return Sg.subVectors(this.c,this.b),yi.subVectors(this.a,this.b),Sg[x(1092)](yi)[x(2989)]()*.5}getMidpoint(x){const e=I;return x.addVectors(this.a,this.b)[e(3014)](this.c)[e(2333)](1/3)}[I(3943)](x){return xg.getNormal(this.a,this.b,this.c,x)}[I(2612)](x){return x[I(1032)](this.a,this.b,this.c)}[I(954)](x,e){return xg[I(954)](x,this.a,this.b,this.c,e)}[I(3216)](x,e,t,g,n){return xg.getInterpolation(x,this.a,this.b,this.c,e,t,g,n)}[I(2035)](x){return xg[I(2035)](x,this.a,this.b,this.c)}[I(2620)](x){return xg[I(2620)](this.a,this.b,this.c,x)}intersectsBox(x){return x[I(3349)](this)}[I(130)](x,e){const t=I,g=this.a,n=this.b,s=this.c;let o,c;As[t(859)](n,g),us[t(859)](s,g),JA[t(859)](x,g);const C=As[t(1760)](JA),r=us[t(1760)](JA);if(C<=0&&r<=0)return e[t(1493)](g);EA.subVectors(x,n);const A=As.dot(EA),d=us[t(1760)](EA);if(A>=0&&d<=A)return e.copy(n);const h=C*d-A*r;if(h<=0&&C>=0&&A<=0)return o=C/(C-A),e[t(1493)](g).addScaledVector(As,o);UA[t(859)](x,s);const f=As.dot(UA),B=us[t(1760)](UA);if(B>=0&&f<=B)return e[t(1493)](s);const Z=f*r-C*B;if(Z<=0&&r>=0&&B<=0)return c=r/(r-B),e[t(1493)](g).addScaledVector(us,c);const G=A*B-f*d;if(G<=0&&d-A>=0&&f-B>=0)return qG[t(859)](s,n),c=(d-A)/(d-A+(f-B)),e[t(1493)](n)[t(832)](qG,c);const m=1/(G+Z+h);return o=Z*m,c=h*m,e.copy(g)[t(832)](As,o)[t(832)](us,c)}equals(x){const e=I;return x.a[e(3106)](this.a)&&x.b[e(3106)](this.b)&&x.c[e(3106)](this.c)}}const Zv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ln={h:0,s:0,l:0},da={h:0,s:0,l:0};function i0(i,x){const e=I2();return i0=function(t,g){return t=t-110,e[t]},i0(i,x)}function _A(i,x,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(x-i)*6*e:e<1/2?x:e<2/3?i+(x-i)*6*(2/3-e):i}class Q0{constructor(x,e,t){const g=I;return this[g(1892)]=!0,this.r=1,this.g=1,this.b=1,this.set(x,e,t)}[I(298)](x,e,t){const g=I;if(e===void 0&&t===void 0){const n=x;n&&n[g(1892)]?this.copy(n):typeof n===g(1025)?this[g(2189)](n):typeof n===g(3674)&&this[g(1804)](n)}else this.setRGB(x,e,t);return this}setScalar(x){return this.r=x,this.g=x,this.b=x,this}[I(2189)](x,e=Ag){const t=I;return x=Math[t(3143)](x),this.r=(x>>16&255)/255,this.g=(x>>8&255)/255,this.b=(x&255)/255,_x[t(2602)](this,e),this}setRGB(x,e,t,g=_x[I(3764)]){return this.r=x,this.g=e,this.b=t,_x.toWorkingColorSpace(this,g),this}[I(1855)](x,e,t,g=_x[I(3764)]){const n=I;if(x=ff(x,1),e=Ae(e,0,1),t=Ae(t,0,1),e===0)this.r=this.g=this.b=t;else{const s=t<=.5?t*(1+e):t+e-t*e,o=2*t-s;this.r=_A(o,s,x+1/3),this.g=_A(o,s,x),this.b=_A(o,s,x-1/3)}return _x[n(2602)](this,g),this}setStyle(x,e=Ag){const t=I;function g(s){const o=i0;s!==void 0&&parseFloat(s)<1&&console[o(3748)](o(2244)+x+o(3750))}let n;if(n=/^(\w+)\(([^\)]*)\)/[t(3193)](x)){let s;const o=n[1],c=n[2];switch(o){case t(1460):case t(2302):if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return g(s[4]),this.setRGB(Math[t(1410)](255,parseInt(s[1],10))/255,Math[t(1410)](255,parseInt(s[2],10))/255,Math[t(1410)](255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/[t(3193)](c))return g(s[4]),this[t(3362)](Math[t(1410)](100,parseInt(s[1],10))/100,Math[t(1410)](100,parseInt(s[2],10))/100,Math[t(1410)](100,parseInt(s[3],10))/100,e);break;case t(2086):case t(1626):if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/[t(3193)](c))return g(s[4]),this[t(1855)](parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console[t(3748)](t(2924)+x)}}else if(n=/^\#([A-Fa-f\d]+)$/[t(3193)](x)){const s=n[1],o=s[t(2989)];if(o===3)return this[t(3362)](parseInt(s[t(2892)](0),16)/15,parseInt(s[t(2892)](1),16)/15,parseInt(s[t(2892)](2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn(t(2061)+x)}else if(x&&x[t(2989)]>0)return this.setColorName(x,e);return this}[I(469)](x,e=Ag){const t=I,g=Zv[x[t(2084)]()];return g!==void 0?this.setHex(g,e):console[t(3748)](t(3977)+x),this}clone(){const x=I;return new this[x(135)](this.r,this.g,this.b)}[I(1493)](x){return this.r=x.r,this.g=x.g,this.b=x.b,this}[I(2271)](x){return this.r=Io(x.r),this.g=Io(x.g),this.b=Io(x.b),this}copyLinearToSRGB(x){return this.r=YA(x.r),this.g=YA(x.g),this.b=YA(x.b),this}[I(2068)](){return this[I(2271)](this),this}[I(570)](){return this.copyLinearToSRGB(this),this}[I(2830)](x=Ag){const e=I;return _x[e(2868)](gt[e(1493)](this),x),Math[e(1008)](Ae(gt.r*255,0,255))*65536+Math.round(Ae(gt.g*255,0,255))*256+Math.round(Ae(gt.b*255,0,255))}getHexString(x=Ag){const e=I;return(e(2388)+this.getHex(x)[e(2635)](16))[e(1226)](-6)}[I(560)](x,e=_x[I(3764)]){const t=I;_x[t(2868)](gt[t(1493)](this),e);const g=gt.r,n=gt.g,s=gt.b,o=Math[t(1971)](g,n,s),c=Math[t(1410)](g,n,s);let C,r;const A=(c+o)/2;if(c===o)C=0,r=0;else{const d=o-c;switch(r=A<=.5?d/(o+c):d/(2-o-c),o){case g:C=(n-s)/d+(n<s?6:0);break;case n:C=(s-g)/d+2;break;case s:C=(g-n)/d+4;break}C/=6}return x.h=C,x.s=r,x.l=A,x}[I(2504)](x,e=_x[I(3764)]){const t=I;return _x[t(2868)](gt[t(1493)](this),e),x.r=gt.r,x.g=gt.g,x.b=gt.b,x}[I(553)](x=Ag){const e=I;_x[e(2868)](gt[e(1493)](this),x);const t=gt.r,g=gt.g,n=gt.b;return x!==Ag?e(3895)+x+" "+t[e(521)](3)+" "+g[e(521)](3)+" "+n[e(521)](3)+")":e(1416)+Math[e(1008)](t*255)+","+Math[e(1008)](g*255)+","+Math[e(1008)](n*255)+")"}offsetHSL(x,e,t){return this[I(560)](ln),this.setHSL(ln.h+x,ln.s+e,ln.l+t)}add(x){return this.r+=x.r,this.g+=x.g,this.b+=x.b,this}[I(3897)](x,e){return this.r=x.r+e.r,this.g=x.g+e.g,this.b=x.b+e.b,this}addScalar(x){return this.r+=x,this.g+=x,this.b+=x,this}[I(3938)](x){const e=I;return this.r=Math[e(1971)](0,this.r-x.r),this.g=Math[e(1971)](0,this.g-x.g),this.b=Math.max(0,this.b-x.b),this}[I(327)](x){return this.r*=x.r,this.g*=x.g,this.b*=x.b,this}[I(2333)](x){return this.r*=x,this.g*=x,this.b*=x,this}lerp(x,e){return this.r+=(x.r-this.r)*e,this.g+=(x.g-this.g)*e,this.b+=(x.b-this.b)*e,this}[I(742)](x,e,t){return this.r=x.r+(e.r-x.r)*t,this.g=x.g+(e.g-x.g)*t,this.b=x.b+(e.b-x.b)*t,this}[I(321)](x,e){const t=I;this[t(560)](ln),x[t(560)](da);const g=Lc(ln.h,da.h,e),n=Lc(ln.s,da.s,e),s=Lc(ln.l,da.l,e);return this[t(1855)](g,n,s),this}setFromVector3(x){return this.r=x.x,this.g=x.y,this.b=x.z,this}[I(1326)](x){const e=I,t=this.r,g=this.g,n=this.b,s=x[e(2574)];return this.r=s[0]*t+s[3]*g+s[6]*n,this.g=s[1]*t+s[4]*g+s[7]*n,this.b=s[2]*t+s[5]*g+s[8]*n,this}[I(3106)](x){return x.r===this.r&&x.g===this.g&&x.b===this.b}[I(2793)](x,e=0){return this.r=x[e],this.g=x[e+1],this.b=x[e+2],this}[I(3904)](x=[],e=0){return x[e]=this.r,x[e+1]=this.g,x[e+2]=this.b,x}[I(2404)](x,e){const t=I;return this.r=x.getX(e),this.g=x[t(655)](e),this.b=x[t(2142)](e),this}[I(2054)](){return this[I(2830)]()}*[Symbol[I(2880)]](){yield this.r,yield this.g,yield this.b}}const gt=new Q0;Q0[I(3825)]=Zv;let JS=0;class lt extends Qi{constructor(){const x=I;super(),this[x(730)]=!0,Object.defineProperty(this,"id",{value:JS++}),this.uuid=gg(),this.name="",this[x(3505)]="Material",this[x(314)]=SI,this.side=Ji,this[x(123)]=!1,this.opacity=1,this[x(3249)]=!1,this.alphaHash=!1,this.blendSrc=e2,this.blendDst=t2,this[x(3664)]=Gn,this[x(2842)]=null,this[x(846)]=null,this[x(926)]=null,this.blendColor=new Q0(0,0,0),this[x(399)]=0,this.depthFunc=IC,this[x(3329)]=!0,this.depthWrite=!0,this[x(3137)]=255,this[x(2139)]=gh,this.stencilRef=0,this.stencilFuncMask=255,this[x(2573)]=dI,this.stencilZFail=dI,this[x(3809)]=dI,this[x(903)]=!1,this.clippingPlanes=null,this[x(2352)]=!1,this.clipShadows=!1,this[x(2408)]=null,this[x(339)]=!0,this[x(1661)]=null,this[x(492)]=!1,this.polygonOffsetFactor=0,this[x(1215)]=0,this[x(1952)]=!1,this[x(1283)]=!1,this[x(3696)]=!1,this[x(3374)]=!1,this[x(2548)]=!0,this[x(572)]=!0,this[x(358)]={},this[x(1450)]=0,this[x(2115)]=0}get[I(151)](){return this[I(2115)]}set[I(151)](x){const e=I;this[e(2115)]>0!=x>0&&this.version++,this[e(2115)]=x}onBuild(){}[I(3548)](){}[I(3031)](){}[I(1911)](){const x=I;return this[x(3031)][x(2635)]()}setValues(x){const e=I;if(x!==void 0)for(const t in x){const g=x[t];if(g===void 0){console[e(3748)](e(2797)+t+e(2735));continue}const n=this[t];if(n===void 0){console[e(3748)]("THREE.Material: '"+t+e(3722)+this.type+".");continue}n&&n[e(1892)]?n.set(g):n&&n.isVector3&&g&&g[e(2752)]?n.copy(g):this[t]=g}}[I(2054)](x){const e=I,t=x===void 0||typeof x===e(3674);t&&(x={textures:{},images:{}});const g={metadata:{version:4.6,type:"Material",generator:e(2956)}};g[e(296)]=this[e(296)],g[e(3505)]=this[e(3505)],this[e(1474)]!==""&&(g[e(1474)]=this.name),this[e(432)]&&this.color.isColor&&(g[e(432)]=this[e(432)][e(2830)]()),this[e(1383)]!==void 0&&(g[e(1383)]=this[e(1383)]),this[e(1194)]!==void 0&&(g[e(1194)]=this.metalness),this[e(691)]!==void 0&&(g[e(691)]=this[e(691)]),this[e(179)]&&this[e(179)][e(1892)]&&(g[e(179)]=this[e(179)][e(2830)]()),this[e(2882)]!==void 0&&(g[e(2882)]=this[e(2882)]),this[e(161)]&&this[e(161)][e(1892)]&&(g[e(161)]=this[e(161)].getHex()),this[e(747)]!==void 0&&this[e(747)]!==1&&(g[e(747)]=this[e(747)]),this.specular&&this[e(2204)].isColor&&(g.specular=this[e(2204)][e(2830)]()),this[e(480)]!==void 0&&(g[e(480)]=this.specularIntensity),this[e(3525)]&&this[e(3525)].isColor&&(g[e(3525)]=this[e(3525)].getHex()),this[e(1169)]!==void 0&&(g.shininess=this[e(1169)]),this[e(3916)]!==void 0&&(g[e(3916)]=this.clearcoat),this[e(2893)]!==void 0&&(g.clearcoatRoughness=this[e(2893)]),this[e(2539)]&&this.clearcoatMap.isTexture&&(g[e(2539)]=this[e(2539)][e(2054)](x)[e(296)]),this[e(241)]&&this[e(241)][e(3984)]&&(g.clearcoatRoughnessMap=this[e(241)].toJSON(x)[e(296)]),this.clearcoatNormalMap&&this[e(1881)][e(3984)]&&(g[e(1881)]=this[e(1881)][e(2054)](x)[e(296)],g[e(1402)]=this.clearcoatNormalScale[e(3904)]()),this[e(1625)]!==void 0&&(g[e(1625)]=this.dispersion),this.iridescence!==void 0&&(g.iridescence=this[e(3175)]),this[e(3986)]!==void 0&&(g.iridescenceIOR=this.iridescenceIOR),this[e(3739)]!==void 0&&(g[e(3739)]=this[e(3739)]),this[e(2374)]&&this[e(2374)].isTexture&&(g[e(2374)]=this[e(2374)][e(2054)](x)[e(296)]),this[e(1904)]&&this.iridescenceThicknessMap[e(3984)]&&(g[e(1904)]=this.iridescenceThicknessMap[e(2054)](x).uuid),this[e(2651)]!==void 0&&(g.anisotropy=this[e(2651)]),this[e(1214)]!==void 0&&(g[e(1214)]=this[e(1214)]),this[e(590)]&&this.anisotropyMap[e(3984)]&&(g[e(590)]=this[e(590)][e(2054)](x).uuid),this[e(3879)]&&this[e(3879)][e(3984)]&&(g[e(3879)]=this.map[e(2054)](x).uuid),this[e(126)]&&this[e(126)][e(3984)]&&(g.matcap=this[e(126)][e(2054)](x).uuid),this[e(3709)]&&this.alphaMap[e(3984)]&&(g[e(3709)]=this[e(3709)].toJSON(x)[e(296)]),this[e(3997)]&&this[e(3997)][e(3984)]&&(g.lightMap=this.lightMap[e(2054)](x)[e(296)],g[e(899)]=this[e(899)]),this[e(2042)]&&this[e(2042)][e(3984)]&&(g[e(2042)]=this[e(2042)][e(2054)](x).uuid,g[e(904)]=this[e(904)]),this[e(2210)]&&this[e(2210)][e(3984)]&&(g[e(2210)]=this[e(2210)].toJSON(x)[e(296)],g.bumpScale=this[e(340)]),this[e(2712)]&&this[e(2712)][e(3984)]&&(g[e(2712)]=this[e(2712)].toJSON(x).uuid,g[e(2308)]=this.normalMapType,g[e(2733)]=this[e(2733)][e(3904)]()),this.displacementMap&&this[e(1638)][e(3984)]&&(g[e(1638)]=this.displacementMap[e(2054)](x).uuid,g.displacementScale=this.displacementScale,g.displacementBias=this[e(977)]),this[e(1372)]&&this[e(1372)][e(3984)]&&(g[e(1372)]=this[e(1372)].toJSON(x)[e(296)]),this.metalnessMap&&this[e(2594)][e(3984)]&&(g[e(2594)]=this[e(2594)][e(2054)](x).uuid),this[e(833)]&&this[e(833)][e(3984)]&&(g[e(833)]=this[e(833)][e(2054)](x)[e(296)]),this[e(2887)]&&this[e(2887)][e(3984)]&&(g[e(2887)]=this[e(2887)][e(2054)](x)[e(296)]),this[e(1499)]&&this[e(1499)][e(3984)]&&(g[e(1499)]=this.specularIntensityMap[e(2054)](x)[e(296)]),this.specularColorMap&&this[e(1335)][e(3984)]&&(g.specularColorMap=this[e(1335)][e(2054)](x)[e(296)]),this[e(1300)]&&this[e(1300)].isTexture&&(g[e(1300)]=this[e(1300)][e(2054)](x).uuid,this[e(2667)]!==void 0&&(g.combine=this.combine)),this[e(1043)]!==void 0&&(g[e(1043)]=this[e(1043)][e(3904)]()),this.envMapIntensity!==void 0&&(g.envMapIntensity=this.envMapIntensity),this[e(1695)]!==void 0&&(g[e(1695)]=this[e(1695)]),this[e(3241)]!==void 0&&(g.refractionRatio=this[e(3241)]),this[e(3023)]&&this[e(3023)][e(3984)]&&(g[e(3023)]=this[e(3023)][e(2054)](x)[e(296)]),this[e(3820)]!==void 0&&(g[e(3820)]=this[e(3820)]),this[e(3403)]&&this[e(3403)][e(3984)]&&(g[e(3403)]=this.transmissionMap[e(2054)](x)[e(296)]),this[e(257)]!==void 0&&(g[e(257)]=this.thickness),this[e(2200)]&&this.thicknessMap.isTexture&&(g.thicknessMap=this[e(2200)].toJSON(x)[e(296)]),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(g.attenuationDistance=this[e(1047)]),this.attenuationColor!==void 0&&(g[e(1207)]=this.attenuationColor.getHex()),this[e(1019)]!==void 0&&(g[e(1019)]=this.size),this[e(2408)]!==null&&(g.shadowSide=this[e(2408)]),this.sizeAttenuation!==void 0&&(g[e(965)]=this[e(965)]),this[e(314)]!==SI&&(g[e(314)]=this[e(314)]),this.side!==Ji&&(g.side=this[e(3601)]),this[e(123)]===!0&&(g[e(123)]=!0),this[e(2390)]<1&&(g[e(2390)]=this[e(2390)]),this[e(3249)]===!0&&(g[e(3249)]=!0),this[e(3939)]!==e2&&(g[e(3939)]=this.blendSrc),this.blendDst!==t2&&(g[e(1179)]=this[e(1179)]),this.blendEquation!==Gn&&(g[e(3664)]=this[e(3664)]),this[e(2842)]!==null&&(g[e(2842)]=this[e(2842)]),this[e(846)]!==null&&(g[e(846)]=this.blendDstAlpha),this[e(926)]!==null&&(g[e(926)]=this[e(926)]),this[e(3132)]&&this[e(3132)][e(1892)]&&(g[e(3132)]=this[e(3132)].getHex()),this[e(399)]!==0&&(g[e(399)]=this.blendAlpha),this[e(3222)]!==IC&&(g[e(3222)]=this[e(3222)]),this[e(3329)]===!1&&(g.depthTest=this[e(3329)]),this[e(129)]===!1&&(g.depthWrite=this[e(129)]),this.colorWrite===!1&&(g.colorWrite=this[e(339)]),this[e(3137)]!==255&&(g[e(3137)]=this[e(3137)]),this[e(2139)]!==gh&&(g[e(2139)]=this.stencilFunc),this[e(3906)]!==0&&(g[e(3906)]=this[e(3906)]),this.stencilFuncMask!==255&&(g[e(3536)]=this[e(3536)]),this[e(2573)]!==dI&&(g[e(2573)]=this[e(2573)]),this[e(2109)]!==dI&&(g[e(2109)]=this.stencilZFail),this[e(3809)]!==dI&&(g[e(3809)]=this.stencilZPass),this.stencilWrite===!0&&(g[e(903)]=this[e(903)]),this[e(1488)]!==void 0&&this[e(1488)]!==0&&(g[e(1488)]=this[e(1488)]),this[e(492)]===!0&&(g[e(492)]=!0),this[e(2996)]!==0&&(g[e(2996)]=this.polygonOffsetFactor),this[e(1215)]!==0&&(g[e(1215)]=this[e(1215)]),this[e(3725)]!==void 0&&this[e(3725)]!==1&&(g[e(3725)]=this[e(3725)]),this[e(1361)]!==void 0&&(g[e(1361)]=this[e(1361)]),this[e(1835)]!==void 0&&(g[e(1835)]=this[e(1835)]),this.scale!==void 0&&(g[e(623)]=this.scale),this[e(1952)]===!0&&(g[e(1952)]=!0),this.alphaTest>0&&(g[e(151)]=this[e(151)]),this[e(2959)]===!0&&(g[e(2959)]=!0),this[e(1283)]===!0&&(g[e(1283)]=!0),this.premultipliedAlpha===!0&&(g[e(3696)]=!0),this[e(3374)]===!0&&(g[e(3374)]=!0),this[e(2734)]===!0&&(g[e(2734)]=!0),this[e(1979)]>1&&(g[e(1979)]=this[e(1979)]),this[e(579)]!==e(1008)&&(g[e(579)]=this[e(579)]),this[e(1897)]!==e(1008)&&(g.wireframeLinejoin=this[e(1897)]),this[e(280)]===!0&&(g[e(280)]=!0),this[e(2548)]===!1&&(g.visible=!1),this[e(572)]===!1&&(g[e(572)]=!1),this[e(1382)]===!1&&(g[e(1382)]=!1),Object.keys(this[e(358)]).length>0&&(g.userData=this[e(358)]);function n(s){const o=e,c=[];for(const C in s){const r=s[C];delete r.metadata,c[o(3330)](r)}return c}if(t){const s=n(x[e(353)]),o=n(x[e(2268)]);s[e(2989)]>0&&(g[e(353)]=s),o[e(2989)]>0&&(g[e(2268)]=o)}return g}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}copy(x){const e=I;this[e(1474)]=x[e(1474)],this[e(314)]=x[e(314)],this.side=x.side,this[e(123)]=x[e(123)],this[e(2390)]=x[e(2390)],this[e(3249)]=x[e(3249)],this.blendSrc=x[e(3939)],this[e(1179)]=x.blendDst,this[e(3664)]=x[e(3664)],this[e(2842)]=x[e(2842)],this[e(846)]=x[e(846)],this[e(926)]=x.blendEquationAlpha,this[e(3132)][e(1493)](x.blendColor),this.blendAlpha=x.blendAlpha,this[e(3222)]=x[e(3222)],this[e(3329)]=x[e(3329)],this[e(129)]=x[e(129)],this[e(3137)]=x.stencilWriteMask,this[e(2139)]=x[e(2139)],this[e(3906)]=x[e(3906)],this[e(3536)]=x[e(3536)],this[e(2573)]=x[e(2573)],this[e(2109)]=x.stencilZFail,this.stencilZPass=x[e(3809)],this.stencilWrite=x[e(903)];const t=x[e(1763)];let g=null;if(t!==null){const n=t.length;g=new Array(n);for(let s=0;s!==n;++s)g[s]=t[s].clone()}return this[e(1763)]=g,this[e(2352)]=x[e(2352)],this[e(2443)]=x[e(2443)],this[e(2408)]=x[e(2408)],this.colorWrite=x[e(339)],this.precision=x.precision,this.polygonOffset=x[e(492)],this.polygonOffsetFactor=x[e(2996)],this[e(1215)]=x[e(1215)],this[e(1952)]=x[e(1952)],this[e(151)]=x[e(151)],this[e(2959)]=x[e(2959)],this.alphaToCoverage=x[e(1283)],this[e(3696)]=x[e(3696)],this[e(3374)]=x[e(3374)],this[e(2548)]=x[e(2548)],this[e(572)]=x[e(572)],this[e(358)]=JSON[e(3073)](JSON.stringify(x.userData)),this}[I(1439)](){this[I(1457)]({type:"dispose"})}set[I(2170)](x){const e=I;x===!0&&this[e(1450)]++}}class Ln extends lt{constructor(x){const e=I;super(),this[e(3731)]=!0,this[e(3505)]=e(3859),this[e(432)]=new Q0(16777215),this[e(3879)]=null,this[e(3997)]=null,this.lightMapIntensity=1,this[e(2042)]=null,this.aoMapIntensity=1,this[e(2887)]=null,this.alphaMap=null,this[e(1300)]=null,this.envMapRotation=new Tt,this[e(2667)]=YC,this[e(1695)]=1,this[e(3241)]=.98,this[e(2734)]=!1,this.wireframeLinewidth=1,this[e(579)]="round",this[e(1897)]=e(1008),this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this.color[e(1493)](x.color),this.map=x.map,this.lightMap=x.lightMap,this[e(899)]=x[e(899)],this[e(2042)]=x[e(2042)],this[e(904)]=x[e(904)],this[e(2887)]=x[e(2887)],this[e(3709)]=x[e(3709)],this[e(1300)]=x.envMap,this[e(1043)].copy(x[e(1043)]),this[e(2667)]=x[e(2667)],this.reflectivity=x[e(1695)],this.refractionRatio=x.refractionRatio,this[e(2734)]=x.wireframe,this[e(1979)]=x[e(1979)],this.wireframeLinecap=x[e(579)],this[e(1897)]=x[e(1897)],this[e(1382)]=x[e(1382)],this}}const Si=ES();function ES(){const i=new ArrayBuffer(4),x=new Float32Array(i),e=new Uint32Array(i),t=new Uint32Array(512),g=new Uint32Array(512);for(let c=0;c<256;++c){const C=c-127;C<-27?(t[c]=0,t[c|256]=32768,g[c]=24,g[c|256]=24):C<-14?(t[c]=1024>>-C-14,t[c|256]=1024>>-C-14|32768,g[c]=-C-1,g[c|256]=-C-1):C<=15?(t[c]=C+15<<10,t[c|256]=C+15<<10|32768,g[c]=13,g[c|256]=13):C<128?(t[c]=31744,t[c|256]=64512,g[c]=24,g[c|256]=24):(t[c]=31744,t[c|256]=64512,g[c]=13,g[c|256]=13)}const n=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let c=1;c<1024;++c){let C=c<<13,r=0;for(;!(C&8388608);)C<<=1,r-=8388608;C&=-8388609,r+=947912704,n[c]=C|r}for(let c=1024;c<2048;++c)n[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)s[c]=c<<23;s[31]=1199570944,s[32]=2147483648;for(let c=33;c<63;++c)s[c]=2147483648+(c-32<<23);s[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(o[c]=1024);return{floatView:x,uint32View:e,baseTable:t,shiftTable:g,mantissaTable:n,exponentTable:s,offsetTable:o}}function Yt(i){const x=I;Math.abs(i)>65504&&console[x(3748)](x(2547)),i=Ae(i,-65504,65504),Si[x(1104)][0]=i;const e=Si[x(2652)][0],t=e>>23&511;return Si[x(1437)][t]+((e&8388607)>>Si[x(819)][t])}function Wc(i){const x=I,e=i>>10;return Si[x(2652)][0]=Si[x(3281)][Si[x(323)][e]+(i&1023)]+Si.exponentTable[e],Si[x(1104)][0]}const US={toHalfFloat:Yt,fromHalfFloat:Wc},pe=new E,Aa=new S0;class Px{constructor(x,e,t=!1){const g=I;if(Array[g(1987)](x))throw new TypeError(g(2405));this[g(2522)]=!0,this[g(1474)]="",this[g(315)]=x,this[g(365)]=e,this[g(3411)]=x!==void 0?x.length/e:0,this[g(1894)]=t,this.usage=bC,this[g(2815)]={offset:0,count:-1},this[g(644)]=[],this.gpuType=pg,this[g(1450)]=0}[I(3390)](){}set needsUpdate(x){const e=I;x===!0&&this[e(1450)]++}get[I(3033)](){const x=I;return Gv("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this[x(2815)]}[I(1504)](x){return this.usage=x,this}addUpdateRange(x,e){const t=I;this[t(644)][t(3330)]({start:x,count:e})}clearUpdateRanges(){const x=I;this[x(644)][x(2989)]=0}copy(x){const e=I;return this.name=x[e(1474)],this[e(315)]=new x[e(315)][e(135)](x[e(315)]),this[e(365)]=x[e(365)],this[e(3411)]=x[e(3411)],this[e(1894)]=x[e(1894)],this.usage=x[e(1676)],this[e(1181)]=x[e(1181)],this}[I(2544)](x,e,t){const g=I;x*=this[g(365)],t*=e[g(365)];for(let n=0,s=this[g(365)];n<s;n++)this[g(315)][x+n]=e[g(315)][t+n];return this}[I(1251)](x){return this[I(315)].set(x),this}[I(1326)](x){const e=I;if(this[e(365)]===2)for(let t=0,g=this[e(3411)];t<g;t++)Aa[e(2404)](this,t),Aa.applyMatrix3(x),this[e(1436)](t,Aa.x,Aa.y);else if(this[e(365)]===3)for(let t=0,g=this[e(3411)];t<g;t++)pe.fromBufferAttribute(this,t),pe.applyMatrix3(x),this[e(3082)](t,pe.x,pe.y,pe.z);return this}[I(3075)](x){const e=I;for(let t=0,g=this[e(3411)];t<g;t++)pe.fromBufferAttribute(this,t),pe[e(3075)](x),this[e(3082)](t,pe.x,pe.y,pe.z);return this}applyNormalMatrix(x){const e=I;for(let t=0,g=this[e(3411)];t<g;t++)pe[e(2404)](this,t),pe[e(1433)](x),this.setXYZ(t,pe.x,pe.y,pe.z);return this}[I(1411)](x){const e=I;for(let t=0,g=this.count;t<g;t++)pe[e(2404)](this,t),pe[e(1411)](x),this[e(3082)](t,pe.x,pe.y,pe.z);return this}set(x,e=0){const t=I;return this[t(315)][t(298)](x,e),this}[I(1096)](x,e){const t=I;let g=this[t(315)][x*this[t(365)]+e];return this[t(1894)]&&(g=pt(g,this[t(315)])),g}[I(1473)](x,e,t){const g=I;return this[g(1894)]&&(t=Bx(t,this[g(315)])),this[g(315)][x*this.itemSize+e]=t,this}getX(x){const e=I;let t=this.array[x*this[e(365)]];return this.normalized&&(t=pt(t,this[e(315)])),t}[I(3126)](x,e){const t=I;return this.normalized&&(e=Bx(e,this[t(315)])),this[t(315)][x*this.itemSize]=e,this}[I(655)](x){const e=I;let t=this[e(315)][x*this.itemSize+1];return this[e(1894)]&&(t=pt(t,this.array)),t}[I(675)](x,e){const t=I;return this.normalized&&(e=Bx(e,this[t(315)])),this[t(315)][x*this.itemSize+1]=e,this}[I(2142)](x){const e=I;let t=this[e(315)][x*this.itemSize+2];return this[e(1894)]&&(t=pt(t,this[e(315)])),t}[I(2819)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this[t(315)])),this[t(315)][x*this[t(365)]+2]=e,this}[I(1176)](x){const e=I;let t=this[e(315)][x*this.itemSize+3];return this[e(1894)]&&(t=pt(t,this[e(315)])),t}setW(x,e){const t=I;return this.normalized&&(e=Bx(e,this[t(315)])),this[t(315)][x*this[t(365)]+3]=e,this}[I(1436)](x,e,t){const g=I;return x*=this.itemSize,this.normalized&&(e=Bx(e,this[g(315)]),t=Bx(t,this[g(315)])),this[g(315)][x+0]=e,this[g(315)][x+1]=t,this}setXYZ(x,e,t,g){const n=I;return x*=this.itemSize,this[n(1894)]&&(e=Bx(e,this[n(315)]),t=Bx(t,this[n(315)]),g=Bx(g,this[n(315)])),this[n(315)][x+0]=e,this.array[x+1]=t,this[n(315)][x+2]=g,this}[I(2753)](x,e,t,g,n){const s=I;return x*=this.itemSize,this[s(1894)]&&(e=Bx(e,this[s(315)]),t=Bx(t,this.array),g=Bx(g,this.array),n=Bx(n,this[s(315)])),this[s(315)][x+0]=e,this[s(315)][x+1]=t,this.array[x+2]=g,this[s(315)][x+3]=n,this}[I(2322)](x){const e=I;return this[e(3390)]=x,this}[I(3123)](){const x=I;return new this.constructor(this.array,this.itemSize)[x(1493)](this)}[I(2054)](){const x=I,e={itemSize:this[x(365)],type:this[x(315)][x(135)][x(1474)],array:Array[x(3803)](this.array),normalized:this[x(1894)]};return this[x(1474)]!==""&&(e[x(1474)]=this[x(1474)]),this.usage!==bC&&(e[x(1676)]=this[x(1676)]),e}}class _S extends Px{constructor(x,e,t){super(new Int8Array(x),e,t)}}class DS extends Px{constructor(x,e,t){super(new Uint8Array(x),e,t)}}class QS extends Px{constructor(x,e,t){super(new Uint8ClampedArray(x),e,t)}}class PS extends Px{constructor(x,e,t){super(new Int16Array(x),e,t)}}class Gf extends Px{constructor(x,e,t){super(new Uint16Array(x),e,t)}}class OS extends Px{constructor(x,e,t){super(new Int32Array(x),e,t)}}class pf extends Px{constructor(x,e,t){super(new Uint32Array(x),e,t)}}class qS extends Px{constructor(x,e,t){super(new Uint16Array(x),e,t),this.isFloat16BufferAttribute=!0}[I(1829)](x){const e=I;let t=Wc(this.array[x*this[e(365)]]);return this[e(1894)]&&(t=pt(t,this[e(315)])),t}[I(3126)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this.array)),this[t(315)][x*this.itemSize]=Yt(e),this}getY(x){const e=I;let t=Wc(this[e(315)][x*this[e(365)]+1]);return this.normalized&&(t=pt(t,this[e(315)])),t}[I(675)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this[t(315)])),this[t(315)][x*this.itemSize+1]=Yt(e),this}[I(2142)](x){const e=I;let t=Wc(this[e(315)][x*this.itemSize+2]);return this.normalized&&(t=pt(t,this[e(315)])),t}[I(2819)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this[t(315)])),this[t(315)][x*this.itemSize+2]=Yt(e),this}[I(1176)](x){const e=I;let t=Wc(this[e(315)][x*this[e(365)]+3]);return this[e(1894)]&&(t=pt(t,this[e(315)])),t}[I(2607)](x,e){const t=I;return this.normalized&&(e=Bx(e,this[t(315)])),this[t(315)][x*this[t(365)]+3]=Yt(e),this}[I(1436)](x,e,t){const g=I;return x*=this.itemSize,this.normalized&&(e=Bx(e,this[g(315)]),t=Bx(t,this.array)),this[g(315)][x+0]=Yt(e),this[g(315)][x+1]=Yt(t),this}[I(3082)](x,e,t,g){const n=I;return x*=this[n(365)],this[n(1894)]&&(e=Bx(e,this[n(315)]),t=Bx(t,this.array),g=Bx(g,this[n(315)])),this[n(315)][x+0]=Yt(e),this.array[x+1]=Yt(t),this[n(315)][x+2]=Yt(g),this}[I(2753)](x,e,t,g,n){const s=I;return x*=this[s(365)],this.normalized&&(e=Bx(e,this[s(315)]),t=Bx(t,this[s(315)]),g=Bx(g,this[s(315)]),n=Bx(n,this.array)),this[s(315)][x+0]=Yt(e),this.array[x+1]=Yt(t),this[s(315)][x+2]=Yt(g),this[s(315)][x+3]=Yt(n),this}}class ix extends Px{constructor(x,e,t){super(new Float32Array(x),e,t)}}let $S=0;const rg=new dx,DA=new Nx,bs=new E,qt=new yt,oc=new yt,Ne=new E;class vx extends Qi{constructor(){const x=I;super(),this.isBufferGeometry=!0,Object[x(2899)](this,"id",{value:$S++}),this[x(296)]=gg(),this[x(1474)]="",this[x(3505)]="BufferGeometry",this[x(587)]=null,this[x(2593)]={},this[x(593)]={},this.morphTargetsRelative=!1,this[x(919)]=[],this[x(3344)]=null,this[x(3636)]=null,this[x(753)]={start:0,count:1/0},this[x(358)]={}}[I(3268)](){return this[I(587)]}[I(3317)](x){const e=I;return Array[e(1987)](x)?this[e(587)]=new(fv(x)?pf:Gf)(x,1):this[e(587)]=x,this}[I(2606)](x){return this[I(2593)][x]}setAttribute(x,e){return this.attributes[x]=e,this}[I(2124)](x){const e=I;return delete this[e(2593)][x],this}[I(1065)](x){return this.attributes[x]!==void 0}[I(184)](x,e,t=0){const g=I;this[g(919)][g(3330)]({start:x,count:e,materialIndex:t})}[I(669)](){const x=I;this[x(919)]=[]}[I(1354)](x,e){const t=I;this[t(753)][t(3988)]=x,this[t(753)].count=e}applyMatrix4(x){const e=I,t=this[e(2593)][e(2817)];t!==void 0&&(t[e(3075)](x),t[e(2170)]=!0);const g=this[e(2593)].normal;if(g!==void 0){const s=new px()[e(2809)](x);g[e(1433)](s),g[e(2170)]=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(x),n[e(2170)]=!0),this[e(3344)]!==null&&this.computeBoundingBox(),this[e(3636)]!==null&&this[e(1668)](),this}[I(2235)](x){const e=I;return rg[e(764)](x),this[e(3075)](rg),this}[I(3550)](x){const e=I;return rg[e(961)](x),this[e(3075)](rg),this}[I(3308)](x){const e=I;return rg[e(3447)](x),this[e(3075)](rg),this}rotateZ(x){return rg[I(2533)](x),this.applyMatrix4(rg),this}[I(2945)](x,e,t){const g=I;return rg[g(804)](x,e,t),this[g(3075)](rg),this}[I(623)](x,e,t){const g=I;return rg[g(1761)](x,e,t),this[g(3075)](rg),this}lookAt(x){const e=I;return DA[e(2765)](x),DA.updateMatrix(),this.applyMatrix4(DA[e(1721)]),this}center(){const x=I;return this.computeBoundingBox(),this[x(3344)][x(878)](bs)[x(3217)](),this[x(2945)](bs.x,bs.y,bs.z),this}[I(1666)](x){const e=I,t=[];for(let g=0,n=x[e(2989)];g<n;g++){const s=x[g];t[e(3330)](s.x,s.y,s.z||0)}return this[e(1236)]("position",new ix(t,3)),this}[I(3775)](){const x=I;this.boundingBox===null&&(this.boundingBox=new yt);const e=this.attributes[x(2817)],t=this.morphAttributes[x(2817)];if(e&&e.isGLBufferAttribute){console[x(2963)]("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this[x(3344)].set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));return}if(e!==void 0){if(this[x(3344)][x(460)](e),t)for(let g=0,n=t[x(2989)];g<n;g++){const s=t[g];qt[x(460)](s),this.morphTargetsRelative?(Ne.addVectors(this[x(3344)][x(1410)],qt.min),this[x(3344)].expandByPoint(Ne),Ne.addVectors(this[x(3344)].max,qt[x(1971)]),this[x(3344)][x(3282)](Ne)):(this.boundingBox[x(3282)](qt[x(1410)]),this.boundingBox[x(3282)](qt.max))}}else this.boundingBox[x(3734)]();(isNaN(this[x(3344)][x(1410)].x)||isNaN(this.boundingBox[x(1410)].y)||isNaN(this.boundingBox.min.z))&&console.error(x(3522),this)}[I(1668)](){const x=I;this.boundingSphere===null&&(this[x(3636)]=new ct);const e=this[x(2593)].position,t=this[x(593)][x(2817)];if(e&&e[x(3247)]){console[x(2963)](x(3320),this),this[x(3636)][x(298)](new E,1/0);return}if(e){const g=this[x(3636)][x(3416)];if(qt.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const c=t[s];oc[x(460)](c),this[x(316)]?(Ne[x(3107)](qt[x(1410)],oc[x(1410)]),qt[x(3282)](Ne),Ne[x(3107)](qt[x(1971)],oc[x(1971)]),qt[x(3282)](Ne)):(qt.expandByPoint(oc[x(1410)]),qt[x(3282)](oc[x(1971)]))}qt.getCenter(g);let n=0;for(let s=0,o=e[x(3411)];s<o;s++)Ne[x(2404)](e,s),n=Math[x(1971)](n,g[x(3489)](Ne));if(t)for(let s=0,o=t[x(2989)];s<o;s++){const c=t[s],C=this.morphTargetsRelative;for(let r=0,A=c[x(3411)];r<A;r++)Ne.fromBufferAttribute(c,r),C&&(bs.fromBufferAttribute(e,r),Ne[x(3014)](bs)),n=Math[x(1971)](n,g.distanceToSquared(Ne))}this[x(3636)].radius=Math[x(3641)](n),isNaN(this[x(3636)][x(3015)])&&console[x(2963)](x(3087),this)}}[I(1558)](){const x=I,e=this[x(587)],t=this[x(2593)];if(e===null||t[x(2817)]===void 0||t[x(3204)]===void 0||t.uv===void 0){console[x(2963)]("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const g=t.position,n=t[x(3204)],s=t.uv;this[x(1065)]("tangent")===!1&&this[x(1236)]("tangent",new Px(new Float32Array(4*g[x(3411)]),4));const o=this[x(2606)](x(132)),c=[],C=[];for(let M=0;M<g.count;M++)c[M]=new E,C[M]=new E;const r=new E,A=new E,d=new E,h=new S0,f=new S0,B=new S0,Z=new E,G=new E;function m(M,Y,S){const H=x;r[H(2404)](g,M),A[H(2404)](g,Y),d[H(2404)](g,S),h.fromBufferAttribute(s,M),f[H(2404)](s,Y),B[H(2404)](s,S),A.sub(r),d.sub(r),f[H(3938)](h),B[H(3938)](h);const O=1/(f.x*B.y-B.x*f.y);isFinite(O)&&(Z[H(1493)](A)[H(2333)](B.y).addScaledVector(d,-f.y).multiplyScalar(O),G[H(1493)](d)[H(2333)](f.x)[H(832)](A,-B.x)[H(2333)](O),c[M][H(3014)](Z),c[Y][H(3014)](Z),c[S].add(Z),C[M][H(3014)](G),C[Y][H(3014)](G),C[S][H(3014)](G))}let v=this[x(919)];v[x(2989)]===0&&(v=[{start:0,count:e[x(3411)]}]);for(let M=0,Y=v[x(2989)];M<Y;++M){const S=v[M],H=S[x(3988)],O=S[x(3411)];for(let I0=H,z=H+O;I0<z;I0+=3)m(e[x(1829)](I0+0),e[x(1829)](I0+1),e.getX(I0+2))}const p=new E,w=new E,V=new E,N=new E;function X(M){const Y=x;V[Y(2404)](n,M),N[Y(1493)](V);const S=c[M];p[Y(1493)](S),p[Y(3938)](V[Y(2333)](V.dot(S)))[Y(3762)](),w[Y(1604)](N,S);const H=w[Y(1760)](C[M]),O=H<0?-1:1;o[Y(2753)](M,p.x,p.y,p.z,O)}for(let M=0,Y=v[x(2989)];M<Y;++M){const S=v[M],H=S[x(3988)],O=S[x(3411)];for(let I0=H,z=H+O;I0<z;I0+=3)X(e[x(1829)](I0+0)),X(e[x(1829)](I0+1)),X(e[x(1829)](I0+2))}}[I(1083)](){const x=I,e=this.index,t=this[x(2606)](x(2817));if(t!==void 0){let g=this[x(2606)](x(3204));if(g===void 0)g=new Px(new Float32Array(t[x(3411)]*3),3),this.setAttribute("normal",g);else for(let h=0,f=g.count;h<f;h++)g[x(3082)](h,0,0,0);const n=new E,s=new E,o=new E,c=new E,C=new E,r=new E,A=new E,d=new E;if(e)for(let h=0,f=e[x(3411)];h<f;h+=3){const B=e[x(1829)](h+0),Z=e[x(1829)](h+1),G=e[x(1829)](h+2);n[x(2404)](t,B),s.fromBufferAttribute(t,Z),o[x(2404)](t,G),A[x(859)](o,s),d[x(859)](n,s),A[x(1092)](d),c[x(2404)](g,B),C[x(2404)](g,Z),r[x(2404)](g,G),c.add(A),C[x(3014)](A),r[x(3014)](A),g[x(3082)](B,c.x,c.y,c.z),g[x(3082)](Z,C.x,C.y,C.z),g[x(3082)](G,r.x,r.y,r.z)}else for(let h=0,f=t[x(3411)];h<f;h+=3)n[x(2404)](t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),A[x(859)](o,s),d[x(859)](n,s),A[x(1092)](d),g.setXYZ(h+0,A.x,A.y,A.z),g.setXYZ(h+1,A.x,A.y,A.z),g[x(3082)](h+2,A.x,A.y,A.z);this[x(2349)](),g[x(2170)]=!0}}[I(2349)](){const x=I,e=this[x(2593)][x(3204)];for(let t=0,g=e[x(3411)];t<g;t++)Ne.fromBufferAttribute(e,t),Ne.normalize(),e[x(3082)](t,Ne.x,Ne.y,Ne.z)}[I(1498)](){const x=I;function e(c,C){const r=i0,A=c[r(315)],d=c[r(365)],h=c[r(1894)],f=new A[r(135)](C[r(2989)]*d);let B=0,Z=0;for(let G=0,m=C[r(2989)];G<m;G++){c[r(2568)]?B=C[G]*c[r(3787)][r(1947)]+c[r(872)]:B=C[G]*d;for(let v=0;v<d;v++)f[Z++]=A[B++]}return new Px(f,d,h)}if(this[x(587)]===null)return console.warn(x(1318)),this;const t=new vx,g=this.index[x(315)],n=this.attributes;for(const c in n){const C=n[c],r=e(C,g);t[x(1236)](c,r)}const s=this[x(593)];for(const c in s){const C=[],r=s[c];for(let A=0,d=r.length;A<d;A++){const h=r[A],f=e(h,g);C[x(3330)](f)}t.morphAttributes[c]=C}t.morphTargetsRelative=this[x(316)];const o=this[x(919)];for(let c=0,C=o[x(2989)];c<C;c++){const r=o[c];t[x(184)](r[x(3988)],r[x(3411)],r[x(2468)])}return t}[I(2054)](){const x=I,e={metadata:{version:4.6,type:x(3982),generator:x(1229)}};if(e[x(296)]=this.uuid,e[x(3505)]=this[x(3505)],this[x(1474)]!==""&&(e[x(1474)]=this[x(1474)]),Object[x(958)](this.userData)[x(2989)]>0&&(e[x(358)]=this.userData),this[x(361)]!==void 0){const C=this[x(361)];for(const r in C)C[r]!==void 0&&(e[r]=C[r]);return e}e.data={attributes:{}};const t=this[x(587)];t!==null&&(e[x(3787)][x(587)]={type:t.array[x(135)][x(1474)],array:Array[x(1566)][x(1226)][x(2627)](t[x(315)])});const g=this.attributes;for(const C in g){const r=g[C];e[x(3787)][x(2593)][C]=r.toJSON(e[x(3787)])}const n={};let s=!1;for(const C in this.morphAttributes){const r=this[x(593)][C],A=[];for(let d=0,h=r.length;d<h;d++){const f=r[d];A.push(f[x(2054)](e[x(3787)]))}A[x(2989)]>0&&(n[C]=A,s=!0)}s&&(e[x(3787)][x(593)]=n,e[x(3787)].morphTargetsRelative=this.morphTargetsRelative);const o=this[x(919)];o[x(2989)]>0&&(e.data[x(919)]=JSON[x(3073)](JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e[x(3787)].boundingSphere={center:c.center.toArray(),radius:c.radius}),e}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}[I(1493)](x){const e=I;this[e(587)]=null,this.attributes={},this[e(593)]={},this[e(919)]=[],this[e(3344)]=null,this[e(3636)]=null;const t={};this[e(1474)]=x.name;const g=x[e(587)];g!==null&&this[e(3317)](g[e(3123)](t));const n=x[e(2593)];for(const r in n){const A=n[r];this[e(1236)](r,A[e(3123)](t))}const s=x[e(593)];for(const r in s){const A=[],d=s[r];for(let h=0,f=d[e(2989)];h<f;h++)A[e(3330)](d[h][e(3123)](t));this.morphAttributes[r]=A}this[e(316)]=x[e(316)];const o=x[e(919)];for(let r=0,A=o[e(2989)];r<A;r++){const d=o[r];this.addGroup(d[e(3988)],d.count,d.materialIndex)}const c=x[e(3344)];c!==null&&(this[e(3344)]=c[e(3123)]());const C=x[e(3636)];return C!==null&&(this[e(3636)]=C.clone()),this[e(753)][e(3988)]=x[e(753)][e(3988)],this[e(753)][e(3411)]=x[e(753)].count,this.userData=x[e(358)],this}[I(1439)](){const x=I;this.dispatchEvent({type:x(1439)})}}const $G=new dx,eI=new vo,ua=new ct,jG=new E,hs=new E,fs=new E,ms=new E,QA=new E,ba=new E,ha=new S0,fa=new S0,ma=new S0,xp=new E,ep=new E,tp=new E,Ga=new E,pa=new E;class ye extends Nx{constructor(x=new vx,e=new Ln){const t=I;super(),this[t(2241)]=!0,this[t(3505)]=t(483),this[t(352)]=x,this[t(3480)]=e,this[t(1667)]()}copy(x,e){const t=I;return super[t(1493)](x,e),x.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=x[t(2891)].slice()),x[t(3300)]!==void 0&&(this[t(3300)]=Object[t(1859)]({},x[t(3300)])),this.material=Array[t(1987)](x[t(3480)])?x.material.slice():x[t(3480)],this.geometry=x[t(352)],this}[I(1667)](){const x=I,e=this[x(352)],t=e[x(593)],g=Object[x(958)](t);if(g[x(2989)]>0){const n=t[g[0]];if(n!==void 0){this.morphTargetInfluences=[],this[x(3300)]={};for(let s=0,o=n[x(2989)];s<o;s++){const c=n[s][x(1474)]||String(s);this[x(2891)][x(3330)](0),this[x(3300)][c]=s}}}}[I(3254)](x,e){const t=I,g=this[t(352)],n=g.attributes[t(2817)],s=g[t(593)][t(2817)],o=g[t(316)];e[t(2404)](n,x);const c=this.morphTargetInfluences;if(s&&c){ba.set(0,0,0);for(let C=0,r=s[t(2989)];C<r;C++){const A=c[C],d=s[C];A!==0&&(QA[t(2404)](d,x),o?ba[t(832)](QA,A):ba[t(832)](QA[t(3938)](e),A))}e[t(3014)](ba)}return e}[I(785)](x,e){const t=I,g=this[t(352)],n=this[t(3480)],s=this[t(2368)];n!==void 0&&(g.boundingSphere===null&&g[t(1668)](),ua.copy(g[t(3636)]),ua[t(3075)](s),eI[t(1493)](x[t(1253)])[t(2439)](x[t(2987)]),!(ua.containsPoint(eI[t(3519)])===!1&&(eI[t(1298)](ua,jG)===null||eI[t(3519)].distanceToSquared(jG)>(x[t(1407)]-x[t(2987)])**2))&&($G[t(1493)](s).invert(),eI[t(1493)](x[t(1253)])[t(3075)]($G),!(g[t(3344)]!==null&&eI[t(2425)](g[t(3344)])===!1)&&this[t(418)](x,e,eI)))}[I(418)](x,e,t){const g=I;let n;const s=this[g(352)],o=this.material,c=s[g(587)],C=s[g(2593)][g(2817)],r=s[g(2593)].uv,A=s[g(2593)].uv1,d=s.attributes[g(3204)],h=s.groups,f=s[g(753)];if(c!==null)if(Array.isArray(o))for(let B=0,Z=h.length;B<Z;B++){const G=h[B],m=o[G[g(2468)]],v=Math[g(1971)](G.start,f[g(3988)]),p=Math[g(1410)](c[g(3411)],Math[g(1410)](G[g(3988)]+G[g(3411)],f[g(3988)]+f[g(3411)]));for(let w=v,V=p;w<V;w+=3){const N=c[g(1829)](w),X=c[g(1829)](w+1),M=c.getX(w+2);n=Ba(this,m,x,t,r,A,d,N,X,M),n&&(n[g(3431)]=Math[g(3143)](w/3),n[g(1454)][g(2468)]=G[g(2468)],e.push(n))}}else{const B=Math[g(1971)](0,f[g(3988)]),Z=Math.min(c.count,f[g(3988)]+f[g(3411)]);for(let G=B,m=Z;G<m;G+=3){const v=c[g(1829)](G),p=c[g(1829)](G+1),w=c[g(1829)](G+2);n=Ba(this,o,x,t,r,A,d,v,p,w),n&&(n[g(3431)]=Math[g(3143)](G/3),e[g(3330)](n))}}else if(C!==void 0)if(Array[g(1987)](o))for(let B=0,Z=h.length;B<Z;B++){const G=h[B],m=o[G[g(2468)]],v=Math.max(G.start,f[g(3988)]),p=Math.min(C[g(3411)],Math.min(G[g(3988)]+G[g(3411)],f[g(3988)]+f[g(3411)]));for(let w=v,V=p;w<V;w+=3){const N=w,X=w+1,M=w+2;n=Ba(this,m,x,t,r,A,d,N,X,M),n&&(n[g(3431)]=Math[g(3143)](w/3),n[g(1454)][g(2468)]=G.materialIndex,e[g(3330)](n))}}else{const B=Math[g(1971)](0,f[g(3988)]),Z=Math[g(1410)](C.count,f[g(3988)]+f[g(3411)]);for(let G=B,m=Z;G<m;G+=3){const v=G,p=G+1,w=G+2;n=Ba(this,o,x,t,r,A,d,v,p,w),n&&(n[g(3431)]=Math.floor(G/3),e[g(3330)](n))}}}}function jS(i,x,e,t,g,n,s,o){const c=I;let C;if(x[c(3601)]===Zt?C=t[c(3745)](s,n,g,!0,o):C=t.intersectTriangle(g,n,s,x[c(3601)]===Ji,o),C===null)return null;pa[c(1493)](o),pa[c(3075)](i[c(2368)]);const r=e.ray[c(3519)].distanceTo(pa);return r<e[c(2987)]||r>e[c(1407)]?null:{distance:r,point:pa[c(3123)](),object:i}}function Ba(i,x,e,t,g,n,s,o,c,C){const r=I;i[r(3254)](o,hs),i[r(3254)](c,fs),i.getVertexPosition(C,ms);const A=jS(i,x,e,t,hs,fs,ms,Ga);if(A){g&&(ha.fromBufferAttribute(g,o),fa[r(2404)](g,c),ma.fromBufferAttribute(g,C),A.uv=xg.getInterpolation(Ga,hs,fs,ms,ha,fa,ma,new S0)),n&&(ha[r(2404)](n,o),fa[r(2404)](n,c),ma.fromBufferAttribute(n,C),A[r(1425)]=xg[r(3216)](Ga,hs,fs,ms,ha,fa,ma,new S0)),s&&(xp[r(2404)](s,o),ep.fromBufferAttribute(s,c),tp[r(2404)](s,C),A[r(3204)]=xg[r(3216)](Ga,hs,fs,ms,xp,ep,tp,new E),A.normal[r(1760)](t[r(2721)])>0&&A[r(3204)].multiplyScalar(-1));const d={a:o,b:c,c:C,normal:new E,materialIndex:0};xg[r(3943)](hs,fs,ms,d[r(3204)]),A[r(1454)]=d}return A}class UI extends vx{constructor(x=1,e=1,t=1,g=1,n=1,s=1){const o=I;super(),this[o(3505)]=o(1936),this[o(361)]={width:x,height:e,depth:t,widthSegments:g,heightSegments:n,depthSegments:s};const c=this;g=Math[o(3143)](g),n=Math[o(3143)](n),s=Math[o(3143)](s);const C=[],r=[],A=[],d=[];let h=0,f=0;B("z","y","x",-1,-1,t,e,x,s,n,0),B("z","y","x",1,-1,t,e,-x,s,n,1),B("x","z","y",1,1,x,t,e,g,s,2),B("x","z","y",1,-1,x,t,-e,g,s,3),B("x","y","z",1,-1,x,e,t,g,n,4),B("x","y","z",-1,-1,x,e,-t,g,n,5),this[o(3317)](C),this[o(1236)]("position",new ix(r,3)),this[o(1236)]("normal",new ix(A,3)),this[o(1236)]("uv",new ix(d,2));function B(Z,G,m,v,p,w,V,N,X,M,Y){const S=o,H=w/X,O=V/M,I0=w/2,z=V/2,b0=N/2,f0=X+1,G0=M+1;let $=0,j=0;const x0=new E;for(let c0=0;c0<G0;c0++){const h0=c0*O-z;for(let X0=0;X0<f0;X0++){const n0=X0*H-I0;x0[Z]=n0*v,x0[G]=h0*p,x0[m]=b0,r[S(3330)](x0.x,x0.y,x0.z),x0[Z]=0,x0[G]=0,x0[m]=N>0?1:-1,A[S(3330)](x0.x,x0.y,x0.z),d[S(3330)](X0/X),d[S(3330)](1-c0/M),$+=1}}for(let c0=0;c0<M;c0++)for(let h0=0;h0<X;h0++){const X0=h+h0+f0*c0,n0=h+h0+f0*(c0+1),g0=h+(h0+1)+f0*(c0+1),l0=h+(h0+1)+f0*c0;C.push(X0,n0,l0),C.push(n0,g0,l0),j+=6}c.addGroup(f,j,Y),f+=j,h+=$}}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static[I(3385)](x){const e=I;return new UI(x[e(2315)],x[e(2741)],x[e(3936)],x.widthSegments,x[e(3022)],x[e(455)])}}function fo(i){const x=I,e={};for(const t in i){e[t]={};for(const g in i[t]){const n=i[t][g];n&&(n.isColor||n[x(3868)]||n.isMatrix4||n[x(3856)]||n[x(2752)]||n[x(658)]||n.isTexture||n.isQuaternion)?n[x(1309)]?(console[x(3748)]("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][g]=null):e[t][g]=n[x(3123)]():Array[x(1987)](n)?e[t][g]=n[x(1226)]():e[t][g]=n}}return e}function bt(i){const x=I,e={};for(let t=0;t<i[x(2989)];t++){const g=fo(i[t]);for(const n in g)e[n]=g[n]}return e}function xX(i){const x=I,e=[];for(let t=0;t<i[x(2989)];t++)e.push(i[t][x(3123)]());return e}function yv(i){const x=I,e=i[x(1117)]();return e===null?i[x(3930)]:e[x(1679)]===!0?e.texture[x(1549)]:_x.workingColorSpace}const vv={clone:fo,merge:bt};var eX=I(3314),tX=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Eg extends lt{constructor(x){const e=I;super(),this[e(1742)]=!0,this[e(3505)]="ShaderMaterial",this.defines={},this.uniforms={},this[e(2259)]=[],this[e(3353)]=eX,this[e(3060)]=tX,this[e(3725)]=1,this[e(2734)]=!1,this[e(1979)]=1,this.fog=!1,this.lights=!1,this.clipping=!1,this[e(3374)]=!0,this[e(986)]={clipCullDistance:!1,multiDraw:!1},this[e(195)]={color:[1,1,1],uv:[0,0],uv1:[0,0]},this[e(2685)]=void 0,this[e(2849)]=!1,this[e(3614)]=null,x!==void 0&&this[e(3001)](x)}copy(x){const e=I;return super.copy(x),this.fragmentShader=x[e(3060)],this.vertexShader=x[e(3353)],this[e(3901)]=fo(x.uniforms),this[e(2259)]=xX(x[e(2259)]),this[e(3891)]=Object[e(1859)]({},x[e(3891)]),this[e(2734)]=x[e(2734)],this[e(1979)]=x[e(1979)],this[e(1382)]=x[e(1382)],this[e(1480)]=x[e(1480)],this.clipping=x[e(933)],this[e(986)]=Object[e(1859)]({},x[e(986)]),this[e(3614)]=x.glslVersion,this}[I(2054)](x){const e=I,t=super[e(2054)](x);t[e(3614)]=this[e(3614)],t[e(3901)]={};for(const n in this[e(3901)]){const s=this[e(3901)][n],o=s[e(2113)];o&&o.isTexture?t[e(3901)][n]={type:"t",value:o[e(2054)](x).uuid}:o&&o[e(1892)]?t[e(3901)][n]={type:"c",value:o[e(2830)]()}:o&&o[e(3856)]?t[e(3901)][n]={type:"v2",value:o[e(3904)]()}:o&&o[e(2752)]?t.uniforms[n]={type:"v3",value:o[e(3904)]()}:o&&o[e(658)]?t.uniforms[n]={type:"v4",value:o[e(3904)]()}:o&&o.isMatrix3?t.uniforms[n]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t[e(3901)][n]={type:"m4",value:o[e(3904)]()}:t[e(3901)][n]={value:o}}Object[e(958)](this[e(3891)])[e(2989)]>0&&(t[e(3891)]=this[e(3891)]),t[e(3353)]=this.vertexShader,t.fragmentShader=this[e(3060)],t[e(1480)]=this[e(1480)],t[e(933)]=this.clipping;const g={};for(const n in this[e(986)])this[e(986)][n]===!0&&(g[n]=!0);return Object.keys(g).length>0&&(t[e(986)]=g),t}}class NC extends Nx{constructor(){const x=I;super(),this[x(980)]=!0,this[x(3505)]=x(2028),this[x(2519)]=new dx,this[x(2900)]=new dx,this[x(2957)]=new dx,this[x(366)]=ci}copy(x,e){const t=I;return super[t(1493)](x,e),this[t(2519)][t(1493)](x[t(2519)]),this[t(2900)][t(1493)](x[t(2900)]),this[t(2957)].copy(x[t(2957)]),this[t(366)]=x.coordinateSystem,this}getWorldDirection(x){return super.getWorldDirection(x).negate()}updateMatrixWorld(x){const e=I;super[e(3554)](x),this[e(2519)][e(1493)](this[e(2368)])[e(2483)]()}[I(2144)](x,e){const t=I;super[t(2144)](x,e),this.matrixWorldInverse.copy(this[t(2368)])[t(2483)]()}clone(){const x=I;return new this[x(135)]()[x(1493)](this)}}const an=new E,gp=new S0,ip=new S0;class ze extends NC{constructor(x=50,e=1,t=.1,g=2e3){const n=I;super(),this[n(1928)]=!0,this[n(3505)]=n(378),this.fov=x,this[n(3981)]=1,this.near=t,this.far=g,this[n(2950)]=10,this[n(3455)]=e,this[n(2728)]=null,this.filmGauge=35,this.filmOffset=0,this[n(3947)]()}copy(x,e){const t=I;return super[t(1493)](x,e),this[t(1302)]=x.fov,this[t(3981)]=x[t(3981)],this[t(2987)]=x[t(2987)],this[t(1407)]=x[t(1407)],this[t(2950)]=x[t(2950)],this[t(3455)]=x.aspect,this[t(2728)]=x[t(2728)]===null?null:Object.assign({},x[t(2728)]),this[t(3970)]=x[t(3970)],this[t(3976)]=x[t(3976)],this}[I(1905)](x){const e=I,t=.5*this[e(238)]()/x;this[e(1302)]=ho*2*Math[e(873)](t),this[e(3947)]()}[I(2366)](){const x=I,e=Math[x(1597)](YI*.5*this[x(1302)]);return .5*this.getFilmHeight()/e}[I(2916)](){const x=I;return ho*2*Math.atan(Math[x(1597)](YI*.5*this[x(1302)])/this[x(3981)])}[I(2479)](){const x=I;return this[x(3970)]*Math[x(1410)](this[x(3455)],1)}[I(238)](){const x=I;return this[x(3970)]/Math[x(1971)](this.aspect,1)}[I(3093)](x,e,t){const g=I;an[g(298)](-1,-1,.5)[g(3075)](this.projectionMatrixInverse),e[g(298)](an.x,an.y)[g(2333)](-x/an.z),an[g(298)](1,1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(an.x,an.y)[g(2333)](-x/an.z)}[I(1186)](x,e){const t=I;return this[t(3093)](x,gp,ip),e[t(859)](ip,gp)}[I(1618)](x,e,t,g,n,s){const o=I;this.aspect=x/e,this[o(2728)]===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view[o(2648)]=!0,this[o(2728)][o(2400)]=x,this[o(2728)][o(1139)]=e,this[o(2728)][o(2119)]=t,this[o(2728)].offsetY=g,this[o(2728)][o(2315)]=n,this.view.height=s,this.updateProjectionMatrix()}[I(3893)](){const x=I;this[x(2728)]!==null&&(this[x(2728)][x(2648)]=!1),this[x(3947)]()}[I(3947)](){const x=I,e=this[x(2987)];let t=e*Math[x(1597)](YI*.5*this.fov)/this.zoom,g=2*t,n=this[x(3455)]*g,s=-.5*n;const o=this[x(2728)];if(this[x(2728)]!==null&&this[x(2728)][x(2648)]){const C=o[x(2400)],r=o[x(1139)];s+=o[x(2119)]*n/C,t-=o.offsetY*g/r,n*=o[x(2315)]/C,g*=o[x(2741)]/r}const c=this[x(3976)];c!==0&&(s+=e*c/this.getFilmWidth()),this[x(2900)][x(994)](s,s+n,t,t-g,e,this.far,this[x(366)]),this[x(2957)].copy(this[x(2900)]).invert()}toJSON(x){const e=I,t=super.toJSON(x);return t[e(1011)][e(1302)]=this[e(1302)],t[e(1011)].zoom=this.zoom,t[e(1011)].near=this[e(2987)],t.object[e(1407)]=this.far,t[e(1011)][e(2950)]=this[e(2950)],t[e(1011)][e(3455)]=this[e(3455)],this[e(2728)]!==null&&(t[e(1011)][e(2728)]=Object[e(1859)]({},this.view)),t[e(1011)][e(3970)]=this.filmGauge,t[e(1011)][e(3976)]=this[e(3976)],t}}const Gs=-90,ps=1;class Wv extends Nx{constructor(x,e,t){const g=I;super(),this[g(3505)]=g(3711),this[g(3176)]=t,this[g(366)]=null,this[g(1990)]=0;const n=new ze(Gs,ps,x,e);n[g(2669)]=this[g(2669)],this[g(3014)](n);const s=new ze(Gs,ps,x,e);s[g(2669)]=this.layers,this[g(3014)](s);const o=new ze(Gs,ps,x,e);o.layers=this.layers,this[g(3014)](o);const c=new ze(Gs,ps,x,e);c[g(2669)]=this[g(2669)],this[g(3014)](c);const C=new ze(Gs,ps,x,e);C[g(2669)]=this[g(2669)],this.add(C);const r=new ze(Gs,ps,x,e);r.layers=this.layers,this[g(3014)](r)}[I(2e3)](){const x=I,e=this[x(366)],t=this[x(1352)][x(534)](),[g,n,s,o,c,C]=t;for(const r of t)this[x(2208)](r);if(e===ci)g.up[x(298)](0,1,0),g[x(2765)](1,0,0),n.up[x(298)](0,1,0),n[x(2765)](-1,0,0),s.up[x(298)](0,0,-1),s.lookAt(0,1,0),o.up[x(298)](0,0,1),o[x(2765)](0,-1,0),c.up.set(0,1,0),c[x(2765)](0,0,1),C.up[x(298)](0,1,0),C.lookAt(0,0,-1);else if(e===hC)g.up[x(298)](0,-1,0),g[x(2765)](-1,0,0),n.up[x(298)](0,-1,0),n[x(2765)](1,0,0),s.up.set(0,0,1),s[x(2765)](0,1,0),o.up[x(298)](0,0,-1),o[x(2765)](0,-1,0),c.up.set(0,-1,0),c[x(2765)](0,0,1),C.up[x(298)](0,-1,0),C[x(2765)](0,0,-1);else throw new Error(x(2062)+e);for(const r of t)this[x(3014)](r),r[x(3554)]()}[I(2341)](x,e){const t=I;this[t(1064)]===null&&this[t(3554)]();const{renderTarget:g,activeMipmapLevel:n}=this;this.coordinateSystem!==x.coordinateSystem&&(this[t(366)]=x[t(366)],this[t(2e3)]());const[s,o,c,C,r,A]=this[t(1352)],d=x[t(1117)](),h=x[t(3152)](),f=x.getActiveMipmapLevel(),B=x.xr.enabled;x.xr[t(2648)]=!1;const Z=g.texture.generateMipmaps;g.texture[t(2787)]=!1,x[t(681)](g,0,n),x[t(948)](e,s),x.setRenderTarget(g,1,n),x.render(e,o),x.setRenderTarget(g,2,n),x[t(948)](e,c),x.setRenderTarget(g,3,n),x[t(948)](e,C),x[t(681)](g,4,n),x[t(948)](e,r),g[t(3840)].generateMipmaps=Z,x[t(681)](g,5,n),x.render(e,A),x[t(681)](d,h,f),x.xr[t(2648)]=B,g[t(3840)][t(3669)]=!0}}class FC extends ue{constructor(x,e,t,g,n,s,o,c,C,r){const A=I;x=x!==void 0?x:[],e=e!==void 0?e:Ei,super(x,e,t,g,n,s,o,c,C,r),this[A(3679)]=!0,this[A(233)]=!1}get[I(2268)](){return this[I(1781)]}set[I(2268)](x){const e=I;this[e(1781)]=x}}class wv extends Jg{constructor(x=1,e={}){const t=I;super(x,x,e),this[t(3948)]=!0;const g={width:x,height:x,depth:1},n=[g,g,g,g,g,g];this[t(3840)]=new FC(n,e.mapping,e[t(861)],e[t(471)],e[t(2637)],e[t(3338)],e[t(3207)],e[t(3505)],e[t(2651)],e[t(1549)]),this[t(3840)][t(1309)]=!0,this[t(3840)].generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this[t(3840)].minFilter=e[t(3338)]!==void 0?e.minFilter:Ze}[I(2603)](x,e){const t=I;this.texture[t(3505)]=e[t(3505)],this[t(3840)].colorSpace=e[t(1549)],this[t(3840)][t(2787)]=e[t(2787)],this[t(3840)][t(3338)]=e[t(3338)],this.texture[t(2637)]=e[t(2637)];const g={uniforms:{tEquirect:{value:null}},vertexShader:t(726),fragmentShader:t(3719)},n=new UI(5,5,5),s=new Eg({name:t(2923),uniforms:fo(g[t(3901)]),vertexShader:g[t(3353)],fragmentShader:g[t(3060)],side:Zt,blending:Li});s.uniforms[t(1762)][t(2113)]=e;const o=new ye(n,s),c=e[t(3338)];return e[t(3338)]===oi&&(e[t(3338)]=Ze),new Wv(1,10,this)[t(2341)](x,o),e.minFilter=c,o[t(352)].dispose(),o[t(3480)][t(1439)](),this}clear(x,e,t,g){const n=I,s=x[n(1117)]();for(let o=0;o<6;o++)x[n(681)](this,o),x[n(3223)](e,t,g);x[n(681)](s)}}const PA=new E,gX=new E,iX=new px;class hn{constructor(x=new E(1,0,0),e=0){const t=I;this.isPlane=!0,this[t(3204)]=x,this.constant=e}[I(298)](x,e){const t=I;return this.normal[t(1493)](x),this.constant=e,this}[I(3756)](x,e,t,g){const n=I;return this[n(3204)][n(298)](x,e,t),this[n(1818)]=g,this}[I(2307)](x,e){const t=I;return this[t(3204)][t(1493)](x),this[t(1818)]=-e[t(1760)](this[t(3204)]),this}setFromCoplanarPoints(x,e,t){const g=I,n=PA[g(859)](t,e)[g(1092)](gX[g(859)](x,e))[g(3762)]();return this[g(2307)](n,x),this}[I(1493)](x){const e=I;return this[e(3204)][e(1493)](x.normal),this[e(1818)]=x[e(1818)],this}[I(3762)](){const x=I,e=1/this[x(3204)].length();return this[x(3204)].multiplyScalar(e),this[x(1818)]*=e,this}[I(3217)](){const x=I;return this[x(1818)]*=-1,this.normal[x(3217)](),this}[I(2587)](x){const e=I;return this[e(3204)][e(1760)](x)+this.constant}[I(3989)](x){const e=I;return this[e(2587)](x[e(3416)])-x[e(3015)]}[I(3738)](x,e){const t=I;return e[t(1493)](x)[t(832)](this[t(3204)],-this[t(2587)](x))}[I(1134)](x,e){const t=I,g=x[t(438)](PA),n=this[t(3204)].dot(g);if(n===0)return this[t(2587)](x[t(3988)])===0?e[t(1493)](x[t(3988)]):null;const s=-(x[t(3988)].dot(this.normal)+this[t(1818)])/n;return s<0||s>1?null:e[t(1493)](x.start)[t(832)](g,s)}[I(3228)](x){const e=I,t=this.distanceToPoint(x[e(3988)]),g=this[e(2587)](x.end);return t<0&&g>0||g<0&&t>0}intersectsBox(x){return x.intersectsPlane(this)}[I(3195)](x){return x.intersectsPlane(this)}[I(3504)](x){const e=I;return x[e(1493)](this[e(3204)])[e(2333)](-this.constant)}[I(3075)](x,e){const t=I,g=e||iX[t(2809)](x),n=this[t(3504)](PA)[t(3075)](x),s=this[t(3204)][t(1326)](g)[t(3762)]();return this[t(1818)]=-n.dot(s),this}[I(2945)](x){const e=I;return this[e(1818)]-=x[e(1760)](this[e(3204)]),this}[I(3106)](x){const e=I;return x[e(3204)][e(3106)](this.normal)&&x[e(1818)]===this.constant}[I(3123)](){const x=I;return new this.constructor()[x(1493)](this)}}const tI=new ct,Za=new E;class zC{constructor(x=new hn,e=new hn,t=new hn,g=new hn,n=new hn,s=new hn){const o=I;this[o(165)]=[x,e,t,g,n,s]}[I(298)](x,e,t,g,n,s){const o=I,c=this[o(165)];return c[0][o(1493)](x),c[1][o(1493)](e),c[2][o(1493)](t),c[3][o(1493)](g),c[4].copy(n),c[5][o(1493)](s),this}[I(1493)](x){const e=I,t=this[e(165)];for(let g=0;g<6;g++)t[g][e(1493)](x[e(165)][g]);return this}[I(525)](x,e=ci){const t=I,g=this[t(165)],n=x[t(2574)],s=n[0],o=n[1],c=n[2],C=n[3],r=n[4],A=n[5],d=n[6],h=n[7],f=n[8],B=n[9],Z=n[10],G=n[11],m=n[12],v=n[13],p=n[14],w=n[15];if(g[0][t(3756)](C-s,h-r,G-f,w-m)[t(3762)](),g[1].setComponents(C+s,h+r,G+f,w+m)[t(3762)](),g[2][t(3756)](C+o,h+A,G+B,w+v)[t(3762)](),g[3][t(3756)](C-o,h-A,G-B,w-v)[t(3762)](),g[4][t(3756)](C-c,h-d,G-Z,w-p)[t(3762)](),e===ci)g[5].setComponents(C+c,h+d,G+Z,w+p).normalize();else if(e===hC)g[5].setComponents(c,d,Z,p)[t(3762)]();else throw new Error(t(2126)+e);return this}[I(3334)](x){const e=I;if(x[e(3636)]!==void 0)x[e(3636)]===null&&x[e(1668)](),tI[e(1493)](x[e(3636)]).applyMatrix4(x[e(2368)]);else{const t=x[e(352)];t[e(3636)]===null&&t[e(1668)](),tI[e(1493)](t[e(3636)])[e(3075)](x[e(2368)])}return this.intersectsSphere(tI)}intersectsSprite(x){const e=I;return tI[e(3416)].set(0,0,0),tI[e(3015)]=.7071067811865476,tI[e(3075)](x[e(2368)]),this[e(3195)](tI)}[I(3195)](x){const e=I,t=this[e(165)],g=x.center,n=-x[e(3015)];for(let s=0;s<6;s++)if(t[s][e(2587)](g)<n)return!1;return!0}intersectsBox(x){const e=I,t=this[e(165)];for(let g=0;g<6;g++){const n=t[g];if(Za.x=n[e(3204)].x>0?x.max.x:x[e(1410)].x,Za.y=n[e(3204)].y>0?x[e(1971)].y:x[e(1410)].y,Za.z=n[e(3204)].z>0?x[e(1971)].z:x.min.z,n.distanceToPoint(Za)<0)return!1}return!0}containsPoint(x){const e=I,t=this[e(165)];for(let g=0;g<6;g++)if(t[g][e(2587)](x)<0)return!1;return!0}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}}function Rv(){let i=null,x=!1,e=null,t=null;function g(n,s){e(n,s),t=i.requestAnimationFrame(g)}return{start:function(){const n=i0;x!==!0&&e!==null&&(t=i[n(1167)](g),x=!0)},stop:function(){i[i0(1098)](t),x=!1},setAnimationLoop:function(n){e=n},setContext:function(n){i=n}}}function nX(i){const x=new WeakMap;function e(o,c){const C=i0,r=o[C(315)],A=o.usage,d=r.byteLength,h=i[C(2295)]();i[C(605)](c,h),i[C(2378)](c,r,A),o[C(3390)]();let f;if(r instanceof Float32Array)f=i.FLOAT;else if(r instanceof Uint16Array)o[C(803)]?f=i.HALF_FLOAT:f=i[C(1958)];else if(r instanceof Int16Array)f=i[C(3072)];else if(r instanceof Uint32Array)f=i[C(225)];else if(r instanceof Int32Array)f=i[C(1071)];else if(r instanceof Int8Array)f=i[C(1888)];else if(r instanceof Uint8Array)f=i[C(2841)];else if(r instanceof Uint8ClampedArray)f=i[C(2841)];else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);return{buffer:h,type:f,bytesPerElement:r[C(218)],version:o[C(1450)],size:d}}function t(o,c,C){const r=i0,A=c[r(315)],d=c._updateRange,h=c[r(644)];if(i[r(605)](C,o),d[r(3411)]===-1&&h[r(2989)]===0&&i[r(3166)](C,0,A),h[r(2989)]!==0){for(let f=0,B=h.length;f<B;f++){const Z=h[f];i.bufferSubData(C,Z[r(3988)]*A[r(218)],A,Z.start,Z[r(3411)])}c[r(3050)]()}d[r(3411)]!==-1&&(i[r(3166)](C,d[r(872)]*A[r(218)],A,d[r(872)],d[r(3411)]),d[r(3411)]=-1),c[r(3390)]()}function g(o){const c=i0;return o[c(2568)]&&(o=o[c(3787)]),x.get(o)}function n(o){const c=i0;o.isInterleavedBufferAttribute&&(o=o.data);const C=x[c(2695)](o);C&&(i[c(3667)](C.buffer),x.delete(o))}function s(o,c){const C=i0;if(o[C(3247)]){const A=x[C(2695)](o);(!A||A[C(1450)]<o[C(1450)])&&x[C(298)](o,{buffer:o[C(2360)],type:o[C(3505)],bytesPerElement:o[C(1624)],version:o[C(1450)]});return}o.isInterleavedBufferAttribute&&(o=o[C(3787)]);const r=x[C(2695)](o);if(r===void 0)x[C(298)](o,e(o,c));else if(r[C(1450)]<o[C(1450)]){if(r[C(1019)]!==o.array[C(835)])throw new Error(C(141));t(r[C(2360)],o,c),r.version=o[C(1450)]}}return{get:g,remove:n,update:s}}class Wo extends vx{constructor(x=1,e=1,t=1,g=1){const n=I;super(),this[n(3505)]="PlaneGeometry",this[n(361)]={width:x,height:e,widthSegments:t,heightSegments:g};const s=x/2,o=e/2,c=Math[n(3143)](t),C=Math[n(3143)](g),r=c+1,A=C+1,d=x/c,h=e/C,f=[],B=[],Z=[],G=[];for(let m=0;m<A;m++){const v=m*h-o;for(let p=0;p<r;p++){const w=p*d-s;B[n(3330)](w,-v,0),Z[n(3330)](0,0,1),G.push(p/c),G[n(3330)](1-m/C)}}for(let m=0;m<C;m++)for(let v=0;v<c;v++){const p=v+r*m,w=v+r*(m+1),V=v+1+r*(m+1),N=v+1+r*m;f[n(3330)](p,w,N),f[n(3330)](w,V,N)}this[n(3317)](f),this[n(1236)](n(2817),new ix(B,3)),this[n(1236)]("normal",new ix(Z,3)),this[n(1236)]("uv",new ix(G,2))}copy(x){const e=I;return super.copy(x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static[I(3385)](x){const e=I;return new Wo(x[e(2315)],x[e(2741)],x[e(2500)],x.heightSegments)}}var IX=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,sX=I(115),oX=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,cX=I(2006),CX=I(215),lX=I(1683),aX=I(3991),rX=I(1212),dX=I(703),AX=I(3324),uX=I(2291),bX=I(3243),hX=I(2579),fX=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mX=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,GX=I(1175),pX=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,BX=I(112),ZX=I(1220),yX=I(2518),vX=I(2827),WX=I(538),wX=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,RX=I(2549),VX=I(2484),SX=I(1559),XX=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,YX=I(1561),KX=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,HX=I(2079),NX="gl_FragColor = linearToOutputTexel( gl_FragColor );",FX=I(692),zX=I(1594),MX=I(145),LX=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,kX=I(1058),TX=I(3622),JX=I(2114),EX=I(3267),UX=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_X=I(2346),DX=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,QX=I(3510),PX=I(991),OX=I(228),qX=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,$X=I(152),jX=I(343),xY=I(1341),eY=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,tY=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,gY=I(2173),iY=I(3004),nY=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,IY=I(3021),sY=I(2275),oY=I(1438),cY=I(651),CY=I(1629),lY=I(531),aY=I(1441),rY=I(1999),dY=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,AY=I(1013),uY=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,bY=I(477),hY=I(3634),fY=I(2055),mY=I(3153),GY=I(401),pY=I(1988),BY=I(2112),ZY=I(1861),yY=I(2515),vY=I(2515),WY=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,wY=I(456),RY=I(293),VY=I(765),SY=I(3913),XY=I(1434),YY=I(3331),KY=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,HY=I(344),NY=I(1869),FY=I(2943),zY=I(2825),MY=I(2076),LY=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,kY=I(1003),TY=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,JY=I(3521),EY=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,UY=I(3138),_Y=I(3200),DY=I(3813),QY=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,PY=I(2871),OY=I(3433),qY=I(1557),$Y=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,jY=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,xK=I(2642),eK=I(437),tK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,gK=I(3823),iK=I(1431);const nK=I(332),IK=I(649),sK=I(2090),oK=I(2264),cK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,CK=I(3406),lK=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,aK=I(1296),rK=I(1247),dK=I(1197),AK=I(1946),uK=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bK=I(1857),hK=I(3512),fK=I(2078),mK=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GK=I(2596),pK=I(1776),BK=I(3918),ZK=I(1614),yK=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,vK=I(434),WK=I(3171),wK=I(3413),RK=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,VK=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,SK=I(410),XK=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,YK=I(3318),KK=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,HK=I(855),NK=I(341),FK=I(725),zK=I(1914),Zx={alphahash_fragment:IX,alphahash_pars_fragment:sX,alphamap_fragment:oX,alphamap_pars_fragment:cX,alphatest_fragment:CX,alphatest_pars_fragment:lX,aomap_fragment:aX,aomap_pars_fragment:rX,batching_pars_vertex:dX,batching_vertex:AX,begin_vertex:uX,beginnormal_vertex:bX,bsdfs:hX,iridescence_fragment:fX,bumpmap_pars_fragment:mX,clipping_planes_fragment:GX,clipping_planes_pars_fragment:pX,clipping_planes_pars_vertex:BX,clipping_planes_vertex:ZX,color_fragment:yX,color_pars_fragment:vX,color_pars_vertex:WX,color_vertex:wX,common:RX,cube_uv_reflection_fragment:VX,defaultnormal_vertex:SX,displacementmap_pars_vertex:XX,displacementmap_vertex:YX,emissivemap_fragment:KX,emissivemap_pars_fragment:HX,colorspace_fragment:NX,colorspace_pars_fragment:FX,envmap_fragment:zX,envmap_common_pars_fragment:MX,envmap_pars_fragment:LX,envmap_pars_vertex:kX,envmap_physical_pars_fragment:$X,envmap_vertex:TX,fog_vertex:JX,fog_pars_vertex:EX,fog_fragment:UX,fog_pars_fragment:_X,gradientmap_pars_fragment:DX,lightmap_pars_fragment:QX,lights_lambert_fragment:PX,lights_lambert_pars_fragment:OX,lights_pars_begin:qX,lights_toon_fragment:jX,lights_toon_pars_fragment:xY,lights_phong_fragment:eY,lights_phong_pars_fragment:tY,lights_physical_fragment:gY,lights_physical_pars_fragment:iY,lights_fragment_begin:nY,lights_fragment_maps:IY,lights_fragment_end:sY,logdepthbuf_fragment:oY,logdepthbuf_pars_fragment:cY,logdepthbuf_pars_vertex:CY,logdepthbuf_vertex:lY,map_fragment:aY,map_pars_fragment:rY,map_particle_fragment:dY,map_particle_pars_fragment:AY,metalnessmap_fragment:uY,metalnessmap_pars_fragment:bY,morphinstance_vertex:hY,morphcolor_vertex:fY,morphnormal_vertex:mY,morphtarget_pars_vertex:GY,morphtarget_vertex:pY,normal_fragment_begin:BY,normal_fragment_maps:ZY,normal_pars_fragment:yY,normal_pars_vertex:vY,normal_vertex:WY,normalmap_pars_fragment:wY,clearcoat_normal_fragment_begin:RY,clearcoat_normal_fragment_maps:VY,clearcoat_pars_fragment:SY,iridescence_pars_fragment:XY,opaque_fragment:YY,packing:KY,premultiplied_alpha_fragment:HY,project_vertex:NY,dithering_fragment:FY,dithering_pars_fragment:zY,roughnessmap_fragment:MY,roughnessmap_pars_fragment:LY,shadowmap_pars_fragment:kY,shadowmap_pars_vertex:TY,shadowmap_vertex:JY,shadowmask_pars_fragment:EY,skinbase_vertex:UY,skinning_pars_vertex:_Y,skinning_vertex:DY,skinnormal_vertex:QY,specularmap_fragment:PY,specularmap_pars_fragment:OY,tonemapping_fragment:qY,tonemapping_pars_fragment:$Y,transmission_fragment:jY,transmission_pars_fragment:xK,uv_pars_fragment:eK,uv_pars_vertex:tK,uv_vertex:gK,worldpos_vertex:iK,background_vert:nK,background_frag:IK,backgroundCube_vert:sK,backgroundCube_frag:oK,cube_vert:cK,cube_frag:CK,depth_vert:lK,depth_frag:aK,distanceRGBA_vert:rK,distanceRGBA_frag:dK,equirect_vert:AK,equirect_frag:uK,linedashed_vert:bK,linedashed_frag:hK,meshbasic_vert:fK,meshbasic_frag:mK,meshlambert_vert:GK,meshlambert_frag:pK,meshmatcap_vert:BK,meshmatcap_frag:ZK,meshnormal_vert:yK,meshnormal_frag:vK,meshphong_vert:WK,meshphong_frag:wK,meshphysical_vert:RK,meshphysical_frag:VK,meshtoon_vert:SK,meshtoon_frag:XK,points_vert:YK,points_frag:KK,shadow_vert:HK,shadow_frag:NK,sprite_vert:FK,sprite_frag:zK},T0={common:{diffuse:{value:new Q0(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new px},alphaMap:{value:null},alphaMapTransform:{value:new px},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new px}},envmap:{envMap:{value:null},envMapRotation:{value:new px},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new px}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new px}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new px},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new px},normalScale:{value:new S0(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new px},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new px}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new px}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new px}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Q0(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Q0(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new px},alphaTest:{value:0},uvTransform:{value:new px}},sprite:{diffuse:{value:new Q0(16777215)},opacity:{value:1},center:{value:new S0(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new px},alphaMap:{value:null},alphaMapTransform:{value:new px},alphaTest:{value:0}}},zg={basic:{uniforms:bt([T0[I(3471)],T0.specularmap,T0[I(3885)],T0[I(1794)],T0[I(3196)],T0[I(1382)]]),vertexShader:Zx[I(1368)],fragmentShader:Zx[I(1590)]},lambert:{uniforms:bt([T0.common,T0.specularmap,T0.envmap,T0[I(1794)],T0[I(3196)],T0.emissivemap,T0[I(3733)],T0[I(2759)],T0.displacementmap,T0[I(1382)],T0.lights,{emissive:{value:new Q0(0)}}]),vertexShader:Zx[I(2655)],fragmentShader:Zx[I(3226)]},phong:{uniforms:bt([T0[I(3471)],T0[I(1094)],T0[I(3885)],T0[I(1794)],T0[I(3196)],T0[I(2301)],T0[I(3733)],T0[I(2759)],T0.displacementmap,T0.fog,T0.lights,{emissive:{value:new Q0(0)},specular:{value:new Q0(1118481)},shininess:{value:30}}]),vertexShader:Zx.meshphong_vert,fragmentShader:Zx.meshphong_frag},standard:{uniforms:bt([T0[I(3471)],T0[I(3885)],T0.aomap,T0[I(3196)],T0[I(2301)],T0[I(3733)],T0[I(2759)],T0[I(3529)],T0[I(2560)],T0.metalnessmap,T0[I(1382)],T0[I(1480)],{emissive:{value:new Q0(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zx[I(3271)],fragmentShader:Zx[I(3074)]},toon:{uniforms:bt([T0[I(3471)],T0[I(1794)],T0.lightmap,T0[I(2301)],T0[I(3733)],T0.normalmap,T0.displacementmap,T0[I(2216)],T0[I(1382)],T0[I(1480)],{emissive:{value:new Q0(0)}}]),vertexShader:Zx[I(1752)],fragmentShader:Zx[I(413)]},matcap:{uniforms:bt([T0[I(3471)],T0[I(3733)],T0[I(2759)],T0[I(3529)],T0[I(1382)],{matcap:{value:null}}]),vertexShader:Zx[I(952)],fragmentShader:Zx[I(1081)]},points:{uniforms:bt([T0.points,T0[I(1382)]]),vertexShader:Zx[I(3568)],fragmentShader:Zx.points_frag},dashed:{uniforms:bt([T0[I(3471)],T0[I(1382)],{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zx[I(714)],fragmentShader:Zx[I(2255)]},depth:{uniforms:bt([T0[I(3471)],T0[I(3529)]]),vertexShader:Zx[I(3295)],fragmentShader:Zx[I(877)]},normal:{uniforms:bt([T0.common,T0.bumpmap,T0[I(2759)],T0.displacementmap,{opacity:{value:1}}]),vertexShader:Zx.meshnormal_vert,fragmentShader:Zx.meshnormal_frag},sprite:{uniforms:bt([T0[I(3404)],T0[I(1382)]]),vertexShader:Zx[I(3865)],fragmentShader:Zx[I(3835)]},background:{uniforms:{uvTransform:{value:new px},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Zx[I(2106)],fragmentShader:Zx[I(3854)]},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new px}},vertexShader:Zx.backgroundCube_vert,fragmentShader:Zx[I(941)]},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Zx.cube_vert,fragmentShader:Zx[I(882)]},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zx[I(1931)],fragmentShader:Zx[I(1193)]},distanceRGBA:{uniforms:bt([T0[I(3471)],T0[I(3529)],{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zx.distanceRGBA_vert,fragmentShader:Zx[I(2236)]},shadow:{uniforms:bt([T0[I(1480)],T0.fog,{color:{value:new Q0(0)},opacity:{value:1}}]),vertexShader:Zx[I(1985)],fragmentShader:Zx[I(3129)]}};zg[I(166)]={uniforms:bt([zg.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new px},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new px},clearcoatNormalScale:{value:new S0(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new px},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new px},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new px},sheen:{value:0},sheenColor:{value:new Q0(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new px},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new px},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new px},transmissionSamplerSize:{value:new S0},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new px},attenuationDistance:{value:0},attenuationColor:{value:new Q0(0)},specularColor:{value:new Q0(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new px},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new px},anisotropyVector:{value:new S0},anisotropyMap:{value:null},anisotropyMapTransform:{value:new px}}]),vertexShader:Zx.meshphysical_vert,fragmentShader:Zx.meshphysical_frag};const ya={r:0,b:0,g:0},gI=new Tt,MK=new dx;function LK(i,x,e,t,g,n,s){const o=new Q0(0);let c=n===!0?0:1,C,r,A=null,d=0,h=null;function f(m){const v=i0;let p=m[v(1037)]===!0?m[v(2393)]:null;return p&&p.isTexture&&(p=(m[v(3215)]>0?e:x).get(p)),p}function B(m){const v=i0;let p=!1;const w=f(m);w===null?G(o,c):w&&w[v(1892)]&&(G(w,1),p=!0);const V=i.xr[v(3445)]();V==="additive"?t.buffers[v(432)][v(2503)](0,0,0,1,s):V===v(1949)&&t[v(2265)][v(432)][v(2503)](0,0,0,0,s),(i[v(1105)]||p)&&i[v(3223)](i[v(1786)],i[v(2229)],i.autoClearStencil)}function Z(m,v){const p=i0,w=f(v);w&&(w[p(3679)]||w[p(3099)]===Zo)?(r===void 0&&(r=new ye(new UI(1,1,1),new Eg({name:p(385),uniforms:fo(zg[p(777)][p(3901)]),vertexShader:zg[p(777)][p(3353)],fragmentShader:zg[p(777)].fragmentShader,side:Zt,depthTest:!1,depthWrite:!1,fog:!1})),r.geometry[p(2124)](p(3204)),r[p(352)].deleteAttribute("uv"),r[p(3548)]=function(V,N,X){const M=p;this[M(2368)][M(319)](X[M(2368)])},Object[p(2899)](r.material,"envMap",{get:function(){const V=p;return this[V(3901)][V(1300)][V(2113)]}}),g[p(2341)](r)),gI[p(1493)](v[p(2311)]),gI.x*=-1,gI.y*=-1,gI.z*=-1,w.isCubeTexture&&w[p(1309)]===!1&&(gI.y*=-1,gI.z*=-1),r.material[p(3901)].envMap[p(2113)]=w,r[p(3480)][p(3901)][p(440)][p(2113)]=w[p(3679)]&&w[p(1309)]===!1?-1:1,r[p(3480)][p(3901)][p(3215)][p(2113)]=v[p(3215)],r[p(3480)][p(3901)].backgroundIntensity[p(2113)]=v[p(3844)],r[p(3480)][p(3901)].backgroundRotation.value[p(3544)](MK[p(1112)](gI)),r[p(3480)][p(572)]=_x.getTransfer(w[p(1549)])!==qx,(A!==w||d!==w[p(1450)]||h!==i[p(1308)])&&(r[p(3480)][p(2170)]=!0,A=w,d=w[p(1450)],h=i[p(1308)]),r[p(2669)][p(2966)](),m[p(1907)](r,r[p(352)],r[p(3480)],0,0,null)):w&&w[p(3984)]&&(C===void 0&&(C=new ye(new Wo(2,2),new Eg({name:p(2646),uniforms:fo(zg[p(2393)][p(3901)]),vertexShader:zg[p(2393)][p(3353)],fragmentShader:zg.background[p(3060)],side:Ji,depthTest:!1,depthWrite:!1,fog:!1})),C.geometry.deleteAttribute(p(3204)),Object.defineProperty(C[p(3480)],"map",{get:function(){const V=p;return this[V(3901)].t2D[V(2113)]}}),g[p(2341)](C)),C.material[p(3901)][p(1615)].value=w,C.material[p(3901)][p(3844)].value=v[p(3844)],C[p(3480)][p(572)]=_x.getTransfer(w[p(1549)])!==qx,w[p(2272)]===!0&&w[p(466)](),C[p(3480)][p(3901)][p(1744)][p(2113)].copy(w[p(1721)]),(A!==w||d!==w[p(1450)]||h!==i.toneMapping)&&(C[p(3480)][p(2170)]=!0,A=w,d=w.version,h=i[p(1308)]),C[p(2669)].enableAll(),m.unshift(C,C[p(352)],C[p(3480)],0,0,null))}function G(m,v){const p=i0;m[p(2504)](ya,yv(i)),t[p(2265)][p(432)][p(2503)](ya.r,ya.g,ya.b,v,s)}return{getClearColor:function(){return o},setClearColor:function(m,v=1){o[i0(298)](m),c=v,G(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(m){c=m,G(o,c)},render:B,addToRenderList:Z}}function kK(i,x){const e=I,t=i[e(2961)](i[e(416)]),g={},n=h(null);let s=n,o=!1;function c(S,H,O,I0,z){const b0=e;let f0=!1;const G0=d(I0,O,H);s!==G0&&(s=G0,r(s[b0(1011)])),f0=f(S,I0,O,z),f0&&B(S,I0,O,z),z!==null&&x[b0(2341)](z,i[b0(493)]),(f0||o)&&(o=!1,w(S,H,O,I0),z!==null&&i[b0(605)](i[b0(493)],x[b0(2695)](z)[b0(2360)]))}function C(){return i[e(3047)]()}function r(S){return i[e(3288)](S)}function A(S){return i.deleteVertexArray(S)}function d(S,H,O){const I0=e,z=O[I0(2734)]===!0;let b0=g[S.id];b0===void 0&&(b0={},g[S.id]=b0);let f0=b0[H.id];f0===void 0&&(f0={},b0[H.id]=f0);let G0=f0[z];return G0===void 0&&(G0=h(C()),f0[z]=G0),G0}function h(S){const H=[],O=[],I0=[];for(let z=0;z<t;z++)H[z]=0,O[z]=0,I0[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:O,attributeDivisors:I0,object:S,attributes:{},index:null}}function f(S,H,O,I0){const z=e,b0=s[z(2593)],f0=H[z(2593)];let G0=0;const $=O[z(3100)]();for(const j in $)if($[j][z(2653)]>=0){const c0=b0[j];let h0=f0[j];if(h0===void 0&&(j==="instanceMatrix"&&S[z(1068)]&&(h0=S[z(1068)]),j==="instanceColor"&&S[z(1224)]&&(h0=S.instanceColor)),c0===void 0||c0.attribute!==h0||h0&&c0[z(3787)]!==h0[z(3787)])return!0;G0++}return s[z(1635)]!==G0||s[z(587)]!==I0}function B(S,H,O,I0){const z=e,b0={},f0=H[z(2593)];let G0=0;const $=O.getAttributes();for(const j in $)if($[j][z(2653)]>=0){let c0=f0[j];c0===void 0&&(j===z(1068)&&S.instanceMatrix&&(c0=S[z(1068)]),j==="instanceColor"&&S[z(1224)]&&(c0=S[z(1224)]));const h0={};h0[z(2760)]=c0,c0&&c0[z(3787)]&&(h0[z(3787)]=c0[z(3787)]),b0[j]=h0,G0++}s.attributes=b0,s[z(1635)]=G0,s[z(587)]=I0}function Z(){const S=e,H=s.newAttributes;for(let O=0,I0=H[S(2989)];O<I0;O++)H[O]=0}function G(S){m(S,0)}function m(S,H){const O=e,I0=s[O(1648)],z=s[O(869)],b0=s[O(533)];I0[S]=1,z[S]===0&&(i.enableVertexAttribArray(S),z[S]=1),b0[S]!==H&&(i[O(739)](S,H),b0[S]=H)}function v(){const S=e,H=s[S(1648)],O=s[S(869)];for(let I0=0,z=O[S(2989)];I0<z;I0++)O[I0]!==H[I0]&&(i[S(3968)](I0),O[I0]=0)}function p(S,H,O,I0,z,b0,f0){f0===!0?i.vertexAttribIPointer(S,H,O,z,b0):i.vertexAttribPointer(S,H,O,I0,z,b0)}function w(S,H,O,I0){const z=e;Z();const b0=I0[z(2593)],f0=O[z(3100)](),G0=H[z(195)];for(const $ in f0){const j=f0[$];if(j[z(2653)]>=0){let x0=b0[$];if(x0===void 0&&($===z(1068)&&S[z(1068)]&&(x0=S.instanceMatrix),$===z(1224)&&S.instanceColor&&(x0=S[z(1224)])),x0!==void 0){const c0=x0.normalized,h0=x0[z(365)],X0=x[z(2695)](x0);if(X0===void 0)continue;const n0=X0.buffer,g0=X0[z(3505)],l0=X0.bytesPerElement,m0=g0===i[z(1071)]||g0===i[z(225)]||x0[z(1181)]===Cf;if(x0[z(2568)]){const M0=x0.data,bx=M0[z(1947)],C0=x0.offset;if(M0[z(3039)]){for(let gx=0;gx<j[z(2198)];gx++)m(j[z(2653)]+gx,M0[z(3188)]);S[z(2369)]!==!0&&I0[z(2355)]===void 0&&(I0[z(2355)]=M0[z(3188)]*M0[z(3411)])}else for(let gx=0;gx<j.locationSize;gx++)G(j[z(2653)]+gx);i[z(605)](i[z(3499)],n0);for(let gx=0;gx<j.locationSize;gx++)p(j[z(2653)]+gx,h0/j[z(2198)],g0,c0,bx*l0,(C0+h0/j[z(2198)]*gx)*l0,m0)}else{if(x0[z(3497)]){for(let M0=0;M0<j.locationSize;M0++)m(j[z(2653)]+M0,x0[z(3188)]);S.isInstancedMesh!==!0&&I0[z(2355)]===void 0&&(I0[z(2355)]=x0[z(3188)]*x0.count)}else for(let M0=0;M0<j[z(2198)];M0++)G(j.location+M0);i[z(605)](i[z(3499)],n0);for(let M0=0;M0<j[z(2198)];M0++)p(j[z(2653)]+M0,h0/j.locationSize,g0,c0,h0*l0,h0/j[z(2198)]*M0*l0,m0)}}else if(G0!==void 0){const c0=G0[$];if(c0!==void 0)switch(c0[z(2989)]){case 2:i[z(331)](j[z(2653)],c0);break;case 3:i[z(168)](j.location,c0);break;case 4:i[z(2181)](j[z(2653)],c0);break;default:i.vertexAttrib1fv(j[z(2653)],c0)}}}}v()}function V(){const S=e;M();for(const H in g){const O=g[H];for(const I0 in O){const z=O[I0];for(const b0 in z)A(z[b0][S(1011)]),delete z[b0];delete O[I0]}delete g[H]}}function N(S){const H=e;if(g[S.id]===void 0)return;const O=g[S.id];for(const I0 in O){const z=O[I0];for(const b0 in z)A(z[b0][H(1011)]),delete z[b0];delete O[I0]}delete g[S.id]}function X(S){const H=e;for(const O in g){const I0=g[O];if(I0[S.id]===void 0)continue;const z=I0[S.id];for(const b0 in z)A(z[b0][H(1011)]),delete z[b0];delete I0[S.id]}}function M(){Y(),o=!0,s!==n&&(s=n,r(s.object))}function Y(){const S=e;n[S(352)]=null,n[S(2169)]=null,n[S(2734)]=!1}return{setup:c,reset:M,resetDefaultState:Y,dispose:V,releaseStatesOfGeometry:N,releaseStatesOfProgram:X,initAttributes:Z,enableAttribute:G,disableUnusedAttributes:v}}function TK(i,x,e){const t=I;let g;function n(r){g=r}function s(r,A){i.drawArrays(g,r,A),e.update(A,g,1)}function o(r,A,d){const h=i0;d!==0&&(i[h(1125)](g,r,A,d),e[h(2341)](A,g,d))}function c(r,A,d){const h=i0;if(d===0)return;const f=x[h(2695)]("WEBGL_multi_draw");if(f===null)for(let B=0;B<d;B++)this.render(r[B],A[B]);else{f.multiDrawArraysWEBGL(g,r,0,A,0,d);let B=0;for(let Z=0;Z<d;Z++)B+=A[Z];e.update(B,g,1)}}function C(r,A,d,h){const f=i0;if(d===0)return;const B=x.get(f(3651));if(B===null)for(let Z=0;Z<r[f(2989)];Z++)o(r[Z],A[Z],h[Z]);else{B[f(995)](g,r,0,A,0,h,0,d);let Z=0;for(let G=0;G<d;G++)Z+=A[G];for(let G=0;G<h[f(2989)];G++)e[f(2341)](Z,g,h[G])}}this[t(2836)]=n,this[t(948)]=s,this[t(2688)]=o,this.renderMultiDraw=c,this[t(1687)]=C}function JK(i,x,e,t){const g=I;let n;function s(){const N=i0;if(n!==void 0)return n;if(x[N(2489)](N(3974))===!0){const X=x[N(2695)](N(3974));n=i[N(2961)](X[N(1527)])}else n=0;return n}function o(N){const X=i0;return!(N!==zt&&t[X(796)](N)!==i[X(2961)](i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(N){const X=i0,M=N===KC&&(x[X(2489)](X(3428))||x[X(2489)](X(3819)));return!(N!==di&&t[X(796)](N)!==i[X(2961)](i.IMPLEMENTATION_COLOR_READ_TYPE)&&N!==pg&&!M)}function C(N){const X=i0;if(N==="highp"){if(i.getShaderPrecisionFormat(i[X(2117)],i.HIGH_FLOAT)[X(1661)]>0&&i[X(585)](i[X(3325)],i.HIGH_FLOAT)[X(1661)]>0)return X(2670);N=X(549)}return N===X(549)&&i[X(585)](i.VERTEX_SHADER,i[X(3969)]).precision>0&&i.getShaderPrecisionFormat(i[X(3325)],i.MEDIUM_FLOAT)[X(1661)]>0?"mediump":X(1225)}let r=e[g(1661)]!==void 0?e[g(1661)]:"highp";const A=C(r);A!==r&&(console.warn(g(1542),r,g(3853),A,g(3160)),r=A);const d=e[g(1699)]===!0,h=i[g(2961)](i[g(660)]),f=i[g(2961)](i[g(3310)]),B=i.getParameter(i[g(969)]),Z=i[g(2961)](i[g(3571)]),G=i.getParameter(i[g(416)]),m=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),v=i[g(2961)](i[g(205)]),p=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),w=f>0,V=i[g(2961)](i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:C,textureFormatReadable:o,textureTypeReadable:c,precision:r,logarithmicDepthBuffer:d,maxTextures:h,maxVertexTextures:f,maxTextureSize:B,maxCubemapSize:Z,maxAttributes:G,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:p,vertexTextures:w,maxSamples:V}}function EK(i){const x=I,e=this;let t=null,g=0,n=!1,s=!1;const o=new hn,c=new px,C={value:null,needsUpdate:!1};this[x(1325)]=C,this.numPlanes=0,this[x(1278)]=0,this[x(2032)]=function(d,h){const f=x,B=d[f(2989)]!==0||h||g!==0||n;return n=h,g=d[f(2989)],B},this[x(2609)]=function(){s=!0,A(null)},this[x(360)]=function(){s=!1},this[x(679)]=function(d,h){t=A(d,h,0)},this[x(1057)]=function(d,h,f){const B=x,Z=d[B(1763)],G=d.clipIntersection,m=d[B(2443)],v=i[B(2695)](d);if(!n||Z===null||Z[B(2989)]===0||s&&!m)s?A(null):r();else{const p=s?0:g,w=p*4;let V=v.clippingState||null;C.value=V,V=A(Z,h,w,f);for(let N=0;N!==w;++N)V[N]=t[N];v[B(159)]=V,this[B(1278)]=G?this.numPlanes:0,this[B(3232)]+=p}};function r(){const d=x;C[d(2113)]!==t&&(C.value=t,C[d(2170)]=g>0),e[d(3232)]=g,e[d(1278)]=0}function A(d,h,f,B){const Z=x,G=d!==null?d.length:0;let m=null;if(G!==0){if(m=C[Z(2113)],B!==!0||m===null){const v=f+G*4,p=h[Z(2519)];c[Z(2809)](p),(m===null||m.length<v)&&(m=new Float32Array(v));for(let w=0,V=f;w!==G;++w,V+=4)o.copy(d[w]).applyMatrix4(p,c),o.normal[Z(3904)](m,V),m[V+3]=o.constant}C[Z(2113)]=m,C[Z(2170)]=!0}return e[Z(3232)]=G,e[Z(1278)]=0,m}}function UK(i){let x=new WeakMap;function e(s,o){const c=i0;return o===sC?s[c(3099)]=Ei:o===oC&&(s[c(3099)]=Hn),s}function t(s){const o=i0;if(s&&s[o(3984)]){const c=s.mapping;if(c===sC||c===oC)if(x[o(2489)](s)){const C=x.get(s)[o(3840)];return e(C,s[o(3099)])}else{const C=s[o(1781)];if(C&&C[o(2741)]>0){const r=new wv(C[o(2741)]);return r[o(2603)](i,s),x[o(298)](s,r),s[o(2134)](o(1439),g),e(r[o(3840)],s[o(3099)])}else return null}}return s}function g(s){const o=i0,c=s.target;c[o(1216)](o(1439),g);const C=x[o(2695)](c);C!==void 0&&(x.delete(c),C[o(1439)]())}function n(){x=new WeakMap}return{get:t,dispose:n}}class MC extends NC{constructor(x=-1,e=1,t=1,g=-1,n=.1,s=2e3){const o=I;super(),this[o(1455)]=!0,this[o(3505)]="OrthographicCamera",this.zoom=1,this[o(2728)]=null,this[o(2881)]=x,this[o(1913)]=e,this.top=t,this[o(801)]=g,this[o(2987)]=n,this[o(1407)]=s,this[o(3947)]()}[I(1493)](x,e){const t=I;return super[t(1493)](x,e),this[t(2881)]=x[t(2881)],this[t(1913)]=x.right,this[t(2058)]=x[t(2058)],this.bottom=x[t(801)],this.near=x[t(2987)],this[t(1407)]=x[t(1407)],this.zoom=x[t(3981)],this[t(2728)]=x[t(2728)]===null?null:Object[t(1859)]({},x[t(2728)]),this}[I(1618)](x,e,t,g,n,s){const o=I;this.view===null&&(this[o(2728)]={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this[o(2728)].enabled=!0,this[o(2728)][o(2400)]=x,this[o(2728)][o(1139)]=e,this[o(2728)][o(2119)]=t,this[o(2728)].offsetY=g,this[o(2728)].width=n,this[o(2728)][o(2741)]=s,this.updateProjectionMatrix()}[I(3893)](){const x=I;this[x(2728)]!==null&&(this[x(2728)][x(2648)]=!1),this[x(3947)]()}updateProjectionMatrix(){const x=I,e=(this[x(1913)]-this[x(2881)])/(2*this.zoom),t=(this.top-this[x(801)])/(2*this[x(3981)]),g=(this.right+this[x(2881)])/2,n=(this.top+this[x(801)])/2;let s=g-e,o=g+e,c=n+t,C=n-t;if(this[x(2728)]!==null&&this[x(2728)][x(2648)]){const r=(this[x(1913)]-this[x(2881)])/this[x(2728)][x(2400)]/this[x(3981)],A=(this[x(2058)]-this[x(801)])/this[x(2728)][x(1139)]/this[x(3981)];s+=r*this[x(2728)][x(2119)],o=s+r*this[x(2728)].width,c-=A*this[x(2728)][x(3450)],C=c-A*this[x(2728)].height}this[x(2900)][x(807)](s,o,c,C,this.near,this.far,this[x(366)]),this[x(2957)].copy(this[x(2900)])[x(2483)]()}toJSON(x){const e=I,t=super.toJSON(x);return t.object[e(3981)]=this[e(3981)],t.object.left=this[e(2881)],t[e(1011)][e(1913)]=this[e(1913)],t[e(1011)][e(2058)]=this.top,t[e(1011)][e(801)]=this.bottom,t[e(1011)].near=this[e(2987)],t[e(1011)].far=this[e(1407)],this.view!==null&&(t[e(1011)][e(2728)]=Object.assign({},this[e(2728)])),t}}const Ps=4,np=[.125,.215,.35,.446,.526,.582],bI=20,OA=new MC,Ip=new Q0;let qA=null,$A=0,jA=0,xu=!1;const AI=(1+Math[I(3641)](5))/2,Bs=1/AI,sp=[new E(-AI,Bs,0),new E(AI,Bs,0),new E(-Bs,0,AI),new E(Bs,0,AI),new E(0,AI,-Bs),new E(0,AI,Bs),new E(-1,1,-1),new E(1,1,-1),new E(-1,1,1),new E(1,1,1)];class nh{constructor(x){const e=I;this[e(3286)]=x,this[e(3876)]=null,this[e(2372)]=0,this[e(2309)]=0,this[e(2979)]=[],this[e(2792)]=[],this[e(2469)]=[],this[e(2227)]=null,this[e(3608)]=null,this._equirectMaterial=null,this._compileMaterial(this[e(2227)])}[I(1485)](x,e=0,t=.1,g=100){const n=I;qA=this[n(3286)][n(1117)](),$A=this[n(3286)][n(3152)](),jA=this[n(3286)][n(1445)](),xu=this[n(3286)].xr[n(2648)],this[n(3286)].xr[n(2648)]=!1,this[n(1640)](256);const s=this._allocateTargets();return s.depthBuffer=!0,this[n(907)](x,t,g,s),e>0&&this[n(1658)](s,0,0,e),this._applyPMREM(s),this[n(2554)](s),s}fromEquirectangular(x,e=null){return this._fromTexture(x,e)}[I(656)](x,e=null){return this[I(3469)](x,e)}[I(1297)](){const x=I;this[x(3608)]===null&&(this[x(3608)]=Cp(),this._compileMaterial(this[x(3608)]))}compileEquirectangularShader(){const x=I;this[x(3682)]===null&&(this[x(3682)]=cp(),this[x(2004)](this._equirectMaterial))}dispose(){const x=I;this._dispose(),this[x(3608)]!==null&&this[x(3608)][x(1439)](),this[x(3682)]!==null&&this[x(3682)].dispose()}_setSize(x){const e=I;this._lodMax=Math.floor(Math[e(127)](x)),this[e(2309)]=Math[e(3395)](2,this[e(2372)])}[I(3068)](){const x=I;this[x(2227)]!==null&&this[x(2227)][x(1439)](),this._pingPongRenderTarget!==null&&this[x(3876)].dispose();for(let e=0;e<this[x(2979)][x(2989)];e++)this[x(2979)][e][x(1439)]()}[I(2554)](x){const e=I;this[e(3286)][e(681)](qA,$A,jA),this[e(3286)].xr[e(2648)]=xu,x[e(3961)]=!1,va(x,0,0,x.width,x[e(2741)])}[I(3469)](x,e){const t=I;x.mapping===Ei||x.mapping===Hn?this[t(1640)](x.image[t(2989)]===0?16:x[t(1781)][0][t(2315)]||x[t(1781)][0][t(1781)][t(2315)]):this[t(1640)](x[t(1781)].width/4),qA=this[t(3286)].getRenderTarget(),$A=this[t(3286)][t(3152)](),jA=this[t(3286)][t(1445)](),xu=this._renderer.xr[t(2648)],this[t(3286)].xr[t(2648)]=!1;const g=e||this._allocateTargets();return this._textureToCubeUV(x,g),this._applyPMREM(g),this[t(2554)](g),g}_allocateTargets(){const x=I,e=3*Math[x(1971)](this[x(2309)],16*7),t=4*this[x(2309)],g={magFilter:Ze,minFilter:Ze,generateMipmaps:!1,type:KC,format:zt,colorSpace:Di,depthBuffer:!1},n=op(e,t,g);if(this[x(3876)]===null||this[x(3876)][x(2315)]!==e||this[x(3876)][x(2741)]!==t){this._pingPongRenderTarget!==null&&this[x(3068)](),this[x(3876)]=op(e,t,g);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this[x(2979)],sigmas:this[x(2469)]}=_K(s)),this[x(2227)]=DK(s,e,t)}return n}_compileMaterial(x){const e=I,t=new ye(this[e(2979)][0],x);this[e(3286)][e(2816)](t,OA)}[I(907)](x,e,t,g){const n=I,s=90,o=1,c=new ze(s,o,e,t),C=[1,-1,1,1,1,1],r=[1,1,1,-1,-1,-1],A=this._renderer,d=A.autoClear,h=A.toneMapping;A[n(1778)](Ip),A[n(1308)]=ai,A[n(1105)]=!1;const f=new Ln({name:n(1091),side:Zt,depthWrite:!1,depthTest:!1}),B=new ye(new UI,f);let Z=!1;const G=x[n(2393)];G?G[n(1892)]&&(f.color.copy(G),x.background=null,Z=!0):(f.color[n(1493)](Ip),Z=!0);for(let m=0;m<6;m++){const v=m%3;v===0?(c.up[n(298)](0,C[m],0),c[n(2765)](r[m],0,0)):v===1?(c.up[n(298)](0,0,C[m]),c[n(2765)](0,r[m],0)):(c.up[n(298)](0,C[m],0),c.lookAt(0,0,r[m]));const p=this[n(2309)];va(g,v*p,m>2?p:0,p,p),A[n(681)](g),Z&&A[n(948)](B,c),A[n(948)](x,c)}B.geometry[n(1439)](),B.material.dispose(),A[n(1308)]=h,A[n(1105)]=d,x[n(2393)]=G}[I(2143)](x,e){const t=I,g=this[t(3286)],n=x.mapping===Ei||x[t(3099)]===Hn;n?(this[t(3608)]===null&&(this._cubemapMaterial=Cp()),this[t(3608)][t(3901)][t(440)][t(2113)]=x[t(1309)]===!1?-1:1):this[t(3682)]===null&&(this[t(3682)]=cp());const s=n?this[t(3608)]:this._equirectMaterial,o=new ye(this[t(2979)][0],s),c=s.uniforms;c[t(1300)].value=x;const C=this[t(2309)];va(e,0,0,3*C,2*C),g[t(681)](e),g[t(948)](o,OA)}[I(3493)](x){const e=I,t=this._renderer,g=t[e(1105)];t[e(1105)]=!1;const n=this[e(2979)][e(2989)];for(let s=1;s<n;s++){const o=Math.sqrt(this._sigmas[s]*this[e(2469)][s]-this[e(2469)][s-1]*this[e(2469)][s-1]),c=sp[(n-s-1)%sp[e(2989)]];this._blur(x,s-1,s,o,c)}t[e(1105)]=g}_blur(x,e,t,g,n){const s=I,o=this[s(3876)];this._halfBlur(x,o,e,t,g,s(3740),n),this._halfBlur(o,x,t,t,g,"longitudinal",n)}[I(2228)](x,e,t,g,n,s,o){const c=I,C=this[c(3286)],r=this[c(2227)];s!==c(3740)&&s!==c(3084)&&console[c(2963)](c(3463));const A=3,d=new ye(this[c(2979)][g],r),h=r[c(3901)],f=this[c(2792)][t]-1,B=isFinite(n)?Math.PI/(2*f):2*Math.PI/(2*bI-1),Z=n/B,G=isFinite(n)?1+Math[c(3143)](A*Z):bI;G>bI&&console.warn(c(3358)+n+c(2019)+G+c(1588)+bI);const m=[];let v=0;for(let X=0;X<bI;++X){const M=X/Z,Y=Math[c(574)](-M*M/2);m[c(3330)](Y),X===0?v+=Y:X<G&&(v+=2*Y)}for(let X=0;X<m.length;X++)m[X]=m[X]/v;h[c(1300)][c(2113)]=x.texture,h[c(2711)][c(2113)]=G,h[c(3646)][c(2113)]=m,h[c(3740)][c(2113)]=s==="latitudinal",o&&(h[c(870)][c(2113)]=o);const{_lodMax:p}=this;h.dTheta[c(2113)]=B,h[c(594)][c(2113)]=p-t;const w=this[c(2792)][g],V=3*w*(g>p-Ps?g-p+Ps:0),N=4*(this[c(2309)]-w);va(e,V,N,3*w,2*w),C[c(681)](e),C[c(948)](d,OA)}}function _K(i){const x=I,e=[],t=[],g=[];let n=i;const s=i-Ps+1+np[x(2989)];for(let o=0;o<s;o++){const c=Math[x(3395)](2,n);t[x(3330)](c);let C=1/c;o>i-Ps?C=np[o-i+Ps-1]:o===0&&(C=0),g.push(C);const r=1/(c-2),A=-r,d=1+r,h=[A,A,d,A,d,d,A,A,d,d,A,d],f=6,B=6,Z=3,G=2,m=1,v=new Float32Array(Z*B*f),p=new Float32Array(G*B*f),w=new Float32Array(m*B*f);for(let N=0;N<f;N++){const X=N%3*2/3-1,M=N>2?0:-1,Y=[X,M,0,X+2/3,M,0,X+2/3,M+1,0,X,M,0,X+2/3,M+1,0,X,M+1,0];v.set(Y,Z*B*N),p[x(298)](h,G*B*N);const S=[N,N,N,N,N,N];w.set(S,m*B*N)}const V=new vx;V[x(1236)](x(2817),new Px(v,Z)),V[x(1236)]("uv",new Px(p,G)),V.setAttribute(x(3431),new Px(w,m)),e[x(3330)](V),n>Ps&&n--}return{lodPlanes:e,sizeLods:t,sigmas:g}}function op(i,x,e){const t=I,g=new Jg(i,x,e);return g.texture[t(3099)]=Zo,g[t(3840)][t(1474)]="PMREM.cubeUv",g.scissorTest=!0,g}function va(i,x,e,t,g){const n=I;i[n(1310)][n(298)](x,e,t,g),i[n(3108)][n(298)](x,e,t,g)}function DK(i,x,e){const t=I,g=new Float32Array(bI),n=new E(0,1,0);return new Eg({name:t(3774),defines:{n:bI,CUBEUV_TEXEL_WIDTH:1/x,CUBEUV_TEXEL_HEIGHT:1/e,CUBEUV_MAX_MIP:i+".0"},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:g},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Bf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Li,depthTest:!1,depthWrite:!1})}function cp(){const i=I;return new Eg({name:i(1998),uniforms:{envMap:{value:null}},vertexShader:Bf(),fragmentShader:i(3305),blending:Li,depthTest:!1,depthWrite:!1})}function Cp(){const i=I;return new Eg({name:i(2850),uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Bf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Li,depthTest:!1,depthWrite:!1})}function Bf(){return I(499)}function QK(i){let x=new WeakMap,e=null;function t(o){const c=i0;if(o&&o.isTexture){const C=o[c(3099)],r=C===sC||C===oC,A=C===Ei||C===Hn;if(r||A){let d=x.get(o);const h=d!==void 0?d.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o[c(3011)]!==h)return e===null&&(e=new nh(i)),d=r?e[c(2643)](o,d):e[c(656)](o,d),d.texture[c(3011)]=o[c(3011)],x[c(298)](o,d),d.texture;if(d!==void 0)return d[c(3840)];{const f=o[c(1781)];return r&&f&&f.height>0||A&&f&&g(f)?(e===null&&(e=new nh(i)),d=r?e[c(2643)](o):e[c(656)](o),d[c(3840)][c(3011)]=o[c(3011)],x[c(298)](o,d),o[c(2134)]("dispose",n),d[c(3840)]):null}}}return o}function g(o){let c=0;const C=6;for(let r=0;r<C;r++)o[r]!==void 0&&c++;return c===C}function n(o){const c=i0,C=o.target;C.removeEventListener(c(1439),n);const r=x[c(2695)](C);r!==void 0&&(x.delete(C),r[c(1439)]())}function s(){const o=i0;x=new WeakMap,e!==null&&(e[o(1439)](),e=null)}return{get:t,dispose:s}}function PK(i){const x={};function e(t){const g=i0;if(x[t]!==void 0)return x[t];let n;switch(t){case g(1183):n=i[g(3771)](g(1183))||i[g(3771)](g(1613))||i[g(3771)]("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=i[g(3771)]("EXT_texture_filter_anisotropic")||i[g(3771)]("MOZ_EXT_texture_filter_anisotropic")||i.getExtension(g(355));break;case g(2461):n=i.getExtension(g(2461))||i[g(3771)](g(3270))||i[g(3771)]("WEBKIT_WEBGL_compressed_texture_s3tc");break;case g(3391):n=i[g(3771)](g(3391))||i[g(3771)](g(1333));break;default:n=i[g(3771)](t)}return x[t]=n,n}return{has:function(t){return e(t)!==null},init:function(){const t=i0;e(t(3819)),e(t(1567)),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e(t(2645)),e(t(2678))},get:function(t){const g=i0,n=e(t);return n===null&&console[g(3748)](g(749)+t+" extension not supported."),n}}}function OK(i,x,e,t){const g={},n=new WeakMap;function s(A){const d=i0,h=A.target;h[d(587)]!==null&&x[d(2208)](h[d(587)]);for(const B in h[d(2593)])x[d(2208)](h[d(2593)][B]);for(const B in h[d(593)]){const Z=h.morphAttributes[B];for(let G=0,m=Z[d(2989)];G<m;G++)x[d(2208)](Z[G])}h[d(1216)](d(1439),s),delete g[h.id];const f=n[d(2695)](h);f&&(x.remove(f),n.delete(h)),t[d(259)](h),h[d(2137)]===!0&&delete h[d(2355)],e[d(338)].geometries--}function o(A,d){const h=i0;return g[d.id]===!0||(d[h(2134)]("dispose",s),g[d.id]=!0,e[h(338)][h(1028)]++),d}function c(A){const d=i0,h=A[d(2593)];for(const B in h)x.update(h[B],i[d(3499)]);const f=A.morphAttributes;for(const B in f){const Z=f[B];for(let G=0,m=Z.length;G<m;G++)x[d(2341)](Z[G],i.ARRAY_BUFFER)}}function C(A){const d=i0,h=[],f=A.index,B=A[d(2593)].position;let Z=0;if(f!==null){const v=f[d(315)];Z=f[d(1450)];for(let p=0,w=v[d(2989)];p<w;p+=3){const V=v[p+0],N=v[p+1],X=v[p+2];h[d(3330)](V,N,N,X,X,V)}}else if(B!==void 0){const v=B.array;Z=B[d(1450)];for(let p=0,w=v.length/3-1;p<w;p+=3){const V=p+0,N=p+1,X=p+2;h[d(3330)](V,N,N,X,X,V)}}else return;const G=new(fv(h)?pf:Gf)(h,1);G[d(1450)]=Z;const m=n[d(2695)](A);m&&x[d(2208)](m),n[d(298)](A,G)}function r(A){const d=i0,h=n[d(2695)](A);if(h){const f=A[d(587)];f!==null&&h[d(1450)]<f.version&&C(A)}else C(A);return n[d(2695)](A)}return{get:o,update:c,getWireframeAttribute:r}}function qK(i,x,e){const t=I;let g;function n(h){g=h}let s,o;function c(h){s=h[i0(3505)],o=h.bytesPerElement}function C(h,f){i[i0(1688)](g,f,s,h*o),e.update(f,g,1)}function r(h,f,B){const Z=i0;B!==0&&(i[Z(1077)](g,f,s,h*o,B),e[Z(2341)](f,g,B))}function A(h,f,B){const Z=i0;if(B===0)return;const G=x[Z(2695)](Z(3651));if(G===null)for(let m=0;m<B;m++)this.render(h[m]/o,f[m]);else{G.multiDrawElementsWEBGL(g,f,0,s,h,0,B);let m=0;for(let v=0;v<B;v++)m+=f[v];e[Z(2341)](m,g,1)}}function d(h,f,B,Z){const G=i0;if(B===0)return;const m=x[G(2695)](G(3651));if(m===null)for(let v=0;v<h[G(2989)];v++)r(h[v]/o,f[v],Z[v]);else{m[G(116)](g,f,0,s,h,0,Z,0,B);let v=0;for(let p=0;p<B;p++)v+=f[p];for(let p=0;p<Z[G(2989)];p++)e.update(v,g,Z[p])}}this[t(2836)]=n,this[t(3317)]=c,this[t(948)]=C,this[t(2688)]=r,this.renderMultiDraw=A,this[t(1687)]=d}function $K(i){const x={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function t(n,s,o){const c=i0;switch(e[c(1304)]++,s){case i[c(3377)]:e[c(1467)]+=o*(n/3);break;case i[c(2927)]:e[c(2327)]+=o*(n/2);break;case i.LINE_STRIP:e[c(2327)]+=o*(n-1);break;case i[c(814)]:e[c(2327)]+=o*n;break;case i[c(1046)]:e[c(2630)]+=o*n;break;default:console[c(2963)]("THREE.WebGLInfo: Unknown draw mode:",s);break}}function g(){const n=i0;e.calls=0,e.triangles=0,e[n(2630)]=0,e[n(2327)]=0}return{memory:x,render:e,programs:null,autoReset:!0,reset:g,update:t}}function jK(i,x,e){const t=new WeakMap,g=new Dx;function n(s,o,c){const C=i0,r=s[C(2891)],A=o[C(593)][C(2817)]||o[C(593)][C(3204)]||o.morphAttributes[C(432)],d=A!==void 0?A[C(2989)]:0;let h=t[C(2695)](o);if(h===void 0||h[C(3411)]!==d){let Y=function(){const S=C;X[S(1439)](),t.delete(o),o[S(1216)](S(1439),Y)};h!==void 0&&h.texture[C(1439)]();const f=o[C(593)].position!==void 0,B=o.morphAttributes[C(3204)]!==void 0,Z=o[C(593)].color!==void 0,G=o[C(593)][C(2817)]||[],m=o[C(593)][C(3204)]||[],v=o.morphAttributes[C(432)]||[];let p=0;f===!0&&(p=1),B===!0&&(p=2),Z===!0&&(p=3);let w=o.attributes[C(2817)].count*p,V=1;w>x.maxTextureSize&&(V=Math[C(2163)](w/x.maxTextureSize),w=x[C(3555)]);const N=new Float32Array(w*V*4*d),X=new Z2(N,w,V,d);X.type=pg,X[C(2170)]=!0;const M=p*4;for(let S=0;S<d;S++){const H=G[S],O=m[S],I0=v[S],z=w*V*4*S;for(let b0=0;b0<H[C(3411)];b0++){const f0=b0*M;f===!0&&(g[C(2404)](H,b0),N[z+f0+0]=g.x,N[z+f0+1]=g.y,N[z+f0+2]=g.z,N[z+f0+3]=0),B===!0&&(g[C(2404)](O,b0),N[z+f0+4]=g.x,N[z+f0+5]=g.y,N[z+f0+6]=g.z,N[z+f0+7]=0),Z===!0&&(g[C(2404)](I0,b0),N[z+f0+8]=g.x,N[z+f0+9]=g.y,N[z+f0+10]=g.z,N[z+f0+11]=I0[C(365)]===4?g.w:1)}}h={count:d,texture:X,size:new S0(w,V)},t[C(298)](o,h),o.addEventListener(C(1439),Y)}if(s.isInstancedMesh===!0&&s[C(3642)]!==null)c.getUniforms().setValue(i,C(3642),s[C(3642)],e);else{let f=0;for(let Z=0;Z<r.length;Z++)f+=r[Z];const B=o[C(316)]?1:1-f;c.getUniforms()[C(342)](i,C(1690),B),c[C(1766)]()[C(342)](i,C(2891),r)}c[C(1766)]()[C(342)](i,"morphTargetsTexture",h[C(3840)],e),c[C(1766)]().setValue(i,C(2102),h[C(1019)])}return{update:n}}function xH(i,x,e,t){let g=new WeakMap;function n(c){const C=i0,r=t[C(948)][C(949)],A=c[C(352)],d=x.get(c,A);if(g[C(2695)](d)!==r&&(x[C(2341)](d),g.set(d,r)),c[C(2369)]&&(c[C(2512)](C(1439),o)===!1&&c[C(2134)](C(1439),o),g[C(2695)](c)!==r&&(e[C(2341)](c[C(1068)],i[C(3499)]),c.instanceColor!==null&&e[C(2341)](c[C(1224)],i[C(3499)]),g[C(298)](c,r))),c[C(1305)]){const h=c[C(2148)];g[C(2695)](h)!==r&&(h[C(2341)](),g[C(298)](h,r))}return d}function s(){g=new WeakMap}function o(c){const C=i0,r=c.target;r[C(1216)]("dispose",o),e[C(2208)](r[C(1068)]),r[C(1224)]!==null&&e[C(2208)](r[C(1224)])}return{update:n,dispose:s}}class Zf extends ue{constructor(x,e,t,g,n,s,o,c,C,r){const A=I;if(r=r!==void 0?r:XI,r!==XI&&r!==bo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");t===void 0&&r===XI&&(t=kI),t===void 0&&r===bo&&(t=yo),super(null,g,n,s,o,c,r,t,C),this.isDepthTexture=!0,this.image={width:x,height:e},this.magFilter=o!==void 0?o:Me,this.minFilter=c!==void 0?c:Me,this[A(233)]=!1,this[A(2787)]=!1,this[A(1446)]=null}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(1446)]=x.compareFunction,this}[I(2054)](x){const e=I,t=super[e(2054)](x);return this[e(1446)]!==null&&(t.compareFunction=this[e(1446)]),t}}const Vv=new ue,Sv=new Zf(1,1);Sv[I(1446)]=hf;const Xv=new Z2,Yv=new mf,Kv=new FC,lp=[],ap=[],rp=new Float32Array(16),dp=new Float32Array(9),Ap=new Float32Array(4);function wo(i,x,e){const t=I,g=i[0];if(g<=0||g>0)return i;const n=x*e;let s=lp[n];if(s===void 0&&(s=new Float32Array(n),lp[n]=s),x!==0){g[t(3904)](s,0);for(let o=1,c=0;o!==x;++o)c+=e,i[o][t(3904)](s,c)}return s}function Re(i,x){const e=I;if(i[e(2989)]!==x.length)return!1;for(let t=0,g=i[e(2989)];t<g;t++)if(i[t]!==x[t])return!1;return!0}function Ve(i,x){const e=I;for(let t=0,g=x[e(2989)];t<g;t++)i[t]=x[t]}function y2(i,x){const e=I;let t=ap[x];t===void 0&&(t=new Int32Array(x),ap[x]=t);for(let g=0;g!==x;++g)t[g]=i[e(2826)]();return t}function eH(i,x){const e=I,t=this[e(672)];t[0]!==x&&(i[e(748)](this[e(1481)],x),t[0]=x)}function tH(i,x){const e=I,t=this[e(672)];if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y)&&(i.uniform2f(this.addr,x.x,x.y),t[0]=x.x,t[1]=x.y);else{if(Re(t,x))return;i.uniform2fv(this[e(1481)],x),Ve(t,x)}}function gH(i,x){const e=I,t=this.cache;if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y||t[2]!==x.z)&&(i.uniform3f(this.addr,x.x,x.y,x.z),t[0]=x.x,t[1]=x.y,t[2]=x.z);else if(x.r!==void 0)(t[0]!==x.r||t[1]!==x.g||t[2]!==x.b)&&(i[e(1347)](this[e(1481)],x.r,x.g,x.b),t[0]=x.r,t[1]=x.g,t[2]=x.b);else{if(Re(t,x))return;i[e(711)](this.addr,x),Ve(t,x)}}function iH(i,x){const e=I,t=this[e(672)];if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y||t[2]!==x.z||t[3]!==x.w)&&(i[e(283)](this[e(1481)],x.x,x.y,x.z,x.w),t[0]=x.x,t[1]=x.y,t[2]=x.z,t[3]=x.w);else{if(Re(t,x))return;i.uniform4fv(this.addr,x),Ve(t,x)}}function nH(i,x){const e=I,t=this[e(672)],g=x[e(2574)];if(g===void 0){if(Re(t,x))return;i.uniformMatrix2fv(this.addr,!1,x),Ve(t,x)}else{if(Re(t,g))return;Ap.set(g),i[e(608)](this[e(1481)],!1,Ap),Ve(t,g)}}function IH(i,x){const e=I,t=this[e(672)],g=x[e(2574)];if(g===void 0){if(Re(t,x))return;i[e(134)](this.addr,!1,x),Ve(t,x)}else{if(Re(t,g))return;dp[e(298)](g),i[e(134)](this.addr,!1,dp),Ve(t,g)}}function sH(i,x){const e=I,t=this[e(672)],g=x[e(2574)];if(g===void 0){if(Re(t,x))return;i[e(1294)](this[e(1481)],!1,x),Ve(t,x)}else{if(Re(t,g))return;rp[e(298)](g),i[e(1294)](this[e(1481)],!1,rp),Ve(t,g)}}function oH(i,x){const e=I,t=this[e(672)];t[0]!==x&&(i[e(3029)](this[e(1481)],x),t[0]=x)}function cH(i,x){const e=I,t=this.cache;if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y)&&(i.uniform2i(this.addr,x.x,x.y),t[0]=x.x,t[1]=x.y);else{if(Re(t,x))return;i[e(1413)](this[e(1481)],x),Ve(t,x)}}function CH(i,x){const e=I,t=this.cache;if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y||t[2]!==x.z)&&(i.uniform3i(this[e(1481)],x.x,x.y,x.z),t[0]=x.x,t[1]=x.y,t[2]=x.z);else{if(Re(t,x))return;i[e(1343)](this[e(1481)],x),Ve(t,x)}}function lH(i,x){const e=I,t=this.cache;if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y||t[2]!==x.z||t[3]!==x.w)&&(i.uniform4i(this[e(1481)],x.x,x.y,x.z,x.w),t[0]=x.x,t[1]=x.y,t[2]=x.z,t[3]=x.w);else{if(Re(t,x))return;i[e(461)](this[e(1481)],x),Ve(t,x)}}function aH(i,x){const e=I,t=this.cache;t[0]!==x&&(i.uniform1ui(this[e(1481)],x),t[0]=x)}function rH(i,x){const e=I,t=this[e(672)];if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y)&&(i[e(3424)](this[e(1481)],x.x,x.y),t[0]=x.x,t[1]=x.y);else{if(Re(t,x))return;i[e(1123)](this[e(1481)],x),Ve(t,x)}}function dH(i,x){const e=I,t=this[e(672)];if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y||t[2]!==x.z)&&(i.uniform3ui(this[e(1481)],x.x,x.y,x.z),t[0]=x.x,t[1]=x.y,t[2]=x.z);else{if(Re(t,x))return;i[e(3587)](this[e(1481)],x),Ve(t,x)}}function AH(i,x){const e=I,t=this.cache;if(x.x!==void 0)(t[0]!==x.x||t[1]!==x.y||t[2]!==x.z||t[3]!==x.w)&&(i.uniform4ui(this[e(1481)],x.x,x.y,x.z,x.w),t[0]=x.x,t[1]=x.y,t[2]=x.z,t[3]=x.w);else{if(Re(t,x))return;i[e(2012)](this[e(1481)],x),Ve(t,x)}}function uH(i,x,e){const t=I,g=this[t(672)],n=e[t(2826)]();g[0]!==n&&(i[t(3029)](this[t(1481)],n),g[0]=n);const s=this[t(3505)]===i[t(2176)]?Sv:Vv;e[t(2820)](x||s,n)}function bH(i,x,e){const t=I,g=this[t(672)],n=e.allocateTextureUnit();g[0]!==n&&(i[t(3029)](this[t(1481)],n),g[0]=n),e[t(2230)](x||Yv,n)}function hH(i,x,e){const t=I,g=this.cache,n=e[t(2826)]();g[0]!==n&&(i.uniform1i(this[t(1481)],n),g[0]=n),e[t(3808)](x||Kv,n)}function fH(i,x,e){const t=I,g=this.cache,n=e[t(2826)]();g[0]!==n&&(i[t(3029)](this[t(1481)],n),g[0]=n),e[t(2814)](x||Xv,n)}function mH(i){switch(i){case 5126:return eH;case 35664:return tH;case 35665:return gH;case 35666:return iH;case 35674:return nH;case 35675:return IH;case 35676:return sH;case 5124:case 35670:return oH;case 35667:case 35671:return cH;case 35668:case 35672:return CH;case 35669:case 35673:return lH;case 5125:return aH;case 36294:return rH;case 36295:return dH;case 36296:return AH;case 35678:case 36198:case 36298:case 36306:case 35682:return uH;case 35679:case 36299:case 36307:return bH;case 35680:case 36300:case 36308:case 36293:return hH;case 36289:case 36303:case 36311:case 36292:return fH}}function GH(i,x){const e=I;i.uniform1fv(this[e(1481)],x)}function pH(i,x){const e=I,t=wo(x,this[e(1019)],2);i[e(3858)](this[e(1481)],t)}function BH(i,x){const e=I,t=wo(x,this[e(1019)],3);i[e(711)](this[e(1481)],t)}function ZH(i,x){const e=I,t=wo(x,this[e(1019)],4);i.uniform4fv(this[e(1481)],t)}function yH(i,x){const e=I,t=wo(x,this.size,4);i[e(608)](this[e(1481)],!1,t)}function vH(i,x){const e=I,t=wo(x,this[e(1019)],9);i[e(134)](this[e(1481)],!1,t)}function WH(i,x){const e=I,t=wo(x,this[e(1019)],16);i[e(1294)](this[e(1481)],!1,t)}function wH(i,x){const e=I;i[e(2074)](this[e(1481)],x)}function RH(i,x){const e=I;i.uniform2iv(this[e(1481)],x)}function VH(i,x){const e=I;i[e(1343)](this[e(1481)],x)}function SH(i,x){const e=I;i[e(461)](this[e(1481)],x)}function XH(i,x){i[I(2942)](this.addr,x)}function YH(i,x){i[I(1123)](this.addr,x)}function KH(i,x){const e=I;i[e(3587)](this[e(1481)],x)}function HH(i,x){const e=I;i.uniform4uiv(this[e(1481)],x)}function NH(i,x,e){const t=I,g=this.cache,n=x.length,s=y2(e,n);!Re(g,s)&&(i[t(2074)](this[t(1481)],s),Ve(g,s));for(let o=0;o!==n;++o)e[t(2820)](x[o]||Vv,s[o])}function FH(i,x,e){const t=I,g=this.cache,n=x[t(2989)],s=y2(e,n);!Re(g,s)&&(i[t(2074)](this[t(1481)],s),Ve(g,s));for(let o=0;o!==n;++o)e[t(2230)](x[o]||Yv,s[o])}function zH(i,x,e){const t=I,g=this[t(672)],n=x[t(2989)],s=y2(e,n);!Re(g,s)&&(i.uniform1iv(this[t(1481)],s),Ve(g,s));for(let o=0;o!==n;++o)e[t(3808)](x[o]||Kv,s[o])}function MH(i,x,e){const t=I,g=this[t(672)],n=x.length,s=y2(e,n);!Re(g,s)&&(i[t(2074)](this[t(1481)],s),Ve(g,s));for(let o=0;o!==n;++o)e[t(2814)](x[o]||Xv,s[o])}function LH(i){switch(i){case 5126:return GH;case 35664:return pH;case 35665:return BH;case 35666:return ZH;case 35674:return yH;case 35675:return vH;case 35676:return WH;case 5124:case 35670:return wH;case 35667:case 35671:return RH;case 35668:case 35672:return VH;case 35669:case 35673:return SH;case 5125:return XH;case 36294:return YH;case 36295:return KH;case 36296:return HH;case 35678:case 36198:case 36298:case 36306:case 35682:return NH;case 35679:case 36299:case 36307:return FH;case 35680:case 36300:case 36308:case 36293:return zH;case 36289:case 36303:case 36311:case 36292:return MH}}class kH{constructor(x,e,t){const g=I;this.id=x,this[g(1481)]=t,this[g(672)]=[],this.type=e[g(3505)],this[g(342)]=mH(e.type)}}class TH{constructor(x,e,t){const g=I;this.id=x,this[g(1481)]=t,this[g(672)]=[],this[g(3505)]=e[g(3505)],this[g(1019)]=e[g(1019)],this[g(342)]=LH(e[g(3505)])}}class JH{constructor(x){const e=I;this.id=x,this[e(1646)]=[],this[e(3879)]={}}[I(342)](x,e,t){const g=I,n=this[g(1646)];for(let s=0,o=n.length;s!==o;++s){const c=n[s];c[g(342)](x,e[c.id],t)}}}const eu=/(\w+)(\])?(\[|\.)?/g;function up(i,x){const e=I;i[e(1646)][e(3330)](x),i[e(3879)][x.id]=x}function EH(i,x,e){const t=I,g=i.name,n=g[t(2989)];for(eu[t(3804)]=0;;){const s=eu[t(3193)](g),o=eu[t(3804)];let c=s[1];const C=s[2]==="]",r=s[3];if(C&&(c=c|0),r===void 0||r==="["&&o+2===n){up(e,r===void 0?new kH(c,i,x):new TH(c,i,x));break}else{let d=e[t(3879)][c];d===void 0&&(d=new JH(c),up(e,d)),e=d}}}class yr{constructor(x,e){const t=I;this[t(1646)]=[],this[t(3879)]={};const g=x[t(2248)](e,x[t(1323)]);for(let n=0;n<g;++n){const s=x[t(3191)](e,n),o=x[t(1306)](e,s[t(1474)]);EH(s,o,this)}}[I(342)](x,e,t,g){const n=I,s=this[n(3879)][e];s!==void 0&&s[n(342)](x,t,g)}[I(800)](x,e,t){const g=I,n=e[t];n!==void 0&&this[g(342)](x,t,n)}static[I(3613)](x,e,t,g){const n=I;for(let s=0,o=e[n(2989)];s!==o;++s){const c=e[s],C=t[c.id];C.needsUpdate!==!1&&c[n(342)](x,C[n(2113)],g)}}static[I(733)](x,e){const t=I,g=[];for(let n=0,s=x[t(2989)];n!==s;++n){const o=x[n];o.id in e&&g[t(3330)](o)}return g}}function bp(i,x,e){const t=I,g=i[t(2023)](x);return i[t(2822)](g,e),i[t(2431)](g),g}const UH=37297;let _H=0;function DH(i,x){const e=I,t=i.split(`
`),g=[],n=Math[e(1971)](x-6,0),s=Math[e(1410)](x+6,t.length);for(let o=n;o<s;o++){const c=o+1;g[e(3330)]((c===x?">":" ")+" "+c+": "+t[o])}return g[e(1812)](`
`)}function QH(i){const x=I,e=_x[x(2529)](_x[x(3764)]),t=_x[x(2529)](i);let g;switch(e===t?g="":e===uC&&t===AC?g=x(1311):e===AC&&t===uC&&(g=x(3944)),i){case Di:case HC:return[g,"LinearTransferOETF"];case Ag:case B2:return[g,"sRGBTransferOETF"];default:return console[x(3748)](x(663),i),[g,x(2044)]}}function hp(i,x,e){const t=I,g=i[t(755)](x,i.COMPILE_STATUS),n=i[t(2925)](x)[t(1388)]();if(g&&n==="")return"";const s=/ERROR: 0:(\d+)/[t(3193)](n);if(s){const o=parseInt(s[1]);return e[t(3773)]()+`

`+n+`

`+DH(i[t(817)](x),o)}else return n}function PH(i,x){const e=I,t=QH(x);return"vec4 "+i+e(600)+t[0]+"( "+t[1]+e(1872)}function OH(i,x){const e=I;let t;switch(x){case Jy:t=e(588);break;case Ey:t="Reinhard";break;case Uy:t=e(3892);break;case sf:t=e(2671);break;case Dy:t=e(1714);break;case Qy:t="Neutral";break;case _y:t="Custom";break;default:console[e(3748)](e(2441),x),t=e(588)}return e(1620)+i+e(2912)+t+e(2411)}function qH(i){const x=I;return[i[x(2796)]?x(1866):"",i[x(524)]?x(307):""].filter(wc)[x(1812)](`
`)}function $H(i){const x=I,e=[];for(const t in i){const g=i[t];g!==!1&&e.push(x(2559)+t+" "+g)}return e.join(`
`)}function jH(i,x){const e=I,t={},g=i[e(2248)](x,i.ACTIVE_ATTRIBUTES);for(let n=0;n<g;n++){const s=i.getActiveAttrib(x,n),o=s.name;let c=1;s.type===i.FLOAT_MAT2&&(c=2),s[e(3505)]===i[e(2511)]&&(c=3),s[e(3505)]===i[e(3459)]&&(c=4),t[o]={type:s[e(3505)],location:i.getAttribLocation(x,o),locationSize:c}}return t}function wc(i){return i!==""}function fp(i,x){const e=I,t=x[e(111)]+x[e(2749)]-x.numSpotLightShadowsWithMaps;return i[e(333)](/NUM_DIR_LIGHTS/g,x.numDirLights)[e(333)](/NUM_SPOT_LIGHTS/g,x[e(2403)])[e(333)](/NUM_SPOT_LIGHT_MAPS/g,x[e(2749)])[e(333)](/NUM_SPOT_LIGHT_COORDS/g,t)[e(333)](/NUM_RECT_AREA_LIGHTS/g,x[e(275)])[e(333)](/NUM_POINT_LIGHTS/g,x[e(304)])[e(333)](/NUM_HEMI_LIGHTS/g,x[e(2498)]).replace(/NUM_DIR_LIGHT_SHADOWS/g,x[e(3322)])[e(333)](/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,x[e(3275)])[e(333)](/NUM_SPOT_LIGHT_SHADOWS/g,x.numSpotLightShadows)[e(333)](/NUM_POINT_LIGHT_SHADOWS/g,x[e(1556)])}function mp(i,x){const e=I;return i[e(333)](/NUM_CLIPPING_PLANES/g,x[e(2657)])[e(333)](/UNION_CLIPPING_PLANES/g,x[e(2657)]-x[e(2261)])}const xN=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ih(i){return i[I(333)](xN,tN)}const eN=new Map;function tN(i,x){const e=I;let t=Zx[x];if(t===void 0){const g=eN[e(2695)](x);if(g!==void 0)t=Zx[g],console[e(3748)](e(3687),x,g);else throw new Error("Can not resolve #include <"+x+">")}return Ih(t)}const gN=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Gp(i){return i.replace(gN,iN)}function iN(i,x,e,t){const g=I;let n="";for(let s=parseInt(x);s<parseInt(e);s++)n+=t[g(333)](/\[\s*i\s*\]/g,"[ "+s+" ]")[g(333)](/UNROLLED_LOOP_INDEX/g,s);return n}function pp(i){const x=I;let e=x(149)+i[x(1661)]+x(3919)+i[x(1661)]+x(1050)+i[x(1661)]+x(2225)+i.precision+` samplerCube;
	precision `+i[x(1661)]+` sampler3D;
	precision `+i[x(1661)]+` sampler2DArray;
	precision `+i[x(1661)]+x(1144)+i[x(1661)]+` samplerCubeShadow;
	precision `+i.precision+x(1681)+i[x(1661)]+x(1059)+i[x(1661)]+` isampler3D;
	precision `+i[x(1661)]+` isamplerCube;
	precision `+i[x(1661)]+x(3834)+i[x(1661)]+x(1729)+i.precision+` usampler3D;
	precision `+i[x(1661)]+x(2363)+i.precision+` usampler2DArray;
	`;return i[x(1661)]==="highp"?e+=x(2016):i.precision===x(549)?e+=x(3590):i[x(1661)]==="lowp"&&(e+=x(2681)),e}function nN(i){const x=I;let e="SHADOWMAP_TYPE_BASIC";return i[x(2615)]===m2?e=x(3665):i.shadowMapType===zc?e=x(3707):i[x(2615)]===Hg&&(e=x(3945)),e}function IN(i){const x=I;let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i[x(1259)]){case Ei:case Hn:e=x(1868);break;case Zo:e=x(1137);break}return e}function sN(i){const x=I;let e=x(3218);if(i[x(1300)])switch(i[x(1259)]){case Hn:e=x(632);break}return e}function oN(i){const x=I;let e=x(2190);if(i[x(1300)])switch(i.combine){case YC:e=x(2146);break;case ky:e=x(1378);break;case Ty:e="ENVMAP_BLENDING_ADD";break}return e}function cN(i){const x=i.envMapCubeUVHeight;if(x===null)return null;const e=Math.log2(x)-2,t=1/x;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function CN(i,x,e,t){const g=I,n=i[g(326)](),s=e[g(3891)];let o=e[g(3353)],c=e.fragmentShader;const C=nN(e),r=IN(e),A=sN(e),d=oN(e),h=cN(e),f=qH(e),B=$H(s),Z=n[g(2193)]();let G,m,v=e.glslVersion?g(3886)+e[g(3614)]+`
`:"";e[g(449)]?(G=[g(2003)+e[g(2482)],g(1045)+e.shaderName,B][g(1095)](wc)[g(1812)](`
`),G[g(2989)]>0&&(G+=`
`),m=[g(2003)+e[g(2482)],g(1045)+e[g(2087)],B][g(1095)](wc)[g(1812)](`
`),m.length>0&&(m+=`
`)):(G=[pp(e),g(2003)+e[g(2482)],g(1045)+e[g(2087)],B,e[g(2796)]?"#define USE_CLIP_DISTANCE":"",e[g(955)]?g(2542):"",e[g(1743)]?g(1689):"",e[g(3855)]?g(362):"",e[g(382)]?g(397):"",e.useFog&&e.fog?g(2903):"",e[g(3654)]&&e[g(3098)]?g(639):"",e[g(3879)]?g(2779):"",e.envMap?"#define USE_ENVMAP":"",e.envMap?g(2559)+A:"",e[g(3997)]?g(1381):"",e[g(2042)]?g(2877):"",e[g(2210)]?g(2286):"",e.normalMap?g(2964):"",e[g(3980)]?g(3144):"",e.normalMapTangentSpace?g(2569):"",e[g(1638)]?g(2941):"",e[g(833)]?"#define USE_EMISSIVEMAP":"",e[g(2651)]?g(3273):"",e.anisotropyMap?g(3293):"",e.clearcoatMap?g(3089):"",e[g(241)]?g(1705):"",e[g(1881)]?g(3101):"",e[g(2374)]?g(3432):"",e[g(1904)]?g(419):"",e[g(2887)]?"#define USE_SPECULARMAP":"",e[g(1335)]?g(2041):"",e[g(1499)]?g(2332):"",e.roughnessMap?g(2854):"",e[g(2594)]?g(2025):"",e[g(3709)]?g(3691):"",e[g(2959)]?g(706):"",e[g(3820)]?"#define USE_TRANSMISSION":"",e[g(3403)]?g(1764):"",e.thicknessMap?g(1719):"",e[g(2416)]?g(3637):"",e[g(3990)]?g(1578):"",e[g(1199)]?"#define MAP_UV "+e[g(1199)]:"",e[g(1692)]?"#define ALPHAMAP_UV "+e[g(1692)]:"",e[g(1759)]?g(957)+e[g(1759)]:"",e.aoMapUv?g(374)+e[g(1242)]:"",e[g(444)]?g(1747)+e.emissiveMapUv:"",e[g(3045)]?g(1363)+e[g(3045)]:"",e[g(1589)]?"#define NORMALMAP_UV "+e[g(1589)]:"",e[g(1942)]?g(964)+e[g(1942)]:"",e[g(1449)]?g(223)+e[g(1449)]:"",e[g(1505)]?g(2636)+e[g(1505)]:"",e[g(3585)]?g(3963)+e[g(3585)]:"",e[g(1616)]?g(150)+e[g(1616)]:"",e[g(1772)]?g(3783)+e[g(1772)]:"",e.clearcoatRoughnessMapUv?g(3389)+e.clearcoatRoughnessMapUv:"",e[g(990)]?g(2342)+e[g(990)]:"",e.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+e.iridescenceThicknessMapUv:"",e[g(3742)]?"#define SHEEN_COLORMAP_UV "+e[g(3742)]:"",e.sheenRoughnessMapUv?g(2111)+e[g(248)]:"",e[g(1909)]?g(3716)+e[g(1909)]:"",e.specularColorMapUv?g(1864)+e.specularColorMapUv:"",e[g(799)]?g(3490)+e.specularIntensityMapUv:"",e.transmissionMapUv?g(3547)+e[g(2099)]:"",e[g(751)]?g(1740)+e.thicknessMapUv:"",e.vertexTangents&&e[g(280)]===!1?g(2057):"",e.vertexColors?"#define USE_COLOR":"",e[g(2077)]?g(2737):"",e[g(3908)]?g(2224):"",e[g(1506)]?g(1061):"",e.vertexUv3s?g(1889):"",e[g(3579)]?g(1387):"",e[g(280)]?"#define FLAT_SHADED":"",e.skinning?g(2175):"",e.morphTargets?g(2089):"",e[g(642)]&&e[g(280)]===!1?"#define USE_MORPHNORMALS":"",e[g(2015)]?"#define USE_MORPHCOLORS":"",e[g(302)]>0?g(746):"",e[g(302)]>0?g(387)+e[g(322)]:"",e[g(302)]>0?g(2213)+e[g(302)]:"",e[g(2638)]?g(1180):"",e[g(1822)]?g(3010):"",e[g(1970)]?g(391):"",e[g(1970)]?"#define "+C:"",e[g(965)]?g(224):"",e[g(1856)]>0?"#define USE_LIGHT_PROBES":"",e[g(2605)]?g(960):"",e[g(1699)]?g(153):"",g(3055),"uniform mat4 modelViewMatrix;",g(2433),"uniform mat4 viewMatrix;",g(547),g(2659),"uniform bool isOrthographic;",g(2805),"	attribute mat4 instanceMatrix;",g(2852),g(2383),g(2665),g(2852),g(1606),g(501),"#endif","attribute vec3 position;","attribute vec3 normal;",g(474),g(1463),g(1874),g(2852),"#ifdef USE_UV2",g(894),g(2852),g(809),g(3155),g(2852),g(1062),g(3078),g(2852),"#if defined( USE_COLOR_ALPHA )",g(2833),g(197),g(229),g(2852),"#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )",g(3435),"	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;",g(3582),g(1177),g(3133),g(1487),g(1553),g(475),g(1160),g(2525),g(2296),"		attribute vec3 morphTarget6;",g(740),g(2861),g(2852),g(708),g(2713),"	attribute vec4 skinWeight;","#endif",`
`][g(1095)](wc)[g(1812)](`
`),m=[pp(e),g(2003)+e[g(2482)],"#define SHADER_NAME "+e[g(2087)],B,e[g(3654)]&&e[g(1382)]?g(2903):"",e[g(3654)]&&e[g(3098)]?g(639):"",e[g(1283)]?g(2908):"",e[g(3879)]?g(2779):"",e[g(126)]?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e[g(1300)]?g(2559)+r:"",e[g(1300)]?g(2559)+A:"",e[g(1300)]?g(2559)+d:"",h?g(3371)+h[g(2507)]:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h[g(2440)]+".0":"",e[g(3997)]?g(1381):"",e[g(2042)]?g(2877):"",e[g(2210)]?g(2286):"",e[g(2712)]?g(2964):"",e.normalMapObjectSpace?g(3144):"",e[g(3474)]?"#define USE_NORMALMAP_TANGENTSPACE":"",e[g(833)]?"#define USE_EMISSIVEMAP":"",e.anisotropy?g(3273):"",e[g(590)]?g(3293):"",e[g(3916)]?g(895):"",e.clearcoatMap?g(3089):"",e[g(241)]?g(1705):"",e[g(1881)]?g(3101):"",e[g(1625)]?g(1570):"",e.iridescence?g(1513):"",e[g(2374)]?g(3432):"",e[g(1904)]?g(419):"",e[g(2887)]?"#define USE_SPECULARMAP":"",e.specularColorMap?g(2041):"",e[g(1499)]?g(2332):"",e[g(1372)]?g(2854):"",e[g(2594)]?g(2025):"",e[g(3709)]?g(3691):"",e[g(151)]?g(1257):"",e[g(2959)]?g(706):"",e[g(691)]?g(277):"",e[g(2416)]?g(3637):"",e[g(3990)]?"#define USE_SHEEN_ROUGHNESSMAP":"",e.transmission?g(2918):"",e[g(3403)]?g(1764):"",e[g(2200)]?g(1719):"",e[g(734)]&&e[g(280)]===!1?"#define USE_TANGENT":"",e[g(123)]||e[g(3855)]?g(281):"",e[g(2077)]?g(2737):"",e[g(3908)]?g(2224):"",e[g(1506)]?g(1061):"",e.vertexUv3s?g(1889):"",e[g(3579)]?g(1387):"",e[g(3023)]?g(3041):"",e[g(280)]?"#define FLAT_SHADED":"",e[g(2638)]?g(1180):"",e[g(1822)]?g(3010):"",e[g(1970)]?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?g(2559)+C:"",e.premultipliedAlpha?g(945):"",e[g(1856)]>0?"#define USE_LIGHT_PROBES":"",e[g(2605)]?g(960):"",e[g(2118)]?g(640):"",e[g(1699)]?g(153):"",g(1929),g(2659),g(1422),e[g(1308)]!==ai?g(1749):"",e[g(1308)]!==ai?Zx[g(2761)]:"",e.toneMapping!==ai?OH(g(1308),e.toneMapping):"",e.dithering?g(357):"",e.opaque?g(1675):"",Zx[g(536)],PH(g(3589),e[g(3930)]),e[g(3179)]?g(2088)+e[g(375)]:"",`
`].filter(wc)[g(1812)](`
`)),o=Ih(o),o=fp(o,e),o=mp(o,e),c=Ih(c),c=fp(c,e),c=mp(c,e),o=Gp(o),c=Gp(c),e[g(449)]!==!0&&(v=g(2798),G=[f,g(1924),g(3245),g(452)][g(1812)](`
`)+`
`+G,m=[g(1787),e[g(3614)]===ih?"":g(2033),e[g(3614)]===ih?"":"#define gl_FragColor pc_fragColor",g(858),g(452),"#define textureCube texture",g(2958),"#define texture2DLodEXT textureLod",g(230),"#define textureCubeLodEXT textureLod",g(1619),"#define texture2DProjGradEXT textureProjGrad",g(117)][g(1812)](`
`)+`
`+m);const p=v+G+o,w=v+m+c,V=bp(n,n.VERTEX_SHADER,p),N=bp(n,n[g(3325)],w);n.attachShader(Z,V),n.attachShader(Z,N),e[g(2685)]!==void 0?n.bindAttribLocation(Z,0,e[g(2685)]):e[g(535)]===!0&&n[g(625)](Z,0,g(2817)),n.linkProgram(Z);function X(H){const O=g;if(i.debug[O(3180)]){const I0=n[O(2974)](Z).trim(),z=n[O(2925)](V)[O(1388)](),b0=n.getShaderInfoLog(N).trim();let f0=!0,G0=!0;if(n[O(2248)](Z,n[O(3292)])===!1)if(f0=!1,typeof i.debug.onShaderError=="function")i[O(1476)].onShaderError(n,Z,V,N);else{const $=hp(n,V,O(721)),j=hp(n,N,O(1483));console[O(2963)]("THREE.WebGLProgram: Shader Error "+n.getError()+O(1466)+"VALIDATE_STATUS "+n[O(2248)](Z,n[O(3910)])+`

`+O(3616)+H[O(1474)]+`
`+O(3516)+H[O(3505)]+`

`+O(3496)+I0+`
`+$+`
`+j)}else I0!==""?console[O(3748)](O(1717),I0):(z===""||b0==="")&&(G0=!1);G0&&(H[O(3644)]={runnable:f0,programLog:I0,vertexShader:{log:z,prefix:G},fragmentShader:{log:b0,prefix:m}})}n[O(1896)](V),n[O(1896)](N),M=new yr(n,Z),Y=jH(n,Z)}let M;this[g(1766)]=function(){return M===void 0&&X(this),M};let Y;this.getAttributes=function(){return Y===void 0&&X(this),Y};let S=e[g(1421)]===!1;return this[g(2238)]=function(){return S===!1&&(S=n.getProgramParameter(Z,UH)),S},this.destroy=function(){const H=g;t[H(1834)](this),n[H(1758)](Z),this[H(2169)]=void 0},this[g(3505)]=e[g(2482)],this[g(1474)]=e[g(2087)],this.id=_H++,this.cacheKey=x,this[g(1097)]=1,this[g(2169)]=Z,this[g(3353)]=V,this[g(3060)]=N,this}let lN=0;class aN{constructor(){const x=I;this[x(113)]=new Map,this[x(185)]=new Map}[I(2341)](x){const e=I,t=x.vertexShader,g=x.fragmentShader,n=this[e(3423)](t),s=this._getShaderStage(g),o=this[e(3284)](x);return o.has(n)===!1&&(o[e(3014)](n),n[e(1097)]++),o[e(2489)](s)===!1&&(o[e(3014)](s),s[e(1097)]++),this}[I(2208)](x){const e=I,t=this[e(185)][e(2695)](x);for(const g of t)g[e(1097)]--,g[e(1097)]===0&&this[e(113)].delete(g[e(1993)]);return this.materialCache[e(1432)](x),this}[I(2287)](x){const e=I;return this[e(3423)](x[e(3353)]).id}[I(2531)](x){const e=I;return this._getShaderStage(x[e(3060)]).id}[I(1439)](){const x=I;this.shaderCache[x(3223)](),this[x(185)].clear()}[I(3284)](x){const e=I,t=this[e(185)];let g=t[e(2695)](x);return g===void 0&&(g=new Set,t[e(298)](x,g)),g}[I(3423)](x){const e=I,t=this.shaderCache;let g=t[e(2695)](x);return g===void 0&&(g=new rN(x),t.set(x,g)),g}}class rN{constructor(x){this.id=lN++,this.code=x,this.usedTimes=0}}function dN(i,x,e,t,g,n,s){const o=I,c=new KI,C=new aN,r=new Set,A=[],d=g[o(1699)],h=g[o(2214)];let f=g.precision;const B={MeshDepthMaterial:"depth",MeshDistanceMaterial:o(1244),MeshNormalMaterial:o(3204),MeshBasicMaterial:o(1879),MeshLambertMaterial:o(2674),MeshPhongMaterial:"phong",MeshToonMaterial:o(209),MeshStandardMaterial:o(166),MeshPhysicalMaterial:o(166),MeshMatcapMaterial:o(126),LineBasicMaterial:o(1879),LineDashedMaterial:o(729),PointsMaterial:o(2630),ShadowMaterial:o(1738),SpriteMaterial:o(3404)};function Z(Y){return r[o(3014)](Y),Y===0?"uv":"uv"+Y}function G(Y,S,H,O,I0){const z=o,b0=O[z(1382)],f0=I0[z(352)],G0=Y.isMeshStandardMaterial?O[z(2731)]:null,$=(Y.isMeshStandardMaterial?e:x).get(Y[z(1300)]||G0),j=$&&$[z(3099)]===Zo?$[z(1781)].height:null,x0=B[Y.type];Y[z(1661)]!==null&&(f=g[z(582)](Y[z(1661)]),f!==Y[z(1661)]&&console[z(3748)]("THREE.WebGLProgram.getParameters:",Y[z(1661)],z(3853),f,z(3160)));const c0=f0.morphAttributes[z(2817)]||f0.morphAttributes.normal||f0.morphAttributes.color,h0=c0!==void 0?c0.length:0;let X0=0;f0[z(593)][z(2817)]!==void 0&&(X0=1),f0.morphAttributes[z(3204)]!==void 0&&(X0=2),f0[z(593)][z(432)]!==void 0&&(X0=3);let n0,g0,l0,m0;if(x0){const Ix=zg[x0];n0=Ix[z(3353)],g0=Ix[z(3060)]}else n0=Y[z(3353)],g0=Y.fragmentShader,C[z(2341)](Y),l0=C[z(2287)](Y),m0=C[z(2531)](Y);const M0=i.getRenderTarget(),bx=I0[z(2369)]===!0,C0=I0.isBatchedMesh===!0,gx=!!Y[z(3879)],ax=!!Y[z(126)],y0=!!$,V0=!!Y[z(2042)],H0=!!Y[z(3997)],Y0=!!Y.bumpMap,F0=!!Y[z(2712)],$0=!!Y[z(1638)],Q=!!Y.emissiveMap,R=!!Y[z(2594)],T=!!Y[z(1372)],F=Y[z(2651)]>0,Z0=Y[z(3916)]>0,d0=Y[z(1625)]>0,w0=Y.iridescence>0,j0=Y[z(691)]>0,L0=Y[z(3820)]>0,J0=F&&!!Y[z(590)],hx=Z0&&!!Y[z(2539)],U0=Z0&&!!Y[z(1881)],Cx=Z0&&!!Y[z(241)],Rx=w0&&!!Y[z(2374)],nx=w0&&!!Y[z(1904)],xx=j0&&!!Y[z(2416)],Vx=j0&&!!Y[z(3990)],Hx=!!Y.specularMap,Sx=!!Y.specularColorMap,q=!!Y[z(1499)],v0=L0&&!!Y[z(3403)],A0=L0&&!!Y.thicknessMap,W0=!!Y[z(3023)],R0=!!Y[z(3709)],P0=Y[z(151)]>0,Yx=!!Y.alphaHash,Ex=!!Y[z(986)];let Pe=ai;Y[z(572)]&&(M0===null||M0.isXRRenderTarget===!0)&&(Pe=i.toneMapping);const Kx={shaderID:x0,shaderType:Y[z(3505)],shaderName:Y.name,vertexShader:n0,fragmentShader:g0,defines:Y[z(3891)],customVertexShaderID:l0,customFragmentShaderID:m0,isRawShaderMaterial:Y[z(449)]===!0,glslVersion:Y[z(3614)],precision:f,batching:C0,instancing:bx,instancingColor:bx&&I0.instanceColor!==null,instancingMorph:bx&&I0.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:M0===null?i.outputColorSpace:M0[z(1679)]===!0?M0[z(3840)].colorSpace:Di,alphaToCoverage:!!Y[z(1283)],map:gx,matcap:ax,envMap:y0,envMapMode:y0&&$.mapping,envMapCubeUVHeight:j,aoMap:V0,lightMap:H0,bumpMap:Y0,normalMap:F0,displacementMap:h&&$0,emissiveMap:Q,normalMapObjectSpace:F0&&Y[z(2308)]===Cv,normalMapTangentSpace:F0&&Y.normalMapType===Mn,metalnessMap:R,roughnessMap:T,anisotropy:F,anisotropyMap:J0,clearcoat:Z0,clearcoatMap:hx,clearcoatNormalMap:U0,clearcoatRoughnessMap:Cx,dispersion:d0,iridescence:w0,iridescenceMap:Rx,iridescenceThicknessMap:nx,sheen:j0,sheenColorMap:xx,sheenRoughnessMap:Vx,specularMap:Hx,specularColorMap:Sx,specularIntensityMap:q,transmission:L0,transmissionMap:v0,thicknessMap:A0,gradientMap:W0,opaque:Y[z(3249)]===!1&&Y[z(314)]===SI&&Y[z(1283)]===!1,alphaMap:R0,alphaTest:P0,alphaHash:Yx,combine:Y[z(2667)],mapUv:gx&&Z(Y[z(3879)][z(2168)]),aoMapUv:V0&&Z(Y.aoMap[z(2168)]),lightMapUv:H0&&Z(Y[z(3997)][z(2168)]),bumpMapUv:Y0&&Z(Y[z(2210)].channel),normalMapUv:F0&&Z(Y.normalMap[z(2168)]),displacementMapUv:$0&&Z(Y.displacementMap[z(2168)]),emissiveMapUv:Q&&Z(Y[z(833)][z(2168)]),metalnessMapUv:R&&Z(Y.metalnessMap[z(2168)]),roughnessMapUv:T&&Z(Y[z(1372)].channel),anisotropyMapUv:J0&&Z(Y.anisotropyMap[z(2168)]),clearcoatMapUv:hx&&Z(Y[z(2539)][z(2168)]),clearcoatNormalMapUv:U0&&Z(Y[z(1881)][z(2168)]),clearcoatRoughnessMapUv:Cx&&Z(Y[z(241)][z(2168)]),iridescenceMapUv:Rx&&Z(Y.iridescenceMap[z(2168)]),iridescenceThicknessMapUv:nx&&Z(Y.iridescenceThicknessMap[z(2168)]),sheenColorMapUv:xx&&Z(Y[z(2416)][z(2168)]),sheenRoughnessMapUv:Vx&&Z(Y[z(3990)][z(2168)]),specularMapUv:Hx&&Z(Y.specularMap[z(2168)]),specularColorMapUv:Sx&&Z(Y[z(1335)][z(2168)]),specularIntensityMapUv:q&&Z(Y[z(1499)][z(2168)]),transmissionMapUv:v0&&Z(Y.transmissionMap[z(2168)]),thicknessMapUv:A0&&Z(Y[z(2200)][z(2168)]),alphaMapUv:R0&&Z(Y[z(3709)][z(2168)]),vertexTangents:!!f0[z(2593)][z(132)]&&(F0||F),vertexColors:Y.vertexColors,vertexAlphas:Y[z(123)]===!0&&!!f0[z(2593)][z(432)]&&f0[z(2593)][z(432)][z(365)]===4,pointsUvs:I0.isPoints===!0&&!!f0[z(2593)].uv&&(gx||R0),fog:!!b0,useFog:Y[z(1382)]===!0,fogExp2:!!b0&&b0[z(1237)],flatShading:Y[z(280)]===!0,sizeAttenuation:Y[z(965)]===!0,logarithmicDepthBuffer:d,skinning:I0[z(1305)]===!0,morphTargets:f0[z(593)].position!==void 0,morphNormals:f0.morphAttributes.normal!==void 0,morphColors:f0[z(593)][z(432)]!==void 0,morphTargetsCount:h0,morphTextureStride:X0,numDirLights:S[z(2848)].length,numPointLights:S[z(962)][z(2989)],numSpotLights:S[z(820)][z(2989)],numSpotLightMaps:S[z(696)].length,numRectAreaLights:S.rectArea[z(2989)],numHemiLights:S[z(1511)][z(2989)],numDirLightShadows:S[z(402)].length,numPointLightShadows:S[z(3276)].length,numSpotLightShadows:S.spotShadowMap[z(2989)],numSpotLightShadowsWithMaps:S[z(3275)],numLightProbes:S[z(1856)],numClippingPlanes:s[z(3232)],numClipIntersection:s[z(1278)],dithering:Y[z(1952)],shadowMapEnabled:i[z(2001)][z(2648)]&&H.length>0,shadowMapType:i[z(2001)][z(3505)],toneMapping:Pe,useLegacyLights:i[z(3296)],decodeVideoTexture:gx&&Y[z(3879)][z(1078)]===!0&&_x[z(3186)](Y.map.colorSpace)===qx,premultipliedAlpha:Y[z(3696)],doubleSided:Y[z(3601)]===si,flipSided:Y.side===Zt,useDepthPacking:Y.depthPacking>=0,depthPacking:Y[z(375)]||0,index0AttributeName:Y[z(2685)],extensionClipCullDistance:Ex&&Y[z(986)][z(3185)]===!0&&t[z(2489)](z(1567)),extensionMultiDraw:Ex&&Y[z(986)].multiDraw===!0&&t[z(2489)]("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:t[z(2489)]("KHR_parallel_shader_compile"),customProgramCacheKey:Y.customProgramCacheKey()};return Kx[z(3908)]=r.has(1),Kx[z(1506)]=r[z(2489)](2),Kx[z(3811)]=r[z(2489)](3),r[z(3223)](),Kx}function m(Y){const S=o,H=[];if(Y[S(2894)]?H[S(3330)](Y[S(2894)]):(H[S(3330)](Y[S(2955)]),H[S(3330)](Y[S(930)])),Y[S(3891)]!==void 0)for(const O in Y.defines)H.push(O),H.push(Y.defines[O]);return Y[S(449)]===!1&&(v(H,Y),p(H,Y),H[S(3330)](i[S(3930)])),H[S(3330)](Y[S(1911)]),H[S(1812)]()}function v(Y,S){const H=o;Y.push(S[H(1661)]),Y.push(S[H(3930)]),Y[H(3330)](S[H(1259)]),Y[H(3330)](S.envMapCubeUVHeight),Y.push(S[H(1199)]),Y[H(3330)](S[H(1692)]),Y.push(S[H(1759)]),Y[H(3330)](S[H(1242)]),Y.push(S[H(3045)]),Y[H(3330)](S[H(1589)]),Y[H(3330)](S[H(1942)]),Y[H(3330)](S[H(444)]),Y.push(S[H(1449)]),Y.push(S.roughnessMapUv),Y[H(3330)](S[H(3585)]),Y[H(3330)](S[H(1616)]),Y[H(3330)](S[H(1772)]),Y[H(3330)](S[H(1397)]),Y.push(S.iridescenceMapUv),Y[H(3330)](S.iridescenceThicknessMapUv),Y[H(3330)](S[H(3742)]),Y[H(3330)](S[H(248)]),Y[H(3330)](S.specularMapUv),Y[H(3330)](S.specularColorMapUv),Y.push(S[H(799)]),Y[H(3330)](S[H(2099)]),Y[H(3330)](S[H(751)]),Y.push(S[H(2667)]),Y[H(3330)](S[H(3098)]),Y[H(3330)](S[H(965)]),Y[H(3330)](S.morphTargetsCount),Y[H(3330)](S[H(3190)]),Y[H(3330)](S[H(309)]),Y[H(3330)](S[H(304)]),Y[H(3330)](S[H(2403)]),Y[H(3330)](S.numSpotLightMaps),Y.push(S[H(2498)]),Y[H(3330)](S.numRectAreaLights),Y[H(3330)](S[H(3322)]),Y.push(S[H(1556)]),Y[H(3330)](S[H(111)]),Y[H(3330)](S.numSpotLightShadowsWithMaps),Y[H(3330)](S[H(1856)]),Y[H(3330)](S.shadowMapType),Y.push(S[H(1308)]),Y[H(3330)](S[H(2657)]),Y[H(3330)](S[H(2261)]),Y[H(3330)](S[H(375)])}function p(Y,S){const H=o;c.disableAll(),S[H(258)]&&c[H(3542)](0),S[H(1743)]&&c[H(3542)](1),S[H(3855)]&&c[H(3542)](2),S[H(382)]&&c.enable(3),S[H(126)]&&c[H(3542)](4),S[H(1300)]&&c.enable(5),S.normalMapObjectSpace&&c[H(3542)](6),S.normalMapTangentSpace&&c[H(3542)](7),S[H(3916)]&&c[H(3542)](8),S[H(3175)]&&c[H(3542)](9),S[H(151)]&&c[H(3542)](10),S[H(123)]&&c[H(3542)](11),S[H(2077)]&&c.enable(12),S[H(3908)]&&c.enable(13),S[H(1506)]&&c.enable(14),S[H(3811)]&&c[H(3542)](15),S[H(734)]&&c[H(3542)](16),S.anisotropy&&c[H(3542)](17),S[H(2959)]&&c.enable(18),S[H(955)]&&c[H(3542)](19),S[H(1625)]&&c.enable(20),Y[H(3330)](c.mask),c[H(1313)](),S[H(1382)]&&c[H(3542)](0),S[H(3654)]&&c[H(3542)](1),S[H(280)]&&c[H(3542)](2),S[H(1699)]&&c[H(3542)](3),S.skinning&&c.enable(4),S.morphTargets&&c[H(3542)](5),S[H(642)]&&c[H(3542)](6),S[H(2015)]&&c[H(3542)](7),S[H(3696)]&&c[H(3542)](8),S[H(1970)]&&c[H(3542)](9),S[H(2605)]&&c[H(3542)](10),S[H(2638)]&&c[H(3542)](11),S.flipSided&&c[H(3542)](12),S[H(3179)]&&c[H(3542)](13),S.dithering&&c[H(3542)](14),S.transmission&&c[H(3542)](15),S.sheen&&c[H(3542)](16),S.opaque&&c[H(3542)](17),S[H(3579)]&&c.enable(18),S[H(2118)]&&c[H(3542)](19),S.alphaToCoverage&&c[H(3542)](20),Y[H(3330)](c[H(829)])}function w(Y){const S=o,H=B[Y[S(3505)]];let O;if(H){const I0=zg[H];O=vv[S(3123)](I0[S(3901)])}else O=Y.uniforms;return O}function V(Y,S){const H=o;let O;for(let I0=0,z=A.length;I0<z;I0++){const b0=A[I0];if(b0[H(2453)]===S){O=b0,++O.usedTimes;break}}return O===void 0&&(O=new CN(i,S,Y,n),A[H(3330)](O)),O}function N(Y){const S=o;if(--Y[S(1097)]===0){const H=A[S(2377)](Y);A[H]=A[A.length-1],A.pop(),Y.destroy()}}function X(Y){C[o(2208)](Y)}function M(){C[o(1439)]()}return{getParameters:G,getProgramCacheKey:m,getUniforms:w,acquireProgram:V,releaseProgram:N,releaseShaderCache:X,programs:A,dispose:M}}function AN(){let i=new WeakMap;function x(n){let o=i[i0(2695)](n);return o===void 0&&(o={},i.set(n,o)),o}function e(n){i[i0(1432)](n)}function t(n,s,o){const c=i0;i[c(2695)](n)[s]=o}function g(){i=new WeakMap}return{get:x,remove:e,update:t,dispose:g}}function uN(i,x){const e=I;return i.groupOrder!==x[e(887)]?i[e(887)]-x[e(887)]:i[e(3238)]!==x[e(3238)]?i[e(3238)]-x[e(3238)]:i[e(3480)].id!==x[e(3480)].id?i[e(3480)].id-x[e(3480)].id:i.z!==x.z?i.z-x.z:i.id-x.id}function Bp(i,x){const e=I;return i[e(887)]!==x[e(887)]?i.groupOrder-x[e(887)]:i.renderOrder!==x[e(3238)]?i.renderOrder-x[e(3238)]:i.z!==x.z?x.z-i.z:i.id-x.id}function Zp(){const i=[];let x=0;const e=[],t=[],g=[];function n(){const A=i0;x=0,e[A(2989)]=0,t[A(2989)]=0,g[A(2989)]=0}function s(A,d,h,f,B,Z){const G=i0;let m=i[x];return m===void 0?(m={id:A.id,object:A,geometry:d,material:h,groupOrder:f,renderOrder:A[G(3238)],z:B,group:Z},i[x]=m):(m.id=A.id,m[G(1011)]=A,m[G(352)]=d,m[G(3480)]=h,m[G(887)]=f,m[G(3238)]=A.renderOrder,m.z=B,m.group=Z),x++,m}function o(A,d,h,f,B,Z){const G=i0,m=s(A,d,h,f,B,Z);h[G(3820)]>0?t[G(3330)](m):h[G(3249)]===!0?g.push(m):e[G(3330)](m)}function c(A,d,h,f,B,Z){const G=i0,m=s(A,d,h,f,B,Z);h[G(3820)]>0?t.unshift(m):h[G(3249)]===!0?g[G(1907)](m):e[G(1907)](m)}function C(A,d){const h=i0;e[h(2989)]>1&&e[h(3609)](A||uN),t[h(2989)]>1&&t[h(3609)](d||Bp),g[h(2989)]>1&&g.sort(d||Bp)}function r(){const A=i0;for(let d=x,h=i.length;d<h;d++){const f=i[d];if(f.id===null)break;f.id=null,f[A(1011)]=null,f.geometry=null,f[A(3480)]=null,f[A(963)]=null}}return{opaque:e,transmissive:t,transparent:g,init:n,push:o,unshift:c,finish:r,sort:C}}function bN(){let i=new WeakMap;function x(t,g){const n=i0,s=i[n(2695)](t);let o;return s===void 0?(o=new Zp,i[n(298)](t,[o])):g>=s.length?(o=new Zp,s.push(o)):o=s[g],o}function e(){i=new WeakMap}return{get:x,dispose:e}}function hN(){const i={};return{get:function(x){const e=i0;if(i[x.id]!==void 0)return i[x.id];let t;switch(x[e(3505)]){case"DirectionalLight":t={direction:new E,color:new Q0};break;case e(481):t={position:new E,direction:new E,color:new Q0,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new E,color:new Q0,distance:0,decay:0};break;case"HemisphereLight":t={direction:new E,skyColor:new Q0,groundColor:new Q0};break;case e(2273):t={color:new Q0,position:new E,halfWidth:new E,halfHeight:new E};break}return i[x.id]=t,t}}}function fN(){const i={};return{get:function(x){const e=i0;if(i[x.id]!==void 0)return i[x.id];let t;switch(x[e(3505)]){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new S0};break;case e(481):t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new S0};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new S0,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[x.id]=t,t}}}let mN=0;function GN(i,x){const e=I;return(x.castShadow?2:0)-(i[e(1239)]?2:0)+(x[e(3879)]?1:0)-(i.map?1:0)}function pN(i){const x=I,e=new hN,t=fN(),g={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let r=0;r<9;r++)g.probe[x(3330)](new E);const n=new E,s=new dx,o=new dx;function c(r,A){const d=x;let h=0,f=0,B=0;for(let O=0;O<9;O++)g[d(667)][O][d(298)](0,0,0);let Z=0,G=0,m=0,v=0,p=0,w=0,V=0,N=0,X=0,M=0,Y=0;r[d(3609)](GN);const S=A===!0?Math.PI:1;for(let O=0,I0=r.length;O<I0;O++){const z=r[O],b0=z.color,f0=z.intensity,G0=z[d(3035)],$=z.shadow&&z[d(1738)][d(3879)]?z.shadow[d(3879)].texture:null;if(z.isAmbientLight)h+=b0.r*f0*S,f+=b0.g*f0*S,B+=b0.b*f0*S;else if(z.isLightProbe){for(let j=0;j<9;j++)g[d(667)][j][d(832)](z.sh[d(3388)][j],f0);Y++}else if(z[d(2632)]){const j=e[d(2695)](z);if(j[d(432)][d(1493)](z[d(432)])[d(2333)](z[d(1707)]*S),z[d(1239)]){const x0=z[d(1738)],c0=t[d(2695)](z);c0[d(529)]=x0[d(2676)],c0[d(376)]=x0[d(2219)],c0[d(705)]=x0[d(3015)],c0[d(1394)]=x0[d(3057)],g.directionalShadow[Z]=c0,g[d(402)][Z]=$,g.directionalShadowMatrix[Z]=z[d(1738)].matrix,w++}g[d(2848)][Z]=j,Z++}else if(z[d(3603)]){const j=e[d(2695)](z);j[d(2817)].setFromMatrixPosition(z[d(2368)]),j.color[d(1493)](b0)[d(2333)](f0*S),j.distance=G0,j[d(2756)]=Math[d(1563)](z[d(3478)]),j[d(1840)]=Math.cos(z[d(3478)]*(1-z[d(1531)])),j[d(2863)]=z.decay,g[d(820)][m]=j;const x0=z[d(1738)];if(z[d(3879)]&&(g[d(696)][X]=z.map,X++,x0[d(745)](z),z[d(1239)]&&M++),g[d(515)][m]=x0[d(1721)],z[d(1239)]){const c0=t[d(2695)](z);c0[d(529)]=x0[d(2676)],c0.shadowNormalBias=x0.normalBias,c0.shadowRadius=x0[d(3015)],c0[d(1394)]=x0[d(3057)],g.spotShadow[m]=c0,g.spotShadowMap[m]=$,N++}m++}else if(z[d(3348)]){const j=e.get(z);j[d(432)][d(1493)](b0)[d(2333)](f0),j[d(122)][d(298)](z[d(2315)]*.5,0,0),j[d(1497)][d(298)](0,z[d(2741)]*.5,0),g[d(3443)][v]=j,v++}else if(z[d(716)]){const j=e[d(2695)](z);if(j[d(432)][d(1493)](z[d(432)])[d(2333)](z[d(1707)]*S),j[d(3035)]=z[d(3035)],j[d(2863)]=z[d(2863)],z[d(1239)]){const x0=z.shadow,c0=t[d(2695)](z);c0.shadowBias=x0.bias,c0[d(376)]=x0[d(2219)],c0.shadowRadius=x0[d(3015)],c0[d(1394)]=x0[d(3057)],c0[d(1270)]=x0[d(240)][d(2987)],c0[d(2980)]=x0[d(240)][d(1407)],g[d(2757)][G]=c0,g.pointShadowMap[G]=$,g[d(3972)][G]=z[d(1738)][d(1721)],V++}g[d(962)][G]=j,G++}else if(z.isHemisphereLight){const j=e[d(2695)](z);j[d(3785)][d(1493)](z.color)[d(2333)](f0*S),j.groundColor[d(1493)](z.groundColor)[d(2333)](f0*S),g.hemi[p]=j,p++}}v>0&&(i[d(2489)]("OES_texture_float_linear")===!0?(g[d(2455)]=T0.LTC_FLOAT_1,g[d(3393)]=T0[d(3341)]):(g[d(2455)]=T0[d(1883)],g.rectAreaLTC2=T0[d(3230)])),g[d(3594)][0]=h,g[d(3594)][1]=f,g.ambient[2]=B;const H=g.hash;(H.directionalLength!==Z||H[d(2373)]!==G||H[d(2774)]!==m||H.rectAreaLength!==v||H.hemiLength!==p||H[d(330)]!==w||H[d(1630)]!==V||H[d(1670)]!==N||H.numSpotMaps!==X||H.numLightProbes!==Y)&&(g[d(2848)][d(2989)]=Z,g[d(820)][d(2989)]=m,g[d(3443)].length=v,g.point.length=G,g[d(1511)][d(2989)]=p,g[d(1202)][d(2989)]=w,g[d(402)][d(2989)]=w,g[d(2757)].length=V,g[d(3276)][d(2989)]=V,g[d(664)][d(2989)]=N,g[d(2237)][d(2989)]=N,g[d(495)][d(2989)]=w,g[d(3972)][d(2989)]=V,g[d(515)][d(2989)]=N+X-M,g.spotLightMap[d(2989)]=X,g[d(3275)]=M,g[d(1856)]=Y,H[d(1145)]=Z,H[d(2373)]=G,H.spotLength=m,H[d(3551)]=v,H[d(1770)]=p,H[d(330)]=w,H[d(1630)]=V,H[d(1670)]=N,H[d(2718)]=X,H[d(1856)]=Y,g[d(1450)]=mN++)}function C(r,A){const d=x;let h=0,f=0,B=0,Z=0,G=0;const m=A[d(2519)];for(let v=0,p=r[d(2989)];v<p;v++){const w=r[v];if(w[d(2632)]){const V=g[d(2848)][h];V[d(2721)].setFromMatrixPosition(w[d(2368)]),n[d(1577)](w.target[d(2368)]),V[d(2721)][d(3938)](n),V[d(2721)][d(1411)](m),h++}else if(w[d(3603)]){const V=g[d(820)][B];V.position[d(1577)](w[d(2368)]),V[d(2817)].applyMatrix4(m),V[d(2721)][d(1577)](w[d(2368)]),n[d(1577)](w.target.matrixWorld),V[d(2721)][d(3938)](n),V[d(2721)][d(1411)](m),B++}else if(w[d(3348)]){const V=g[d(3443)][Z];V[d(2817)][d(1577)](w[d(2368)]),V[d(2817)][d(3075)](m),o[d(532)](),s.copy(w[d(2368)]),s[d(2050)](m),o[d(3009)](s),V.halfWidth[d(298)](w.width*.5,0,0),V[d(1497)].set(0,w[d(2741)]*.5,0),V.halfWidth[d(3075)](o),V[d(1497)].applyMatrix4(o),Z++}else if(w[d(716)]){const V=g[d(962)][f];V[d(2817)][d(1577)](w[d(2368)]),V[d(2817)].applyMatrix4(m),f++}else if(w.isHemisphereLight){const V=g[d(1511)][G];V.direction.setFromMatrixPosition(w[d(2368)]),V.direction[d(1411)](m),G++}}}return{setup:c,setupView:C,state:g}}function yp(i){const x=new pN(i),e=[],t=[];function g(r){const A=i0;C[A(240)]=r,e[A(2989)]=0,t[A(2989)]=0}function n(r){e[i0(3330)](r)}function s(r){t[i0(3330)](r)}function o(r){x[i0(1842)](e,r)}function c(r){x[i0(610)](e,r)}const C={lightsArray:e,shadowsArray:t,camera:null,lights:x,transmissionRenderTarget:{}};return{init:g,state:C,setupLights:o,setupLightsView:c,pushLight:n,pushShadow:s}}function BN(i){let x=new WeakMap;function e(g,n=0){const s=i0,o=x[s(2695)](g);let c;return o===void 0?(c=new yp(i),x[s(298)](g,[c])):n>=o[s(2989)]?(c=new yp(i),o[s(3330)](c)):c=o[n],c}function t(){x=new WeakMap}return{get:e,dispose:t}}class yf extends lt{constructor(x){const e=I;super(),this[e(709)]=!0,this[e(3505)]=e(2618),this.depthPacking=ov,this[e(3879)]=null,this[e(3709)]=null,this.displacementMap=null,this.displacementScale=1,this[e(977)]=0,this[e(2734)]=!1,this[e(1979)]=1,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(375)]=x[e(375)],this[e(3879)]=x[e(3879)],this[e(3709)]=x[e(3709)],this[e(1638)]=x[e(1638)],this[e(2523)]=x[e(2523)],this.displacementBias=x.displacementBias,this[e(2734)]=x[e(2734)],this.wireframeLinewidth=x[e(1979)],this}}class vf extends lt{constructor(x){const e=I;super(),this[e(959)]=!0,this[e(3505)]=e(1562),this[e(3879)]=null,this[e(3709)]=null,this[e(1638)]=null,this[e(2523)]=1,this[e(977)]=0,this.setValues(x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(3879)]=x[e(3879)],this[e(3709)]=x.alphaMap,this[e(1638)]=x[e(1638)],this[e(2523)]=x[e(2523)],this[e(977)]=x.displacementBias,this}}const ZN=I(3e3),yN=I(883);function vN(i,x,e){const t=I;let g=new zC;const n=new S0,s=new S0,o=new Dx,c=new yf({depthPacking:cv}),C=new vf,r={},A=e[t(3555)],d={[Ji]:Zt,[Zt]:Ji,[si]:si},h=new Eg({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new S0},radius:{value:4}},vertexShader:ZN,fragmentShader:yN}),f=h.clone();f.defines[t(2725)]=1;const B=new vx;B.setAttribute(t(2817),new Px(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Z=new ye(B,h),G=this;this[t(2648)]=!1,this[t(254)]=!0,this[t(2170)]=!1,this[t(3505)]=m2;let m=this.type;this.render=function(N,X,M){const Y=t;if(G[Y(2648)]===!1||G.autoUpdate===!1&&G.needsUpdate===!1||N[Y(2989)]===0)return;const S=i[Y(1117)](),H=i.getActiveCubeFace(),O=i.getActiveMipmapLevel(),I0=i[Y(704)];I0.setBlending(Li),I0[Y(2265)][Y(432)][Y(2503)](1,1,1,1),I0[Y(2265)][Y(3936)].setTest(!0),I0[Y(3253)](!1);const z=m!==Hg&&this.type===Hg,b0=m===Hg&&this.type!==Hg;for(let f0=0,G0=N[Y(2989)];f0<G0;f0++){const $=N[f0],j=$[Y(1738)];if(j===void 0){console[Y(3748)](Y(3500),$,Y(557));continue}if(j[Y(254)]===!1&&j[Y(2170)]===!1)continue;n[Y(1493)](j[Y(3057)]);const x0=j.getFrameExtents();if(n[Y(327)](x0),s[Y(1493)](j.mapSize),(n.x>A||n.y>A)&&(n.x>A&&(s.x=Math.floor(A/x0.x),n.x=s.x*x0.x,j[Y(3057)].x=s.x),n.y>A&&(s.y=Math[Y(3143)](A/x0.y),n.y=s.y*x0.y,j[Y(3057)].y=s.y)),j[Y(3879)]===null||z===!0||b0===!0){const h0=this[Y(3505)]!==Hg?{minFilter:Me,magFilter:Me}:{};j[Y(3879)]!==null&&j[Y(3879)][Y(1439)](),j[Y(3879)]=new Jg(n.x,n.y,h0),j[Y(3879)][Y(3840)].name=$[Y(1474)]+Y(2096),j[Y(240)][Y(3947)]()}i.setRenderTarget(j[Y(3879)]),i.clear();const c0=j.getViewportCount();for(let h0=0;h0<c0;h0++){const X0=j[Y(476)](h0);o[Y(298)](s.x*X0.x,s.y*X0.y,s.x*X0.z,s.y*X0.w),I0[Y(1310)](o),j[Y(745)]($,h0),g=j.getFrustum(),w(X,M,j[Y(240)],$,this[Y(3505)])}j.isPointLightShadow!==!0&&this[Y(3505)]===Hg&&v(j,M),j[Y(2170)]=!1}m=this[Y(3505)],G.needsUpdate=!1,i[Y(681)](S,H,O)};function v(N,X){const M=t,Y=x.update(Z);h[M(3891)].VSM_SAMPLES!==N.blurSamples&&(h.defines[M(3857)]=N.blurSamples,f.defines.VSM_SAMPLES=N[M(139)],h[M(2170)]=!0,f.needsUpdate=!0),N[M(2799)]===null&&(N[M(2799)]=new Jg(n.x,n.y)),h[M(3901)][M(1189)][M(2113)]=N.map[M(3840)],h[M(3901)][M(3414)][M(2113)]=N[M(3057)],h.uniforms[M(3015)][M(2113)]=N[M(3015)],i[M(681)](N.mapPass),i[M(3223)](),i[M(2444)](X,null,Y,h,Z,null),f.uniforms[M(1189)][M(2113)]=N[M(2799)][M(3840)],f[M(3901)][M(3414)][M(2113)]=N[M(3057)],f.uniforms[M(3015)].value=N.radius,i[M(681)](N[M(3879)]),i[M(3223)](),i.renderBufferDirect(X,null,Y,f,Z,null)}function p(N,X,M,Y){const S=t;let H=null;const O=M[S(716)]===!0?N[S(975)]:N.customDepthMaterial;if(O!==void 0)H=O;else if(H=M[S(716)]===!0?C:c,i[S(896)]&&X[S(2443)]===!0&&Array[S(1987)](X[S(1763)])&&X.clippingPlanes.length!==0||X[S(1638)]&&X[S(2523)]!==0||X.alphaMap&&X[S(151)]>0||X[S(3879)]&&X[S(151)]>0){const I0=H[S(296)],z=X[S(296)];let b0=r[I0];b0===void 0&&(b0={},r[I0]=b0);let f0=b0[z];f0===void 0&&(f0=H[S(3123)](),b0[z]=f0,X[S(2134)](S(1439),V)),H=f0}if(H[S(2548)]=X[S(2548)],H[S(2734)]=X.wireframe,Y===Hg?H[S(3601)]=X[S(2408)]!==null?X.shadowSide:X[S(3601)]:H.side=X.shadowSide!==null?X[S(2408)]:d[X.side],H[S(3709)]=X.alphaMap,H[S(151)]=X[S(151)],H[S(3879)]=X[S(3879)],H[S(2443)]=X.clipShadows,H[S(1763)]=X[S(1763)],H[S(2352)]=X[S(2352)],H.displacementMap=X[S(1638)],H[S(2523)]=X[S(2523)],H[S(977)]=X[S(977)],H[S(1979)]=X.wireframeLinewidth,H[S(3725)]=X[S(3725)],M[S(716)]===!0&&H[S(959)]===!0){const I0=i[S(2043)][S(2695)](H);I0[S(2680)]=M}return H}function w(N,X,M,Y,S){const H=t;if(N[H(2548)]===!1)return;if(N[H(2669)][H(3633)](X[H(2669)])&&(N[H(2241)]||N[H(2154)]||N[H(1146)])&&(N[H(1239)]||N[H(3328)]&&S===Hg)&&(!N.frustumCulled||g[H(3334)](N))){N.modelViewMatrix[H(1418)](M[H(2519)],N[H(2368)]);const z=x[H(2341)](N),b0=N.material;if(Array[H(1987)](b0)){const f0=z[H(919)];for(let G0=0,$=f0.length;G0<$;G0++){const j=f0[G0],x0=b0[j[H(2468)]];if(x0&&x0[H(2548)]){const c0=p(N,x0,Y,S);N[H(204)](i,N,X,M,z,c0,j),i[H(2444)](M,null,z,c0,N,j),N[H(3134)](i,N,X,M,z,c0,j)}}}else if(b0[H(2548)]){const f0=p(N,b0,Y,S);N[H(204)](i,N,X,M,z,f0,null),i[H(2444)](M,null,z,f0,N,null),N[H(3134)](i,N,X,M,z,f0,null)}}const I0=N[H(1352)];for(let z=0,b0=I0[H(2989)];z<b0;z++)w(I0[z],X,M,Y,S)}function V(N){const X=t;N[X(2930)][X(1216)]("dispose",V);for(const Y in r){const S=r[Y],H=N[X(2930)].uuid;H in S&&(S[H][X(1439)](),delete S[H])}}}function WN(i){const x=I;function e(){let q=!1;const v0=new Dx;let A0=null;const W0=new Dx(0,0,0,0);return{setMask:function(R0){A0!==R0&&!q&&(i[i0(1389)](R0,R0,R0,R0),A0=R0)},setLocked:function(R0){q=R0},setClear:function(R0,P0,Yx,Ex,Pe){const Kx=i0;Pe===!0&&(R0*=Ex,P0*=Ex,Yx*=Ex),v0.set(R0,P0,Yx,Ex),W0.equals(v0)===!1&&(i.clearColor(R0,P0,Yx,Ex),W0[Kx(1493)](v0))},reset:function(){const R0=i0;q=!1,A0=null,W0[R0(298)](-1,0,0,0)}}}function t(){let q=!1,v0=null,A0=null,W0=null;return{setTest:function(R0){const P0=i0;R0?l0(i[P0(3779)]):m0(i[P0(3779)])},setMask:function(R0){v0!==R0&&!q&&(i[i0(2075)](R0),v0=R0)},setFunc:function(R0){const P0=i0;if(A0!==R0){switch(R0){case Ky:i[P0(3222)](i.NEVER);break;case Hy:i[P0(3222)](i[P0(1178)]);break;case Ny:i[P0(3222)](i[P0(1213)]);break;case IC:i[P0(3222)](i[P0(3815)]);break;case Fy:i[P0(3222)](i.EQUAL);break;case zy:i[P0(3222)](i[P0(2429)]);break;case My:i[P0(3222)](i[P0(308)]);break;case Ly:i[P0(3222)](i[P0(3090)]);break;default:i[P0(3222)](i[P0(3815)])}A0=R0}},setLocked:function(R0){q=R0},setClear:function(R0){W0!==R0&&(i[i0(1777)](R0),W0=R0)},reset:function(){q=!1,v0=null,A0=null,W0=null}}}function g(){let q=!1,v0=null,A0=null,W0=null,R0=null,P0=null,Yx=null,Ex=null,Pe=null;return{setTest:function(Kx){const Ix=i0;!q&&(Kx?l0(i[Ix(1523)]):m0(i[Ix(1523)]))},setMask:function(Kx){v0!==Kx&&!q&&(i[i0(1102)](Kx),v0=Kx)},setFunc:function(Kx,Ix,Se){(A0!==Kx||W0!==Ix||R0!==Se)&&(i[i0(2139)](Kx,Ix,Se),A0=Kx,W0=Ix,R0=Se)},setOp:function(Kx,Ix,Se){(P0!==Kx||Yx!==Ix||Ex!==Se)&&(i.stencilOp(Kx,Ix,Se),P0=Kx,Yx=Ix,Ex=Se)},setLocked:function(Kx){q=Kx},setClear:function(Kx){Pe!==Kx&&(i[i0(622)](Kx),Pe=Kx)},reset:function(){q=!1,v0=null,A0=null,W0=null,R0=null,P0=null,Yx=null,Ex=null,Pe=null}}}const n=new e,s=new t,o=new g,c=new WeakMap,C=new WeakMap;let r={},A={},d=new WeakMap,h=[],f=null,B=!1,Z=null,G=null,m=null,v=null,p=null,w=null,V=null,N=new Q0(0,0,0),X=0,M=!1,Y=null,S=null,H=null,O=null,I0=null;const z=i[x(2961)](i[x(900)]);let b0=!1,f0=0;const G0=i[x(2961)](i.VERSION);G0[x(2377)](x(3415))!==-1?(f0=parseFloat(/^WebGL (\d)/[x(3193)](G0)[1]),b0=f0>=1):G0[x(2377)](x(3979))!==-1&&(f0=parseFloat(/^OpenGL ES (\d)/[x(3193)](G0)[1]),b0=f0>=2);let $=null,j={};const x0=i[x(2961)](i[x(602)]),c0=i.getParameter(i.VIEWPORT),h0=new Dx().fromArray(x0),X0=new Dx()[x(2793)](c0);function n0(q,v0,A0,W0){const R0=x,P0=new Uint8Array(4),Yx=i[R0(2654)]();i[R0(715)](q,Yx),i[R0(3778)](q,i[R0(3355)],i.NEAREST),i[R0(3778)](q,i[R0(2418)],i[R0(2445)]);for(let Ex=0;Ex<A0;Ex++)q===i[R0(2984)]||q===i[R0(2954)]?i[R0(2026)](v0,0,i[R0(792)],1,1,W0,0,i[R0(792)],i[R0(2841)],P0):i.texImage2D(v0+Ex,0,i[R0(792)],1,1,0,i.RGBA,i[R0(2841)],P0);return Yx}const g0={};g0[i.TEXTURE_2D]=n0(i[x(1915)],i[x(1915)],1),g0[i[x(757)]]=n0(i[x(757)],i[x(3427)],6),g0[i[x(2954)]]=n0(i[x(2954)],i.TEXTURE_2D_ARRAY,1,1),g0[i[x(2984)]]=n0(i[x(2984)],i[x(2984)],1,1),n[x(2503)](0,0,0,1),s[x(2503)](1),o[x(2503)](0),l0(i[x(3779)]),s.setFunc(IC),H0(!1),Y0(vb),l0(i[x(974)]),y0(Li);function l0(q){const v0=x;r[q]!==!0&&(i[v0(3542)](q),r[q]=!0)}function m0(q){const v0=x;r[q]!==!1&&(i[v0(3994)](q),r[q]=!1)}function M0(q,v0){const A0=x;return A[q]!==v0?(i.bindFramebuffer(q,v0),A[q]=v0,q===i[A0(2462)]&&(A[i[A0(1477)]]=v0),q===i[A0(1477)]&&(A[i[A0(2462)]]=v0),!0):!1}function bx(q,v0){const A0=x;let W0=h,R0=!1;if(q){W0=d[A0(2695)](v0),W0===void 0&&(W0=[],d.set(v0,W0));const P0=q.textures;if(W0[A0(2989)]!==P0[A0(2989)]||W0[0]!==i[A0(1898)]){for(let Yx=0,Ex=P0[A0(2989)];Yx<Ex;Yx++)W0[Yx]=i[A0(1898)]+Yx;W0.length=P0[A0(2989)],R0=!0}}else W0[0]!==i[A0(3851)]&&(W0[0]=i[A0(3851)],R0=!0);R0&&i[A0(3460)](W0)}function C0(q){const v0=x;return f!==q?(i[v0(2509)](q),f=q,!0):!1}const gx={[Gn]:i[x(1053)],[by]:i[x(2199)],[hy]:i[x(1492)]};gx[fy]=i[x(3112)],gx[my]=i.MAX;const ax={[Gy]:i.ZERO,[py]:i.ONE,[By]:i.SRC_COLOR,[e2]:i[x(2661)],[Ry]:i[x(1844)],[Wy]:i[x(788)],[yy]:i[x(1359)],[Zy]:i[x(3693)],[t2]:i.ONE_MINUS_SRC_ALPHA,[wy]:i[x(3923)],[vy]:i[x(2452)],[Vy]:i[x(1945)],[Sy]:i.ONE_MINUS_CONSTANT_COLOR,[Xy]:i.CONSTANT_ALPHA,[Yy]:i[x(2101)]};function y0(q,v0,A0,W0,R0,P0,Yx,Ex,Pe,Kx){const Ix=x;if(q===Li){B===!0&&(m0(i[Ix(305)]),B=!1);return}if(B===!1&&(l0(i[Ix(305)]),B=!0),q!==uy){if(q!==Z||Kx!==M){if((G!==Gn||p!==Gn)&&(i[Ix(3664)](i.FUNC_ADD),G=Gn,p=Gn),Kx)switch(q){case SI:i.blendFuncSeparate(i[Ix(3763)],i.ONE_MINUS_SRC_ALPHA,i[Ix(3763)],i[Ix(1070)]);break;case Wb:i[Ix(3784)](i[Ix(3763)],i.ONE);break;case wb:i.blendFuncSeparate(i[Ix(3583)],i.ONE_MINUS_SRC_COLOR,i[Ix(3583)],i[Ix(3763)]);break;case Rb:i[Ix(713)](i.ZERO,i[Ix(3805)],i[Ix(3583)],i[Ix(2661)]);break;default:console[Ix(2963)](Ix(1355),q);break}else switch(q){case SI:i[Ix(713)](i.SRC_ALPHA,i[Ix(1070)],i[Ix(3763)],i.ONE_MINUS_SRC_ALPHA);break;case Wb:i[Ix(3784)](i[Ix(2661)],i[Ix(3763)]);break;case wb:i[Ix(713)](i[Ix(3583)],i[Ix(3693)],i.ZERO,i[Ix(3763)]);break;case Rb:i[Ix(3784)](i.ZERO,i[Ix(3805)]);break;default:console[Ix(2963)](Ix(1355),q);break}m=null,v=null,w=null,V=null,N[Ix(298)](0,0,0),X=0,Z=q,M=Kx}return}R0=R0||v0,P0=P0||A0,Yx=Yx||W0,(v0!==G||R0!==p)&&(i[Ix(1816)](gx[v0],gx[R0]),G=v0,p=R0),(A0!==m||W0!==v||P0!==w||Yx!==V)&&(i[Ix(713)](ax[A0],ax[W0],ax[P0],ax[Yx]),m=A0,v=W0,w=P0,V=Yx),(Ex.equals(N)===!1||Pe!==X)&&(i[Ix(3132)](Ex.r,Ex.g,Ex.b,Pe),N[Ix(1493)](Ex),X=Pe),Z=q,M=!1}function V0(q,v0){const A0=x;q[A0(3601)]===si?m0(i[A0(974)]):l0(i.CULL_FACE);let W0=q[A0(3601)]===Zt;v0&&(W0=!W0),H0(W0),q[A0(314)]===SI&&q[A0(3249)]===!1?y0(Li):y0(q.blending,q.blendEquation,q[A0(3939)],q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q[A0(846)],q[A0(3132)],q[A0(399)],q.premultipliedAlpha),s[A0(325)](q.depthFunc),s[A0(1627)](q[A0(3329)]),s[A0(216)](q.depthWrite),n[A0(216)](q[A0(339)]);const R0=q[A0(903)];o[A0(1627)](R0),R0&&(o.setMask(q[A0(3137)]),o[A0(325)](q[A0(2139)],q[A0(3906)],q[A0(3536)]),o.setOp(q[A0(2573)],q[A0(2109)],q[A0(3809)])),$0(q[A0(492)],q[A0(2996)],q.polygonOffsetUnits),q[A0(1283)]===!0?l0(i[A0(3408)]):m0(i[A0(3408)])}function H0(q){const v0=x;Y!==q&&(q?i[v0(3694)](i.CW):i[v0(3694)](i[v0(2177)]),Y=q)}function Y0(q){const v0=x;q!==ry?(l0(i[v0(974)]),q!==S&&(q===vb?i[v0(3049)](i[v0(3851)]):q===dy?i.cullFace(i[v0(3638)]):i[v0(3049)](i.FRONT_AND_BACK))):m0(i[v0(974)]),S=q}function F0(q){q!==H&&(b0&&i.lineWidth(q),H=q)}function $0(q,v0,A0){const W0=x;q?(l0(i[W0(379)]),(O!==v0||I0!==A0)&&(i[W0(492)](v0,A0),O=v0,I0=A0)):m0(i[W0(379)])}function Q(q){q?l0(i[x(2474)]):m0(i.SCISSOR_TEST)}function R(q){const v0=x;q===void 0&&(q=i[v0(2017)]+z-1),$!==q&&(i[v0(2345)](q),$=q)}function T(q,v0,A0){const W0=x;A0===void 0&&($===null?A0=i[W0(2017)]+z-1:A0=$);let R0=j[A0];R0===void 0&&(R0={type:void 0,texture:void 0},j[A0]=R0),(R0[W0(3505)]!==q||R0[W0(3840)]!==v0)&&($!==A0&&(i[W0(2345)](A0),$=A0),i[W0(715)](q,v0||g0[q]),R0[W0(3505)]=q,R0[W0(3840)]=v0)}function F(){const q=x,v0=j[$];v0!==void 0&&v0[q(3505)]!==void 0&&(i[q(715)](v0.type,null),v0.type=void 0,v0.texture=void 0)}function Z0(){const q=x;try{i[q(3429)][q(1307)](i,arguments)}catch(v0){console[q(2963)](q(2201),v0)}}function d0(){const q=x;try{i.compressedTexImage3D[q(1307)](i,arguments)}catch(v0){console.error(q(2201),v0)}}function w0(){const q=x;try{i[q(1358)][q(1307)](i,arguments)}catch(v0){console[q(2963)](q(2201),v0)}}function j0(){const q=x;try{i[q(3488)].apply(i,arguments)}catch(v0){console[q(2963)]("THREE.WebGLState:",v0)}}function L0(){const q=x;try{i[q(3822)][q(1307)](i,arguments)}catch(v0){console[q(2963)](q(2201),v0)}}function J0(){const q=x;try{i.compressedTexSubImage3D[q(1307)](i,arguments)}catch(v0){console.error(q(2201),v0)}}function hx(){const q=x;try{i.texStorage2D[q(1307)](i,arguments)}catch(v0){console.error(q(2201),v0)}}function U0(){const q=x;try{i[q(886)][q(1307)](i,arguments)}catch(v0){console.error(q(2201),v0)}}function Cx(){const q=x;try{i[q(849)][q(1307)](i,arguments)}catch(v0){console[q(2963)](q(2201),v0)}}function Rx(){const q=x;try{i[q(2026)][q(1307)](i,arguments)}catch(v0){console.error("THREE.WebGLState:",v0)}}function nx(q){const v0=x;h0[v0(3106)](q)===!1&&(i.scissor(q.x,q.y,q.z,q.w),h0[v0(1493)](q))}function xx(q){const v0=x;X0[v0(3106)](q)===!1&&(i[v0(1310)](q.x,q.y,q.z,q.w),X0[v0(1493)](q))}function Vx(q,v0){const A0=x;let W0=C[A0(2695)](v0);W0===void 0&&(W0=new WeakMap,C[A0(298)](v0,W0));let R0=W0[A0(2695)](q);R0===void 0&&(R0=i[A0(3458)](v0,q.name),W0[A0(298)](q,R0))}function Hx(q,v0){const A0=x,W0=C[A0(2695)](v0),R0=W0[A0(2695)](q);c[A0(2695)](v0)!==R0&&(i[A0(3169)](v0,R0,q[A0(1651)]),c[A0(298)](v0,R0))}function Sx(){const q=x;i[q(3994)](i.BLEND),i[q(3994)](i[q(974)]),i[q(3994)](i[q(3779)]),i.disable(i[q(379)]),i.disable(i[q(2474)]),i.disable(i.STENCIL_TEST),i[q(3994)](i[q(3408)]),i[q(3664)](i.FUNC_ADD),i[q(3784)](i.ONE,i[q(3583)]),i[q(713)](i[q(3763)],i[q(3583)],i[q(3763)],i[q(3583)]),i.blendColor(0,0,0,0),i[q(1389)](!0,!0,!0,!0),i.clearColor(0,0,0,0),i[q(2075)](!0),i[q(3222)](i[q(1213)]),i.clearDepth(1),i[q(1102)](4294967295),i[q(2139)](i[q(1178)],0,4294967295),i[q(2801)](i.KEEP,i[q(546)],i.KEEP),i.clearStencil(0),i[q(3049)](i[q(3851)]),i.frontFace(i[q(2177)]),i.polygonOffset(0,0),i.activeTexture(i[q(2017)]),i.bindFramebuffer(i[q(1477)],null),i[q(693)](i[q(2462)],null),i[q(693)](i[q(3257)],null),i.useProgram(null),i.lineWidth(1),i[q(3108)](0,0,i[q(2359)].width,i[q(2359)].height),i.viewport(0,0,i[q(2359)][q(2315)],i.canvas[q(2741)]),r={},$=null,j={},A={},d=new WeakMap,h=[],f=null,B=!1,Z=null,G=null,m=null,v=null,p=null,w=null,V=null,N=new Q0(0,0,0),X=0,M=!1,Y=null,S=null,H=null,O=null,I0=null,h0[q(298)](0,0,i[q(2359)].width,i.canvas[q(2741)]),X0.set(0,0,i[q(2359)][q(2315)],i.canvas[q(2741)]),n.reset(),s.reset(),o.reset()}return{buffers:{color:n,depth:s,stencil:o},enable:l0,disable:m0,bindFramebuffer:M0,drawBuffers:bx,useProgram:C0,setBlending:y0,setMaterial:V0,setFlipSided:H0,setCullFace:Y0,setLineWidth:F0,setPolygonOffset:$0,setScissorTest:Q,activeTexture:R,bindTexture:T,unbindTexture:F,compressedTexImage2D:Z0,compressedTexImage3D:d0,texImage2D:Cx,texImage3D:Rx,updateUBOMapping:Vx,uniformBlockBinding:Hx,texStorage2D:hx,texStorage3D:U0,texSubImage2D:w0,texSubImage3D:j0,compressedTexSubImage2D:L0,compressedTexSubImage3D:J0,scissor:nx,viewport:xx,reset:Sx}}function wN(i,x,e,t,g,n,s){const o=I,c=x[o(2489)](o(2645))?x[o(2695)](o(2645)):null,C=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator[o(1161)]),r=new S0,A=new WeakMap;let d;const h=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1)[o(326)]("2d")!==null}catch{}function B(Q,R){return f?new OffscreenCanvas(Q,R):fC("canvas")}function Z(Q,R,T){const F=o;let Z0=1;const d0=$0(Q);if((d0[F(2315)]>T||d0[F(2741)]>T)&&(Z0=T/Math.max(d0.width,d0[F(2741)])),Z0<1)if(typeof HTMLImageElement!==F(1797)&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement!==F(1797)&&Q instanceof HTMLCanvasElement||typeof ImageBitmap!==F(1797)&&Q instanceof ImageBitmap||typeof VideoFrame!==F(1797)&&Q instanceof VideoFrame){const w0=Math[F(3143)](Z0*d0[F(2315)]),j0=Math[F(3143)](Z0*d0[F(2741)]);d===void 0&&(d=B(w0,j0));const L0=R?B(w0,j0):d;return L0[F(2315)]=w0,L0[F(2741)]=j0,L0[F(326)]("2d").drawImage(Q,0,0,w0,j0),console[F(3748)]("THREE.WebGLRenderer: Texture has been resized from ("+d0[F(2315)]+"x"+d0[F(2741)]+") to ("+w0+"x"+j0+")."),L0}else return"data"in Q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+d0[F(2315)]+"x"+d0[F(2741)]+")."),Q;return Q}function G(Q){const R=o;return Q[R(2787)]&&Q[R(3338)]!==Me&&Q.minFilter!==Ze}function m(Q){i[o(2870)](Q)}function v(Q,R,T,F,Z0=!1){const d0=o;if(Q!==null){if(i[Q]!==void 0)return i[Q];console.warn(d0(3227)+Q+"'")}let w0=R;if(R===i[d0(539)]&&(T===i[d0(3954)]&&(w0=i.R32F),T===i.HALF_FLOAT&&(w0=i[d0(1940)]),T===i[d0(2841)]&&(w0=i.R8)),R===i[d0(880)]&&(T===i[d0(2841)]&&(w0=i[d0(1292)]),T===i[d0(1958)]&&(w0=i[d0(821)]),T===i[d0(225)]&&(w0=i[d0(2009)]),T===i[d0(1888)]&&(w0=i[d0(2790)]),T===i[d0(3072)]&&(w0=i.R16I),T===i[d0(1071)]&&(w0=i[d0(2246)])),R===i.RG&&(T===i[d0(3954)]&&(w0=i[d0(3962)]),T===i[d0(2496)]&&(w0=i[d0(2320)]),T===i[d0(2841)]&&(w0=i[d0(3183)])),R===i[d0(3874)]&&(T===i[d0(2841)]&&(w0=i.RG8UI),T===i.UNSIGNED_SHORT&&(w0=i[d0(2884)]),T===i[d0(225)]&&(w0=i[d0(853)]),T===i[d0(1888)]&&(w0=i[d0(1435)]),T===i[d0(3072)]&&(w0=i[d0(950)]),T===i[d0(1071)]&&(w0=i[d0(3574)])),R===i.RGB&&T===i.UNSIGNED_INT_5_9_9_9_REV&&(w0=i[d0(514)]),R===i[d0(792)]){const j0=Z0?dC:_x[d0(3186)](F);T===i.FLOAT&&(w0=i[d0(2357)]),T===i[d0(2496)]&&(w0=i[d0(781)]),T===i[d0(2841)]&&(w0=j0===qx?i[d0(1712)]:i[d0(1012)]),T===i[d0(892)]&&(w0=i[d0(140)]),T===i[d0(2437)]&&(w0=i[d0(2601)])}return(w0===i[d0(1940)]||w0===i.R32F||w0===i[d0(2320)]||w0===i[d0(3962)]||w0===i[d0(781)]||w0===i.RGBA32F)&&x[d0(2695)](d0(3819)),w0}function p(Q,R){const T=o;return G(Q)===!0||Q[T(3495)]&&Q.minFilter!==Me&&Q[T(3338)]!==Ze?Math[T(127)](Math.max(R.width,R[T(2741)]))+1:Q.mipmaps!==void 0&&Q.mipmaps[T(2989)]>0?Q[T(2768)][T(2989)]:Q.isCompressedTexture&&Array.isArray(Q.image)?R.mipmaps.length:1}function w(Q){const R=o,T=Q.target;T[R(1216)](R(1439),w),N(T),T[R(1078)]&&A[R(1432)](T)}function V(Q){const R=o,T=Q[R(2930)];T[R(1216)](R(1439),V),M(T)}function N(Q){const R=o,T=t[R(2695)](Q);if(T[R(2103)]===void 0)return;const F=Q[R(3272)],Z0=h[R(2695)](F);if(Z0){const d0=Z0[T.__cacheKey];d0[R(1097)]--,d0.usedTimes===0&&X(Q),Object[R(958)](Z0)[R(2989)]===0&&h[R(1432)](F)}t[R(2208)](Q)}function X(Q){const R=o,T=t[R(2695)](Q);i.deleteTexture(T[R(2508)]);const F=Q.source,Z0=h.get(F);delete Z0[T[R(2299)]],s[R(338)].textures--}function M(Q){const R=o,T=t[R(2695)](Q);if(Q[R(2550)]&&Q[R(2550)].dispose(),Q[R(3948)])for(let Z0=0;Z0<6;Z0++){if(Array[R(1987)](T[R(445)][Z0]))for(let d0=0;d0<T[R(445)][Z0].length;d0++)i[R(2435)](T[R(445)][Z0][d0]);else i[R(2435)](T.__webglFramebuffer[Z0]);T[R(3071)]&&i[R(496)](T.__webglDepthbuffer[Z0])}else{if(Array[R(1987)](T[R(445)]))for(let Z0=0;Z0<T[R(445)][R(2989)];Z0++)i.deleteFramebuffer(T[R(445)][Z0]);else i.deleteFramebuffer(T[R(445)]);if(T[R(3071)]&&i[R(496)](T.__webglDepthbuffer),T[R(3760)]&&i[R(2435)](T.__webglMultisampledFramebuffer),T[R(1876)])for(let Z0=0;Z0<T[R(1876)][R(2989)];Z0++)T[R(1876)][Z0]&&i[R(496)](T.__webglColorRenderbuffer[Z0]);T[R(2537)]&&i[R(496)](T.__webglDepthRenderbuffer)}const F=Q.textures;for(let Z0=0,d0=F[R(2989)];Z0<d0;Z0++){const w0=t.get(F[Z0]);w0[R(2508)]&&(i[R(2491)](w0[R(2508)]),s[R(338)][R(353)]--),t[R(2208)](F[Z0])}t[R(2208)](Q)}let Y=0;function S(){Y=0}function H(){const Q=o,R=Y;return R>=g[Q(647)]&&console[Q(3748)](Q(2281)+R+" texture units while this GPU supports only "+g[Q(647)]),Y+=1,R}function O(Q){const R=o,T=[];return T.push(Q[R(861)]),T[R(3330)](Q.wrapT),T[R(3330)](Q.wrapR||0),T.push(Q[R(2637)]),T[R(3330)](Q[R(3338)]),T.push(Q[R(2651)]),T.push(Q[R(724)]),T[R(3330)](Q[R(3207)]),T.push(Q[R(3505)]),T[R(3330)](Q[R(2787)]),T[R(3330)](Q[R(3721)]),T[R(3330)](Q.flipY),T[R(3330)](Q[R(1005)]),T[R(3330)](Q[R(1549)]),T.join()}function I0(Q,R){const T=o,F=t[T(2695)](Q);if(Q[T(1078)]&&Y0(Q),Q.isRenderTargetTexture===!1&&Q[T(1450)]>0&&F.__version!==Q.version){const Z0=Q[T(1781)];if(Z0===null)console.warn(T(2233));else if(Z0[T(3605)]===!1)console[T(3748)](T(3476));else{h0(F,Q,R);return}}e[T(715)](i[T(1915)],F[T(2508)],i[T(2017)]+R)}function z(Q,R){const T=o,F=t[T(2695)](Q);if(Q[T(1450)]>0&&F[T(2417)]!==Q.version){h0(F,Q,R);return}e[T(715)](i[T(2954)],F[T(2508)],i[T(2017)]+R)}function b0(Q,R){const T=o,F=t.get(Q);if(Q[T(1450)]>0&&F.__version!==Q[T(1450)]){h0(F,Q,R);return}e[T(715)](i.TEXTURE_3D,F[T(2508)],i[T(2017)]+R)}function f0(Q,R){const T=o,F=t[T(2695)](Q);if(Q.version>0&&F.__version!==Q.version){X0(F,Q,R);return}e[T(715)](i[T(757)],F[T(2508)],i[T(2017)]+R)}const G0={[cC]:i.REPEAT,[Gg]:i[o(1655)],[CC]:i[o(183)]},$={[Me]:i[o(2445)],[of]:i[o(1284)],[Ds]:i.NEAREST_MIPMAP_LINEAR,[Ze]:i[o(1036)],[Mc]:i[o(568)],[oi]:i[o(3326)]},j={[lv]:i.NEVER,[bv]:i[o(1178)],[av]:i[o(1213)],[hf]:i[o(3815)],[rv]:i.EQUAL,[uv]:i[o(2429)],[dv]:i[o(308)],[Av]:i.NOTEQUAL};function x0(Q,R){const T=o;if(R.type===pg&&x[T(2489)](T(2552))===!1&&(R[T(2637)]===Ze||R[T(2637)]===Mc||R.magFilter===Ds||R[T(2637)]===oi||R[T(3338)]===Ze||R[T(3338)]===Mc||R[T(3338)]===Ds||R.minFilter===oi)&&console[T(3748)](T(3206)),i[T(3778)](Q,i[T(3387)],G0[R[T(861)]]),i[T(3778)](Q,i.TEXTURE_WRAP_T,G0[R[T(471)]]),(Q===i.TEXTURE_3D||Q===i[T(2954)])&&i.texParameteri(Q,i[T(3383)],G0[R[T(3883)]]),i[T(3778)](Q,i[T(2418)],$[R.magFilter]),i.texParameteri(Q,i.TEXTURE_MIN_FILTER,$[R[T(3338)]]),R[T(1446)]&&(i[T(3778)](Q,i[T(1534)],i[T(1370)]),i[T(3778)](Q,i[T(1223)],j[R[T(1446)]])),x.has(T(3974))===!0){if(R[T(2637)]===Me||R.minFilter!==Ds&&R.minFilter!==oi||R.type===pg&&x[T(2489)](T(2552))===!1)return;if(R[T(2651)]>1||t[T(2695)](R)[T(1142)]){const F=x[T(2695)](T(3974));i.texParameterf(Q,F[T(756)],Math.min(R.anisotropy,g[T(3572)]())),t.get(R)[T(1142)]=R.anisotropy}}}function c0(Q,R){const T=o;let F=!1;Q[T(2103)]===void 0&&(Q[T(2103)]=!0,R[T(2134)](T(1439),w));const Z0=R[T(3272)];let d0=h[T(2695)](Z0);d0===void 0&&(d0={},h[T(298)](Z0,d0));const w0=O(R);if(w0!==Q.__cacheKey){d0[w0]===void 0&&(d0[w0]={texture:i[T(2654)](),usedTimes:0},s[T(338)][T(353)]++,F=!0),d0[w0].usedTimes++;const j0=d0[Q[T(2299)]];j0!==void 0&&(d0[Q[T(2299)]][T(1097)]--,j0.usedTimes===0&&X(R)),Q[T(2299)]=w0,Q[T(2508)]=d0[w0][T(3840)]}return F}function h0(Q,R,T){const F=o;let Z0=i[F(1915)];(R[F(3821)]||R[F(3302)])&&(Z0=i[F(2954)]),R.isData3DTexture&&(Z0=i[F(2984)]);const d0=c0(Q,R),w0=R.source;e.bindTexture(Z0,Q[F(2508)],i.TEXTURE0+T);const j0=t.get(w0);if(w0.version!==j0[F(2417)]||d0===!0){e.activeTexture(i.TEXTURE0+T);const L0=_x[F(2529)](_x.workingColorSpace),J0=R[F(1549)]===Vi?null:_x[F(2529)](R.colorSpace),hx=R[F(1549)]===Vi||L0===J0?i[F(1276)]:i.BROWSER_DEFAULT_WEBGL;i[F(2133)](i[F(750)],R.flipY),i[F(2133)](i[F(351)],R[F(3721)]),i[F(2133)](i[F(3949)],R.unpackAlignment),i[F(2133)](i.UNPACK_COLORSPACE_CONVERSION_WEBGL,hx);let U0=Z(R.image,!1,g[F(3555)]);U0=F0(R,U0);const Cx=n[F(796)](R[F(3207)],R[F(1549)]),Rx=n[F(796)](R[F(3505)]);let nx=v(R[F(724)],Cx,Rx,R[F(1549)],R[F(1078)]);x0(Z0,R);let xx;const Vx=R.mipmaps,Hx=R.isVideoTexture!==!0,Sx=j0[F(2417)]===void 0||d0===!0,q=w0[F(334)],v0=p(R,U0);if(R[F(2907)])nx=i[F(2413)],R[F(3505)]===pg?nx=i[F(414)]:R[F(3505)]===kI?nx=i[F(3557)]:R[F(3505)]===yo&&(nx=i[F(1027)]),Sx&&(Hx?e[F(3064)](i.TEXTURE_2D,1,nx,U0[F(2315)],U0.height):e[F(849)](i[F(1915)],0,nx,U0[F(2315)],U0[F(2741)],0,Cx,Rx,null));else if(R[F(3079)])if(Vx[F(2989)]>0){Hx&&Sx&&e[F(3064)](i[F(1915)],v0,nx,Vx[0][F(2315)],Vx[0].height);for(let A0=0,W0=Vx.length;A0<W0;A0++)xx=Vx[A0],Hx?q&&e.texSubImage2D(i[F(1915)],A0,0,0,xx[F(2315)],xx[F(2741)],Cx,Rx,xx[F(3787)]):e[F(849)](i[F(1915)],A0,nx,xx.width,xx[F(2741)],0,Cx,Rx,xx[F(3787)]);R[F(2787)]=!1}else Hx?(Sx&&e[F(3064)](i[F(1915)],v0,nx,U0.width,U0[F(2741)]),q&&e.texSubImage2D(i.TEXTURE_2D,0,0,0,U0.width,U0[F(2741)],Cx,Rx,U0[F(3787)])):e[F(849)](i[F(1915)],0,nx,U0.width,U0[F(2741)],0,Cx,Rx,U0[F(3787)]);else if(R[F(1848)])if(R[F(3302)]){Hx&&Sx&&e[F(886)](i[F(2954)],v0,nx,Vx[0][F(2315)],Vx[0].height,U0[F(3936)]);for(let A0=0,W0=Vx.length;A0<W0;A0++)xx=Vx[A0],R[F(3207)]!==zt?Cx!==null?Hx?q&&e.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,A0,0,0,0,xx.width,xx.height,U0[F(3936)],Cx,xx[F(3787)],0,0):e[F(1925)](i.TEXTURE_2D_ARRAY,A0,nx,xx[F(2315)],xx[F(2741)],U0[F(3936)],0,xx[F(3787)],0,0):console[F(3748)](F(1875)):Hx?q&&e.texSubImage3D(i[F(2954)],A0,0,0,0,xx.width,xx[F(2741)],U0[F(3936)],Cx,Rx,xx[F(3787)]):e[F(2026)](i[F(2954)],A0,nx,xx[F(2315)],xx[F(2741)],U0[F(3936)],0,Cx,Rx,xx[F(3787)])}else{Hx&&Sx&&e[F(3064)](i[F(1915)],v0,nx,Vx[0][F(2315)],Vx[0][F(2741)]);for(let A0=0,W0=Vx[F(2989)];A0<W0;A0++)xx=Vx[A0],R[F(3207)]!==zt?Cx!==null?Hx?q&&e[F(3822)](i[F(1915)],A0,0,0,xx[F(2315)],xx.height,Cx,xx.data):e[F(3429)](i.TEXTURE_2D,A0,nx,xx[F(2315)],xx.height,0,xx[F(3787)]):console.warn(F(1875)):Hx?q&&e.texSubImage2D(i[F(1915)],A0,0,0,xx[F(2315)],xx[F(2741)],Cx,Rx,xx[F(3787)]):e.texImage2D(i.TEXTURE_2D,A0,nx,xx[F(2315)],xx[F(2741)],0,Cx,Rx,xx[F(3787)])}else if(R[F(3821)])Hx?(Sx&&e.texStorage3D(i[F(2954)],v0,nx,U0[F(2315)],U0[F(2741)],U0[F(3936)]),q&&e[F(3488)](i[F(2954)],0,0,0,0,U0[F(2315)],U0[F(2741)],U0[F(3936)],Cx,Rx,U0[F(3787)])):e[F(2026)](i[F(2954)],0,nx,U0[F(2315)],U0[F(2741)],U0[F(3936)],0,Cx,Rx,U0[F(3787)]);else if(R.isData3DTexture)Hx?(Sx&&e[F(886)](i.TEXTURE_3D,v0,nx,U0[F(2315)],U0[F(2741)],U0[F(3936)]),q&&e[F(3488)](i[F(2984)],0,0,0,0,U0.width,U0[F(2741)],U0.depth,Cx,Rx,U0[F(3787)])):e[F(2026)](i.TEXTURE_3D,0,nx,U0[F(2315)],U0.height,U0.depth,0,Cx,Rx,U0[F(3787)]);else if(R.isFramebufferTexture){if(Sx)if(Hx)e[F(3064)](i[F(1915)],v0,nx,U0[F(2315)],U0[F(2741)]);else{let A0=U0.width,W0=U0[F(2741)];for(let R0=0;R0<v0;R0++)e[F(849)](i[F(1915)],R0,nx,A0,W0,0,Cx,Rx,null),A0>>=1,W0>>=1}}else if(Vx[F(2989)]>0){if(Hx&&Sx){const A0=$0(Vx[0]);e.texStorage2D(i[F(1915)],v0,nx,A0[F(2315)],A0[F(2741)])}for(let A0=0,W0=Vx[F(2989)];A0<W0;A0++)xx=Vx[A0],Hx?q&&e.texSubImage2D(i[F(1915)],A0,0,0,Cx,Rx,xx):e[F(849)](i[F(1915)],A0,nx,Cx,Rx,xx);R.generateMipmaps=!1}else if(Hx){if(Sx){const A0=$0(U0);e[F(3064)](i[F(1915)],v0,nx,A0.width,A0[F(2741)])}q&&e[F(1358)](i[F(1915)],0,0,0,Cx,Rx,U0)}else e[F(849)](i[F(1915)],0,nx,Cx,Rx,U0);G(R)&&m(Z0),j0[F(2417)]=w0.version,R[F(1581)]&&R.onUpdate(R)}Q[F(2417)]=R.version}function X0(Q,R,T){const F=o;if(R.image[F(2989)]!==6)return;const Z0=c0(Q,R),d0=R[F(3272)];e.bindTexture(i[F(757)],Q[F(2508)],i[F(2017)]+T);const w0=t[F(2695)](d0);if(d0.version!==w0[F(2417)]||Z0===!0){e[F(2345)](i.TEXTURE0+T);const j0=_x[F(2529)](_x[F(3764)]),L0=R[F(1549)]===Vi?null:_x[F(2529)](R[F(1549)]),J0=R[F(1549)]===Vi||j0===L0?i[F(1276)]:i[F(2855)];i.pixelStorei(i[F(750)],R[F(233)]),i[F(2133)](i[F(351)],R[F(3721)]),i.pixelStorei(i.UNPACK_ALIGNMENT,R[F(1005)]),i[F(2133)](i[F(3070)],J0);const hx=R[F(1848)]||R.image[0][F(1848)],U0=R.image[0]&&R[F(1781)][0][F(3079)],Cx=[];for(let W0=0;W0<6;W0++)!hx&&!U0?Cx[W0]=Z(R[F(1781)][W0],!0,g[F(3008)]):Cx[W0]=U0?R[F(1781)][W0].image:R.image[W0],Cx[W0]=F0(R,Cx[W0]);const Rx=Cx[0],nx=n[F(796)](R[F(3207)],R[F(1549)]),xx=n[F(796)](R[F(3505)]),Vx=v(R[F(724)],nx,xx,R[F(1549)]),Hx=R[F(1078)]!==!0,Sx=w0[F(2417)]===void 0||Z0===!0,q=d0[F(334)];let v0=p(R,Rx);x0(i[F(757)],R);let A0;if(hx){Hx&&Sx&&e[F(3064)](i.TEXTURE_CUBE_MAP,v0,Vx,Rx[F(2315)],Rx[F(2741)]);for(let W0=0;W0<6;W0++){A0=Cx[W0][F(2768)];for(let R0=0;R0<A0[F(2989)];R0++){const P0=A0[R0];R[F(3207)]!==zt?nx!==null?Hx?q&&e.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W0,R0,0,0,P0[F(2315)],P0[F(2741)],nx,P0[F(3787)]):e.compressedTexImage2D(i[F(3427)]+W0,R0,Vx,P0[F(2315)],P0[F(2741)],0,P0.data):console.warn(F(741)):Hx?q&&e[F(1358)](i.TEXTURE_CUBE_MAP_POSITIVE_X+W0,R0,0,0,P0[F(2315)],P0[F(2741)],nx,xx,P0.data):e[F(849)](i[F(3427)]+W0,R0,Vx,P0.width,P0[F(2741)],0,nx,xx,P0[F(3787)])}}}else{if(A0=R[F(2768)],Hx&&Sx){A0[F(2989)]>0&&v0++;const W0=$0(Cx[0]);e.texStorage2D(i[F(757)],v0,Vx,W0.width,W0[F(2741)])}for(let W0=0;W0<6;W0++)if(U0){Hx?q&&e[F(1358)](i[F(3427)]+W0,0,0,0,Cx[W0][F(2315)],Cx[W0][F(2741)],nx,xx,Cx[W0].data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W0,0,Vx,Cx[W0][F(2315)],Cx[W0].height,0,nx,xx,Cx[W0][F(3787)]);for(let R0=0;R0<A0[F(2989)];R0++){const P0=A0[R0],Yx=P0.image[W0][F(1781)];Hx?q&&e[F(1358)](i.TEXTURE_CUBE_MAP_POSITIVE_X+W0,R0+1,0,0,Yx[F(2315)],Yx[F(2741)],nx,xx,Yx[F(3787)]):e[F(849)](i[F(3427)]+W0,R0+1,Vx,Yx[F(2315)],Yx[F(2741)],0,nx,xx,Yx.data)}}else{Hx?q&&e.texSubImage2D(i[F(3427)]+W0,0,0,0,nx,xx,Cx[W0]):e[F(849)](i[F(3427)]+W0,0,Vx,nx,xx,Cx[W0]);for(let R0=0;R0<A0[F(2989)];R0++){const P0=A0[R0];Hx?q&&e[F(1358)](i[F(3427)]+W0,R0+1,0,0,nx,xx,P0[F(1781)][W0]):e[F(849)](i[F(3427)]+W0,R0+1,Vx,nx,xx,P0.image[W0])}}}G(R)&&m(i[F(757)]),w0[F(2417)]=d0.version,R[F(1581)]&&R[F(1581)](R)}Q[F(2417)]=R[F(1450)]}function n0(Q,R,T,F,Z0,d0){const w0=o,j0=n[w0(796)](T.format,T.colorSpace),L0=n[w0(796)](T[w0(3505)]),J0=v(T.internalFormat,j0,L0,T[w0(1549)]);if(!t.get(R)[w0(388)]){const U0=Math[w0(1971)](1,R[w0(2315)]>>d0),Cx=Math[w0(1971)](1,R[w0(2741)]>>d0);Z0===i.TEXTURE_3D||Z0===i[w0(2954)]?e.texImage3D(Z0,d0,J0,U0,Cx,R[w0(3936)],0,j0,L0,null):e.texImage2D(Z0,d0,J0,U0,Cx,0,j0,L0,null)}e.bindFramebuffer(i.FRAMEBUFFER,Q),H0(R)?c.framebufferTexture2DMultisampleEXT(i[w0(1477)],F,Z0,t[w0(2695)](T)[w0(2508)],0,V0(R)):(Z0===i.TEXTURE_2D||Z0>=i[w0(3427)]&&Z0<=i[w0(2857)])&&i[w0(1533)](i[w0(1477)],F,Z0,t.get(T).__webglTexture,d0),e[w0(693)](i[w0(1477)],null)}function g0(Q,R,T){const F=o;if(i.bindRenderbuffer(i[F(793)],Q),R[F(1899)]&&!R[F(2876)]){let Z0=i.DEPTH_COMPONENT24;if(T||H0(R)){const d0=R[F(2550)];d0&&d0[F(2907)]&&(d0[F(3505)]===pg?Z0=i[F(414)]:d0.type===kI&&(Z0=i[F(3557)]));const w0=V0(R);H0(R)?c[F(3591)](i[F(793)],w0,Z0,R.width,R[F(2741)]):i[F(3793)](i.RENDERBUFFER,w0,Z0,R[F(2315)],R[F(2741)])}else i[F(1814)](i[F(793)],Z0,R[F(2315)],R[F(2741)]);i[F(2226)](i[F(1477)],i.DEPTH_ATTACHMENT,i[F(793)],Q)}else if(R.depthBuffer&&R[F(2876)]){const Z0=V0(R);T&&H0(R)===!1?i[F(3793)](i[F(793)],Z0,i[F(1027)],R[F(2315)],R[F(2741)]):H0(R)?c[F(3591)](i[F(793)],Z0,i.DEPTH24_STENCIL8,R[F(2315)],R[F(2741)]):i[F(1814)](i[F(793)],i[F(2438)],R[F(2315)],R[F(2741)]),i[F(2226)](i[F(1477)],i[F(1138)],i[F(793)],Q)}else{const Z0=R[F(353)];for(let d0=0;d0<Z0[F(2989)];d0++){const w0=Z0[d0],j0=n.convert(w0.format,w0[F(1549)]),L0=n.convert(w0[F(3505)]),J0=v(w0[F(724)],j0,L0,w0.colorSpace),hx=V0(R);T&&H0(R)===!1?i[F(3793)](i[F(793)],hx,J0,R.width,R[F(2741)]):H0(R)?c[F(3591)](i[F(793)],hx,J0,R[F(2315)],R[F(2741)]):i[F(1814)](i[F(793)],J0,R.width,R[F(2741)])}}i[F(3036)](i[F(793)],null)}function l0(Q,R){const T=o;if(R&&R.isWebGLCubeRenderTarget)throw new Error(T(1171));if(e[T(693)](i[T(1477)],Q),!(R[T(2550)]&&R[T(2550)][T(2907)]))throw new Error(T(1745));(!t[T(2695)](R[T(2550)]).__webglTexture||R[T(2550)].image[T(2315)]!==R[T(2315)]||R[T(2550)][T(1781)][T(2741)]!==R.height)&&(R[T(2550)][T(1781)][T(2315)]=R.width,R[T(2550)][T(1781)].height=R[T(2741)],R[T(2550)][T(2170)]=!0),I0(R[T(2550)],0);const Z0=t[T(2695)](R[T(2550)])[T(2508)],d0=V0(R);if(R[T(2550)][T(3207)]===XI)H0(R)?c[T(462)](i[T(1477)],i.DEPTH_ATTACHMENT,i[T(1915)],Z0,0,d0):i[T(1533)](i[T(1477)],i.DEPTH_ATTACHMENT,i[T(1915)],Z0,0);else if(R[T(2550)][T(3207)]===bo)H0(R)?c[T(462)](i[T(1477)],i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Z0,0,d0):i[T(1533)](i[T(1477)],i[T(1138)],i[T(1915)],Z0,0);else throw new Error("Unknown depthTexture format")}function m0(Q){const R=o,T=t[R(2695)](Q),F=Q[R(3948)]===!0;if(Q.depthTexture&&!T[R(2581)]){if(F)throw new Error(R(893));l0(T[R(445)],Q)}else if(F){T[R(3071)]=[];for(let Z0=0;Z0<6;Z0++)e[R(693)](i.FRAMEBUFFER,T[R(445)][Z0]),T[R(3071)][Z0]=i[R(267)](),g0(T.__webglDepthbuffer[Z0],Q,!1)}else e[R(693)](i[R(1477)],T[R(445)]),T[R(3071)]=i[R(267)](),g0(T[R(3071)],Q,!1);e[R(693)](i[R(1477)],null)}function M0(Q,R,T){const F=o,Z0=t[F(2695)](Q);R!==void 0&&n0(Z0.__webglFramebuffer,Q,Q[F(3840)],i[F(1898)],i[F(1915)],0),T!==void 0&&m0(Q)}function bx(Q){const R=o,T=Q[R(3840)],F=t[R(2695)](Q),Z0=t.get(T);Q[R(2134)](R(1439),V);const d0=Q[R(353)],w0=Q[R(3948)]===!0,j0=d0[R(2989)]>1;if(!j0&&(Z0[R(2508)]===void 0&&(Z0[R(2508)]=i[R(2654)]()),Z0[R(2417)]=T[R(1450)],s.memory[R(353)]++),w0){F[R(445)]=[];for(let L0=0;L0<6;L0++)if(T[R(2768)]&&T[R(2768)][R(2989)]>0){F[R(445)][L0]=[];for(let J0=0;J0<T.mipmaps[R(2989)];J0++)F.__webglFramebuffer[L0][J0]=i[R(2919)]()}else F[R(445)][L0]=i[R(2919)]()}else{if(T[R(2768)]&&T[R(2768)][R(2989)]>0){F[R(445)]=[];for(let L0=0;L0<T[R(2768)][R(2989)];L0++)F[R(445)][L0]=i[R(2919)]()}else F[R(445)]=i.createFramebuffer();if(j0)for(let L0=0,J0=d0[R(2989)];L0<J0;L0++){const hx=t[R(2695)](d0[L0]);hx.__webglTexture===void 0&&(hx[R(2508)]=i[R(2654)](),s.memory[R(353)]++)}if(Q[R(2711)]>0&&H0(Q)===!1){F[R(3760)]=i[R(2919)](),F.__webglColorRenderbuffer=[],e[R(693)](i[R(1477)],F[R(3760)]);for(let L0=0;L0<d0[R(2989)];L0++){const J0=d0[L0];F.__webglColorRenderbuffer[L0]=i[R(267)](),i.bindRenderbuffer(i[R(793)],F[R(1876)][L0]);const hx=n[R(796)](J0.format,J0[R(1549)]),U0=n[R(796)](J0.type),Cx=v(J0[R(724)],hx,U0,J0[R(1549)],Q[R(1679)]===!0),Rx=V0(Q);i[R(3793)](i[R(793)],Rx,Cx,Q.width,Q[R(2741)]),i.framebufferRenderbuffer(i[R(1477)],i.COLOR_ATTACHMENT0+L0,i[R(793)],F.__webglColorRenderbuffer[L0])}i[R(3036)](i.RENDERBUFFER,null),Q[R(1899)]&&(F[R(2537)]=i[R(267)](),g0(F[R(2537)],Q,!0)),e.bindFramebuffer(i[R(1477)],null)}}if(w0){e[R(715)](i[R(757)],Z0[R(2508)]),x0(i[R(757)],T);for(let L0=0;L0<6;L0++)if(T[R(2768)]&&T.mipmaps[R(2989)]>0)for(let J0=0;J0<T[R(2768)].length;J0++)n0(F.__webglFramebuffer[L0][J0],Q,T,i[R(1898)],i.TEXTURE_CUBE_MAP_POSITIVE_X+L0,J0);else n0(F[R(445)][L0],Q,T,i[R(1898)],i[R(3427)]+L0,0);G(T)&&m(i[R(757)]),e[R(1430)]()}else if(j0){for(let L0=0,J0=d0.length;L0<J0;L0++){const hx=d0[L0],U0=t.get(hx);e[R(715)](i[R(1915)],U0[R(2508)]),x0(i[R(1915)],hx),n0(F[R(445)],Q,hx,i[R(1898)]+L0,i[R(1915)],0),G(hx)&&m(i[R(1915)])}e[R(1430)]()}else{let L0=i[R(1915)];if((Q[R(1373)]||Q[R(3599)])&&(L0=Q[R(1373)]?i.TEXTURE_3D:i[R(2954)]),e[R(715)](L0,Z0[R(2508)]),x0(L0,T),T.mipmaps&&T.mipmaps[R(2989)]>0)for(let J0=0;J0<T[R(2768)][R(2989)];J0++)n0(F.__webglFramebuffer[J0],Q,T,i.COLOR_ATTACHMENT0,L0,J0);else n0(F[R(445)],Q,T,i.COLOR_ATTACHMENT0,L0,0);G(T)&&m(L0),e.unbindTexture()}Q[R(1899)]&&m0(Q)}function C0(Q){const R=o,T=Q[R(353)];for(let F=0,Z0=T[R(2989)];F<Z0;F++){const d0=T[F];if(G(d0)){const w0=Q[R(3948)]?i[R(757)]:i[R(1915)],j0=t[R(2695)](d0).__webglTexture;e[R(715)](w0,j0),m(w0),e.unbindTexture()}}}const gx=[],ax=[];function y0(Q){const R=o;if(Q.samples>0){if(H0(Q)===!1){const T=Q.textures,F=Q.width,Z0=Q[R(2741)];let d0=i.COLOR_BUFFER_BIT;const w0=Q.stencilBuffer?i[R(1138)]:i[R(335)],j0=t.get(Q),L0=T[R(2989)]>1;if(L0)for(let J0=0;J0<T[R(2989)];J0++)e[R(693)](i.FRAMEBUFFER,j0[R(3760)]),i[R(2226)](i[R(1477)],i[R(1898)]+J0,i[R(793)],null),e[R(693)](i[R(1477)],j0[R(445)]),i.framebufferTexture2D(i[R(2462)],i.COLOR_ATTACHMENT0+J0,i[R(1915)],null,0);e.bindFramebuffer(i[R(3257)],j0[R(3760)]),e[R(693)](i[R(2462)],j0[R(445)]);for(let J0=0;J0<T[R(2989)];J0++){if(Q[R(3361)]&&(Q[R(1899)]&&(d0|=i.DEPTH_BUFFER_BIT),Q[R(2876)]&&Q[R(2121)]&&(d0|=i.STENCIL_BUFFER_BIT)),L0){i[R(2226)](i[R(3257)],i[R(1898)],i[R(793)],j0[R(1876)][J0]);const hx=t[R(2695)](T[J0])[R(2508)];i[R(1533)](i.DRAW_FRAMEBUFFER,i[R(1898)],i[R(1915)],hx,0)}i.blitFramebuffer(0,0,F,Z0,0,0,F,Z0,d0,i[R(2445)]),C===!0&&(gx[R(2989)]=0,ax[R(2989)]=0,gx.push(i[R(1898)]+J0),Q[R(1899)]&&Q[R(3361)]===!1&&(gx[R(3330)](w0),ax[R(3330)](w0),i[R(1966)](i.DRAW_FRAMEBUFFER,ax)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,gx))}if(e[R(693)](i.READ_FRAMEBUFFER,null),e[R(693)](i[R(2462)],null),L0)for(let J0=0;J0<T.length;J0++){e[R(693)](i[R(1477)],j0.__webglMultisampledFramebuffer),i[R(2226)](i[R(1477)],i[R(1898)]+J0,i.RENDERBUFFER,j0[R(1876)][J0]);const hx=t[R(2695)](T[J0]).__webglTexture;e[R(693)](i.FRAMEBUFFER,j0[R(445)]),i[R(1533)](i[R(2462)],i[R(1898)]+J0,i.TEXTURE_2D,hx,0)}e[R(693)](i[R(2462)],j0[R(3760)])}else if(Q[R(1899)]&&Q[R(3361)]===!1&&C){const T=Q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i[R(335)];i[R(1966)](i.DRAW_FRAMEBUFFER,[T])}}}function V0(Q){return Math[o(1410)](g.maxSamples,Q.samples)}function H0(Q){const R=o,T=t[R(2695)](Q);return Q.samples>0&&x[R(2489)](R(2645))===!0&&T[R(1974)]!==!1}function Y0(Q){const R=o,T=s[R(948)][R(949)];A[R(2695)](Q)!==T&&(A[R(298)](Q,T),Q.update())}function F0(Q,R){const T=o,F=Q[T(1549)],Z0=Q.format,d0=Q[T(3505)];return Q[T(1848)]===!0||Q[T(1078)]===!0||F!==Di&&F!==Vi&&(_x.getTransfer(F)===qx?(Z0!==zt||d0!==di)&&console.warn(T(1023)):console[T(2963)]("THREE.WebGLTextures: Unsupported texture color space:",F)),R}function $0(Q){const R=o;return typeof HTMLImageElement!==R(1797)&&Q instanceof HTMLImageElement?(r.width=Q[R(624)]||Q[R(2315)],r[R(2741)]=Q[R(1275)]||Q[R(2741)]):typeof VideoFrame!==R(1797)&&Q instanceof VideoFrame?(r.width=Q[R(3342)],r[R(2741)]=Q[R(3817)]):(r[R(2315)]=Q[R(2315)],r[R(2741)]=Q[R(2741)]),r}this[o(2826)]=H,this[o(2130)]=S,this.setTexture2D=I0,this[o(2814)]=z,this.setTexture3D=b0,this.setTextureCube=f0,this.rebindTextures=M0,this.setupRenderTarget=bx,this.updateRenderTargetMipmap=C0,this.updateMultisampleRenderTarget=y0,this[o(3737)]=m0,this.setupFrameBufferTexture=n0,this[o(1232)]=H0}function Hv(i,x){function e(t,g=Vi){const n=i0;let s;const o=_x[n(3186)](g);if(t===di)return i[n(2841)];if(t===lf)return i[n(892)];if(t===af)return i[n(2437)];if(t===$y)return i[n(2493)];if(t===Oy)return i[n(1888)];if(t===qy)return i[n(3072)];if(t===cf)return i[n(1958)];if(t===Cf)return i.INT;if(t===kI)return i[n(225)];if(t===pg)return i[n(3954)];if(t===KC)return i[n(2496)];if(t===jy)return i.ALPHA;if(t===xv)return i[n(516)];if(t===zt)return i[n(792)];if(t===ev)return i.LUMINANCE;if(t===tv)return i.LUMINANCE_ALPHA;if(t===XI)return i[n(1099)];if(t===bo)return i[n(2438)];if(t===rf)return i.RED;if(t===df)return i[n(880)];if(t===gv)return i.RG;if(t===Af)return i[n(3874)];if(t===uf)return i.RGBA_INTEGER;if(t===fr||t===mr||t===Gr||t===pr)if(o===qx)if(s=x[n(2695)](n(3663)),s!==null){if(t===fr)return s[n(1592)];if(t===mr)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(t===Gr)return s[n(3372)];if(t===pr)return s[n(2904)]}else return null;else if(s=x[n(2695)](n(2461)),s!==null){if(t===fr)return s[n(3363)];if(t===mr)return s[n(3563)];if(t===Gr)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===pr)return s[n(1746)]}else return null;if(t===Sb||t===Xb||t===Yb||t===Kb)if(s=x[n(2695)](n(3391)),s!==null){if(t===Sb)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===Xb)return s[n(392)];if(t===Yb)return s[n(3345)];if(t===Kb)return s[n(818)]}else return null;if(t===Hb||t===Nb||t===Fb)if(s=x.get(n(3768)),s!==null){if(t===Hb||t===Nb)return o===qx?s[n(723)]:s[n(677)];if(t===Fb)return o===qx?s[n(2705)]:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(t===zb||t===Mb||t===Lb||t===kb||t===Tb||t===Jb||t===Eb||t===Ub||t===_b||t===Db||t===Qb||t===Pb||t===Ob||t===qb)if(s=x[n(2695)](n(3538)),s!==null){if(t===zb)return o===qx?s[n(2387)]:s[n(2277)];if(t===Mb)return o===qx?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s[n(889)];if(t===Lb)return o===qx?s[n(448)]:s[n(144)];if(t===kb)return o===qx?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s[n(3826)];if(t===Tb)return o===qx?s[n(420)]:s[n(3255)];if(t===Jb)return o===qx?s[n(2288)]:s[n(120)];if(t===Eb)return o===qx?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s[n(2008)];if(t===Ub)return o===qx?s[n(1704)]:s[n(1817)];if(t===_b)return o===qx?s[n(862)]:s[n(2415)];if(t===Db)return o===qx?s[n(2847)]:s[n(2202)];if(t===Qb)return o===qx?s[n(2639)]:s[n(3366)];if(t===Pb)return o===qx?s[n(812)]:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(t===Ob)return o===qx?s[n(1884)]:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(t===qb)return o===qx?s[n(783)]:s[n(1191)]}else return null;if(t===Br||t===$b||t===jb)if(s=x.get("EXT_texture_compression_bptc"),s!==null){if(t===Br)return o===qx?s[n(3109)]:s[n(2572)];if(t===$b)return s[n(731)];if(t===jb)return s[n(1254)]}else return null;if(t===iv||t===xh||t===eh||t===th)if(s=x[n(2695)](n(3040)),s!==null){if(t===Br)return s[n(2831)];if(t===xh)return s[n(2473)];if(t===eh)return s[n(2866)];if(t===th)return s[n(1517)]}else return null;return t===yo?i[n(503)]:i[t]!==void 0?i[t]:null}return{convert:e}}class Nv extends ze{constructor(x=[]){const e=I;super(),this[e(510)]=!0,this[e(2457)]=x}}class Os extends Nx{constructor(){const x=I;super(),this[x(1982)]=!0,this[x(3505)]=x(2156)}}const RN={type:I(1837)};class tu{constructor(){const x=I;this[x(1649)]=null,this[x(1710)]=null,this[x(2179)]=null}[I(3258)](){const x=I;return this[x(2179)]===null&&(this[x(2179)]=new Os,this._hand.matrixAutoUpdate=!1,this[x(2179)][x(2548)]=!1,this._hand.joints={},this._hand[x(3154)]={pinching:!1}),this[x(2179)]}[I(3466)](){const x=I;return this._targetRay===null&&(this[x(1649)]=new Os,this[x(1649)].matrixAutoUpdate=!1,this._targetRay[x(2548)]=!1,this[x(1649)][x(3626)]=!1,this[x(1649)][x(3735)]=new E,this[x(1649)].hasAngularVelocity=!1,this[x(1649)][x(810)]=new E),this._targetRay}[I(1853)](){const x=I;return this[x(1710)]===null&&(this[x(1710)]=new Os,this[x(1710)][x(2272)]=!1,this[x(1710)].visible=!1,this[x(1710)][x(3626)]=!1,this[x(1710)][x(3735)]=new E,this._grip.hasAngularVelocity=!1,this[x(1710)].angularVelocity=new E),this[x(1710)]}[I(1457)](x){const e=I;return this[e(1649)]!==null&&this._targetRay[e(1457)](x),this[e(1710)]!==null&&this._grip.dispatchEvent(x),this[e(2179)]!==null&&this[e(2179)][e(1457)](x),this}connect(x){const e=I;if(x&&x.hand){const t=this[e(2179)];if(t)for(const g of x.hand[e(2326)]())this._getHandJoint(t,g)}return this[e(1457)]({type:"connected",data:x}),this}disconnect(x){const e=I;return this[e(1457)]({type:e(3451),data:x}),this[e(1649)]!==null&&(this._targetRay[e(2548)]=!1),this[e(1710)]!==null&&(this[e(1710)][e(2548)]=!1),this[e(2179)]!==null&&(this[e(2179)][e(2548)]=!1),this}[I(2341)](x,e,t){const g=I;let n=null,s=null,o=null;const c=this._targetRay,C=this._grip,r=this[g(2179)];if(x&&e[g(2448)][g(1912)]!==g(2673)){if(r&&x[g(2081)]){o=!0;for(const Z of x[g(2081)][g(2326)]()){const G=e.getJointPose(Z,t),m=this._getHandJoint(r,Z);G!==null&&(m[g(1721)][g(2793)](G[g(967)][g(1721)]),m[g(1721)].decompose(m.position,m[g(1488)],m[g(623)]),m[g(2621)]=!0,m[g(1774)]=G[g(3015)]),m[g(2548)]=G!==null}const A=r[g(1344)]["index-finger-tip"],d=r[g(1344)][g(694)],h=A[g(2817)][g(3708)](d[g(2817)]),f=.02,B=.005;r[g(3154)][g(2329)]&&h>f+B?(r[g(3154)].pinching=!1,this[g(1457)]({type:"pinchend",handedness:x.handedness,target:this})):!r[g(3154)][g(2329)]&&h<=f-B&&(r.inputState[g(2329)]=!0,this.dispatchEvent({type:g(2843),handedness:x.handedness,target:this}))}else C!==null&&x[g(2804)]&&(s=e.getPose(x.gripSpace,t),s!==null&&(C[g(1721)][g(2793)](s[g(967)][g(1721)]),C[g(1721)][g(2986)](C[g(2817)],C[g(1488)],C[g(623)]),C[g(2621)]=!0,s.linearVelocity?(C[g(3626)]=!0,C[g(3735)][g(1493)](s[g(3735)])):C.hasLinearVelocity=!1,s.angularVelocity?(C[g(273)]=!0,C[g(810)][g(1493)](s[g(810)])):C[g(273)]=!1));c!==null&&(n=e[g(3509)](x.targetRaySpace,t),n===null&&s!==null&&(n=s),n!==null&&(c[g(1721)][g(2793)](n[g(967)][g(1721)]),c.matrix.decompose(c.position,c[g(1488)],c[g(623)]),c[g(2621)]=!0,n[g(3735)]?(c.hasLinearVelocity=!0,c[g(3735)].copy(n[g(3735)])):c[g(3626)]=!1,n[g(810)]?(c.hasAngularVelocity=!0,c[g(810)][g(1493)](n[g(810)])):c.hasAngularVelocity=!1,this[g(1457)](RN)))}return c!==null&&(c[g(2548)]=n!==null),C!==null&&(C[g(2548)]=s!==null),r!==null&&(r.visible=o!==null),this}[I(2732)](x,e){const t=I;if(x[t(1344)][e[t(615)]]===void 0){const g=new Os;g[t(2272)]=!1,g.visible=!1,x[t(1344)][e[t(615)]]=g,x[t(3014)](g)}return x[t(1344)][e[t(615)]]}}const VN=I(3440),SN=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class XN{constructor(){const x=I;this[x(3840)]=null,this.mesh=null,this[x(3515)]=0,this.depthFar=0}[I(2032)](x,e,t){const g=I;if(this[g(3840)]===null){const n=new ue,s=x.properties[g(2695)](n);s[g(2508)]=e.texture,(e[g(3515)]!=t[g(3515)]||e[g(636)]!=t[g(636)])&&(this.depthNear=e.depthNear,this[g(636)]=e[g(636)]),this[g(3840)]=n}}[I(948)](x,e){const t=I;if(this[t(3840)]!==null){if(this.mesh===null){const g=e[t(2457)][0][t(1310)],n=new Eg({vertexShader:VN,fragmentShader:SN,uniforms:{depthColor:{value:this[t(3840)]},depthWidth:{value:g.z},depthHeight:{value:g.w}}});this[t(2532)]=new ye(new Wo(20,20),n)}x[t(948)](this.mesh,e)}}[I(1877)](){const x=I;this[x(3840)]=null,this[x(2532)]=null}}class YN extends Qi{constructor(x,e){const t=I;super();const g=this;let n=null,s=1,o=null,c=t(1847),C=1,r=null,A=null,d=null,h=null,f=null,B=null;const Z=new XN,G=e[t(3965)]();let m=null,v=null;const p=[],w=[],V=new S0;let N=null;const X=new ze;X.layers[t(3542)](1),X[t(1310)]=new Dx;const M=new ze;M[t(2669)][t(3542)](2),M[t(1310)]=new Dx;const Y=[X,M],S=new Nv;S.layers[t(3542)](1),S[t(2669)][t(3542)](2);let H=null,O=null;this[t(1631)]=!0,this.enabled=!1,this[t(1509)]=!1,this.getController=function(n0){const g0=t;let l0=p[n0];return l0===void 0&&(l0=new tu,p[n0]=l0),l0[g0(3466)]()},this[t(2365)]=function(n0){const g0=t;let l0=p[n0];return l0===void 0&&(l0=new tu,p[n0]=l0),l0[g0(1853)]()},this[t(2682)]=function(n0){const g0=t;let l0=p[n0];return l0===void 0&&(l0=new tu,p[n0]=l0),l0[g0(3258)]()};function I0(n0){const g0=t,l0=w[g0(2377)](n0[g0(1977)]);if(l0===-1)return;const m0=p[l0];m0!==void 0&&(m0.update(n0[g0(1977)],n0[g0(949)],r||o),m0[g0(1457)]({type:n0[g0(3505)],data:n0.inputSource}))}function z(){const n0=t;n[n0(1216)](n0(1860),I0),n[n0(1216)]("selectstart",I0),n.removeEventListener("selectend",I0),n[n0(1216)](n0(1444),I0),n.removeEventListener(n0(2420),I0),n.removeEventListener(n0(2521),I0),n[n0(1216)](n0(922),z),n[n0(1216)]("inputsourceschange",b0);for(let g0=0;g0<p.length;g0++){const l0=w[g0];l0!==null&&(w[g0]=null,p[g0][n0(3573)](l0))}H=null,O=null,Z[n0(1877)](),x[n0(681)](m),f=null,h=null,d=null,n=null,v=null,X0.stop(),g[n0(1509)]=!1,x[n0(3261)](N),x.setSize(V[n0(2315)],V[n0(2741)],!1),g[n0(1457)]({type:n0(2704)})}this[t(2506)]=function(n0){const g0=t;s=n0,g.isPresenting===!0&&console.warn(g0(2580))},this[t(398)]=function(n0){const g0=t;c=n0,g[g0(1509)]===!0&&console.warn(g0(1391))},this[t(771)]=function(){return r||o},this[t(689)]=function(n0){r=n0},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return d},this[t(3528)]=function(){return B},this.getSession=function(){return n},this[t(3307)]=async function(n0){const g0=t;if(n=n0,n!==null){if(m=x.getRenderTarget(),n.addEventListener("select",I0),n[g0(2134)]("selectstart",I0),n[g0(2134)](g0(1995),I0),n.addEventListener(g0(1444),I0),n[g0(2134)](g0(2420),I0),n.addEventListener(g0(2521),I0),n[g0(2134)](g0(922),z),n[g0(2134)](g0(843),b0),G[g0(3336)]!==!0&&await e[g0(1539)](),N=x[g0(1320)](),x[g0(1277)](V),n.renderState[g0(2669)]===void 0){const l0={antialias:G[g0(2553)],alpha:!0,depth:G[g0(3936)],stencil:G[g0(3236)],framebufferScaleFactor:s};f=new XRWebGLLayer(n,e,l0),n[g0(110)]({baseLayer:f}),x.setPixelRatio(1),x[g0(2614)](f.framebufferWidth,f.framebufferHeight,!1),v=new Jg(f[g0(1903)],f.framebufferHeight,{format:zt,type:di,colorSpace:x.outputColorSpace,stencilBuffer:G.stencil})}else{let l0=null,m0=null,M0=null;G[g0(3936)]&&(M0=G[g0(3236)]?e[g0(1027)]:e[g0(3557)],l0=G.stencil?bo:XI,m0=G.stencil?yo:kI);const bx={colorFormat:e.RGBA8,depthFormat:M0,scaleFactor:s};d=new XRWebGLBinding(n,e),h=d[g0(3666)](bx),n[g0(110)]({layers:[h]}),x[g0(3261)](1),x[g0(2614)](h.textureWidth,h[g0(3705)],!1),v=new Jg(h.textureWidth,h.textureHeight,{format:zt,type:di,depthTexture:new Zf(h[g0(2140)],h[g0(3705)],m0,void 0,void 0,void 0,void 0,void 0,void 0,l0),stencilBuffer:G[g0(3236)],colorSpace:x.outputColorSpace,samples:G.antialias?4:0,resolveDepthBuffer:h[g0(1926)]===!1})}v[g0(1679)]=!0,this[g0(946)](C),r=null,o=await n.requestReferenceSpace(c),X0[g0(3213)](n),X0[g0(3988)](),g[g0(1509)]=!0,g[g0(1457)]({type:g0(2517)})}},this.getEnvironmentBlendMode=function(){const n0=t;if(n!==null)return n[n0(2921)]};function b0(n0){const g0=t;for(let l0=0;l0<n0[g0(1468)][g0(2989)];l0++){const m0=n0[g0(1468)][l0],M0=w[g0(2377)](m0);M0>=0&&(w[M0]=null,p[M0][g0(3573)](m0))}for(let l0=0;l0<n0[g0(118)][g0(2989)];l0++){const m0=n0[g0(118)][l0];let M0=w.indexOf(m0);if(M0===-1){for(let C0=0;C0<p[g0(2989)];C0++)if(C0>=w[g0(2989)]){w.push(m0),M0=C0;break}else if(w[C0]===null){w[C0]=m0,M0=C0;break}if(M0===-1)break}const bx=p[M0];bx&&bx[g0(1222)](m0)}}const f0=new E,G0=new E;function $(n0,g0,l0){const m0=t;f0[m0(1577)](g0[m0(2368)]),G0[m0(1577)](l0.matrixWorld);const M0=f0[m0(3708)](G0),bx=g0.projectionMatrix[m0(2574)],C0=l0[m0(2900)][m0(2574)],gx=bx[14]/(bx[10]-1),ax=bx[14]/(bx[10]+1),y0=(bx[9]+1)/bx[5],V0=(bx[9]-1)/bx[5],H0=(bx[8]-1)/bx[0],Y0=(C0[8]+1)/C0[0],F0=gx*H0,$0=gx*Y0,Q=M0/(-H0+Y0),R=Q*-H0;g0[m0(2368)].decompose(n0.position,n0[m0(3915)],n0[m0(623)]),n0[m0(243)](R),n0[m0(148)](Q),n0[m0(2368)][m0(1669)](n0[m0(2817)],n0.quaternion,n0[m0(623)]),n0[m0(2519)][m0(1493)](n0[m0(2368)]).invert();const T=gx+Q,F=ax+Q,Z0=F0-R,d0=$0+(M0-R),w0=y0*ax/F*T,j0=V0*ax/F*T;n0[m0(2900)][m0(994)](Z0,d0,w0,j0,T,F),n0[m0(2957)][m0(1493)](n0[m0(2900)])[m0(2483)]()}function j(n0,g0){const l0=t;g0===null?n0.matrixWorld.copy(n0[l0(1721)]):n0[l0(2368)][l0(1418)](g0[l0(2368)],n0[l0(1721)]),n0.matrixWorldInverse[l0(1493)](n0.matrixWorld)[l0(2483)]()}this[t(181)]=function(n0){const g0=t;if(n===null)return;Z[g0(3840)]!==null&&(n0.near=Z[g0(3515)],n0.far=Z[g0(636)]),S[g0(2987)]=M[g0(2987)]=X[g0(2987)]=n0[g0(2987)],S.far=M[g0(1407)]=X[g0(1407)]=n0[g0(1407)],(H!==S[g0(2987)]||O!==S[g0(1407)])&&(n[g0(110)]({depthNear:S.near,depthFar:S[g0(1407)]}),H=S.near,O=S[g0(1407)],X[g0(2987)]=H,X[g0(1407)]=O,M.near=H,M[g0(1407)]=O,X[g0(3947)](),M[g0(3947)](),n0[g0(3947)]());const l0=n0.parent,m0=S[g0(2457)];j(S,l0);for(let M0=0;M0<m0.length;M0++)j(m0[M0],l0);m0[g0(2989)]===2?$(S,X,M):S[g0(2900)][g0(1493)](X[g0(2900)]),x0(n0,S,l0)};function x0(n0,g0,l0){const m0=t;l0===null?n0[m0(1721)][m0(1493)](g0.matrixWorld):(n0[m0(1721)][m0(1493)](l0[m0(2368)]),n0.matrix.invert(),n0[m0(1721)][m0(327)](g0[m0(2368)])),n0[m0(1721)][m0(2986)](n0[m0(2817)],n0[m0(3915)],n0[m0(623)]),n0[m0(3554)](!0),n0[m0(2900)][m0(1493)](g0[m0(2900)]),n0[m0(2957)][m0(1493)](g0[m0(2957)]),n0[m0(1928)]&&(n0[m0(1302)]=ho*2*Math[m0(873)](1/n0[m0(2900)].elements[5]),n0[m0(3981)]=1)}this.getCamera=function(){return S},this.getFoveation=function(){if(!(h===null&&f===null))return C},this[t(946)]=function(n0){const g0=t;C=n0,h!==null&&(h[g0(3524)]=n0),f!==null&&f[g0(3524)]!==void 0&&(f.fixedFoveation=n0)},this.hasDepthSensing=function(){return Z[t(3840)]!==null};let c0=null;function h0(n0,g0){const l0=t;if(A=g0[l0(1379)](r||o),B=g0,A!==null){const m0=A[l0(2829)];f!==null&&(x[l0(2929)](v,f.framebuffer),x[l0(681)](v));let M0=!1;m0[l0(2989)]!==S[l0(2457)][l0(2989)]&&(S[l0(2457)][l0(2989)]=0,M0=!0);for(let C0=0;C0<m0[l0(2989)];C0++){const gx=m0[C0];let ax=null;if(f!==null)ax=f.getViewport(gx);else{const V0=d[l0(2107)](h,gx);ax=V0.viewport,C0===0&&(x[l0(2300)](v,V0[l0(2141)],h[l0(1926)]?void 0:V0[l0(3956)]),x[l0(681)](v))}let y0=Y[C0];y0===void 0&&(y0=new ze,y0[l0(2669)][l0(3542)](C0),y0[l0(1310)]=new Dx,Y[C0]=y0),y0[l0(1721)][l0(2793)](gx[l0(967)][l0(1721)]),y0[l0(1721)][l0(2986)](y0[l0(2817)],y0[l0(3915)],y0[l0(623)]),y0[l0(2900)][l0(2793)](gx[l0(2900)]),y0.projectionMatrixInverse[l0(1493)](y0.projectionMatrix)[l0(2483)](),y0[l0(1310)][l0(298)](ax.x,ax.y,ax[l0(2315)],ax.height),C0===0&&(S.matrix[l0(1493)](y0.matrix),S.matrix.decompose(S[l0(2817)],S.quaternion,S[l0(623)])),M0===!0&&S[l0(2457)].push(y0)}const bx=n.enabledFeatures;if(bx&&bx[l0(3532)]("depth-sensing")){const C0=d[l0(1932)](m0[0]);C0&&C0[l0(1252)]&&C0[l0(3840)]&&Z.init(x,C0,n.renderState)}}for(let m0=0;m0<p[l0(2989)];m0++){const M0=w[m0],bx=p[m0];M0!==null&&bx!==void 0&&bx.update(M0,g0,r||o)}Z.render(x,S),c0&&c0(n0,g0),g0[l0(1015)]&&g[l0(1457)]({type:l0(2289),data:g0}),B=null}const X0=new Rv;X0[t(2073)](h0),this.setAnimationLoop=function(n0){c0=n0},this[t(1439)]=function(){}}}const iI=new Tt,KN=new dx;function HN(i,x){function e(Z,G){const m=i0;Z.matrixAutoUpdate===!0&&Z[m(466)](),G[m(2113)][m(1493)](Z[m(1721)])}function t(Z,G){const m=i0;G[m(432)][m(2504)](Z[m(3782)].value,yv(i)),G[m(761)]?(Z[m(2477)].value=G.near,Z[m(3829)].value=G.far):G.isFogExp2&&(Z[m(953)][m(2113)]=G[m(2699)])}function g(Z,G,m,v,p){const w=i0;G[w(3731)]||G[w(2856)]?n(Z,G):G[w(2317)]?(n(Z,G),A(Z,G)):G[w(3838)]?(n(Z,G),r(Z,G)):G[w(3743)]?(n(Z,G),d(Z,G),G[w(1755)]&&h(Z,G,p)):G[w(908)]?(n(Z,G),f(Z,G)):G[w(709)]?n(Z,G):G[w(959)]?(n(Z,G),B(Z,G)):G[w(827)]?n(Z,G):G[w(3343)]?(s(Z,G),G[w(3359)]&&o(Z,G)):G[w(297)]?c(Z,G,m,v):G[w(577)]?C(Z,G):G.isShadowMaterial?(Z[w(432)][w(2113)].copy(G[w(432)]),Z.opacity[w(2113)]=G[w(2390)]):G[w(1742)]&&(G.uniformsNeedUpdate=!1)}function n(Z,G){const m=i0;Z[m(2390)][m(2113)]=G.opacity,G[m(432)]&&Z[m(377)][m(2113)][m(1493)](G[m(432)]),G.emissive&&Z[m(161)][m(2113)][m(1493)](G[m(161)])[m(2333)](G[m(747)]),G[m(3879)]&&(Z[m(3879)].value=G[m(3879)],e(G[m(3879)],Z.mapTransform)),G[m(3709)]&&(Z[m(3709)][m(2113)]=G.alphaMap,e(G[m(3709)],Z[m(3757)])),G.bumpMap&&(Z.bumpMap[m(2113)]=G.bumpMap,e(G.bumpMap,Z[m(1051)]),Z[m(340)][m(2113)]=G.bumpScale,G[m(3601)]===Zt&&(Z[m(340)][m(2113)]*=-1)),G[m(2712)]&&(Z[m(2712)].value=G[m(2712)],e(G[m(2712)],Z[m(3209)]),Z[m(2733)][m(2113)][m(1493)](G.normalScale),G.side===Zt&&Z[m(2733)][m(2113)][m(3217)]()),G[m(1638)]&&(Z[m(1638)][m(2113)]=G[m(1638)],e(G[m(1638)],Z[m(173)]),Z[m(2523)][m(2113)]=G[m(2523)],Z.displacementBias[m(2113)]=G[m(977)]),G.emissiveMap&&(Z[m(833)][m(2113)]=G[m(833)],e(G[m(833)],Z.emissiveMapTransform)),G[m(2887)]&&(Z[m(2887)][m(2113)]=G[m(2887)],e(G[m(2887)],Z[m(2166)])),G[m(151)]>0&&(Z.alphaTest[m(2113)]=G.alphaTest);const v=x[m(2695)](G),p=v[m(1300)],w=v[m(1043)];if(p&&(Z[m(1300)][m(2113)]=p,iI.copy(w),iI.x*=-1,iI.y*=-1,iI.z*=-1,p.isCubeTexture&&p[m(1309)]===!1&&(iI.y*=-1,iI.z*=-1),Z[m(1043)][m(2113)][m(3544)](KN[m(1112)](iI)),Z.flipEnvMap[m(2113)]=p[m(3679)]&&p[m(1309)]===!1?-1:1,Z[m(1695)][m(2113)]=G[m(1695)],Z.ior.value=G.ior,Z[m(3241)][m(2113)]=G[m(3241)]),G[m(3997)]){Z[m(3997)][m(2113)]=G[m(3997)];const V=i[m(3296)]===!0?Math.PI:1;Z.lightMapIntensity.value=G[m(899)]*V,e(G[m(3997)],Z.lightMapTransform)}G.aoMap&&(Z.aoMap.value=G.aoMap,Z[m(904)][m(2113)]=G[m(904)],e(G[m(2042)],Z.aoMapTransform))}function s(Z,G){const m=i0;Z.diffuse.value[m(1493)](G[m(432)]),Z[m(2390)].value=G[m(2390)],G[m(3879)]&&(Z[m(3879)].value=G[m(3879)],e(G.map,Z[m(2206)]))}function o(Z,G){const m=i0;Z[m(1361)][m(2113)]=G[m(1361)],Z[m(172)][m(2113)]=G.dashSize+G[m(1835)],Z[m(623)][m(2113)]=G[m(623)]}function c(Z,G,m,v){const p=i0;Z[p(377)][p(2113)].copy(G.color),Z.opacity[p(2113)]=G[p(2390)],Z[p(1019)].value=G[p(1019)]*m,Z[p(623)][p(2113)]=v*.5,G[p(3879)]&&(Z[p(3879)][p(2113)]=G[p(3879)],e(G[p(3879)],Z[p(1744)])),G[p(3709)]&&(Z[p(3709)][p(2113)]=G.alphaMap,e(G[p(3709)],Z[p(3757)])),G[p(151)]>0&&(Z[p(151)][p(2113)]=G[p(151)])}function C(Z,G){const m=i0;Z.diffuse[m(2113)][m(1493)](G.color),Z[m(2390)][m(2113)]=G[m(2390)],Z[m(1488)][m(2113)]=G[m(1488)],G[m(3879)]&&(Z.map[m(2113)]=G[m(3879)],e(G[m(3879)],Z[m(2206)])),G[m(3709)]&&(Z.alphaMap[m(2113)]=G[m(3709)],e(G.alphaMap,Z.alphaMapTransform)),G[m(151)]>0&&(Z[m(151)][m(2113)]=G[m(151)])}function r(Z,G){const m=i0;Z.specular[m(2113)][m(1493)](G[m(2204)]),Z[m(1169)][m(2113)]=Math[m(1971)](G[m(1169)],1e-4)}function A(Z,G){const m=i0;G.gradientMap&&(Z[m(3023)].value=G[m(3023)])}function d(Z,G){const m=i0;Z[m(1194)][m(2113)]=G[m(1194)],G[m(2594)]&&(Z.metalnessMap[m(2113)]=G[m(2594)],e(G[m(2594)],Z.metalnessMapTransform)),Z[m(1383)][m(2113)]=G[m(1383)],G.roughnessMap&&(Z[m(1372)][m(2113)]=G[m(1372)],e(G.roughnessMap,Z[m(425)])),G[m(1300)]&&(Z[m(1639)][m(2113)]=G[m(1639)])}function h(Z,G,m){const v=i0;Z[v(2592)].value=G[v(2592)],G[v(691)]>0&&(Z.sheenColor[v(2113)][v(1493)](G[v(179)])[v(2333)](G.sheen),Z.sheenRoughness.value=G[v(2882)],G.sheenColorMap&&(Z.sheenColorMap.value=G.sheenColorMap,e(G[v(2416)],Z[v(633)])),G[v(3990)]&&(Z[v(3990)][v(2113)]=G[v(3990)],e(G[v(3990)],Z[v(3299)]))),G[v(3916)]>0&&(Z[v(3916)].value=G[v(3916)],Z[v(2893)].value=G[v(2893)],G.clearcoatMap&&(Z[v(2539)][v(2113)]=G[v(2539)],e(G[v(2539)],Z[v(3054)])),G.clearcoatRoughnessMap&&(Z[v(241)][v(2113)]=G[v(241)],e(G.clearcoatRoughnessMap,Z[v(3600)])),G[v(1881)]&&(Z.clearcoatNormalMap[v(2113)]=G[v(1881)],e(G[v(1881)],Z[v(464)]),Z[v(1402)].value[v(1493)](G[v(1402)]),G.side===Zt&&Z[v(1402)][v(2113)][v(3217)]())),G[v(1625)]>0&&(Z[v(1625)].value=G[v(1625)]),G[v(3175)]>0&&(Z[v(3175)].value=G[v(3175)],Z.iridescenceIOR[v(2113)]=G[v(3986)],Z[v(3659)][v(2113)]=G[v(3739)][0],Z[v(2561)][v(2113)]=G[v(3739)][1],G[v(2374)]&&(Z[v(2374)][v(2113)]=G[v(2374)],e(G.iridescenceMap,Z[v(1103)])),G[v(1904)]&&(Z[v(1904)][v(2113)]=G[v(1904)],e(G[v(1904)],Z[v(3026)]))),G[v(3820)]>0&&(Z.transmission.value=G[v(3820)],Z.transmissionSamplerMap[v(2113)]=m[v(3840)],Z[v(638)][v(2113)][v(298)](m.width,m[v(2741)]),G[v(3403)]&&(Z[v(3403)].value=G[v(3403)],e(G[v(3403)],Z[v(279)])),Z.thickness.value=G.thickness,G.thicknessMap&&(Z[v(2200)][v(2113)]=G[v(2200)],e(G[v(2200)],Z[v(3351)])),Z.attenuationDistance[v(2113)]=G[v(1047)],Z[v(1207)][v(2113)][v(1493)](G.attenuationColor)),G.anisotropy>0&&(Z[v(242)].value.set(G[v(2651)]*Math[v(1563)](G[v(1214)]),G[v(2651)]*Math.sin(G.anisotropyRotation)),G[v(590)]&&(Z.anisotropyMap.value=G[v(590)],e(G[v(590)],Z[v(2180)]))),Z[v(480)].value=G[v(480)],Z[v(3525)][v(2113)][v(1493)](G[v(3525)]),G[v(1335)]&&(Z[v(1335)][v(2113)]=G.specularColorMap,e(G[v(1335)],Z[v(863)])),G[v(1499)]&&(Z.specularIntensityMap[v(2113)]=G[v(1499)],e(G[v(1499)],Z[v(2720)]))}function f(Z,G){const m=i0;G[m(126)]&&(Z[m(126)].value=G.matcap)}function B(Z,G){const m=i0,v=x[m(2695)](G)[m(2680)];Z[m(491)][m(2113)][m(1577)](v[m(2368)]),Z[m(2376)].value=v[m(1738)].camera[m(2987)],Z.farDistance.value=v.shadow[m(240)][m(1407)]}return{refreshFogUniforms:t,refreshMaterialUniforms:g}}function NN(i,x,e,t){const g=I;let n={},s={},o=[];const c=i[g(2961)](i[g(687)]);function C(v,p){const w=g,V=p[w(2169)];t[w(3169)](v,V)}function r(v,p){const w=g;let V=n[v.id];V===void 0&&(B(v),V=A(v),n[v.id]=V,v.addEventListener(w(1439),G));const N=p[w(2169)];t.updateUBOMapping(v,N);const X=x[w(948)].frame;s[v.id]!==X&&(h(v),s[v.id]=X)}function A(v){const p=g,w=d();v.__bindingPointIndex=w;const V=i[p(2295)](),N=v[p(2633)],X=v.usage;return i[p(605)](i[p(2406)],V),i[p(2378)](i[p(2406)],N,X),i[p(605)](i[p(2406)],null),i[p(372)](i[p(2406)],w,V),V}function d(){const v=g;for(let p=0;p<c;p++)if(o.indexOf(p)===-1)return o[v(3330)](p),p;return console[v(2963)](v(1598)),0}function h(v){const p=g,w=n[v.id],V=v[p(3901)],N=v.__cache;i[p(605)](i[p(2406)],w);for(let X=0,M=V[p(2989)];X<M;X++){const Y=Array[p(1987)](V[X])?V[X]:[V[X]];for(let S=0,H=Y[p(2989)];S<H;S++){const O=Y[S];if(f(O,X,S,N)===!0){const I0=O[p(1490)],z=Array.isArray(O[p(2113)])?O[p(2113)]:[O[p(2113)]];let b0=0;for(let f0=0;f0<z[p(2989)];f0++){const G0=z[f0],$=Z(G0);typeof G0===p(1025)||typeof G0===p(3889)?(O[p(1299)][0]=G0,i[p(3166)](i[p(2406)],I0+b0,O[p(1299)])):G0.isMatrix3?(O[p(1299)][0]=G0[p(2574)][0],O[p(1299)][1]=G0[p(2574)][1],O[p(1299)][2]=G0[p(2574)][2],O[p(1299)][3]=0,O.__data[4]=G0.elements[3],O[p(1299)][5]=G0[p(2574)][4],O.__data[6]=G0[p(2574)][5],O[p(1299)][7]=0,O[p(1299)][8]=G0.elements[6],O.__data[9]=G0[p(2574)][7],O.__data[10]=G0[p(2574)][8],O[p(1299)][11]=0):(G0[p(3904)](O[p(1299)],b0),b0+=$[p(1991)]/Float32Array[p(218)])}i[p(3166)](i[p(2406)],I0,O[p(1299)])}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function f(v,p,w,V){const N=g,X=v[N(2113)],M=p+"_"+w;if(V[M]===void 0)return typeof X===N(1025)||typeof X===N(3889)?V[M]=X:V[M]=X[N(3123)](),!0;{const Y=V[M];if(typeof X===N(1025)||typeof X===N(3889)){if(Y!==X)return V[M]=X,!0}else if(Y[N(3106)](X)===!1)return Y[N(1493)](X),!0}return!1}function B(v){const p=g,w=v[p(3901)];let V=0;const N=16;for(let M=0,Y=w[p(2989)];M<Y;M++){const S=Array[p(1987)](w[M])?w[M]:[w[M]];for(let H=0,O=S[p(2989)];H<O;H++){const I0=S[H],z=Array[p(1987)](I0.value)?I0[p(2113)]:[I0[p(2113)]];for(let b0=0,f0=z.length;b0<f0;b0++){const G0=z[b0],$=Z(G0),j=V%N;j!==0&&N-j<$.boundary&&(V+=N-j),I0[p(1299)]=new Float32Array($.storage/Float32Array[p(218)]),I0[p(1490)]=V,V+=$[p(1991)]}}}const X=V%N;return X>0&&(V+=N-X),v[p(2633)]=V,v[p(2218)]={},this}function Z(v){const p=g,w={boundary:0,storage:0};return typeof v=="number"||typeof v===p(3889)?(w[p(1034)]=4,w[p(1991)]=4):v[p(3856)]?(w[p(1034)]=8,w.storage=8):v[p(2752)]||v[p(1892)]?(w[p(1034)]=16,w.storage=12):v.isVector4?(w[p(1034)]=16,w[p(1991)]=16):v[p(3868)]?(w[p(1034)]=48,w[p(1991)]=48):v[p(299)]?(w[p(1034)]=64,w.storage=64):v[p(3984)]?console[p(3748)](p(2466)):console.warn(p(1317),v),w}function G(v){const p=g,w=v.target;w[p(1216)](p(1439),G);const V=o[p(2377)](w[p(1651)]);o[p(2960)](V,1),i[p(3667)](n[w.id]),delete n[w.id],delete s[w.id]}function m(){const v=g;for(const p in n)i[v(3667)](n[p]);o=[],n={},s={}}return{bind:C,update:r,dispose:m}}class Fv{constructor(x={}){const e=I,{canvas:t=mv(),context:g=null,depth:n=!0,stencil:s=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:C=!0,preserveDrawingBuffer:r=!1,powerPreference:A=e(311),failIfMajorPerformanceCaveat:d=!1}=x;this[e(609)]=!0;let h;if(g!==null){if(typeof WebGLRenderingContext!==e(1797)&&g instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=g[e(3965)]()[e(576)]}else h=o;const f=new Uint32Array(4),B=new Int32Array(4);let Z=null,G=null;const m=[],v=[];this[e(227)]=t,this[e(1476)]={checkShaderErrors:!0,onShaderError:null},this[e(1105)]=!0,this.autoClearColor=!0,this[e(2229)]=!0,this[e(266)]=!0,this[e(1371)]=!0,this[e(1763)]=[],this[e(896)]=!1,this._outputColorSpace=Ag,this[e(3296)]=!1,this[e(1308)]=ai,this.toneMappingExposure=1;const p=this;let w=!1,V=0,N=0,X=null,M=-1,Y=null;const S=new Dx,H=new Dx;let O=null;const I0=new Q0(0);let z=0,b0=t.width,f0=t.height,G0=1,$=null,j=null;const x0=new Dx(0,0,b0,f0),c0=new Dx(0,0,b0,f0);let h0=!1;const X0=new zC;let n0=!1,g0=!1;const l0=new dx,m0=new E,M0={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function bx(){return X===null?G0:1}let C0=g;function gx(L,t0){return t[e(326)](L,t0)}try{const L={alpha:!0,depth:n,stencil:s,antialias:c,premultipliedAlpha:C,preserveDrawingBuffer:r,powerPreference:A,failIfMajorPerformanceCaveat:d};if(e(1236)in t&&t[e(1236)](e(500),e(2917)+f2),t[e(2134)](e(2467),q,!1),t[e(2134)](e(1733),v0,!1),t[e(2134)](e(3333),A0,!1),C0===null){const t0=e(3769);if(C0=gx(t0,L),C0===null)throw gx(t0)?new Error(e(349)):new Error(e(1980))}}catch(L){throw console[e(2963)](e(749)+L[e(268)]),L}let ax,y0,V0,H0,Y0,F0,$0,Q,R,T,F,Z0,d0,w0,j0,L0,J0,hx,U0,Cx,Rx,nx,xx,Vx;function Hx(){const L=e;ax=new PK(C0),ax[L(2032)](),nx=new Hv(C0,ax),y0=new JK(C0,ax,x,nx),V0=new WN(C0),H0=new $K(C0),Y0=new AN,F0=new wN(C0,ax,V0,Y0,y0,nx,H0),$0=new UK(p),Q=new QK(p),R=new nX(C0),xx=new kK(C0,R),T=new OK(C0,R,H0,xx),F=new xH(C0,T,R,H0),U0=new jK(C0,y0,F0),L0=new EK(Y0),Z0=new dN(p,$0,Q,ax,y0,xx,L0),d0=new HN(p,Y0),w0=new bN,j0=new BN(ax),hx=new LK(p,$0,Q,V0,F,h,C),J0=new vN(p,F,y0),Vx=new NN(C0,H0,y0,V0),Cx=new TK(C0,ax,H0),Rx=new qK(C0,ax,H0),H0[L(2729)]=Z0[L(2729)],p.capabilities=y0,p[L(986)]=ax,p.properties=Y0,p[L(2556)]=w0,p[L(2001)]=J0,p[L(704)]=V0,p[L(3618)]=H0}Hx();const Sx=new YN(p,C0);this.xr=Sx,this[e(326)]=function(){return C0},this[e(3965)]=function(){return C0.getContextAttributes()},this[e(2769)]=function(){const L=e,t0=ax[L(2695)](L(1849));t0&&t0[L(3161)]()},this[e(2623)]=function(){const L=e,t0=ax[L(2695)](L(1849));t0&&t0.restoreContext()},this[e(1320)]=function(){return G0},this[e(3261)]=function(L){const t0=e;L!==void 0&&(G0=L,this[t0(2614)](b0,f0,!1))},this[e(1277)]=function(L){return L[e(298)](b0,f0)},this[e(2614)]=function(L,t0,e0=!0){const k=e;if(Sx[k(1509)]){console.warn(k(2791));return}b0=L,f0=t0,t.width=Math[k(3143)](L*G0),t[k(2741)]=Math.floor(t0*G0),e0===!0&&(t.style[k(2315)]=L+"px",t[k(1720)].height=t0+"px"),this[k(1846)](0,0,L,t0)},this.getDrawingBufferSize=function(L){return L.set(b0*G0,f0*G0).floor()},this[e(164)]=function(L,t0,e0){const k=e;b0=L,f0=t0,G0=e0,t[k(2315)]=Math[k(3143)](L*e0),t.height=Math[k(3143)](t0*e0),this[k(1846)](0,0,L,t0)},this[e(2631)]=function(L){return L[e(1493)](S)},this[e(476)]=function(L){return L[e(1493)](x0)},this[e(1846)]=function(L,t0,e0,k){const D=e;L[D(658)]?x0[D(298)](L.x,L.y,L.z,L.w):x0[D(298)](L,t0,e0,k),V0[D(1310)](S[D(1493)](x0)[D(2333)](G0)[D(1008)]())},this[e(2391)]=function(L){return L[e(1493)](c0)},this[e(198)]=function(L,t0,e0,k){const D=e;L[D(658)]?c0.set(L.x,L.y,L.z,L.w):c0[D(298)](L,t0,e0,k),V0[D(3108)](H[D(1493)](c0)[D(2333)](G0).round())},this.getScissorTest=function(){return h0},this[e(3253)]=function(L){V0[e(3253)](h0=L)},this[e(2038)]=function(L){$=L},this[e(2895)]=function(L){j=L},this[e(1778)]=function(L){const t0=e;return L.copy(hx[t0(1778)]())},this[e(537)]=function(){const L=e;hx[L(537)][L(1307)](hx,arguments)},this[e(2794)]=function(){return hx[e(2794)]()},this[e(1362)]=function(){const L=e;hx.setClearAlpha[L(1307)](hx,arguments)},this[e(3223)]=function(L=!0,t0=!0,e0=!0){const k=e;let D=0;if(L){let J=!1;if(X!==null){const a0=X[k(3840)].format;J=a0===uf||a0===Af||a0===df}if(J){const a0=X[k(3840)].type,k0=a0===di||a0===kI||a0===cf||a0===yo||a0===lf||a0===af,ex=hx.getClearColor(),lx=hx[k(2794)](),Ax=ex.r,ux=ex.g,fx=ex.b;k0?(f[0]=Ax,f[1]=ux,f[2]=fx,f[3]=lx,C0.clearBufferuiv(C0[k(2187)],0,f)):(B[0]=Ax,B[1]=ux,B[2]=fx,B[3]=lx,C0[k(1697)](C0.COLOR,0,B))}else D|=C0[k(2367)]}t0&&(D|=C0[k(1501)]),e0&&(D|=C0[k(1090)],this.state[k(2265)][k(3236)][k(216)](4294967295)),C0[k(3223)](D)},this[e(1524)]=function(){this.clear(!0,!1,!1)},this[e(1777)]=function(){this[e(3223)](!1,!0,!1)},this.clearStencil=function(){this[e(3223)](!1,!1,!0)},this[e(1439)]=function(){const L=e;t[L(1216)]("webglcontextlost",q,!1),t.removeEventListener("webglcontextrestored",v0,!1),t[L(1216)]("webglcontextcreationerror",A0,!1),w0.dispose(),j0[L(1439)](),Y0[L(1439)](),$0[L(1439)](),Q[L(1439)](),F[L(1439)](),xx[L(1439)](),Vx[L(1439)](),Z0[L(1439)](),Sx.dispose(),Sx[L(1216)](L(2517),Kx),Sx[L(1216)](L(2704),Ix),Se[L(548)]()};function q(L){const t0=e;L.preventDefault(),console[t0(2013)](t0(3714)),w=!0}function v0(){const L=e;console[L(2013)]("THREE.WebGLRenderer: Context Restored."),w=!1;const t0=H0.autoReset,e0=J0[L(2648)],k=J0[L(254)],D=J0.needsUpdate,J=J0[L(3505)];Hx(),H0[L(2589)]=t0,J0.enabled=e0,J0[L(254)]=k,J0[L(2170)]=D,J0[L(3505)]=J}function A0(L){const t0=e;console.error(t0(301),L[t0(1703)])}function W0(L){const t0=e,e0=L[t0(2930)];e0[t0(1216)](t0(1439),W0),R0(e0)}function R0(L){P0(L),Y0.remove(L)}function P0(L){const t0=e,e0=Y0[t0(2695)](L)[t0(2729)];e0!==void 0&&(e0[t0(1599)](function(k){Z0[t0(3430)](k)}),L[t0(1742)]&&Z0[t0(1150)](L))}this[e(2444)]=function(L,t0,e0,k,D,J){const a0=e;t0===null&&(t0=M0);const k0=D[a0(2241)]&&D[a0(2368)][a0(345)]()<0,ex=D2(L,t0,e0,k,D);V0[a0(3005)](k,k0);let lx=e0.index,Ax=1;if(k[a0(2734)]===!0){if(lx=T[a0(3473)](e0),lx===void 0)return;Ax=2}const ux=e0[a0(753)],fx=e0[a0(2593)][a0(2817)];let ge=ux.start*Ax,Xe=(ux[a0(3988)]+ux[a0(3411)])*Ax;J!==null&&(ge=Math.max(ge,J[a0(3988)]*Ax),Xe=Math[a0(1410)](Xe,(J.start+J[a0(3411)])*Ax)),lx!==null?(ge=Math[a0(1971)](ge,0),Xe=Math[a0(1410)](Xe,lx[a0(3411)])):fx!=null&&(ge=Math.max(ge,0),Xe=Math.min(Xe,fx.count));const ke=Xe-ge;if(ke<0||ke===1/0)return;xx[a0(1842)](D,k,ex,e0,lx);let Oe,Wx=Cx;if(lx!==null&&(Oe=R.get(lx),Wx=Rx,Wx[a0(3317)](Oe)),D[a0(2241)])k[a0(2734)]===!0?(V0[a0(2108)](k[a0(1979)]*bx()),Wx[a0(2836)](C0.LINES)):Wx[a0(2836)](C0[a0(3377)]);else if(D[a0(2154)]){let D0=k[a0(3725)];D0===void 0&&(D0=1),V0[a0(2108)](D0*bx()),D[a0(3728)]?Wx[a0(2836)](C0[a0(2927)]):D[a0(482)]?Wx[a0(2836)](C0[a0(814)]):Wx[a0(2836)](C0[a0(1791)])}else D[a0(1146)]?Wx[a0(2836)](C0[a0(1046)]):D[a0(2339)]&&Wx[a0(2836)](C0[a0(3377)]);if(D[a0(1754)])D[a0(3449)]!==null?Wx[a0(1687)](D[a0(2098)],D._multiDrawCounts,D[a0(865)],D[a0(3449)]):Wx.renderMultiDraw(D._multiDrawStarts,D[a0(2766)],D._multiDrawCount);else if(D[a0(2369)])Wx[a0(2688)](ge,ke,D[a0(3411)]);else if(e0[a0(2137)]){const D0=e0[a0(2355)]!==void 0?e0[a0(2355)]:1/0,Lx=Math[a0(1410)](e0[a0(3059)],D0);Wx[a0(2688)](ge,ke,Lx)}else Wx[a0(948)](ge,ke)};function Yx(L,t0,e0){const k=e;L.transparent===!0&&L[k(3601)]===si&&L[k(3374)]===!1?(L.side=Zt,L[k(2170)]=!0,DI(L,t0,e0),L[k(3601)]=Ji,L[k(2170)]=!0,DI(L,t0,e0),L.side=si):DI(L,t0,e0)}this[e(2816)]=function(L,t0,e0=null){const k=e;e0===null&&(e0=L),G=j0[k(2695)](e0),G[k(2032)](t0),v.push(G),e0[k(1495)](function(J){const a0=k;J.isLight&&J.layers[a0(3633)](t0[a0(2669)])&&(G.pushLight(J),J[a0(1239)]&&G[a0(2973)](J))}),L!==e0&&L.traverseVisible(function(J){const a0=k;J[a0(1408)]&&J[a0(2669)][a0(3633)](t0.layers)&&(G[a0(1114)](J),J[a0(1239)]&&G[a0(2973)](J))}),G[k(1159)](p[k(3296)]);const D=new Set;return L[k(1044)](function(J){const a0=k,k0=J[a0(3480)];if(k0)if(Array[a0(1987)](k0))for(let ex=0;ex<k0[a0(2989)];ex++){const lx=k0[ex];Yx(lx,e0,J),D[a0(3014)](lx)}else Yx(k0,e0,J),D[a0(3014)](k0)}),v[k(3604)](),G=null,D},this[e(1514)]=function(L,t0,e0=null){const k=e,D=this[k(2816)](L,t0,e0);return new Promise(J=>{const a0=k;function k0(){const ex=i0;if(D[ex(1599)](function(lx){Y0[ex(2695)](lx).currentProgram.isReady()&&D.delete(lx)}),D[ex(1019)]===0){J(L);return}setTimeout(k0,10)}ax[a0(2695)](a0(1479))!==null?k0():setTimeout(k0,10)})};let Ex=null;function Pe(L){Ex&&Ex(L)}function Kx(){Se[e(548)]()}function Ix(){Se[e(3988)]()}const Se=new Rv;Se[e(2073)](Pe),typeof self!==e(1797)&&Se[e(3213)](self),this[e(2073)]=function(L){const t0=e;Ex=L,Sx.setAnimationLoop(L),L===null?Se[t0(548)]():Se[t0(3988)]()},Sx[e(2134)](e(2517),Kx),Sx[e(2134)]("sessionend",Ix),this[e(948)]=function(L,t0){const e0=e;if(t0!==void 0&&t0[e0(980)]!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(w===!0)return;L[e0(2222)]===!0&&L[e0(3554)](),t0[e0(1064)]===null&&t0[e0(2222)]===!0&&t0.updateMatrixWorld(),Sx[e0(2648)]===!0&&Sx[e0(1509)]===!0&&(Sx[e0(1631)]===!0&&Sx[e0(181)](t0),t0=Sx[e0(2490)]()),L.isScene===!0&&L[e0(3548)](p,L,t0,X),G=j0[e0(2695)](L,v.length),G[e0(2032)](t0),v[e0(3330)](G),l0.multiplyMatrices(t0.projectionMatrix,t0[e0(2519)]),X0.setFromProjectionMatrix(l0),g0=this[e0(896)],n0=L0[e0(2032)](this[e0(1763)],g0),Z=w0[e0(2695)](L,m[e0(2989)]),Z[e0(2032)](),m.push(Z),Vo(L,t0,0,p[e0(1371)]),Z.finish(),p.sortObjects===!0&&Z.sort($,j);const k=Sx[e0(2648)]===!1||Sx[e0(1509)]===!1||Sx[e0(2024)]()===!1;k&&hx[e0(2266)](Z,L),this[e0(3618)][e0(948)].frame++,n0===!0&&L0[e0(2609)]();const D=G[e0(704)][e0(3726)];J0[e0(948)](D,L,t0),n0===!0&&L0[e0(360)](),this[e0(3618)].autoReset===!0&&this.info.reset();const J=Z[e0(417)],a0=Z[e0(3442)];if(G.setupLights(p[e0(3296)]),t0[e0(510)]){const k0=t0[e0(2457)];if(a0[e0(2989)]>0)for(let ex=0,lx=k0.length;ex<lx;ex++){const Ax=k0[ex];_C(J,a0,L,Ax)}k&&hx[e0(948)](L);for(let ex=0,lx=k0[e0(2989)];ex<lx;ex++){const Ax=k0[ex];UC(Z,L,Ax,Ax[e0(1310)])}}else a0[e0(2989)]>0&&_C(J,a0,L,t0),k&&hx[e0(948)](L),UC(Z,L,t0);X!==null&&(F0.updateMultisampleRenderTarget(X),F0[e0(2215)](X)),L.isScene===!0&&L[e0(2407)](p,L,t0),xx[e0(1963)](),M=-1,Y=null,v.pop(),v.length>0?(G=v[v[e0(2989)]-1],n0===!0&&L0.setGlobalState(p.clippingPlanes,G[e0(704)][e0(240)])):G=null,m[e0(3604)](),m[e0(2989)]>0?Z=m[m[e0(2989)]-1]:Z=null};function Vo(L,t0,e0,k){const D=e;if(L.visible===!1)return;if(L.layers[D(3633)](t0[D(2669)])){if(L[D(1982)])e0=L.renderOrder;else if(L[D(1384)])L[D(254)]===!0&&L[D(2341)](t0);else if(L[D(1408)])G[D(1114)](L),L[D(1239)]&&G[D(2973)](L);else if(L[D(2339)]){if(!L[D(1131)]||X0[D(650)](L)){k&&m0[D(1577)](L[D(2368)])[D(3075)](l0);const k0=F[D(2341)](L),ex=L[D(3480)];ex[D(2548)]&&Z[D(3330)](L,k0,ex,e0,m0.z,null)}}else if((L.isMesh||L[D(2154)]||L.isPoints)&&(!L.frustumCulled||X0[D(3334)](L))){const k0=F[D(2341)](L),ex=L.material;if(k&&(L[D(3636)]!==void 0?(L[D(3636)]===null&&L[D(1668)](),m0[D(1493)](L[D(3636)][D(3416)])):(k0.boundingSphere===null&&k0[D(1668)](),m0[D(1493)](k0[D(3636)][D(3416)])),m0[D(3075)](L[D(2368)])[D(3075)](l0)),Array[D(1987)](ex)){const lx=k0[D(919)];for(let Ax=0,ux=lx.length;Ax<ux;Ax++){const fx=lx[Ax],ge=ex[fx[D(2468)]];ge&&ge[D(2548)]&&Z[D(3330)](L,k0,ge,e0,m0.z,fx)}}else ex[D(2548)]&&Z.push(L,k0,ex,e0,m0.z,null)}}const a0=L[D(1352)];for(let k0=0,ex=a0[D(2989)];k0<ex;k0++)Vo(a0[k0],t0,e0,k)}function UC(L,t0,e0,k){const D=e,J=L[D(417)],a0=L[D(3442)],k0=L[D(3249)];G[D(1055)](e0),n0===!0&&L0.setGlobalState(p[D(1763)],e0),k&&V0[D(1310)](S.copy(k)),J[D(2989)]>0&&Jn(J,t0,e0),a0.length>0&&Jn(a0,t0,e0),k0.length>0&&Jn(k0,t0,e0),V0[D(2265)].depth.setTest(!0),V0[D(2265)].depth[D(216)](!0),V0[D(2265)].color[D(216)](!0),V0[D(3018)](!1)}function _C(L,t0,e0,k){const D=e;if((e0[D(1037)]===!0?e0[D(3831)]:null)!==null)return;G[D(704)][D(1087)][k.id]===void 0&&(G.state.transmissionRenderTarget[k.id]=new Jg(1,1,{generateMipmaps:!0,type:ax[D(2489)]("EXT_color_buffer_half_float")||ax[D(2489)](D(3819))?KC:di,minFilter:oi,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const a0=G[D(704)][D(1087)][k.id],k0=k[D(1310)]||S;a0.setSize(k0.z,k0.w);const ex=p[D(1117)]();p[D(681)](a0),p.getClearColor(I0),z=p[D(2794)](),z<1&&p[D(537)](16777215,.5),p[D(3223)]();const lx=p[D(1308)];p[D(1308)]=ai;const Ax=k.viewport;if(k.viewport!==void 0&&(k.viewport=void 0),G[D(1055)](k),n0===!0&&L0[D(679)](p.clippingPlanes,k),Jn(L,e0,k),F0[D(2380)](a0),F0[D(2215)](a0),ax.has("WEBGL_multisampled_render_to_texture")===!1){let ux=!1;for(let fx=0,ge=t0.length;fx<ge;fx++){const Xe=t0[fx],ke=Xe[D(1011)],Oe=Xe[D(352)],Wx=Xe[D(3480)],D0=Xe.group;if(Wx.side===si&&ke[D(2669)][D(3633)](k.layers)){const Lx=Wx[D(3601)];Wx[D(3601)]=Zt,Wx[D(2170)]=!0,_I(ke,e0,k,Oe,Wx,D0),Wx[D(3601)]=Lx,Wx[D(2170)]=!0,ux=!0}}ux===!0&&(F0[D(2380)](a0),F0[D(2215)](a0))}p[D(681)](ex),p[D(537)](I0,z),Ax!==void 0&&(k.viewport=Ax),p[D(1308)]=lx}function Jn(L,t0,e0){const k=e,D=t0.isScene===!0?t0[k(3831)]:null;for(let J=0,a0=L[k(2989)];J<a0;J++){const k0=L[J],ex=k0.object,lx=k0[k(352)],Ax=D===null?k0[k(3480)]:D,ux=k0.group;ex[k(2669)].test(e0[k(2669)])&&_I(ex,t0,e0,lx,Ax,ux)}}function _I(L,t0,e0,k,D,J){const a0=e;L[a0(3548)](p,t0,e0,k,D,J),L[a0(702)].multiplyMatrices(e0[a0(2519)],L.matrixWorld),L[a0(1208)][a0(2809)](L[a0(702)]),D.onBeforeRender(p,t0,e0,k,L,J),D.transparent===!0&&D[a0(3601)]===si&&D[a0(3374)]===!1?(D[a0(3601)]=Zt,D.needsUpdate=!0,p.renderBufferDirect(e0,t0,k,D,L,J),D[a0(3601)]=Ji,D[a0(2170)]=!0,p[a0(2444)](e0,t0,k,D,L,J),D[a0(3601)]=si):p[a0(2444)](e0,t0,k,D,L,J),L[a0(2407)](p,t0,e0,k,D,J)}function DI(L,t0,e0){const k=e;t0[k(1037)]!==!0&&(t0=M0);const D=Y0[k(2695)](L),J=G[k(704)][k(1480)],a0=G.state[k(3726)],k0=J[k(704)][k(1450)],ex=Z0[k(2398)](L,J[k(704)],a0,t0,e0),lx=Z0.getProgramCacheKey(ex);let Ax=D.programs;D[k(2731)]=L[k(3743)]?t0[k(2731)]:null,D.fog=t0.fog,D.envMap=(L.isMeshStandardMaterial?Q:$0).get(L[k(1300)]||D[k(2731)]),D[k(1043)]=D[k(2731)]!==null&&L[k(1300)]===null?t0.environmentRotation:L.envMapRotation,Ax===void 0&&(L.addEventListener("dispose",W0),Ax=new Map,D[k(2729)]=Ax);let ux=Ax[k(2695)](lx);if(ux!==void 0){if(D[k(1395)]===ux&&D[k(758)]===k0)return DC(L,ex),ux}else ex[k(3901)]=Z0[k(1766)](L),L[k(1249)](e0,ex,p),L[k(3031)](ex,p),ux=Z0[k(430)](ex,lx),Ax[k(298)](lx,ux),D[k(3901)]=ex[k(3901)];const fx=D[k(3901)];return(!L.isShaderMaterial&&!L[k(449)]||L[k(933)]===!0)&&(fx[k(1763)]=L0[k(1325)]),DC(L,ex),D[k(3561)]=P2(L),D[k(758)]=k0,D[k(3561)]&&(fx[k(1424)][k(2113)]=J[k(704)][k(3594)],fx[k(628)][k(2113)]=J[k(704)][k(667)],fx[k(2946)][k(2113)]=J.state[k(2848)],fx.directionalLightShadows[k(2113)]=J[k(704)][k(1202)],fx[k(674)][k(2113)]=J[k(704)][k(820)],fx[k(3103)][k(2113)]=J.state.spotShadow,fx[k(3340)][k(2113)]=J.state[k(3443)],fx.ltc_1[k(2113)]=J[k(704)][k(2455)],fx[k(2967)][k(2113)]=J.state[k(3393)],fx.pointLights[k(2113)]=J.state[k(962)],fx.pointLightShadows[k(2113)]=J[k(704)][k(2757)],fx.hemisphereLights.value=J.state[k(1511)],fx[k(402)][k(2113)]=J[k(704)][k(402)],fx[k(495)][k(2113)]=J[k(704)][k(495)],fx[k(2237)][k(2113)]=J[k(704)][k(2237)],fx[k(515)][k(2113)]=J[k(704)].spotLightMatrix,fx[k(696)][k(2113)]=J[k(704)].spotLightMap,fx.pointShadowMap[k(2113)]=J.state[k(3276)],fx[k(3972)].value=J[k(704)][k(3972)]),D.currentProgram=ux,D.uniformsList=null,ux}function Pi(L){const t0=e;if(L.uniformsList===null){const e0=L[t0(1395)][t0(1766)]();L.uniformsList=yr[t0(733)](e0[t0(1646)],L.uniforms)}return L[t0(451)]}function DC(L,t0){const e0=e,k=Y0[e0(2695)](L);k[e0(3930)]=t0[e0(3930)],k[e0(955)]=t0[e0(955)],k.instancing=t0[e0(1743)],k[e0(3855)]=t0[e0(3855)],k[e0(382)]=t0[e0(382)],k[e0(541)]=t0[e0(541)],k.morphTargets=t0.morphTargets,k[e0(642)]=t0[e0(642)],k[e0(2015)]=t0.morphColors,k.morphTargetsCount=t0.morphTargetsCount,k[e0(2657)]=t0.numClippingPlanes,k[e0(1278)]=t0[e0(2261)],k[e0(2077)]=t0[e0(2077)],k[e0(734)]=t0.vertexTangents,k[e0(1308)]=t0.toneMapping}function D2(L,t0,e0,k,D){const J=e;t0[J(1037)]!==!0&&(t0=M0),F0[J(2130)]();const a0=t0[J(1382)],k0=k[J(3743)]?t0.environment:null,ex=X===null?p[J(3930)]:X[J(1679)]===!0?X.texture[J(1549)]:Di,lx=(k[J(3743)]?Q:$0)[J(2695)](k.envMap||k0),Ax=k[J(123)]===!0&&!!e0[J(2593)][J(432)]&&e0[J(2593)][J(432)][J(365)]===4,ux=!!e0[J(2593)][J(132)]&&(!!k[J(2712)]||k.anisotropy>0),fx=!!e0.morphAttributes[J(2817)],ge=!!e0.morphAttributes[J(3204)],Xe=!!e0[J(593)][J(432)];let ke=ai;k[J(572)]&&(X===null||X[J(1679)]===!0)&&(ke=p[J(1308)]);const Oe=e0[J(593)][J(2817)]||e0[J(593)][J(3204)]||e0.morphAttributes[J(432)],Wx=Oe!==void 0?Oe.length:0,D0=Y0[J(2695)](k),Lx=G[J(704)].lights;if(n0===!0&&(g0===!0||L!==Y)){const at=L===Y&&k.id===M;L0[J(1057)](k,L,at)}let Fx=!1;k.version===D0[J(2417)]?(D0[J(3561)]&&D0[J(758)]!==Lx[J(704)][J(1450)]||D0.outputColorSpace!==ex||D.isBatchedMesh&&D0[J(955)]===!1||!D[J(1754)]&&D0.batching===!0||D[J(2369)]&&D0.instancing===!1||!D[J(2369)]&&D0[J(1743)]===!0||D.isSkinnedMesh&&D0[J(541)]===!1||!D.isSkinnedMesh&&D0[J(541)]===!0||D[J(2369)]&&D0.instancingColor===!0&&D[J(1224)]===null||D[J(2369)]&&D0[J(3855)]===!1&&D[J(1224)]!==null||D[J(2369)]&&D0.instancingMorph===!0&&D[J(3642)]===null||D.isInstancedMesh&&D0.instancingMorph===!1&&D[J(3642)]!==null||D0[J(1300)]!==lx||k[J(1382)]===!0&&D0[J(1382)]!==a0||D0.numClippingPlanes!==void 0&&(D0[J(2657)]!==L0[J(3232)]||D0[J(1278)]!==L0[J(1278)])||D0.vertexAlphas!==Ax||D0[J(734)]!==ux||D0[J(535)]!==fx||D0[J(642)]!==ge||D0.morphColors!==Xe||D0[J(1308)]!==ke||D0[J(302)]!==Wx)&&(Fx=!0):(Fx=!0,D0.__version=k[J(1450)]);let ie=D0[J(1395)];Fx===!0&&(ie=DI(k,t0,D));let Te=!1,Et=!1,_g=!1;const Ux=ie[J(1766)](),Ut=D0[J(3901)];if(V0.useProgram(ie.program)&&(Te=!0,Et=!0,_g=!0),k.id!==M&&(M=k.id,Et=!0),Te||Y!==L){Ux[J(342)](C0,J(2900),L[J(2900)]),Ux.setValue(C0,"viewMatrix",L[J(2519)]);const at=Ux.map.cameraPosition;at!==void 0&&at[J(342)](C0,m0[J(1577)](L[J(2368)])),y0[J(1699)]&&Ux[J(342)](C0,J(2764),2/(Math[J(2013)](L[J(1407)]+1)/Math[J(3048)])),(k.isMeshPhongMaterial||k[J(2317)]||k.isMeshLambertMaterial||k[J(3731)]||k[J(3743)]||k.isShaderMaterial)&&Ux[J(342)](C0,J(3788),L[J(1455)]===!0),Y!==L&&(Y=L,Et=!0,_g=!0)}if(D.isSkinnedMesh){Ux[J(800)](C0,D,J(635)),Ux.setOptional(C0,D,J(1182));const at=D[J(2148)];at&&(at.boneTexture===null&&at[J(1716)](),Ux[J(342)](C0,"boneTexture",at[J(1478)],F0))}D[J(1754)]&&(Ux[J(800)](C0,D,J(1706)),Ux[J(342)](C0,"batchingTexture",D[J(1245)],F0));const QI=e0[J(593)];if((QI.position!==void 0||QI.normal!==void 0||QI[J(432)]!==void 0)&&U0.update(D,e0,ie),(Et||D0[J(3328)]!==D[J(3328)])&&(D0.receiveShadow=D[J(3328)],Ux[J(342)](C0,"receiveShadow",D[J(3328)])),k[J(3592)]&&k.envMap!==null&&(Ut[J(1300)][J(2113)]=lx,Ut.flipEnvMap.value=lx[J(3679)]&&lx[J(1309)]===!1?-1:1),k.isMeshStandardMaterial&&k[J(1300)]===null&&t0[J(2731)]!==null&&(Ut[J(1639)].value=t0[J(1595)]),Et&&(Ux[J(342)](C0,J(567),p[J(567)]),D0[J(3561)]&&Q2(Ut,_g),a0&&k[J(1382)]===!0&&d0[J(2872)](Ut,a0),d0[J(3565)](Ut,k,G0,f0,G[J(704)].transmissionRenderTarget[L.id]),yr.upload(C0,Pi(D0),Ut,F0)),k[J(1742)]&&k.uniformsNeedUpdate===!0&&(yr[J(3613)](C0,Pi(D0),Ut,F0),k[J(2849)]=!1),k[J(577)]&&Ux[J(342)](C0,J(3416),D[J(3416)]),Ux[J(342)](C0,J(702),D.modelViewMatrix),Ux[J(342)](C0,J(1208),D[J(1208)]),Ux[J(342)](C0,J(3588),D[J(2368)]),k[J(1742)]||k[J(449)]){const at=k[J(2259)];for(let Oi=0,QC=at.length;Oi<QC;Oi++){const Wt=at[Oi];Vx.update(Wt,ie),Vx.bind(Wt,ie)}}return ie}function Q2(L,t0){const e0=e;L[e0(1424)][e0(2170)]=t0,L.lightProbe[e0(2170)]=t0,L[e0(2946)][e0(2170)]=t0,L[e0(3767)][e0(2170)]=t0,L[e0(310)][e0(2170)]=t0,L[e0(2002)][e0(2170)]=t0,L[e0(674)][e0(2170)]=t0,L[e0(3103)][e0(2170)]=t0,L[e0(3340)][e0(2170)]=t0,L[e0(2211)][e0(2170)]=t0}function P2(L){const t0=e;return L[t0(2856)]||L.isMeshToonMaterial||L.isMeshPhongMaterial||L[t0(3743)]||L[t0(914)]||L.isShaderMaterial&&L[t0(1480)]===!0}this.getActiveCubeFace=function(){return V},this[e(1445)]=function(){return N},this.getRenderTarget=function(){return X},this[e(2300)]=function(L,t0,e0){const k=e;Y0[k(2695)](L.texture)[k(2508)]=t0,Y0[k(2695)](L[k(2550)])[k(2508)]=e0;const D=Y0[k(2695)](L);D[k(388)]=!0,D[k(2581)]=e0===void 0,!D.__autoAllocateDepthBuffer&&ax[k(2489)]("WEBGL_multisampled_render_to_texture")===!0&&(console[k(3748)](k(1443)),D[k(1974)]=!1)},this[e(2929)]=function(L,t0){const e0=e,k=Y0.get(L);k.__webglFramebuffer=t0,k[e0(2243)]=t0===void 0},this[e(681)]=function(L,t0=0,e0=0){const k=e;X=L,V=t0,N=e0;let D=!0,J=null,a0=!1,k0=!1;if(L){const lx=Y0.get(L);lx[k(2243)]!==void 0?(V0[k(693)](C0.FRAMEBUFFER,null),D=!1):lx.__webglFramebuffer===void 0?F0.setupRenderTarget(L):lx[k(388)]&&F0[k(3698)](L,Y0[k(2695)](L[k(3840)]).__webglTexture,Y0[k(2695)](L[k(2550)])[k(2508)]);const Ax=L[k(3840)];(Ax[k(465)]||Ax[k(3821)]||Ax.isCompressedArrayTexture)&&(k0=!0);const ux=Y0[k(2695)](L)[k(445)];L.isWebGLCubeRenderTarget?(Array.isArray(ux[t0])?J=ux[t0][e0]:J=ux[t0],a0=!0):L.samples>0&&F0.useMultisampledRTT(L)===!1?J=Y0[k(2695)](L)[k(3760)]:Array[k(1987)](ux)?J=ux[e0]:J=ux,S[k(1493)](L[k(1310)]),H[k(1493)](L[k(3108)]),O=L[k(3961)]}else S.copy(x0).multiplyScalar(G0)[k(3143)](),H[k(1493)](c0)[k(2333)](G0)[k(3143)](),O=h0;if(V0[k(693)](C0[k(1477)],J)&&D&&V0[k(3460)](L,J),V0[k(1310)](S),V0[k(3108)](H),V0[k(3253)](O),a0){const lx=Y0[k(2695)](L.texture);C0.framebufferTexture2D(C0[k(1477)],C0[k(1898)],C0[k(3427)]+t0,lx[k(2508)],e0)}else if(k0){const lx=Y0.get(L.texture),Ax=t0||0;C0.framebufferTextureLayer(C0[k(1477)],C0[k(1898)],lx[k(2508)],e0||0,Ax)}M=-1},this.readRenderTargetPixels=function(L,t0,e0,k,D,J,a0){const k0=e;if(!(L&&L[k0(1285)])){console[k0(2963)](k0(3401));return}let ex=Y0.get(L)[k0(445)];if(L.isWebGLCubeRenderTarget&&a0!==void 0&&(ex=ex[a0]),ex){V0[k0(693)](C0.FRAMEBUFFER,ex);try{const lx=L.texture,Ax=lx[k0(3207)],ux=lx.type;if(!y0[k0(3135)](Ax)){console[k0(2963)](k0(3511));return}if(!y0[k0(786)](ux)){console[k0(2963)](k0(805));return}t0>=0&&t0<=L[k0(2315)]-k&&e0>=0&&e0<=L[k0(2741)]-D&&C0[k0(2865)](t0,e0,k,D,nx[k0(796)](Ax),nx.convert(ux),J)}finally{const lx=X!==null?Y0[k0(2695)](X)[k0(445)]:null;V0[k0(693)](C0[k0(1477)],lx)}}},this[e(592)]=function(L,t0,e0=0){const k=e,D=Math[k(3395)](2,-e0),J=Math[k(3143)](t0.image[k(2315)]*D),a0=Math.floor(t0[k(1781)][k(2741)]*D);F0[k(2820)](t0,0),C0[k(1602)](C0[k(1915)],e0,0,0,L.x,L.y,J,a0),V0[k(1430)]()},this.copyTextureToTexture=function(L,t0,e0,k=0){const D=e,J=t0.image[D(2315)],a0=t0[D(1781)][D(2741)],k0=nx.convert(e0[D(3207)]),ex=nx[D(796)](e0[D(3505)]);F0[D(2820)](e0,0),C0[D(2133)](C0.UNPACK_FLIP_Y_WEBGL,e0[D(233)]),C0[D(2133)](C0.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e0[D(3721)]),C0[D(2133)](C0[D(3949)],e0[D(1005)]),t0[D(3079)]?C0[D(1358)](C0.TEXTURE_2D,k,L.x,L.y,J,a0,k0,ex,t0[D(1781)][D(3787)]):t0[D(1848)]?C0.compressedTexSubImage2D(C0[D(1915)],k,L.x,L.y,t0.mipmaps[0][D(2315)],t0.mipmaps[0].height,k0,t0[D(2768)][0][D(3787)]):C0.texSubImage2D(C0[D(1915)],k,L.x,L.y,k0,ex,t0[D(1781)]),k===0&&e0[D(2787)]&&C0[D(2870)](C0[D(1915)]),V0[D(1430)]()},this.copyTextureToTexture3D=function(L,t0,e0,k,D=0){const J=e,a0=L.max.x-L[J(1410)].x,k0=L[J(1971)].y-L[J(1410)].y,ex=L.max.z-L[J(1410)].z,lx=nx[J(796)](k[J(3207)]),Ax=nx[J(796)](k.type);let ux;if(k[J(465)])F0[J(2230)](k,0),ux=C0[J(2984)];else if(k[J(3821)]||k.isCompressedArrayTexture)F0[J(2814)](k,0),ux=C0[J(2954)];else{console[J(3748)]("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}C0[J(2133)](C0[J(750)],k.flipY),C0[J(2133)](C0[J(351)],k.premultiplyAlpha),C0[J(2133)](C0[J(3949)],k.unpackAlignment);const fx=C0[J(2961)](C0[J(701)]),ge=C0[J(2961)](C0[J(3024)]),Xe=C0.getParameter(C0[J(3252)]),ke=C0[J(2961)](C0[J(411)]),Oe=C0.getParameter(C0[J(774)]),Wx=e0.isCompressedTexture?e0[J(2768)][D]:e0[J(1781)];C0[J(2133)](C0[J(701)],Wx[J(2315)]),C0[J(2133)](C0[J(3024)],Wx[J(2741)]),C0[J(2133)](C0[J(3252)],L[J(1410)].x),C0[J(2133)](C0[J(411)],L[J(1410)].y),C0.pixelStorei(C0[J(774)],L[J(1410)].z),e0[J(3079)]||e0[J(465)]?C0[J(3488)](ux,D,t0.x,t0.y,t0.z,a0,k0,ex,lx,Ax,Wx.data):k.isCompressedArrayTexture?C0[J(2666)](ux,D,t0.x,t0.y,t0.z,a0,k0,ex,lx,Wx[J(3787)]):C0[J(3488)](ux,D,t0.x,t0.y,t0.z,a0,k0,ex,lx,Ax,Wx),C0[J(2133)](C0[J(701)],fx),C0.pixelStorei(C0[J(3024)],ge),C0[J(2133)](C0[J(3252)],Xe),C0[J(2133)](C0[J(411)],ke),C0[J(2133)](C0[J(774)],Oe),D===0&&k.generateMipmaps&&C0[J(2870)](ux),V0[J(1430)]()},this[e(2993)]=function(L){const t0=e;L[t0(3679)]?F0[t0(3808)](L,0):L[t0(465)]?F0[t0(2230)](L,0):L[t0(3821)]||L[t0(3302)]?F0[t0(2814)](L,0):F0.setTexture2D(L,0),V0.unbindTexture()},this[e(2297)]=function(){const L=e;V=0,N=0,X=null,V0.reset(),xx[L(1877)]()},typeof __THREE_DEVTOOLS__!==e(1797)&&__THREE_DEVTOOLS__[e(1457)](new CustomEvent("observe",{detail:this}))}get[I(366)](){return ci}get[I(3930)](){return this._outputColorSpace}set[I(3930)](x){const e=I;this[e(3194)]=x;const t=this[e(326)]();t.drawingBufferColorSpace=e(x===B2?1255:554),t[e(2672)]=_x[e(3764)]===HC?e(1255):e(554)}get useLegacyLights(){const x=I;return console[x(3748)](x(1088)),this[x(3296)]}set[I(2605)](x){const e=I;console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this[e(3296)]=x}}class v2{constructor(x,e=25e-5){const t=I;this.isFogExp2=!0,this.name="",this[t(432)]=new Q0(x),this[t(2699)]=e}[I(3123)](){const x=I;return new v2(this.color,this[x(2699)])}[I(2054)](){const x=I;return{type:x(1870),name:this.name,color:this[x(432)][x(2830)](),density:this.density}}}class W2{constructor(x,e=1,t=1e3){const g=I;this[g(761)]=!0,this[g(1474)]="",this.color=new Q0(x),this[g(2987)]=e,this[g(1407)]=t}clone(){const x=I;return new W2(this.color,this[x(2987)],this[x(1407)])}[I(2054)](){const x=I;return{type:x(3077),name:this.name,color:this[x(432)][x(2830)](),near:this[x(2987)],far:this[x(1407)]}}}class Wf extends Nx{constructor(){const x=I;super(),this[x(1037)]=!0,this[x(3505)]=x(3199),this[x(2393)]=null,this.environment=null,this[x(1382)]=null,this[x(3215)]=0,this.backgroundIntensity=1,this[x(2311)]=new Tt,this[x(1595)]=1,this[x(3581)]=new Tt,this[x(3831)]=null,typeof __THREE_DEVTOOLS__!==x(1797)&&__THREE_DEVTOOLS__[x(1457)](new CustomEvent("observe",{detail:this}))}[I(1493)](x,e){const t=I;return super.copy(x,e),x.background!==null&&(this[t(2393)]=x[t(2393)][t(3123)]()),x.environment!==null&&(this[t(2731)]=x[t(2731)][t(3123)]()),x[t(1382)]!==null&&(this[t(1382)]=x[t(1382)][t(3123)]()),this[t(3215)]=x.backgroundBlurriness,this[t(3844)]=x[t(3844)],this[t(2311)][t(1493)](x[t(2311)]),this[t(1595)]=x[t(1595)],this.environmentRotation.copy(x[t(3581)]),x.overrideMaterial!==null&&(this[t(3831)]=x[t(3831)][t(3123)]()),this.matrixAutoUpdate=x[t(2272)],this}[I(2054)](x){const e=I,t=super[e(2054)](x);return this[e(1382)]!==null&&(t[e(1011)].fog=this[e(1382)].toJSON()),this[e(3215)]>0&&(t.object.backgroundBlurriness=this[e(3215)]),this[e(3844)]!==1&&(t[e(1011)][e(3844)]=this[e(3844)]),t[e(1011)][e(2311)]=this.backgroundRotation[e(3904)](),this[e(1595)]!==1&&(t.object[e(1595)]=this.environmentIntensity),t[e(1011)][e(3581)]=this[e(3581)][e(3904)](),t}}class w2{constructor(x,e){const t=I;this[t(2808)]=!0,this.array=x,this[t(1947)]=e,this[t(3411)]=x!==void 0?x.length/e:0,this[t(1676)]=bC,this[t(2815)]={offset:0,count:-1},this[t(644)]=[],this[t(1450)]=0,this[t(296)]=gg()}onUploadCallback(){}set[I(2170)](x){const e=I;x===!0&&this[e(1450)]++}get updateRange(){const x=I;return Gv("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this[x(2815)]}[I(1504)](x){const e=I;return this[e(1676)]=x,this}[I(3174)](x,e){const t=I;this.updateRanges[t(3330)]({start:x,count:e})}[I(3050)](){const x=I;this.updateRanges[x(2989)]=0}[I(1493)](x){const e=I;return this[e(315)]=new x[e(315)][e(135)](x[e(315)]),this[e(3411)]=x[e(3411)],this[e(1947)]=x[e(1947)],this.usage=x[e(1676)],this}copyAt(x,e,t){const g=I;x*=this.stride,t*=e.stride;for(let n=0,s=this[g(1947)];n<s;n++)this[g(315)][x+n]=e[g(315)][t+n];return this}set(x,e=0){const t=I;return this.array[t(298)](x,e),this}clone(x){const e=I;x[e(2348)]===void 0&&(x[e(2348)]={}),this[e(315)][e(2360)][e(3146)]===void 0&&(this[e(315)][e(2360)][e(3146)]=gg()),x[e(2348)][this.array[e(2360)][e(3146)]]===void 0&&(x[e(2348)][this[e(315)][e(2360)][e(3146)]]=this.array.slice(0)[e(2360)]);const t=new this.array[e(135)](x[e(2348)][this[e(315)].buffer[e(3146)]]),g=new this[e(135)](t,this[e(1947)]);return g[e(1504)](this[e(1676)]),g}onUpload(x){return this.onUploadCallback=x,this}[I(2054)](x){const e=I;return x.arrayBuffers===void 0&&(x.arrayBuffers={}),this[e(315)][e(2360)][e(3146)]===void 0&&(this[e(315)][e(2360)][e(3146)]=gg()),x.arrayBuffers[this[e(315)][e(2360)][e(3146)]]===void 0&&(x.arrayBuffers[this[e(315)].buffer[e(3146)]]=Array.from(new Uint32Array(this[e(315)].buffer))),{uuid:this[e(296)],buffer:this[e(315)].buffer[e(3146)],type:this.array[e(135)][e(1474)],stride:this[e(1947)]}}}const At=new E;class TI{constructor(x,e,t,g=!1){const n=I;this[n(2568)]=!0,this[n(1474)]="",this[n(3787)]=x,this.itemSize=e,this[n(872)]=t,this[n(1894)]=g}get[I(3411)](){const x=I;return this[x(3787)][x(3411)]}get[I(315)](){const x=I;return this[x(3787)][x(315)]}set[I(2170)](x){const e=I;this.data[e(2170)]=x}applyMatrix4(x){const e=I;for(let t=0,g=this[e(3787)][e(3411)];t<g;t++)At[e(2404)](this,t),At[e(3075)](x),this[e(3082)](t,At.x,At.y,At.z);return this}[I(1433)](x){const e=I;for(let t=0,g=this[e(3411)];t<g;t++)At[e(2404)](this,t),At[e(1433)](x),this[e(3082)](t,At.x,At.y,At.z);return this}transformDirection(x){const e=I;for(let t=0,g=this[e(3411)];t<g;t++)At[e(2404)](this,t),At[e(1411)](x),this[e(3082)](t,At.x,At.y,At.z);return this}[I(1096)](x,e){const t=I;let g=this.array[x*this[t(3787)][t(1947)]+this[t(872)]+e];return this[t(1894)]&&(g=pt(g,this[t(315)])),g}[I(1473)](x,e,t){const g=I;return this[g(1894)]&&(t=Bx(t,this[g(315)])),this[g(3787)].array[x*this.data.stride+this[g(872)]+e]=t,this}[I(3126)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this[t(315)])),this.data.array[x*this[t(3787)][t(1947)]+this[t(872)]]=e,this}[I(675)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this[t(315)])),this[t(3787)][t(315)][x*this[t(3787)][t(1947)]+this.offset+1]=e,this}[I(2819)](x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this.array)),this.data[t(315)][x*this[t(3787)][t(1947)]+this.offset+2]=e,this}setW(x,e){const t=I;return this[t(1894)]&&(e=Bx(e,this[t(315)])),this.data[t(315)][x*this[t(3787)][t(1947)]+this[t(872)]+3]=e,this}[I(1829)](x){const e=I;let t=this[e(3787)].array[x*this[e(3787)][e(1947)]+this[e(872)]];return this[e(1894)]&&(t=pt(t,this[e(315)])),t}[I(655)](x){const e=I;let t=this[e(3787)][e(315)][x*this[e(3787)][e(1947)]+this[e(872)]+1];return this.normalized&&(t=pt(t,this[e(315)])),t}getZ(x){const e=I;let t=this[e(3787)][e(315)][x*this[e(3787)].stride+this[e(872)]+2];return this[e(1894)]&&(t=pt(t,this[e(315)])),t}getW(x){const e=I;let t=this[e(3787)][e(315)][x*this.data[e(1947)]+this[e(872)]+3];return this[e(1894)]&&(t=pt(t,this[e(315)])),t}[I(1436)](x,e,t){const g=I;return x=x*this.data.stride+this[g(872)],this[g(1894)]&&(e=Bx(e,this.array),t=Bx(t,this.array)),this[g(3787)][g(315)][x+0]=e,this[g(3787)][g(315)][x+1]=t,this}[I(3082)](x,e,t,g){const n=I;return x=x*this[n(3787)][n(1947)]+this.offset,this[n(1894)]&&(e=Bx(e,this[n(315)]),t=Bx(t,this[n(315)]),g=Bx(g,this[n(315)])),this.data[n(315)][x+0]=e,this.data.array[x+1]=t,this[n(3787)][n(315)][x+2]=g,this}setXYZW(x,e,t,g,n){const s=I;return x=x*this.data.stride+this.offset,this[s(1894)]&&(e=Bx(e,this[s(315)]),t=Bx(t,this[s(315)]),g=Bx(g,this.array),n=Bx(n,this[s(315)])),this[s(3787)][s(315)][x+0]=e,this[s(3787)][s(315)][x+1]=t,this[s(3787)][s(315)][x+2]=g,this[s(3787)][s(315)][x+3]=n,this}[I(3123)](x){const e=I;if(x===void 0){console[e(2013)](e(507));const t=[];for(let g=0;g<this[e(3411)];g++){const n=g*this[e(3787)].stride+this[e(872)];for(let s=0;s<this[e(365)];s++)t.push(this[e(3787)][e(315)][n+s])}return new Px(new this[e(315)].constructor(t),this[e(365)],this[e(1894)])}else return x[e(2340)]===void 0&&(x[e(2340)]={}),x[e(2340)][this[e(3787)].uuid]===void 0&&(x[e(2340)][this[e(3787)][e(296)]]=this[e(3787)].clone(x)),new TI(x.interleavedBuffers[this[e(3787)][e(296)]],this.itemSize,this[e(872)],this[e(1894)])}[I(2054)](x){const e=I;if(x===void 0){console.log(e(2031));const t=[];for(let g=0;g<this[e(3411)];g++){const n=g*this.data.stride+this[e(872)];for(let s=0;s<this[e(365)];s++)t.push(this[e(3787)][e(315)][n+s])}return{itemSize:this[e(365)],type:this[e(315)][e(135)][e(1474)],array:t,normalized:this.normalized}}else return x[e(2340)]===void 0&&(x[e(2340)]={}),x[e(2340)][this[e(3787)][e(296)]]===void 0&&(x[e(2340)][this.data[e(296)]]=this[e(3787)][e(2054)](x)),{isInterleavedBufferAttribute:!0,itemSize:this[e(365)],data:this[e(3787)][e(296)],offset:this.offset,normalized:this[e(1894)]}}}class wf extends lt{constructor(x){const e=I;super(),this[e(577)]=!0,this[e(3505)]=e(1808),this[e(432)]=new Q0(16777215),this.map=null,this[e(3709)]=null,this[e(1488)]=0,this[e(965)]=!0,this.transparent=!0,this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super.copy(x),this[e(432)][e(1493)](x[e(432)]),this[e(3879)]=x[e(3879)],this[e(3709)]=x[e(3709)],this[e(1488)]=x[e(1488)],this[e(965)]=x[e(965)],this[e(1382)]=x[e(1382)],this}}let Zs;const cc=new E,ys=new E,vs=new E,Ws=new S0,Cc=new S0,zv=new dx,Wa=new E,lc=new E,wa=new E,vp=new S0,gu=new S0,Wp=new S0;class Mv extends Nx{constructor(x=new wf){const e=I;if(super(),this[e(2339)]=!0,this[e(3505)]="Sprite",Zs===void 0){Zs=new vx;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),g=new w2(t,5);Zs[e(3317)]([0,1,2,0,2,3]),Zs.setAttribute("position",new TI(g,3,0,!1)),Zs.setAttribute("uv",new TI(g,2,3,!1))}this[e(352)]=Zs,this[e(3480)]=x,this[e(3416)]=new S0(.5,.5)}[I(785)](x,e){const t=I;x.camera===null&&console[t(2963)](t(1580)),ys[t(1128)](this.matrixWorld),zv.copy(x[t(240)][t(2368)]),this.modelViewMatrix[t(1418)](x[t(240)][t(2519)],this[t(2368)]),vs[t(1577)](this[t(702)]),x[t(240)][t(1928)]&&this[t(3480)][t(965)]===!1&&ys[t(2333)](-vs.z);const g=this[t(3480)].rotation;let n,s;g!==0&&(s=Math[t(1563)](g),n=Math[t(1996)](g));const o=this[t(3416)];Ra(Wa[t(298)](-.5,-.5,0),vs,o,ys,n,s),Ra(lc[t(298)](.5,-.5,0),vs,o,ys,n,s),Ra(wa.set(.5,.5,0),vs,o,ys,n,s),vp[t(298)](0,0),gu[t(298)](1,0),Wp[t(298)](1,1);let c=x[t(1253)][t(3745)](Wa,lc,wa,!1,cc);if(c===null&&(Ra(lc.set(-.5,.5,0),vs,o,ys,n,s),gu[t(298)](0,1),c=x[t(1253)].intersectTriangle(Wa,wa,lc,!1,cc),c===null))return;const C=x[t(1253)].origin[t(3708)](cc);C<x[t(2987)]||C>x[t(1407)]||e[t(3330)]({distance:C,point:cc.clone(),uv:xg[t(3216)](cc,Wa,lc,wa,vp,gu,Wp,new S0),face:null,object:this})}[I(1493)](x,e){const t=I;return super.copy(x,e),x.center!==void 0&&this[t(3416)].copy(x[t(3416)]),this[t(3480)]=x[t(3480)],this}}function Ra(i,x,e,t,g,n){const s=I;Ws[s(859)](i,e)[s(1440)](.5).multiply(t),g!==void 0?(Cc.x=n*Ws.x-g*Ws.y,Cc.y=g*Ws.x+n*Ws.y):Cc[s(1493)](Ws),i[s(1493)](x),i.x+=Cc.x,i.y+=Cc.y,i[s(3075)](zv)}const Va=new E,wp=new E;class Lv extends Nx{constructor(){const x=I;super(),this[x(348)]=0,this[x(3505)]=x(2714),Object[x(1266)](this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this[x(254)]=!0}[I(1493)](x){const e=I;super[e(1493)](x,!1);const t=x[e(1348)];for(let g=0,n=t.length;g<n;g++){const s=t[g];this[e(3116)](s.object[e(3123)](),s[e(3035)],s[e(3880)])}return this.autoUpdate=x[e(254)],this}[I(3116)](x,e=0,t=0){const g=I;e=Math.abs(e);const n=this.levels;let s;for(s=0;s<n[g(2989)]&&!(e<n[s][g(3035)]);s++);return n[g(2960)](s,0,{distance:e,hysteresis:t,object:x}),this[g(3014)](x),this}[I(2886)](){return this[I(348)]}getObjectForDistance(x){const e=I,t=this.levels;if(t[e(2989)]>0){let g,n;for(g=1,n=t.length;g<n;g++){let s=t[g][e(3035)];if(t[g][e(1011)].visible&&(s-=s*t[g][e(3880)]),x<s)break}return t[g-1][e(1011)]}return null}raycast(x,e){const t=I;if(this[t(1348)].length>0){Va.setFromMatrixPosition(this[t(2368)]);const n=x[t(1253)].origin[t(3708)](Va);this[t(189)](n).raycast(x,e)}}[I(2341)](x){const e=I,t=this[e(1348)];if(t[e(2989)]>1){Va[e(1577)](x[e(2368)]),wp.setFromMatrixPosition(this[e(2368)]);const g=Va[e(3708)](wp)/x[e(3981)];t[0][e(1011)][e(2548)]=!0;let n,s;for(n=1,s=t[e(2989)];n<s;n++){let o=t[n][e(3035)];if(t[n][e(1011)][e(2548)]&&(o-=o*t[n][e(3880)]),g>=o)t[n-1][e(1011)][e(2548)]=!1,t[n][e(1011)][e(2548)]=!0;else break}for(this[e(348)]=n-1;n<s;n++)t[n][e(1011)][e(2548)]=!1}}[I(2054)](x){const e=I,t=super.toJSON(x);this[e(254)]===!1&&(t.object[e(254)]=!1),t[e(1011)][e(1348)]=[];const g=this[e(1348)];for(let n=0,s=g[e(2989)];n<s;n++){const o=g[n];t[e(1011)][e(1348)][e(3330)]({object:o.object.uuid,distance:o[e(3035)],hysteresis:o[e(3880)]})}return t}}const Rp=new E,Vp=new Dx,Sp=new Dx,FN=new E,Xp=new dx,Sa=new E,iu=new ct,Yp=new dx,nu=new vo;class kv extends ye{constructor(x,e){const t=I;super(x,e),this[t(1305)]=!0,this.type=t(1273),this.bindMode=Vb,this.bindMatrix=new dx,this[t(1182)]=new dx,this[t(3344)]=null,this[t(3636)]=null}[I(3775)](){const x=I,e=this[x(352)];this.boundingBox===null&&(this.boundingBox=new yt),this[x(3344)].makeEmpty();const t=e[x(2606)](x(2817));for(let g=0;g<t[x(3411)];g++)this[x(3254)](g,Sa),this[x(3344)].expandByPoint(Sa)}computeBoundingSphere(){const x=I,e=this[x(352)];this.boundingSphere===null&&(this[x(3636)]=new ct),this.boundingSphere.makeEmpty();const t=e[x(2606)](x(2817));for(let g=0;g<t[x(3411)];g++)this[x(3254)](g,Sa),this[x(3636)][x(3282)](Sa)}copy(x,e){const t=I;return super[t(1493)](x,e),this[t(2313)]=x[t(2313)],this[t(635)][t(1493)](x.bindMatrix),this[t(1182)][t(1493)](x[t(1182)]),this[t(2148)]=x[t(2148)],x[t(3344)]!==null&&(this[t(3344)]=x[t(3344)][t(3123)]()),x[t(3636)]!==null&&(this[t(3636)]=x.boundingSphere.clone()),this}[I(785)](x,e){const t=I,g=this[t(3480)],n=this[t(2368)];g!==void 0&&(this.boundingSphere===null&&this[t(1668)](),iu[t(1493)](this[t(3636)]),iu[t(3075)](n),x[t(1253)][t(3195)](iu)!==!1&&(Yp.copy(n)[t(2483)](),nu.copy(x.ray)[t(3075)](Yp),!(this[t(3344)]!==null&&nu[t(2425)](this.boundingBox)===!1)&&this[t(418)](x,e,nu)))}[I(3254)](x,e){const t=I;return super[t(3254)](x,e),this[t(3479)](x,e),e}bind(x,e){const t=I;this.skeleton=x,e===void 0&&(this[t(3554)](!0),this[t(2148)][t(2402)](),e=this[t(2368)]),this[t(635)][t(1493)](e),this[t(1182)][t(1493)](e).invert()}[I(3266)](){const x=I;this[x(2148)][x(3266)]()}[I(3683)](){const x=I,e=new Dx,t=this[x(352)][x(2593)][x(245)];for(let g=0,n=t[x(3411)];g<n;g++){e.fromBufferAttribute(t,g);const s=1/e[x(3027)]();s!==1/0?e[x(2333)](s):e[x(298)](1,0,0,0),t.setXYZW(g,e.x,e.y,e.z,e.w)}}[I(3554)](x){const e=I;super[e(3554)](x),this[e(2313)]===Vb?this[e(1182)][e(1493)](this[e(2368)])[e(2483)]():this[e(2313)]===Py?this[e(1182)][e(1493)](this[e(635)])[e(2483)]():console.warn(e(1340)+this.bindMode)}[I(3479)](x,e){const t=I,g=this[t(2148)],n=this.geometry;Vp[t(2404)](n.attributes[t(1997)],x),Sp.fromBufferAttribute(n[t(2593)][t(245)],x),Rp.copy(e)[t(3075)](this[t(635)]),e.set(0,0,0);for(let s=0;s<4;s++){const o=Sp[t(1096)](s);if(o!==0){const c=Vp.getComponent(s);Xp.multiplyMatrices(g[t(3932)][c][t(2368)],g[t(2284)][c]),e[t(832)](FN.copy(Rp)[t(3075)](Xp),o)}}return e.applyMatrix4(this[t(1182)])}}class Rf extends Nx{constructor(){const x=I;super(),this[x(2772)]=!0,this[x(3505)]="Bone"}}class Xn extends ue{constructor(x=null,e=1,t=1,g,n,s,o,c,C=Me,r=Me,A,d){const h=I;super(null,s,o,c,C,r,g,n,A,d),this[h(3079)]=!0,this[h(1781)]={data:x,width:e,height:t},this[h(2787)]=!1,this.flipY=!1,this[h(1005)]=1}}const Kp=new dx,zN=new dx;class R2{constructor(x=[],e=[]){const t=I;this[t(296)]=gg(),this.bones=x[t(1226)](0),this[t(2284)]=e,this[t(2781)]=null,this[t(1478)]=null,this[t(2032)]()}[I(2032)](){const x=I,e=this.bones,t=this[x(2284)];if(this[x(2781)]=new Float32Array(e[x(2989)]*16),t[x(2989)]===0)this.calculateInverses();else if(e[x(2989)]!==t[x(2989)]){console.warn(x(3639)),this[x(2284)]=[];for(let g=0,n=this[x(3932)].length;g<n;g++)this[x(2284)][x(3330)](new dx)}}[I(2402)](){const x=I;this[x(2284)][x(2989)]=0;for(let e=0,t=this[x(3932)].length;e<t;e++){const g=new dx;this.bones[e]&&g[x(1493)](this[x(3932)][e][x(2368)]).invert(),this[x(2284)].push(g)}}pose(){const x=I;for(let e=0,t=this[x(3932)].length;e<t;e++){const g=this.bones[e];g&&g.matrixWorld[x(1493)](this[x(2284)][e])[x(2483)]()}for(let e=0,t=this[x(3932)][x(2989)];e<t;e++){const g=this[x(3932)][e];g&&(g[x(1064)]&&g.parent.isBone?(g[x(1721)][x(1493)](g.parent.matrixWorld)[x(2483)](),g[x(1721)][x(327)](g.matrixWorld)):g[x(1721)][x(1493)](g[x(2368)]),g.matrix[x(2986)](g[x(2817)],g[x(3915)],g[x(623)]))}}[I(2341)](){const x=I,e=this[x(3932)],t=this[x(2284)],g=this[x(2781)],n=this[x(1478)];for(let s=0,o=e[x(2989)];s<o;s++){const c=e[s]?e[s][x(2368)]:zN;Kp[x(1418)](c,t[s]),Kp[x(3904)](g,s*16)}n!==null&&(n[x(2170)]=!0)}[I(3123)](){const x=I;return new R2(this.bones,this[x(2284)])}computeBoneTexture(){const x=I;let e=Math[x(3641)](this[x(3932)].length*4);e=Math.ceil(e/4)*4,e=Math[x(1971)](e,4);const t=new Float32Array(e*e*4);t[x(298)](this.boneMatrices);const g=new Xn(t,e,e,zt,pg);return g[x(2170)]=!0,this[x(2781)]=t,this.boneTexture=g,this}[I(2971)](x){const e=I;for(let t=0,g=this.bones[e(2989)];t<g;t++){const n=this[e(3932)][t];if(n[e(1474)]===x)return n}}[I(1439)](){const x=I;this.boneTexture!==null&&(this.boneTexture.dispose(),this[x(1478)]=null)}[I(3385)](x,e){const t=I;this.uuid=x[t(296)];for(let g=0,n=x[t(3932)][t(2989)];g<n;g++){const s=x[t(3932)][g];let o=e[s];o===void 0&&(console.warn(t(3671),s),o=new Rf),this[t(3932)][t(3330)](o),this[t(2284)][t(3330)](new dx()[t(2793)](x[t(2284)][g]))}return this[t(2032)](),this}[I(2054)](){const x=I,e={metadata:{version:4.6,type:x(2683),generator:x(2604)},bones:[],boneInverses:[]};e.uuid=this[x(296)];const t=this.bones,g=this.boneInverses;for(let n=0,s=t[x(2989)];n<s;n++){const o=t[n];e[x(3932)][x(3330)](o.uuid);const c=g[n];e[x(2284)].push(c.toArray())}return e}}class mo extends Px{constructor(x,e,t,g=1){const n=I;super(x,e,t),this.isInstancedBufferAttribute=!0,this[n(3188)]=g}[I(1493)](x){const e=I;return super[e(1493)](x),this.meshPerAttribute=x.meshPerAttribute,this}[I(2054)](){const x=I,e=super[x(2054)]();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ws=new dx,Hp=new dx,Xa=[],Np=new yt,MN=new dx,ac=new ye,rc=new ct;class so extends ye{constructor(x,e,t){const g=I;super(x,e),this[g(2369)]=!0,this[g(1068)]=new mo(new Float32Array(t*16),16),this[g(1224)]=null,this.morphTexture=null,this.count=t,this[g(3344)]=null,this.boundingSphere=null;for(let n=0;n<t;n++)this[g(2430)](n,MN)}[I(3775)](){const x=I,e=this[x(352)],t=this[x(3411)];this[x(3344)]===null&&(this.boundingBox=new yt),e.boundingBox===null&&e[x(3775)](),this[x(3344)][x(3734)]();for(let g=0;g<t;g++)this[x(2192)](g,ws),Np[x(1493)](e[x(3344)])[x(3075)](ws),this[x(3344)][x(2092)](Np)}computeBoundingSphere(){const x=I,e=this[x(352)],t=this[x(3411)];this[x(3636)]===null&&(this.boundingSphere=new ct),e.boundingSphere===null&&e[x(1668)](),this[x(3636)][x(3734)]();for(let g=0;g<t;g++)this[x(2192)](g,ws),rc[x(1493)](e[x(3636)]).applyMatrix4(ws),this.boundingSphere[x(2092)](rc)}copy(x,e){const t=I;return super[t(1493)](x,e),this[t(1068)][t(1493)](x[t(1068)]),x[t(3642)]!==null&&(this[t(3642)]=x[t(3642)][t(3123)]()),x.instanceColor!==null&&(this[t(1224)]=x.instanceColor[t(3123)]()),this[t(3411)]=x[t(3411)],x.boundingBox!==null&&(this[t(3344)]=x.boundingBox[t(3123)]()),x[t(3636)]!==null&&(this[t(3636)]=x[t(3636)][t(3123)]()),this}[I(2328)](x,e){const t=I;e[t(2793)](this.instanceColor[t(315)],x*3)}[I(2192)](x,e){e[I(2793)](this.instanceMatrix.array,x*16)}getMorphAt(x,e){const t=I,g=e.morphTargetInfluences,n=this[t(3642)][t(3272)].data[t(3787)],s=g[t(2989)]+1,o=x*s+1;for(let c=0;c<g[t(2989)];c++)g[c]=n[o+c]}[I(785)](x,e){const t=I,g=this[t(2368)],n=this[t(3411)];if(ac[t(352)]=this.geometry,ac[t(3480)]=this[t(3480)],ac[t(3480)]!==void 0&&(this.boundingSphere===null&&this[t(1668)](),rc[t(1493)](this[t(3636)]),rc[t(3075)](g),x[t(1253)][t(3195)](rc)!==!1))for(let s=0;s<n;s++){this[t(2192)](s,ws),Hp.multiplyMatrices(g,ws),ac.matrixWorld=Hp,ac[t(785)](x,Xa);for(let o=0,c=Xa[t(2989)];o<c;o++){const C=Xa[o];C[t(1280)]=s,C[t(1011)]=this,e[t(3330)](C)}Xa[t(2989)]=0}}[I(3931)](x,e){const t=I;this[t(1224)]===null&&(this[t(1224)]=new mo(new Float32Array(this[t(1068)].count*3),3)),e[t(3904)](this[t(1224)][t(315)],x*3)}[I(2430)](x,e){const t=I;e[t(3904)](this[t(1068)].array,x*16)}setMorphAt(x,e){const t=I,g=e[t(2891)],n=g.length+1;this[t(3642)]===null&&(this[t(3642)]=new Xn(new Float32Array(n*this[t(3411)]),n,this[t(3411)],rf,pg));const s=this.morphTexture[t(3272)].data.data;let o=0;for(let r=0;r<g[t(2989)];r++)o+=g[r];const c=this[t(352)][t(316)]?1:1-o,C=n*x;s[C]=c,s[t(298)](g,C+1)}updateMorphTargets(){}dispose(){const x=I;return this[x(1457)]({type:"dispose"}),this[x(3642)]!==null&&(this[x(3642)][x(1439)](),this[x(3642)]=null),this}}function LN(i,x){return i.z-x.z}function kN(i,x){return x.z-i.z}class TN{constructor(){const x=I;this.index=0,this[x(3615)]=[],this[x(2267)]=[]}[I(3330)](x,e){const t=I,g=this.pool,n=this[t(2267)];this[t(587)]>=g[t(2989)]&&g[t(3330)]({start:-1,count:-1,z:-1});const s=g[this[t(587)]];n[t(3330)](s),this[t(587)]++,s[t(3988)]=x[t(3988)],s[t(3411)]=x.count,s.z=e}[I(1877)](){this.list.length=0,this.index=0}}const Rs=I(3543),rn=new dx,Fp=new dx,JN=new dx,zp=new dx,Iu=new zC,Ya=new yt,nI=new ct,dc=new E,su=new TN,it=new ye,Ka=[];function EN(i,x,e=0){const t=I,g=x.itemSize;if(i[t(2568)]||i.array[t(135)]!==x[t(315)][t(135)]){const n=i[t(3411)];for(let s=0;s<n;s++)for(let o=0;o<g;o++)x[t(1473)](s+e,o,i.getComponent(s,o))}else x[t(315)][t(298)](i[t(315)],e*g);x[t(2170)]=!0}class Tv extends ye{get[I(1957)](){return this[I(2896)]}constructor(x,e,t=e*2,g){const n=I;super(new vx,g),this[n(1754)]=!0,this.perObjectFrustumCulled=!0,this[n(1371)]=!0,this.boundingBox=null,this.boundingSphere=null,this[n(287)]=null,this._drawRanges=[],this[n(1547)]=[],this[n(3065)]=[],this[n(3765)]=[],this[n(1301)]=[],this._maxGeometryCount=x,this[n(2127)]=e,this[n(2409)]=t,this[n(2447)]=!1,this[n(987)]=0,this[n(2766)]=new Int32Array(x),this._multiDrawStarts=new Int32Array(x),this[n(865)]=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){const x=I;let e=Math[x(3641)](this[x(2896)]*4);e=Math.ceil(e/4)*4,e=Math[x(1971)](e,4);const t=new Float32Array(e*e*4),g=new Xn(t,e,e,zt,pg);this[x(1245)]=g}_initializeGeometry(x){const e=I,t=this[e(352)],g=this[e(2127)],n=this._maxGeometryCount,s=this[e(2409)];if(this[e(2447)]===!1){for(const c in x[e(2593)]){const C=x[e(2606)](c),{array:r,itemSize:A,normalized:d}=C,h=new r[e(135)](g*A),f=new Px(h,A,d);t[e(1236)](c,f)}if(x[e(3268)]()!==null){const c=g>65536?new Uint32Array(s):new Uint16Array(s);t[e(3317)](new Px(c,1))}const o=n>65536?new Uint32Array(g):new Uint16Array(g);t.setAttribute(Rs,new Px(o,1)),this[e(2447)]=!0}}[I(1321)](x){const e=I;if(x[e(2606)](Rs))throw new Error(e(1654)+Rs+'"');const t=this[e(352)];if(!!x[e(3268)]()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const g in t[e(2593)]){if(g===Rs)continue;if(!x[e(1065)](g))throw new Error(e(728)+g+e(1568));const n=x.getAttribute(g),s=t[e(2606)](g);if(n.itemSize!==s.itemSize||n.normalized!==s[e(1894)])throw new Error(e(2283))}}setCustomSort(x){const e=I;return this[e(287)]=x,this}[I(3775)](){const x=I;this[x(3344)]===null&&(this[x(3344)]=new yt);const e=this[x(987)],t=this.boundingBox,g=this[x(3765)];t[x(3734)]();for(let n=0;n<e;n++)g[n]!==!1&&(this.getMatrixAt(n,rn),this[x(676)](n,Ya)[x(3075)](rn),t[x(2092)](Ya))}[I(1668)](){const x=I;this[x(3636)]===null&&(this[x(3636)]=new ct);const e=this[x(987)],t=this[x(3636)],g=this[x(3765)];t[x(3734)]();for(let n=0;n<e;n++)g[n]!==!1&&(this.getMatrixAt(n,rn),this[x(1838)](n,nI)[x(3075)](rn),t[x(2092)](nI))}[I(897)](x,e=-1,t=-1){const g=I;if(this._initializeGeometry(x),this[g(1321)](x),this._geometryCount>=this[g(2896)])throw new Error("BatchedMesh: Maximum geometry count reached.");const n={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this[g(1547)],c=this[g(2692)],C=this[g(1301)];this._geometryCount!==0&&(s=o[o[g(2989)]-1]),e===-1?n.vertexCount=x[g(2606)](g(2817))[g(3411)]:n[g(405)]=e,s===null?n.vertexStart=0:n[g(762)]=s.vertexStart+s[g(405)];const r=x[g(3268)](),A=r!==null;if(A&&(t===-1?n[g(3692)]=r.count:n[g(3692)]=t,s===null?n[g(3037)]=0:n[g(3037)]=s.indexStart+s[g(3692)]),n[g(3037)]!==-1&&n.indexStart+n[g(3692)]>this._maxIndexCount||n[g(762)]+n[g(405)]>this[g(2127)])throw new Error(g(1066));const d=this[g(3065)],h=this[g(3765)],f=this[g(1245)],B=this._matricesTexture.image[g(3787)];d[g(3330)](!0),h[g(3330)](!0);const Z=this[g(987)];this[g(987)]++,JN[g(3904)](B,Z*16),f[g(2170)]=!0,o[g(3330)](n),c[g(3330)]({start:A?n[g(3037)]:n[g(762)],count:-1}),C.push({boxInitialized:!1,box:new yt,sphereInitialized:!1,sphere:new ct});const G=this[g(352)][g(2606)](Rs);for(let m=0;m<n.vertexCount;m++)G[g(3126)](n[g(762)]+m,Z);return G[g(2170)]=!0,this.setGeometryAt(Z,x),Z}[I(252)](x,e){const t=I;if(x>=this[t(987)])throw new Error(t(1001));this._validateGeometry(e);const g=this[t(352)],n=g[t(3268)]()!==null,s=g[t(3268)](),o=e[t(3268)](),c=this[t(1547)][x];if(n&&o[t(3411)]>c[t(3692)]||e[t(2593)][t(2817)][t(3411)]>c[t(405)])throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const C=c[t(762)],r=c[t(405)];for(const f in g[t(2593)]){if(f===Rs)continue;const B=e[t(2606)](f),Z=g.getAttribute(f);EN(B,Z,C);const G=B[t(365)];for(let m=B[t(3411)],v=r;m<v;m++){const p=C+m;for(let w=0;w<G;w++)Z[t(1473)](p,w,0)}Z[t(2170)]=!0,Z.addUpdateRange(C*G,r*G)}if(n){const f=c[t(3037)];for(let B=0;B<o[t(3411)];B++)s[t(3126)](f+B,C+o.getX(B));for(let B=o[t(3411)],Z=c.indexCount;B<Z;B++)s[t(3126)](f+B,C);s[t(2170)]=!0,s[t(3174)](f,c[t(3692)])}const A=this[t(1301)][x];e[t(3344)]!==null?(A.box.copy(e[t(3344)]),A.boxInitialized=!0):A.boxInitialized=!1,e[t(3636)]!==null?(A[t(3119)][t(1493)](e[t(3636)]),A[t(328)]=!0):A[t(328)]=!1;const d=this[t(2692)][x],h=e[t(2606)](t(2817));return d.count=n?o[t(3411)]:h[t(3411)],this[t(300)]=!0,x}[I(811)](x){const e=I,t=this[e(3765)];return x>=t[e(2989)]||t[x]===!1?this:(t[x]=!1,this._visibilityChanged=!0,this)}[I(1724)](x){const e=I;return this[e(3449)]===null?null:this[e(3449)][x]}[I(3732)](x,e){const t=I;return this[t(3449)]===null&&(this._multiDrawInstances=new Int32Array(this[t(2896)]).fill(1)),this[t(3449)][x]=e,x}getBoundingBoxAt(x,e){const t=I;if(this[t(3765)][x]===!1)return null;const n=this[t(1301)][x],s=n[t(1405)],o=this.geometry;if(n[t(906)]===!1){s[t(3734)]();const c=o.index,C=o[t(2593)][t(2817)],r=this[t(2692)][x];for(let A=r[t(3988)],d=r[t(3988)]+r.count;A<d;A++){let h=A;c&&(h=c[t(1829)](h)),s.expandByPoint(dc.fromBufferAttribute(C,h))}n[t(906)]=!0}return e[t(1493)](s),e}getBoundingSphereAt(x,e){const t=I;if(this._active[x]===!1)return null;const n=this[t(1301)][x],s=n.sphere,o=this[t(352)];if(n.sphereInitialized===!1){s[t(3734)](),this[t(676)](x,Ya),Ya.getCenter(s.center);const c=o[t(587)],C=o.attributes[t(2817)],r=this[t(2692)][x];let A=0;for(let d=r[t(3988)],h=r[t(3988)]+r[t(3411)];d<h;d++){let f=d;c&&(f=c[t(1829)](f)),dc[t(2404)](C,f),A=Math[t(1971)](A,s.center[t(3489)](dc))}s.radius=Math[t(3641)](A),n[t(328)]=!0}return e[t(1493)](s),e}setMatrixAt(x,e){const t=I,g=this[t(3765)],n=this[t(1245)],s=this[t(1245)].image[t(3787)],o=this[t(987)];return x>=o||g[x]===!1?this:(e[t(3904)](s,x*16),n[t(2170)]=!0,this)}[I(2192)](x,e){const t=I,g=this[t(3765)],n=this[t(1245)][t(1781)][t(3787)],s=this[t(987)];return x>=s||g[x]===!1?null:e[t(2793)](n,x*16)}[I(396)](x,e){const t=I,g=this[t(3065)],n=this[t(3765)],s=this[t(987)];return x>=s||n[x]===!1||g[x]===e?this:(g[x]=e,this._visibilityChanged=!0,this)}[I(428)](x){const e=I,t=this[e(3065)],g=this[e(3765)],n=this[e(987)];return x>=n||g[x]===!1?!1:t[x]}[I(785)](x,e){const t=I,g=this[t(3065)],n=this[t(3765)],s=this[t(2692)],o=this[t(987)],c=this[t(2368)],C=this[t(352)];it[t(3480)]=this.material,it.geometry[t(587)]=C[t(587)],it[t(352)][t(2593)]=C[t(2593)],it[t(352)][t(3344)]===null&&(it[t(352)][t(3344)]=new yt),it[t(352)].boundingSphere===null&&(it[t(352)][t(3636)]=new ct);for(let r=0;r<o;r++){if(!g[r]||!n[r])continue;const A=s[r];it.geometry[t(1354)](A.start,A[t(3411)]),this.getMatrixAt(r,it[t(2368)])[t(2050)](c),this[t(676)](r,it[t(352)].boundingBox),this.getBoundingSphereAt(r,it[t(352)][t(3636)]),it[t(785)](x,Ka);for(let d=0,h=Ka[t(2989)];d<h;d++){const f=Ka[d];f.object=this,f[t(3543)]=r,e[t(3330)](f)}Ka[t(2989)]=0}it[t(3480)]=null,it[t(352)][t(587)]=null,it[t(352)][t(2593)]={},it[t(352)].setDrawRange(0,1/0)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(352)]=x[e(352)].clone(),this[e(916)]=x[e(916)],this[e(1371)]=x.sortObjects,this.boundingBox=x.boundingBox!==null?x[e(3344)].clone():null,this[e(3636)]=x.boundingSphere!==null?x[e(3636)][e(3123)]():null,this[e(2692)]=x._drawRanges[e(3879)](t=>({...t})),this._reservedRanges=x[e(1547)][e(3879)](t=>({...t})),this[e(3065)]=x[e(3065)].slice(),this[e(3765)]=x._active[e(1226)](),this[e(1301)]=x._bounds[e(3879)](t=>({boxInitialized:t[e(906)],box:t[e(1405)][e(3123)](),sphereInitialized:t.sphereInitialized,sphere:t.sphere[e(3123)]()})),this._maxGeometryCount=x[e(2896)],this[e(2127)]=x[e(2127)],this[e(2409)]=x._maxIndexCount,this[e(2447)]=x[e(2447)],this[e(987)]=x._geometryCount,this._multiDrawCounts=x._multiDrawCounts[e(1226)](),this[e(2098)]=x[e(2098)].slice(),this[e(1245)]=x[e(1245)][e(3123)](),this[e(1245)].image.data=this[e(1245)][e(1781)][e(1226)](),this}dispose(){const x=I;return this[x(352)][x(1439)](),this[x(1245)][x(1439)](),this[x(1245)]=null,this}[I(3548)](x,e,t,g,n){const s=I;if(!this._visibilityChanged&&!this[s(916)]&&!this[s(1371)])return;const o=g[s(3268)](),c=o===null?1:o[s(315)][s(218)],C=this[s(3765)],r=this._visibility,A=this[s(2098)],d=this._multiDrawCounts,h=this[s(2692)],f=this.perObjectFrustumCulled;f&&(zp[s(1418)](t[s(2900)],t.matrixWorldInverse)[s(327)](this[s(2368)]),Iu.setFromProjectionMatrix(zp,x[s(366)]));let B=0;if(this.sortObjects){Fp[s(1493)](this[s(2368)])[s(2483)](),dc.setFromMatrixPosition(t[s(2368)])[s(3075)](Fp);for(let m=0,v=r[s(2989)];m<v;m++)if(r[m]&&C[m]){this[s(2192)](m,rn),this[s(1838)](m,nI)[s(3075)](rn);let p=!1;if(f&&(p=!Iu[s(3195)](nI)),!p){const w=dc[s(3708)](nI[s(3416)]);su[s(3330)](h[m],w)}}const Z=su[s(2267)],G=this[s(287)];G===null?Z[s(3609)](n.transparent?kN:LN):G[s(2627)](this,Z,t);for(let m=0,v=Z[s(2989)];m<v;m++){const p=Z[m];A[B]=p[s(3988)]*c,d[B]=p[s(3411)],B++}su[s(1877)]()}else for(let Z=0,G=r[s(2989)];Z<G;Z++)if(r[Z]&&C[Z]){let m=!1;if(f&&(this.getMatrixAt(Z,rn),this.getBoundingSphereAt(Z,nI).applyMatrix4(rn),m=!Iu[s(3195)](nI)),!m){const v=h[Z];A[B]=v[s(3988)]*c,d[B]=v.count,B++}}this[s(865)]=B,this._visibilityChanged=!1}[I(204)](x,e,t,g,n,s){this[I(3548)](x,null,g,n,s)}}class vt extends lt{constructor(x){const e=I;super(),this[e(3343)]=!0,this[e(3505)]="LineBasicMaterial",this[e(432)]=new Q0(16777215),this[e(3879)]=null,this[e(3725)]=1,this[e(767)]=e(1008),this[e(542)]=e(1008),this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(432)][e(1493)](x[e(432)]),this.map=x.map,this[e(3725)]=x.linewidth,this[e(767)]=x[e(767)],this[e(542)]=x.linejoin,this[e(1382)]=x[e(1382)],this}}const g2=new E,i2=new E,Mp=new dx,Ac=new vo,Ha=new ct,ou=new E,Lp=new E;class Nn extends Nx{constructor(x=new vx,e=new vt){const t=I;super(),this[t(2154)]=!0,this[t(3505)]="Line",this[t(352)]=x,this.material=e,this[t(1667)]()}[I(1493)](x,e){const t=I;return super[t(1493)](x,e),this[t(3480)]=Array[t(1987)](x.material)?x.material[t(1226)]():x[t(3480)],this[t(352)]=x[t(352)],this}[I(1779)](){const x=I,e=this[x(352)];if(e[x(587)]===null){const t=e[x(2593)][x(2817)],g=[0];for(let n=1,s=t.count;n<s;n++)g2[x(2404)](t,n-1),i2[x(2404)](t,n),g[n]=g[n-1],g[n]+=g2[x(3708)](i2);e[x(1236)](x(3256),new ix(g,1))}else console[x(3748)](x(1272));return this}[I(785)](x,e){const t=I,g=this[t(352)],n=this[t(2368)],s=x[t(3598)][t(2743)].threshold,o=g[t(753)];if(g[t(3636)]===null&&g[t(1668)](),Ha[t(1493)](g[t(3636)]),Ha.applyMatrix4(n),Ha.radius+=s,x[t(1253)].intersectsSphere(Ha)===!1)return;Mp.copy(n)[t(2483)](),Ac.copy(x[t(1253)])[t(3075)](Mp);const c=s/((this.scale.x+this.scale.y+this[t(623)].z)/3),C=c*c,r=this[t(3728)]?2:1,A=g[t(587)],d=g[t(2593)],h=d[t(2817)];if(A!==null){const f=Math[t(1971)](0,o[t(3988)]),B=Math[t(1410)](A[t(3411)],o[t(3988)]+o.count);for(let Z=f,G=B-1;Z<G;Z+=r){const m=A[t(1829)](Z),v=A[t(1829)](Z+1),p=Na(this,x,Ac,C,m,v);p&&e.push(p)}if(this.isLineLoop){const Z=A[t(1829)](B-1),G=A[t(1829)](f),m=Na(this,x,Ac,C,Z,G);m&&e[t(3330)](m)}}else{const f=Math[t(1971)](0,o.start),B=Math.min(h.count,o.start+o[t(3411)]);for(let Z=f,G=B-1;Z<G;Z+=r){const m=Na(this,x,Ac,C,Z,Z+1);m&&e[t(3330)](m)}if(this[t(482)]){const Z=Na(this,x,Ac,C,B-1,f);Z&&e[t(3330)](Z)}}}[I(1667)](){const x=I,e=this[x(352)],t=e.morphAttributes,g=Object.keys(t);if(g[x(2989)]>0){const n=t[g[0]];if(n!==void 0){this[x(2891)]=[],this[x(3300)]={};for(let s=0,o=n[x(2989)];s<o;s++){const c=n[s].name||String(s);this[x(2891)].push(0),this[x(3300)][c]=s}}}}}function Na(i,x,e,t,g,n){const s=I,o=i[s(352)][s(2593)][s(2817)];if(g2[s(2404)](o,g),i2[s(2404)](o,n),e[s(1151)](g2,i2,ou,Lp)>t)return;ou[s(3075)](i.matrixWorld);const C=x[s(1253)].origin[s(3708)](ou);if(!(C<x[s(2987)]||C>x.far))return{distance:C,point:Lp[s(3123)]()[s(3075)](i[s(2368)]),index:g,face:null,faceIndex:null,object:i}}const kp=new E,Tp=new E;class Ai extends Nn{constructor(x,e){const t=I;super(x,e),this[t(3728)]=!0,this[t(3505)]=t(1503)}[I(1779)](){const x=I,e=this[x(352)];if(e[x(587)]===null){const t=e.attributes[x(2817)],g=[];for(let n=0,s=t[x(3411)];n<s;n+=2)kp[x(2404)](t,n),Tp.fromBufferAttribute(t,n+1),g[n]=n===0?0:g[n-1],g[n+1]=g[n]+kp.distanceTo(Tp);e[x(1236)]("lineDistance",new ix(g,1))}else console.warn(x(1775));return this}}class Jv extends Nn{constructor(x,e){const t=I;super(x,e),this[t(482)]=!0,this[t(3505)]=t(2875)}}class Vf extends lt{constructor(x){const e=I;super(),this.isPointsMaterial=!0,this[e(3505)]=e(2220),this[e(432)]=new Q0(16777215),this[e(3879)]=null,this[e(3709)]=null,this[e(1019)]=1,this[e(965)]=!0,this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(432)][e(1493)](x[e(432)]),this[e(3879)]=x[e(3879)],this[e(3709)]=x.alphaMap,this.size=x.size,this.sizeAttenuation=x[e(965)],this[e(1382)]=x.fog,this}}const Jp=new dx,sh=new vo,Fa=new ct,za=new E;class Ev extends Nx{constructor(x=new vx,e=new Vf){const t=I;super(),this[t(1146)]=!0,this[t(3505)]=t(1674),this[t(352)]=x,this[t(3480)]=e,this.updateMorphTargets()}[I(1493)](x,e){const t=I;return super.copy(x,e),this[t(3480)]=Array[t(1987)](x.material)?x[t(3480)][t(1226)]():x.material,this.geometry=x[t(352)],this}raycast(x,e){const t=I,g=this.geometry,n=this[t(2368)],s=x[t(3598)][t(1674)][t(479)],o=g[t(753)];if(g[t(3636)]===null&&g.computeBoundingSphere(),Fa[t(1493)](g.boundingSphere),Fa[t(3075)](n),Fa.radius+=s,x[t(1253)].intersectsSphere(Fa)===!1)return;Jp.copy(n)[t(2483)](),sh[t(1493)](x[t(1253)])[t(3075)](Jp);const c=s/((this[t(623)].x+this[t(623)].y+this[t(623)].z)/3),C=c*c,r=g[t(587)],A=g.attributes,d=A[t(2817)];if(r!==null){const h=Math[t(1971)](0,o[t(3988)]),f=Math.min(r.count,o[t(3988)]+o[t(3411)]);for(let B=h,Z=f;B<Z;B++){const G=r[t(1829)](B);za[t(2404)](d,G),Ep(za,G,C,n,x,e,this)}}else{const h=Math[t(1971)](0,o.start),f=Math[t(1410)](d.count,o[t(3988)]+o[t(3411)]);for(let B=h,Z=f;B<Z;B++)za[t(2404)](d,B),Ep(za,B,C,n,x,e,this)}}[I(1667)](){const x=I,e=this[x(352)],t=e[x(593)],g=Object[x(958)](t);if(g[x(2989)]>0){const n=t[g[0]];if(n!==void 0){this[x(2891)]=[],this[x(3300)]={};for(let s=0,o=n[x(2989)];s<o;s++){const c=n[s].name||String(s);this[x(2891)][x(3330)](0),this.morphTargetDictionary[c]=s}}}}}function Ep(i,x,e,t,g,n,s){const o=I,c=sh.distanceSqToPoint(i);if(c<e){const C=new E;sh[o(130)](i,C),C[o(3075)](t);const r=g[o(1253)][o(3519)].distanceTo(C);if(r<g.near||r>g[o(1407)])return;n.push({distance:r,distanceToRay:Math[o(3641)](c),point:C,index:x,face:null,object:s})}}class UN extends ue{constructor(x,e,t,g,n,s,o,c,C){const r=I;super(x,e,t,g,n,s,o,c,C),this[r(1078)]=!0,this[r(3338)]=s!==void 0?s:Ze,this[r(2637)]=n!==void 0?n:Ze,this.generateMipmaps=!1;const A=this;function d(){const h=r;A[h(2170)]=!0,x[h(1026)](d)}r(1026)in x&&x.requestVideoFrameCallback(d)}[I(3123)](){const x=I;return new this.constructor(this[x(1781)])[x(1493)](this)}update(){const x=I,e=this[x(1781)];x(1026)in e===!1&&e[x(363)]>=e[x(2545)]&&(this[x(2170)]=!0)}}class _N extends ue{constructor(x,e){const t=I;super({width:x,height:e}),this[t(3495)]=!0,this[t(2637)]=Me,this[t(3338)]=Me,this[t(2787)]=!1,this.needsUpdate=!0}}class V2 extends ue{constructor(x,e,t,g,n,s,o,c,C,r,A,d){const h=I;super(null,s,o,c,C,r,g,n,A,d),this.isCompressedTexture=!0,this[h(1781)]={width:e,height:t},this[h(2768)]=x,this[h(233)]=!1,this[h(2787)]=!1}}class DN extends V2{constructor(x,e,t,g,n,s){const o=I;super(x,e,t,n,s),this[o(3302)]=!0,this.image.depth=g,this[o(3883)]=Gg}}class QN extends V2{constructor(x,e,t){const g=I;super(void 0,x[0][g(2315)],x[0].height,e,t,Ei),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this[g(1781)]=x}}class PN extends ue{constructor(x,e,t,g,n,s,o,c,C){const r=I;super(x,e,t,g,n,s,o,c,C),this[r(3278)]=!0,this[r(2170)]=!0}}class Ug{constructor(){const x=I;this[x(3505)]=x(1773),this[x(1796)]=200}[I(695)](){const x=I;return console[x(3748)](x(3360)),null}[I(3066)](x,e){const t=I,g=this.getUtoTmapping(x);return this[t(695)](g,e)}[I(527)](x=5){const e=[];for(let t=0;t<=x;t++)e.push(this.getPoint(t/x));return e}[I(249)](x=5){const e=I,t=[];for(let g=0;g<=x;g++)t[e(3330)](this.getPointAt(g/x));return t}getLength(){const x=I,e=this[x(163)]();return e[e[x(2989)]-1]}[I(163)](x=this[I(1796)]){const e=I;if(this[e(1261)]&&this.cacheArcLengths[e(2989)]===x+1&&!this[e(2170)])return this[e(1261)];this[e(2170)]=!1;const t=[];let g,n=this.getPoint(0),s=0;t[e(3330)](0);for(let o=1;o<=x;o++)g=this[e(695)](o/x),s+=g.distanceTo(n),t[e(3330)](s),n=g;return this.cacheArcLengths=t,t}[I(3957)](){const x=I;this[x(2170)]=!0,this.getLengths()}[I(1586)](x,e){const t=I,g=this[t(163)]();let n=0;const s=g[t(2989)];let o;e?o=e:o=x*g[s-1];let c=0,C=s-1,r;for(;c<=C;)if(n=Math.floor(c+(C-c)/2),r=g[n]-o,r<0)c=n+1;else if(r>0)C=n-1;else{C=n;break}if(n=C,g[n]===o)return n/(s-1);const A=g[n],d=g[n+1],h=d-A,f=(o-A)/h;return(n+f)/(s-1)}[I(2844)](x,e){const t=I,g=1e-4;let n=x-g,s=x+g;n<0&&(n=0),s>1&&(s=1);const o=this[t(695)](n),c=this.getPoint(s),C=e||(o[t(3856)]?new S0:new E);return C[t(1493)](c)[t(3938)](o)[t(3762)](),C}[I(2451)](x,e){const t=I,g=this[t(1586)](x);return this[t(2844)](g,e)}[I(2305)](x,e){const t=I,g=new E,n=[],s=[],o=[],c=new E,C=new dx;for(let f=0;f<=x;f++){const B=f/x;n[f]=this[t(2451)](B,new E)}s[0]=new E,o[0]=new E;let r=Number[t(2888)];const A=Math.abs(n[0].x),d=Math[t(447)](n[0].y),h=Math[t(447)](n[0].z);A<=r&&(r=A,g[t(298)](1,0,0)),d<=r&&(r=d,g[t(298)](0,1,0)),h<=r&&g[t(298)](0,0,1),c.crossVectors(n[0],g).normalize(),s[0][t(1604)](n[0],c),o[0][t(1604)](n[0],s[0]);for(let f=1;f<=x;f++){if(s[f]=s[f-1][t(3123)](),o[f]=o[f-1][t(3123)](),c[t(1604)](n[f-1],n[f]),c[t(2989)]()>Number[t(2700)]){c[t(3762)]();const B=Math[t(3102)](Ae(n[f-1][t(1760)](n[f]),-1,1));s[f][t(3075)](C[t(3034)](c,B))}o[f][t(1604)](n[f],s[f])}if(e===!0){let f=Math[t(3102)](Ae(s[0].dot(s[x]),-1,1));f/=x,n[0][t(1760)](c[t(1604)](s[0],s[x]))>0&&(f=-f);for(let B=1;B<=x;B++)s[B].applyMatrix4(C[t(3034)](n[B],f*B)),o[B][t(1604)](n[B],s[B])}return{tangents:n,normals:s,binormals:o}}[I(3123)](){const x=I;return new this.constructor()[x(1493)](this)}copy(x){const e=I;return this[e(1796)]=x[e(1796)],this}toJSON(){const x=I,e={metadata:{version:4.6,type:x(1773),generator:"Curve.toJSON"}};return e[x(1796)]=this.arcLengthDivisions,e.type=this.type,e}[I(3385)](x){const e=I;return this[e(1796)]=x[e(1796)],this}}class S2 extends Ug{constructor(x=0,e=0,t=1,g=1,n=0,s=Math.PI*2,o=!1,c=0){const C=I;super(),this[C(1582)]=!0,this[C(3505)]=C(3996),this.aX=x,this.aY=e,this[C(1442)]=t,this[C(1330)]=g,this[C(540)]=n,this[C(759)]=s,this.aClockwise=o,this[C(3456)]=c}[I(695)](x,e=new S0){const t=I,g=e,n=Math.PI*2;let s=this.aEndAngle-this[t(540)];const o=Math[t(447)](s)<Number[t(2700)];for(;s<0;)s+=n;for(;s>n;)s-=n;s<Number[t(2700)]&&(o?s=0:s=n),this.aClockwise===!0&&!o&&(s===n?s=-n:s=s-n);const c=this[t(540)]+x*s;let C=this.aX+this[t(1442)]*Math[t(1563)](c),r=this.aY+this[t(1330)]*Math.sin(c);if(this[t(3456)]!==0){const A=Math[t(1563)](this[t(3456)]),d=Math[t(1996)](this[t(3456)]),h=C-this.aX,f=r-this.aY;C=h*A-f*d+this.aX,r=h*d+f*A+this.aY}return g.set(C,r)}[I(1493)](x){const e=I;return super[e(1493)](x),this.aX=x.aX,this.aY=x.aY,this[e(1442)]=x[e(1442)],this.yRadius=x[e(1330)],this.aStartAngle=x[e(540)],this.aEndAngle=x[e(759)],this[e(1295)]=x[e(1295)],this[e(3456)]=x.aRotation,this}[I(2054)](){const x=I,e=super[x(2054)]();return e.aX=this.aX,e.aY=this.aY,e[x(1442)]=this[x(1442)],e.yRadius=this[x(1330)],e[x(540)]=this[x(540)],e[x(759)]=this[x(759)],e[x(1295)]=this.aClockwise,e.aRotation=this[x(3456)],e}[I(3385)](x){const e=I;return super[e(3385)](x),this.aX=x.aX,this.aY=x.aY,this[e(1442)]=x.xRadius,this[e(1330)]=x[e(1330)],this.aStartAngle=x[e(540)],this[e(759)]=x.aEndAngle,this[e(1295)]=x[e(1295)],this[e(3456)]=x[e(3456)],this}}class Uv extends S2{constructor(x,e,t,g,n,s){const o=I;super(x,e,t,t,g,n,s),this[o(2364)]=!0,this[o(3505)]=o(2885)}}function Sf(){let i=0,x=0,e=0,t=0;function g(n,s,o,c){i=n,x=o,e=-3*n+3*s-2*o-c,t=2*n-2*s+o+c}return{initCatmullRom:function(n,s,o,c,C){g(s,o,C*(o-n),C*(c-s))},initNonuniformCatmullRom:function(n,s,o,c,C,r,A){let d=(s-n)/C-(o-n)/(C+r)+(o-s)/r,h=(o-s)/r-(c-s)/(r+A)+(c-o)/A;d*=r,h*=r,g(s,o,d,h)},calc:function(n){const s=n*n,o=s*n;return i+x*n+e*s+t*o}}}const Ma=new E,cu=new Sf,Cu=new Sf,lu=new Sf;class _v extends Ug{constructor(x=[],e=!1,t=I(1572),g=.5){const n=I;super(),this.isCatmullRomCurve3=!0,this.type=n(2375),this[n(2630)]=x,this[n(2379)]=e,this[n(346)]=t,this.tension=g}[I(695)](x,e=new E){const t=I,g=e,n=this.points,s=n[t(2989)],o=(s-(this[t(2379)]?0:1))*x;let c=Math.floor(o),C=o-c;this.closed?c+=c>0?0:(Math[t(3143)](Math[t(447)](c)/s)+1)*s:C===0&&c===s-1&&(c=s-2,C=1);let r,A;this[t(2379)]||c>0?r=n[(c-1)%s]:(Ma[t(859)](n[0],n[1])[t(3014)](n[0]),r=Ma);const d=n[c%s],h=n[(c+1)%s];if(this[t(2379)]||c+2<s?A=n[(c+2)%s]:(Ma[t(859)](n[s-1],n[s-2])[t(3014)](n[s-1]),A=Ma),this[t(346)]===t(1572)||this[t(346)]===t(2110)){const f=this.curveType==="chordal"?.5:.25;let B=Math.pow(r[t(3489)](d),f),Z=Math[t(3395)](d.distanceToSquared(h),f),G=Math.pow(h[t(3489)](A),f);Z<1e-4&&(Z=1),B<1e-4&&(B=Z),G<1e-4&&(G=Z),cu[t(2158)](r.x,d.x,h.x,A.x,B,Z,G),Cu[t(2158)](r.y,d.y,h.y,A.y,B,Z,G),lu.initNonuniformCatmullRom(r.z,d.z,h.z,A.z,B,Z,G)}else this[t(346)]===t(2859)&&(cu[t(3315)](r.x,d.x,h.x,A.x,this[t(210)]),Cu[t(3315)](r.y,d.y,h.y,A.y,this[t(210)]),lu.initCatmullRom(r.z,d.z,h.z,A.z,this.tension));return g[t(298)](cu[t(3219)](C),Cu[t(3219)](C),lu.calc(C)),g}[I(1493)](x){const e=I;super.copy(x),this.points=[];for(let t=0,g=x.points[e(2989)];t<g;t++){const n=x.points[t];this.points[e(3330)](n[e(3123)]())}return this[e(2379)]=x[e(2379)],this[e(346)]=x.curveType,this[e(210)]=x[e(210)],this}[I(2054)](){const x=I,e=super[x(2054)]();e[x(2630)]=[];for(let t=0,g=this[x(2630)][x(2989)];t<g;t++){const n=this.points[t];e[x(2630)][x(3330)](n.toArray())}return e[x(2379)]=this[x(2379)],e[x(346)]=this.curveType,e[x(210)]=this[x(210)],e}[I(3385)](x){const e=I;super.fromJSON(x),this[e(2630)]=[];for(let t=0,g=x[e(2630)][e(2989)];t<g;t++){const n=x.points[t];this[e(2630)][e(3330)](new E().fromArray(n))}return this[e(2379)]=x.closed,this[e(346)]=x[e(346)],this[e(210)]=x.tension,this}}function Up(i,x,e,t,g){const n=(t-x)*.5,s=(g-e)*.5,o=i*i,c=i*o;return(2*e-2*t+n+s)*c+(-3*e+3*t-2*n-s)*o+n*i+e}function ON(i,x){const e=1-i;return e*e*x}function qN(i,x){return 2*(1-i)*i*x}function $N(i,x){return i*i*x}function kc(i,x,e,t){return ON(i,x)+qN(i,e)+$N(i,t)}function jN(i,x){const e=1-i;return e*e*e*x}function xF(i,x){const e=1-i;return 3*e*e*i*x}function eF(i,x){return 3*(1-i)*i*i*x}function tF(i,x){return i*i*i*x}function Tc(i,x,e,t,g){return jN(i,x)+xF(i,e)+eF(i,t)+tF(i,g)}class Xf extends Ug{constructor(x=new S0,e=new S0,t=new S0,g=new S0){const n=I;super(),this[n(2128)]=!0,this[n(3505)]=n(3776),this.v0=x,this.v1=e,this.v2=t,this.v3=g}getPoint(x,e=new S0){const t=I,g=e,n=this.v0,s=this.v1,o=this.v2,c=this.v3;return g[t(298)](Tc(x,n.x,s.x,o.x,c.x),Tc(x,n.y,s.y,o.y,c.y)),g}copy(x){const e=I;return super[e(1493)](x),this.v0[e(1493)](x.v0),this.v1[e(1493)](x.v1),this.v2[e(1493)](x.v2),this.v3[e(1493)](x.v3),this}[I(2054)](){const x=I,e=super[x(2054)]();return e.v0=this.v0[x(3904)](),e.v1=this.v1[x(3904)](),e.v2=this.v2[x(3904)](),e.v3=this.v3[x(3904)](),e}fromJSON(x){const e=I;return super.fromJSON(x),this.v0[e(2793)](x.v0),this.v1.fromArray(x.v1),this.v2[e(2793)](x.v2),this.v3[e(2793)](x.v3),this}}class Dv extends Ug{constructor(x=new E,e=new E,t=new E,g=new E){const n=I;super(),this.isCubicBezierCurve3=!0,this.type=n(1040),this.v0=x,this.v1=e,this.v2=t,this.v3=g}[I(695)](x,e=new E){const t=I,g=e,n=this.v0,s=this.v1,o=this.v2,c=this.v3;return g[t(298)](Tc(x,n.x,s.x,o.x,c.x),Tc(x,n.y,s.y,o.y,c.y),Tc(x,n.z,s.z,o.z,c.z)),g}[I(1493)](x){const e=I;return super.copy(x),this.v0[e(1493)](x.v0),this.v1[e(1493)](x.v1),this.v2[e(1493)](x.v2),this.v3.copy(x.v3),this}[I(2054)](){const x=I,e=super[x(2054)]();return e.v0=this.v0[x(3904)](),e.v1=this.v1[x(3904)](),e.v2=this.v2[x(3904)](),e.v3=this.v3[x(3904)](),e}[I(3385)](x){const e=I;return super.fromJSON(x),this.v0.fromArray(x.v0),this.v1.fromArray(x.v1),this.v2[e(2793)](x.v2),this.v3[e(2793)](x.v3),this}}class Yf extends Ug{constructor(x=new S0,e=new S0){const t=I;super(),this[t(231)]=!0,this[t(3505)]=t(629),this.v1=x,this.v2=e}getPoint(x,e=new S0){const t=I,g=e;return x===1?g[t(1493)](this.v2):(g[t(1493)](this.v2).sub(this.v1),g[t(2333)](x)[t(3014)](this.v1)),g}[I(3066)](x,e){return this[I(695)](x,e)}[I(2844)](x,e=new S0){const t=I;return e[t(859)](this.v2,this.v1)[t(3762)]()}[I(2451)](x,e){return this.getTangent(x,e)}[I(1493)](x){const e=I;return super[e(1493)](x),this.v1[e(1493)](x.v1),this.v2[e(1493)](x.v2),this}[I(2054)](){const x=I,e=super[x(2054)]();return e.v1=this.v1[x(3904)](),e.v2=this.v2[x(3904)](),e}fromJSON(x){const e=I;return super[e(3385)](x),this.v1[e(2793)](x.v1),this.v2[e(2793)](x.v2),this}}class Qv extends Ug{constructor(x=new E,e=new E){const t=I;super(),this[t(2501)]=!0,this[t(3505)]=t(794),this.v1=x,this.v2=e}[I(695)](x,e=new E){const t=I,g=e;return x===1?g[t(1493)](this.v2):(g.copy(this.v2)[t(3938)](this.v1),g[t(2333)](x)[t(3014)](this.v1)),g}[I(3066)](x,e){return this[I(695)](x,e)}[I(2844)](x,e=new E){const t=I;return e[t(859)](this.v2,this.v1)[t(3762)]()}[I(2451)](x,e){return this[I(2844)](x,e)}copy(x){const e=I;return super.copy(x),this.v1[e(1493)](x.v1),this.v2[e(1493)](x.v2),this}[I(2054)](){const x=I,e=super[x(2054)]();return e.v1=this.v1[x(3904)](),e.v2=this.v2.toArray(),e}[I(3385)](x){const e=I;return super.fromJSON(x),this.v1[e(2793)](x.v1),this.v2[e(2793)](x.v2),this}}class Kf extends Ug{constructor(x=new S0,e=new S0,t=new S0){const g=I;super(),this[g(2583)]=!0,this[g(3505)]="QuadraticBezierCurve",this.v0=x,this.v1=e,this.v2=t}[I(695)](x,e=new S0){const t=I,g=e,n=this.v0,s=this.v1,o=this.v2;return g[t(298)](kc(x,n.x,s.x,o.x),kc(x,n.y,s.y,o.y)),g}[I(1493)](x){const e=I;return super[e(1493)](x),this.v0[e(1493)](x.v0),this.v1[e(1493)](x.v1),this.v2.copy(x.v2),this}[I(2054)](){const x=I,e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1[x(3904)](),e.v2=this.v2.toArray(),e}[I(3385)](x){const e=I;return super.fromJSON(x),this.v0[e(2793)](x.v0),this.v1[e(2793)](x.v1),this.v2[e(2793)](x.v2),this}}class Hf extends Ug{constructor(x=new E,e=new E,t=new E){const g=I;super(),this[g(3168)]=!0,this[g(3505)]=g(2353),this.v0=x,this.v1=e,this.v2=t}[I(695)](x,e=new E){const t=I,g=e,n=this.v0,s=this.v1,o=this.v2;return g[t(298)](kc(x,n.x,s.x,o.x),kc(x,n.y,s.y,o.y),kc(x,n.z,s.z,o.z)),g}copy(x){const e=I;return super.copy(x),this.v0.copy(x.v0),this.v1[e(1493)](x.v1),this.v2[e(1493)](x.v2),this}[I(2054)](){const x=I,e=super[x(2054)]();return e.v0=this.v0.toArray(),e.v1=this.v1[x(3904)](),e.v2=this.v2[x(3904)](),e}fromJSON(x){const e=I;return super[e(3385)](x),this.v0[e(2793)](x.v0),this.v1[e(2793)](x.v1),this.v2.fromArray(x.v2),this}}class Nf extends Ug{constructor(x=[]){const e=I;super(),this[e(3117)]=!0,this[e(3505)]=e(1621),this.points=x}[I(695)](x,e=new S0){const t=I,g=e,n=this[t(2630)],s=(n[t(2989)]-1)*x,o=Math[t(3143)](s),c=s-o,C=n[o===0?o:o-1],r=n[o],A=n[o>n[t(2989)]-2?n[t(2989)]-1:o+1],d=n[o>n[t(2989)]-3?n.length-1:o+2];return g[t(298)](Up(c,C.x,r.x,A.x,d.x),Up(c,C.y,r.y,A.y,d.y)),g}[I(1493)](x){const e=I;super[e(1493)](x),this.points=[];for(let t=0,g=x.points.length;t<g;t++){const n=x.points[t];this.points[e(3330)](n[e(3123)]())}return this}[I(2054)](){const x=I,e=super.toJSON();e.points=[];for(let t=0,g=this[x(2630)].length;t<g;t++){const n=this[x(2630)][t];e[x(2630)][x(3330)](n[x(3904)]())}return e}[I(3385)](x){const e=I;super[e(3385)](x),this[e(2630)]=[];for(let t=0,g=x[e(2630)].length;t<g;t++){const n=x[e(2630)][t];this[e(2630)][e(3330)](new S0()[e(2793)](n))}return this}}var n2=Object[I(776)]({__proto__:null,ArcCurve:Uv,CatmullRomCurve3:_v,CubicBezierCurve:Xf,CubicBezierCurve3:Dv,EllipseCurve:S2,LineCurve:Yf,LineCurve3:Qv,QuadraticBezierCurve:Kf,QuadraticBezierCurve3:Hf,SplineCurve:Nf});class Pv extends Ug{constructor(){const x=I;super(),this.type=x(3498),this.curves=[],this.autoClose=!1}[I(3014)](x){this[I(2818)].push(x)}[I(1867)](){const x=I,e=this[x(2818)][0].getPoint(0),t=this.curves[this[x(2818)][x(2989)]-1][x(695)](1);if(!e.equals(t)){const g=e[x(3856)]===!0?x(629):x(794);this[x(2818)].push(new n2[g](t,e))}return this}getPoint(x,e){const t=I,g=x*this[t(3729)](),n=this.getCurveLengths();let s=0;for(;s<n.length;){if(n[s]>=g){const o=n[s]-g,c=this[t(2818)][s],C=c[t(3729)](),r=C===0?0:1-o/C;return c[t(3066)](r,e)}s++}return null}getLength(){const x=I,e=this.getCurveLengths();return e[e[x(2989)]-1]}[I(3957)](){const x=I;this[x(2170)]=!0,this[x(2588)]=null,this[x(265)]()}[I(265)](){const x=I;if(this[x(2588)]&&this.cacheLengths[x(2989)]===this[x(2818)][x(2989)])return this[x(2588)];const e=[];let t=0;for(let g=0,n=this[x(2818)][x(2989)];g<n;g++)t+=this[x(2818)][g][x(3729)](),e[x(3330)](t);return this[x(2588)]=e,e}[I(249)](x=40){const e=I,t=[];for(let g=0;g<=x;g++)t[e(3330)](this[e(695)](g/x));return this.autoClose&&t[e(3330)](t[0]),t}getPoints(x=12){const e=I,t=[];let g;for(let n=0,s=this[e(2818)];n<s[e(2989)];n++){const o=s[n],c=o[e(1582)]?x*2:o[e(231)]||o[e(2501)]?1:o[e(3117)]?x*o[e(2630)][e(2989)]:x,C=o[e(527)](c);for(let r=0;r<C[e(2989)];r++){const A=C[r];g&&g[e(3106)](A)||(t[e(3330)](A),g=A)}}return this[e(1550)]&&t[e(2989)]>1&&!t[t[e(2989)]-1][e(3106)](t[0])&&t[e(3330)](t[0]),t}copy(x){const e=I;super[e(1493)](x),this[e(2818)]=[];for(let t=0,g=x[e(2818)][e(2989)];t<g;t++){const n=x[e(2818)][t];this[e(2818)][e(3330)](n[e(3123)]())}return this.autoClose=x[e(1550)],this}[I(2054)](){const x=I,e=super[x(2054)]();e[x(1550)]=this.autoClose,e[x(2818)]=[];for(let t=0,g=this[x(2818)].length;t<g;t++){const n=this[x(2818)][t];e[x(2818)].push(n[x(2054)]())}return e}[I(3385)](x){const e=I;super[e(3385)](x),this[e(1550)]=x[e(1550)],this.curves=[];for(let t=0,g=x[e(2818)][e(2989)];t<g;t++){const n=x[e(2818)][t];this.curves[e(3330)](new n2[n.type]()[e(3385)](n))}return this}}class mC extends Pv{constructor(x){const e=I;super(),this[e(3505)]=e(2424),this[e(2011)]=new S0,x&&this[e(1666)](x)}setFromPoints(x){const e=I;this[e(2048)](x[0].x,x[0].y);for(let t=1,g=x.length;t<g;t++)this[e(1132)](x[t].x,x[t].y);return this}[I(2048)](x,e){const t=I;return this.currentPoint[t(298)](x,e),this}[I(1132)](x,e){const t=I,g=new Yf(this.currentPoint[t(3123)](),new S0(x,e));return this.curves[t(3330)](g),this[t(2011)][t(298)](x,e),this}quadraticCurveTo(x,e,t,g){const n=I,s=new Kf(this.currentPoint.clone(),new S0(x,e),new S0(t,g));return this[n(2818)].push(s),this[n(2011)].set(t,g),this}[I(3673)](x,e,t,g,n,s){const o=I,c=new Xf(this.currentPoint[o(3123)](),new S0(x,e),new S0(t,g),new S0(n,s));return this.curves[o(3330)](c),this.currentPoint[o(298)](n,s),this}splineThru(x){const e=I,t=[this[e(2011)].clone()][e(534)](x),g=new Nf(t);return this.curves[e(3330)](g),this[e(2011)][e(1493)](x[x[e(2989)]-1]),this}arc(x,e,t,g,n,s){const o=I,c=this[o(2011)].x,C=this[o(2011)].y;return this[o(1975)](x+c,e+C,t,g,n,s),this}[I(1975)](x,e,t,g,n,s){return this[I(591)](x,e,t,t,g,n,s),this}[I(719)](x,e,t,g,n,s,o,c){const C=I,r=this[C(2011)].x,A=this[C(2011)].y;return this[C(591)](x+r,e+A,t,g,n,s,o,c),this}[I(591)](x,e,t,g,n,s,o,c){const C=I,r=new S2(x,e,t,g,n,s,o,c);if(this[C(2818)][C(2989)]>0){const d=r.getPoint(0);!d[C(3106)](this.currentPoint)&&this[C(1132)](d.x,d.y)}this[C(2818)][C(3330)](r);const A=r.getPoint(1);return this[C(2011)][C(1493)](A),this}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(2011)][e(1493)](x[e(2011)]),this}[I(2054)](){const x=I,e=super.toJSON();return e[x(2011)]=this[x(2011)][x(3904)](),e}[I(3385)](x){const e=I;return super[e(3385)](x),this[e(2011)][e(2793)](x[e(2011)]),this}}class LC extends vx{constructor(x=[new S0(0,-.5),new S0(.5,0),new S0(0,.5)],e=12,t=0,g=Math.PI*2){const n=I;super(),this.type=n(1009),this.parameters={points:x,segments:e,phiStart:t,phiLength:g},e=Math.floor(e),g=Ae(g,0,Math.PI*2);const s=[],o=[],c=[],C=[],r=[],A=1/e,d=new E,h=new S0,f=new E,B=new E,Z=new E;let G=0,m=0;for(let v=0;v<=x[n(2989)]-1;v++)switch(v){case 0:G=x[v+1].x-x[v].x,m=x[v+1].y-x[v].y,f.x=m*1,f.y=-G,f.z=m*0,Z.copy(f),f[n(3762)](),C[n(3330)](f.x,f.y,f.z);break;case x[n(2989)]-1:C[n(3330)](Z.x,Z.y,Z.z);break;default:G=x[v+1].x-x[v].x,m=x[v+1].y-x[v].y,f.x=m*1,f.y=-G,f.z=m*0,B.copy(f),f.x+=Z.x,f.y+=Z.y,f.z+=Z.z,f[n(3762)](),C.push(f.x,f.y,f.z),Z[n(1493)](B)}for(let v=0;v<=e;v++){const p=t+v*A*g,w=Math[n(1996)](p),V=Math[n(1563)](p);for(let N=0;N<=x[n(2989)]-1;N++){d.x=x[N].x*w,d.y=x[N].y,d.z=x[N].x*V,o.push(d.x,d.y,d.z),h.x=v/e,h.y=N/(x[n(2989)]-1),c[n(3330)](h.x,h.y);const X=C[3*N+0]*w,M=C[3*N+1],Y=C[3*N+0]*V;r[n(3330)](X,M,Y)}}for(let v=0;v<e;v++)for(let p=0;p<x[n(2989)]-1;p++){const w=p+v*x[n(2989)],V=w,N=w+x[n(2989)],X=w+x[n(2989)]+1,M=w+1;s.push(V,N,M),s[n(3330)](X,M,N)}this.setIndex(s),this[n(1236)](n(2817),new ix(o,3)),this.setAttribute("uv",new ix(c,2)),this[n(1236)](n(3204),new ix(r,3))}[I(1493)](x){const e=I;return super[e(1493)](x),this.parameters=Object[e(1859)]({},x.parameters),this}static[I(3385)](x){const e=I;return new LC(x.points,x[e(3526)],x[e(2064)],x[e(1453)])}}class X2 extends LC{constructor(x=1,e=1,t=4,g=8){const n=I,s=new mC;s[n(1975)](0,-e/2,x,Math.PI*1.5,0),s[n(1975)](0,e/2,x,0,Math.PI*.5),super(s[n(527)](t),g),this[n(3505)]="CapsuleGeometry",this[n(361)]={radius:x,length:e,capSegments:t,radialSegments:g}}static[I(3385)](x){const e=I;return new X2(x[e(3015)],x[e(2989)],x[e(3863)],x[e(3513)])}}class Y2 extends vx{constructor(x=1,e=32,t=0,g=Math.PI*2){const n=I;super(),this.type=n(2675),this.parameters={radius:x,segments:e,thetaStart:t,thetaLength:g},e=Math[n(1971)](3,e);const s=[],o=[],c=[],C=[],r=new E,A=new S0;o[n(3330)](0,0,0),c.push(0,0,1),C[n(3330)](.5,.5);for(let d=0,h=3;d<=e;d++,h+=3){const f=t+d/e*g;r.x=x*Math.cos(f),r.y=x*Math[n(1996)](f),o.push(r.x,r.y,r.z),c[n(3330)](0,0,1),A.x=(o[h]/x+1)/2,A.y=(o[h+1]/x+1)/2,C[n(3330)](A.x,A.y)}for(let d=1;d<=e;d++)s.push(d,d+1,0);this[n(3317)](s),this[n(1236)](n(2817),new ix(o,3)),this.setAttribute(n(3204),new ix(c,3)),this[n(1236)]("uv",new ix(C,2))}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static fromJSON(x){const e=I;return new Y2(x[e(3015)],x[e(3526)],x[e(1427)],x.thetaLength)}}class Ro extends vx{constructor(x=1,e=1,t=1,g=32,n=1,s=!1,o=0,c=Math.PI*2){const C=I;super(),this.type="CylinderGeometry",this[C(361)]={radiusTop:x,radiusBottom:e,height:t,radialSegments:g,heightSegments:n,openEnded:s,thetaStart:o,thetaLength:c};const r=this;g=Math[C(3143)](g),n=Math[C(3143)](n);const A=[],d=[],h=[],f=[];let B=0;const Z=[],G=t/2;let m=0;v(),s===!1&&(x>0&&p(!0),e>0&&p(!1)),this[C(3317)](A),this.setAttribute(C(2817),new ix(d,3)),this[C(1236)]("normal",new ix(h,3)),this[C(1236)]("uv",new ix(f,2));function v(){const w=C,V=new E,N=new E;let X=0;const M=(e-x)/t;for(let Y=0;Y<=n;Y++){const S=[],H=Y/n,O=H*(e-x)+x;for(let I0=0;I0<=g;I0++){const z=I0/g,b0=z*c+o,f0=Math[w(1996)](b0),G0=Math.cos(b0);N.x=O*f0,N.y=-H*t+G,N.z=O*G0,d[w(3330)](N.x,N.y,N.z),V[w(298)](f0,M,G0)[w(3762)](),h.push(V.x,V.y,V.z),f.push(z,1-H),S[w(3330)](B++)}Z.push(S)}for(let Y=0;Y<g;Y++)for(let S=0;S<n;S++){const H=Z[S][Y],O=Z[S+1][Y],I0=Z[S+1][Y+1],z=Z[S][Y+1];A[w(3330)](H,O,z),A[w(3330)](O,I0,z),X+=6}r.addGroup(m,X,0),m+=X}function p(w){const V=C,N=B,X=new S0,M=new E;let Y=0;const S=w===!0?x:e,H=w===!0?1:-1;for(let I0=1;I0<=g;I0++)d[V(3330)](0,G*H,0),h[V(3330)](0,H,0),f[V(3330)](.5,.5),B++;const O=B;for(let I0=0;I0<=g;I0++){const z=I0/g,b0=z*c+o,f0=Math[V(1563)](b0),G0=Math[V(1996)](b0);M.x=S*G0,M.y=G*H,M.z=S*f0,d.push(M.x,M.y,M.z),h[V(3330)](0,H,0),X.x=f0*.5+.5,X.y=G0*.5*H+.5,f.push(X.x,X.y),B++}for(let I0=0;I0<g;I0++){const z=N+I0,b0=O+I0;w===!0?A[V(3330)](b0,b0+1,z):A[V(3330)](b0+1,b0,z),Y+=3}r[V(184)](m,Y,w===!0?1:2),m+=Y}}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static[I(3385)](x){const e=I;return new Ro(x[e(2740)],x[e(3929)],x[e(2741)],x[e(3513)],x[e(3022)],x[e(1269)],x[e(1427)],x[e(171)])}}class K2 extends Ro{constructor(x=1,e=1,t=32,g=1,n=!1,s=0,o=Math.PI*2){const c=I;super(0,x,e,t,g,n,s,o),this.type=c(3531),this[c(361)]={radius:x,height:e,radialSegments:t,heightSegments:g,openEnded:n,thetaStart:s,thetaLength:o}}static[I(3385)](x){const e=I;return new K2(x[e(3015)],x[e(2741)],x[e(3513)],x[e(3022)],x[e(1269)],x[e(1427)],x.thetaLength)}}class kn extends vx{constructor(x=[],e=[],t=1,g=0){const n=I;super(),this[n(3505)]=n(143),this[n(361)]={vertices:x,indices:e,radius:t,detail:g};const s=[],o=[];c(g),r(t),A(),this[n(1236)](n(2817),new ix(s,3)),this.setAttribute("normal",new ix(s[n(1226)](),3)),this[n(1236)]("uv",new ix(o,2)),g===0?this[n(1083)]():this[n(2349)]();function c(v){const p=n,w=new E,V=new E,N=new E;for(let X=0;X<e[p(2989)];X+=3)f(e[X+0],w),f(e[X+1],V),f(e[X+2],N),C(w,V,N,v)}function C(v,p,w,V){const N=n,X=V+1,M=[];for(let Y=0;Y<=X;Y++){M[Y]=[];const S=v[N(3123)]().lerp(w,Y/X),H=p[N(3123)]()[N(3814)](w,Y/X),O=X-Y;for(let I0=0;I0<=O;I0++)I0===0&&Y===X?M[Y][I0]=S:M[Y][I0]=S[N(3123)]().lerp(H,I0/O)}for(let Y=0;Y<X;Y++)for(let S=0;S<2*(X-Y)-1;S++){const H=Math[N(3143)](S/2);S%2===0?(h(M[Y][H+1]),h(M[Y+1][H]),h(M[Y][H])):(h(M[Y][H+1]),h(M[Y+1][H+1]),h(M[Y+1][H]))}}function r(v){const p=n,w=new E;for(let V=0;V<s[p(2989)];V+=3)w.x=s[V+0],w.y=s[V+1],w.z=s[V+2],w[p(3762)]()[p(2333)](v),s[V+0]=w.x,s[V+1]=w.y,s[V+2]=w.z}function A(){const v=n,p=new E;for(let w=0;w<s.length;w+=3){p.x=s[w+0],p.y=s[w+1],p.z=s[w+2];const V=G(p)/2/Math.PI+.5,N=m(p)/Math.PI+.5;o[v(3330)](V,1-N)}B(),d()}function d(){const v=n;for(let p=0;p<o[v(2989)];p+=6){const w=o[p+0],V=o[p+2],N=o[p+4],X=Math.max(w,V,N),M=Math[v(1410)](w,V,N);X>.9&&M<.1&&(w<.2&&(o[p+0]+=1),V<.2&&(o[p+2]+=1),N<.2&&(o[p+4]+=1))}}function h(v){s[n(3330)](v.x,v.y,v.z)}function f(v,p){const w=v*3;p.x=x[w+0],p.y=x[w+1],p.z=x[w+2]}function B(){const v=n,p=new E,w=new E,V=new E,N=new E,X=new S0,M=new S0,Y=new S0;for(let S=0,H=0;S<s.length;S+=9,H+=6){p[v(298)](s[S+0],s[S+1],s[S+2]),w.set(s[S+3],s[S+4],s[S+5]),V.set(s[S+6],s[S+7],s[S+8]),X.set(o[H+0],o[H+1]),M[v(298)](o[H+2],o[H+3]),Y[v(298)](o[H+4],o[H+5]),N.copy(p).add(w)[v(3014)](V).divideScalar(3);const O=G(N);Z(X,H+0,p,O),Z(M,H+2,w,O),Z(Y,H+4,V,O)}}function Z(v,p,w,V){V<0&&v.x===1&&(o[p]=v.x-1),w.x===0&&w.z===0&&(o[p]=V/2/Math.PI+.5)}function G(v){return Math[n(435)](v.z,-v.x)}function m(v){const p=n;return Math[p(435)](-v.y,Math[p(3641)](v.x*v.x+v.z*v.z))}}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static[I(3385)](x){const e=I;return new kn(x.vertices,x[e(3110)],x[e(3015)],x[e(1279)])}}class H2 extends kn{constructor(x=1,e=0){const t=I,g=(1+Math[t(3641)](5))/2,n=1/g,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-g,0,-n,g,0,n,-g,0,n,g,-n,-g,0,-n,g,0,n,-g,0,n,g,0,-g,0,-n,g,0,-n,-g,0,n,g,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,x,e),this.type=t(201),this[t(361)]={radius:x,detail:e}}static fromJSON(x){const e=I;return new H2(x[e(3015)],x[e(2093)])}}const La=new E,ka=new E,au=new E,Ta=new xg;class Ov extends vx{constructor(x=null,e=1){const t=I;if(super(),this[t(3505)]=t(2251),this[t(361)]={geometry:x,thresholdAngle:e},x!==null){const n=Math[t(3395)](10,4),s=Math[t(1563)](YI*e),o=x[t(3268)](),c=x[t(2606)]("position"),C=o?o[t(3411)]:c[t(3411)],r=[0,0,0],A=["a","b","c"],d=new Array(3),h={},f=[];for(let B=0;B<C;B+=3){o?(r[0]=o.getX(B),r[1]=o[t(1829)](B+1),r[2]=o[t(1829)](B+2)):(r[0]=B,r[1]=B+1,r[2]=B+2);const{a:Z,b:G,c:m}=Ta;if(Z[t(2404)](c,r[0]),G[t(2404)](c,r[1]),m[t(2404)](c,r[2]),Ta[t(3943)](au),d[0]=Math[t(1008)](Z.x*n)+","+Math[t(1008)](Z.y*n)+","+Math[t(1008)](Z.z*n),d[1]=Math[t(1008)](G.x*n)+","+Math.round(G.y*n)+","+Math.round(G.z*n),d[2]=Math[t(1008)](m.x*n)+","+Math[t(1008)](m.y*n)+","+Math.round(m.z*n),!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let v=0;v<3;v++){const p=(v+1)%3,w=d[v],V=d[p],N=Ta[A[v]],X=Ta[A[p]],M=w+"_"+V,Y=V+"_"+w;Y in h&&h[Y]?(au[t(1760)](h[Y][t(3204)])<=s&&(f[t(3330)](N.x,N.y,N.z),f.push(X.x,X.y,X.z)),h[Y]=null):!(M in h)&&(h[M]={index0:r[v],index1:r[p],normal:au[t(3123)]()})}}for(const B in h)if(h[B]){const{index0:Z,index1:G}=h[B];La[t(2404)](c,Z),ka[t(2404)](c,G),f[t(3330)](La.x,La.y,La.z),f.push(ka.x,ka.y,ka.z)}this[t(1236)]("position",new ix(f,3))}}[I(1493)](x){const e=I;return super.copy(x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}}let HI=class extends mC{constructor(x){const e=I;super(x),this[e(296)]=gg(),this.type="Shape",this.holes=[]}[I(2879)](x){const e=I,t=[];for(let g=0,n=this.holes[e(2989)];g<n;g++)t[g]=this[e(1585)][g][e(527)](x);return t}[I(2555)](x){const e=I;return{shape:this[e(527)](x),holes:this[e(2879)](x)}}[I(1493)](x){const e=I;super[e(1493)](x),this[e(1585)]=[];for(let t=0,g=x[e(1585)].length;t<g;t++){const n=x[e(1585)][t];this[e(1585)][e(3330)](n[e(3123)]())}return this}[I(2054)](){const x=I,e=super[x(2054)]();e[x(296)]=this[x(296)],e.holes=[];for(let t=0,g=this.holes[x(2989)];t<g;t++){const n=this[x(1585)][t];e[x(1585)][x(3330)](n[x(2054)]())}return e}[I(3385)](x){const e=I;super.fromJSON(x),this[e(296)]=x[e(296)],this[e(1585)]=[];for(let t=0,g=x.holes[e(2989)];t<g;t++){const n=x[e(1585)][t];this[e(1585)][e(3330)](new mC()[e(3385)](n))}return this}};const gF={triangulate:function(i,x,e=2){const t=I,g=x&&x[t(2989)],n=g?x[0]*e:i[t(2989)];let s=qv(i,0,n,e,!0);const o=[];if(!s||s.next===s[t(3643)])return o;let c,C,r,A,d,h,f;if(g&&(s=oF(i,x,s,e)),i[t(2989)]>80*e){c=r=i[0],C=A=i[1];for(let B=e;B<n;B+=e)d=i[B],h=i[B+1],d<c&&(c=d),h<C&&(C=h),d>r&&(r=d),h>A&&(A=h);f=Math.max(r-c,A-C),f=f!==0?32767/f:0}return GC(s,o,e,c,C,f,0),o}};function qv(i,x,e,t,g){const n=I;let s,o;if(g===fF(i,x,e,t)>0)for(s=x;s<e;s+=t)o=_p(s,i[s],i[s+1],o);else for(s=e-t;s>=x;s-=t)o=_p(s,i[s],i[s+1],o);return o&&N2(o,o.next)&&(BC(o),o=o[n(890)]),o}function JI(i,x){const e=I;if(!i)return i;x||(x=i);let t=i,g;do if(g=!1,!t[e(2563)]&&(N2(t,t.next)||ce(t[e(3643)],t,t[e(890)])===0)){if(BC(t),t=x=t[e(3643)],t===t[e(890)])break;g=!0}else t=t[e(890)];while(g||t!==x);return x}function GC(i,x,e,t,g,n,s){const o=I;if(!i)return;!s&&n&&rF(i,t,g,n);let c=i,C,r;for(;i[o(3643)]!==i.next;){if(C=i[o(3643)],r=i[o(890)],n?nF(i,t,g,n):iF(i)){x[o(3330)](C.i/e|0),x[o(3330)](i.i/e|0),x.push(r.i/e|0),BC(i),i=r[o(890)],c=r[o(890)];continue}if(i=r,i===c){s?s===1?(i=IF(JI(i),x,e),GC(i,x,e,t,g,n,2)):s===2&&sF(i,x,e,t,g,n):GC(JI(i),x,e,t,g,n,1);break}}}function iF(i){const x=I,e=i.prev,t=i,g=i[x(890)];if(ce(e,t,g)>=0)return!1;const n=e.x,s=t.x,o=g.x,c=e.y,C=t.y,r=g.y,A=n<s?n<o?n:o:s<o?s:o,d=c<C?c<r?c:r:C<r?C:r,h=n>s?n>o?n:o:s>o?s:o,f=c>C?c>r?c:r:C>r?C:r;let B=g[x(890)];for(;B!==e;){if(B.x>=A&&B.x<=h&&B.y>=d&&B.y<=f&&qs(n,c,s,C,o,r,B.x,B.y)&&ce(B[x(3643)],B,B[x(890)])>=0)return!1;B=B.next}return!0}function nF(i,x,e,t){const g=I,n=i.prev,s=i,o=i.next;if(ce(n,s,o)>=0)return!1;const c=n.x,C=s.x,r=o.x,A=n.y,d=s.y,h=o.y,f=c<C?c<r?c:r:C<r?C:r,B=A<d?A<h?A:h:d<h?d:h,Z=c>C?c>r?c:r:C>r?C:r,G=A>d?A>h?A:h:d>h?d:h,m=oh(f,B,x,e,t),v=oh(Z,G,x,e,t);let p=i[g(3875)],w=i[g(1698)];for(;p&&p.z>=m&&w&&w.z<=v;){if(p.x>=f&&p.x<=Z&&p.y>=B&&p.y<=G&&p!==n&&p!==o&&qs(c,A,C,d,r,h,p.x,p.y)&&ce(p[g(3643)],p,p.next)>=0||(p=p.prevZ,w.x>=f&&w.x<=Z&&w.y>=B&&w.y<=G&&w!==n&&w!==o&&qs(c,A,C,d,r,h,w.x,w.y)&&ce(w[g(3643)],w,w[g(890)])>=0))return!1;w=w[g(1698)]}for(;p&&p.z>=m;){if(p.x>=f&&p.x<=Z&&p.y>=B&&p.y<=G&&p!==n&&p!==o&&qs(c,A,C,d,r,h,p.x,p.y)&&ce(p[g(3643)],p,p.next)>=0)return!1;p=p[g(3875)]}for(;w&&w.z<=v;){if(w.x>=f&&w.x<=Z&&w.y>=B&&w.y<=G&&w!==n&&w!==o&&qs(c,A,C,d,r,h,w.x,w.y)&&ce(w[g(3643)],w,w[g(890)])>=0)return!1;w=w[g(1698)]}return!0}function IF(i,x,e){const t=I;let g=i;do{const n=g.prev,s=g.next.next;!N2(n,s)&&$v(n,g,g[t(890)],s)&&pC(n,s)&&pC(s,n)&&(x[t(3330)](n.i/e|0),x.push(g.i/e|0),x[t(3330)](s.i/e|0),BC(g),BC(g.next),g=i=s),g=g[t(890)]}while(g!==i);return JI(g)}function sF(i,x,e,t,g,n){const s=I;let o=i;do{let c=o[s(890)][s(890)];for(;c!==o[s(3643)];){if(o.i!==c.i&&uF(o,c)){let C=jv(o,c);o=JI(o,o.next),C=JI(C,C[s(890)]),GC(o,x,e,t,g,n,0),GC(C,x,e,t,g,n,0);return}c=c.next}o=o[s(890)]}while(o!==i)}function oF(i,x,e,t){const g=I,n=[];let s,o,c,C,r;for(s=0,o=x[g(2989)];s<o;s++)c=x[s]*t,C=s<o-1?x[s+1]*t:i[g(2989)],r=qv(i,c,C,t,!1),r===r.next&&(r[g(2563)]=!0),n[g(3330)](AF(r));for(n.sort(cF),s=0;s<n[g(2989)];s++)e=CF(n[s],e);return e}function cF(i,x){return i.x-x.x}function CF(i,x){const e=I,t=lF(i,x);if(!t)return x;const g=jv(t,i);return JI(g,g[e(890)]),JI(t,t[e(890)])}function lF(i,x){const e=I;let t=x,g=-1/0,n;const s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t[e(890)].y!==t.y){const h=t.x+(o-t.y)*(t.next.x-t.x)/(t[e(890)].y-t.y);if(h<=s&&h>g&&(g=h,n=t.x<t[e(890)].x?t:t[e(890)],h===s))return n}t=t.next}while(t!==x);if(!n)return null;const c=n,C=n.x,r=n.y;let A=1/0,d;t=n;do s>=t.x&&t.x>=C&&s!==t.x&&qs(o<r?s:g,o,C,r,o<r?g:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),pC(t,i)&&(d<A||d===A&&(t.x>n.x||t.x===n.x&&aF(n,t)))&&(n=t,A=d)),t=t[e(890)];while(t!==c);return n}function aF(i,x){const e=I;return ce(i.prev,i,x[e(3643)])<0&&ce(x[e(890)],i,i[e(890)])<0}function rF(i,x,e,t){const g=I;let n=i;do n.z===0&&(n.z=oh(n.x,n.y,x,e,t)),n.prevZ=n[g(3643)],n[g(1698)]=n[g(890)],n=n[g(890)];while(n!==i);n[g(3875)][g(1698)]=null,n[g(3875)]=null,dF(n)}function dF(i){const x=I;let e,t,g,n,s,o,c,C,r=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,g=t,c=0,e=0;e<r&&(c++,g=g[x(1698)],!!g);e++);for(C=r;c>0||C>0&&g;)c!==0&&(C===0||!g||t.z<=g.z)?(n=t,t=t[x(1698)],c--):(n=g,g=g[x(1698)],C--),s?s[x(1698)]=n:i=n,n[x(3875)]=s,s=n;t=g}s[x(1698)]=null,r*=2}while(o>1);return i}function oh(i,x,e,t,g){return i=(i-e)*g|0,x=(x-t)*g|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,x=(x|x<<8)&16711935,x=(x|x<<4)&252645135,x=(x|x<<2)&858993459,x=(x|x<<1)&1431655765,i|x<<1}function AF(i){const x=I;let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e[x(890)];while(e!==i);return t}function qs(i,x,e,t,g,n,s,o){return(g-s)*(x-o)>=(i-s)*(n-o)&&(i-s)*(t-o)>=(e-s)*(x-o)&&(e-s)*(n-o)>=(g-s)*(t-o)}function uF(i,x){const e=I;return i[e(890)].i!==x.i&&i[e(3643)].i!==x.i&&!bF(i,x)&&(pC(i,x)&&pC(x,i)&&hF(i,x)&&(ce(i.prev,i,x.prev)||ce(i,x[e(3643)],x))||N2(i,x)&&ce(i[e(3643)],i,i.next)>0&&ce(x[e(3643)],x,x[e(890)])>0)}function ce(i,x,e){return(x.y-i.y)*(e.x-x.x)-(x.x-i.x)*(e.y-x.y)}function N2(i,x){return i.x===x.x&&i.y===x.y}function $v(i,x,e,t){const g=Ea(ce(i,x,e)),n=Ea(ce(i,x,t)),s=Ea(ce(e,t,i)),o=Ea(ce(e,t,x));return!!(g!==n&&s!==o||g===0&&Ja(i,e,x)||n===0&&Ja(i,t,x)||s===0&&Ja(e,i,t)||o===0&&Ja(e,x,t))}function Ja(i,x,e){const t=I;return x.x<=Math.max(i.x,e.x)&&x.x>=Math[t(1410)](i.x,e.x)&&x.y<=Math.max(i.y,e.y)&&x.y>=Math[t(1410)](i.y,e.y)}function Ea(i){return i>0?1:i<0?-1:0}function bF(i,x){const e=I;let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==x.i&&t[e(890)].i!==x.i&&$v(t,t[e(890)],i,x))return!0;t=t.next}while(t!==i);return!1}function pC(i,x){const e=I;return ce(i[e(3643)],i,i[e(890)])<0?ce(i,x,i[e(890)])>=0&&ce(i,i[e(3643)],x)>=0:ce(i,x,i[e(3643)])<0||ce(i,i[e(890)],x)<0}function hF(i,x){const e=I;let t=i,g=!1;const n=(i.x+x.x)/2,s=(i.y+x.y)/2;do t.y>s!=t.next.y>s&&t[e(890)].y!==t.y&&n<(t[e(890)].x-t.x)*(s-t.y)/(t[e(890)].y-t.y)+t.x&&(g=!g),t=t[e(890)];while(t!==i);return g}function jv(i,x){const e=I,t=new ch(i.i,i.x,i.y),g=new ch(x.i,x.x,x.y),n=i[e(890)],s=x[e(3643)];return i[e(890)]=x,x[e(3643)]=i,t[e(890)]=n,n[e(3643)]=t,g[e(890)]=t,t.prev=g,s[e(890)]=g,g.prev=s,g}function _p(i,x,e,t){const g=I,n=new ch(i,x,e);return t?(n.next=t.next,n.prev=t,t.next[g(3643)]=n,t.next=n):(n.prev=n,n[g(890)]=n),n}function BC(i){const x=I;i[x(890)][x(3643)]=i.prev,i.prev[x(890)]=i[x(890)],i[x(3875)]&&(i[x(3875)][x(1698)]=i[x(1698)]),i[x(1698)]&&(i[x(1698)].prevZ=i.prevZ)}function ch(i,x,e){const t=I;this.i=i,this.x=x,this.y=e,this[t(3643)]=null,this[t(890)]=null,this.z=0,this.prevZ=null,this[t(1698)]=null,this[t(2563)]=!1}function fF(i,x,e,t){let g=0;for(let n=x,s=e-t;n<e;n+=t)g+=(i[s]-i[n])*(i[n+1]+i[s+1]),s=n;return g}class ri{static[I(2120)](x){const e=x.length;let t=0;for(let g=e-1,n=0;n<e;g=n++)t+=x[g].x*x[n].y-x[n].x*x[g].y;return t*.5}static isClockWise(x){return ri.area(x)<0}static[I(2371)](x,e){const t=I,g=[],n=[],s=[];Dp(x),Qp(g,x);let o=x.length;e[t(1599)](Dp);for(let C=0;C<e[t(2989)];C++)n[t(3330)](o),o+=e[C][t(2989)],Qp(g,e[C]);const c=gF[t(3461)](g,n);for(let C=0;C<c[t(2989)];C+=3)s[t(3330)](c[t(1226)](C,C+3));return s}}function Dp(i){const x=I,e=i.length;e>2&&i[e-1][x(3106)](i[0])&&i[x(3604)]()}function Qp(i,x){const e=I;for(let t=0;t<x[e(2989)];t++)i.push(x[t].x),i[e(3330)](x[t].y)}class F2 extends vx{constructor(x=new HI([new S0(.5,.5),new S0(-.5,.5),new S0(-.5,-.5),new S0(.5,-.5)]),e={}){const t=I;super(),this[t(3505)]=t(221),this[t(361)]={shapes:x,options:e},x=Array[t(1987)](x)?x:[x];const g=this,n=[],s=[];for(let c=0,C=x[t(2989)];c<C;c++){const r=x[c];o(r)}this[t(1236)](t(2817),new ix(n,3)),this[t(1236)]("uv",new ix(s,2)),this[t(1083)]();function o(c){const C=t,r=[],A=e.curveSegments!==void 0?e[C(1158)]:12,d=e.steps!==void 0?e[C(1555)]:1,h=e[C(3936)]!==void 0?e[C(3936)]:1;let f=e[C(612)]!==void 0?e[C(612)]:!0,B=e[C(1041)]!==void 0?e.bevelThickness:.2,Z=e[C(1170)]!==void 0?e[C(1170)]:B-.1,G=e[C(1809)]!==void 0?e[C(1809)]:0,m=e[C(1908)]!==void 0?e[C(1908)]:3;const v=e[C(3724)],p=e[C(1989)]!==void 0?e.UVGenerator:mF;let w,V=!1,N,X,M,Y;v&&(w=v[C(249)](d),V=!0,f=!1,N=v.computeFrenetFrames(d,!1),X=new E,M=new E,Y=new E),!f&&(m=0,B=0,Z=0,G=0);const S=c.extractPoints(A);let H=S[C(2934)];const O=S[C(1585)];if(!ri.isClockWise(H)){H=H.reverse();for(let y0=0,V0=O[C(2989)];y0<V0;y0++){const H0=O[y0];ri[C(1954)](H0)&&(O[y0]=H0.reverse())}}const z=ri[C(2371)](H,O),b0=H;for(let y0=0,V0=O[C(2989)];y0<V0;y0++){const H0=O[y0];H=H[C(534)](H0)}function f0(y0,V0,H0){const Y0=C;return V0||console.error(Y0(1934)),y0[Y0(3123)]()[Y0(832)](V0,H0)}const G0=H[C(2989)],$=z[C(2989)];function j(y0,V0,H0){const Y0=C;let F0,$0,Q;const R=y0.x-V0.x,T=y0.y-V0.y,F=H0.x-y0.x,Z0=H0.y-y0.y,d0=R*R+T*T,w0=R*Z0-T*F;if(Math[Y0(447)](w0)>Number.EPSILON){const j0=Math[Y0(3641)](d0),L0=Math[Y0(3641)](F*F+Z0*Z0),J0=V0.x-T/j0,hx=V0.y+R/j0,U0=H0.x-Z0/L0,Cx=H0.y+F/L0,Rx=((U0-J0)*Z0-(Cx-hx)*F)/(R*Z0-T*F);F0=J0+R*Rx-y0.x,$0=hx+T*Rx-y0.y;const nx=F0*F0+$0*$0;if(nx<=2)return new S0(F0,$0);Q=Math.sqrt(nx/2)}else{let j0=!1;R>Number[Y0(2700)]?F>Number[Y0(2700)]&&(j0=!0):R<-Number.EPSILON?F<-Number.EPSILON&&(j0=!0):Math[Y0(1392)](T)===Math[Y0(1392)](Z0)&&(j0=!0),j0?(F0=-T,$0=R,Q=Math[Y0(3641)](d0)):(F0=R,$0=T,Q=Math[Y0(3641)](d0/2))}return new S0(F0/Q,$0/Q)}const x0=[];for(let y0=0,V0=b0[C(2989)],H0=V0-1,Y0=y0+1;y0<V0;y0++,H0++,Y0++)H0===V0&&(H0=0),Y0===V0&&(Y0=0),x0[y0]=j(b0[y0],b0[H0],b0[Y0]);const c0=[];let h0,X0=x0[C(534)]();for(let y0=0,V0=O[C(2989)];y0<V0;y0++){const H0=O[y0];h0=[];for(let Y0=0,F0=H0[C(2989)],$0=F0-1,Q=Y0+1;Y0<F0;Y0++,$0++,Q++)$0===F0&&($0=0),Q===F0&&(Q=0),h0[Y0]=j(H0[Y0],H0[$0],H0[Q]);c0[C(3330)](h0),X0=X0[C(534)](h0)}for(let y0=0;y0<m;y0++){const V0=y0/m,H0=B*Math[C(1563)](V0*Math.PI/2),Y0=Z*Math[C(1996)](V0*Math.PI/2)+G;for(let F0=0,$0=b0[C(2989)];F0<$0;F0++){const Q=f0(b0[F0],x0[F0],Y0);M0(Q.x,Q.y,-H0)}for(let F0=0,$0=O[C(2989)];F0<$0;F0++){const Q=O[F0];h0=c0[F0];for(let R=0,T=Q[C(2989)];R<T;R++){const F=f0(Q[R],h0[R],Y0);M0(F.x,F.y,-H0)}}}const n0=Z+G;for(let y0=0;y0<G0;y0++){const V0=f?f0(H[y0],X0[y0],n0):H[y0];V?(M[C(1493)](N[C(3172)][0])[C(2333)](V0.x),X[C(1493)](N[C(2254)][0])[C(2333)](V0.y),Y[C(1493)](w[0])[C(3014)](M)[C(3014)](X),M0(Y.x,Y.y,Y.z)):M0(V0.x,V0.y,0)}for(let y0=1;y0<=d;y0++)for(let V0=0;V0<G0;V0++){const H0=f?f0(H[V0],X0[V0],n0):H[V0];V?(M[C(1493)](N[C(3172)][y0])[C(2333)](H0.x),X[C(1493)](N.binormals[y0])[C(2333)](H0.y),Y[C(1493)](w[y0])[C(3014)](M).add(X),M0(Y.x,Y.y,Y.z)):M0(H0.x,H0.y,h/d*y0)}for(let y0=m-1;y0>=0;y0--){const V0=y0/m,H0=B*Math[C(1563)](V0*Math.PI/2),Y0=Z*Math.sin(V0*Math.PI/2)+G;for(let F0=0,$0=b0.length;F0<$0;F0++){const Q=f0(b0[F0],x0[F0],Y0);M0(Q.x,Q.y,h+H0)}for(let F0=0,$0=O[C(2989)];F0<$0;F0++){const Q=O[F0];h0=c0[F0];for(let R=0,T=Q[C(2989)];R<T;R++){const F=f0(Q[R],h0[R],Y0);V?M0(F.x,F.y+w[d-1].y,w[d-1].x+H0):M0(F.x,F.y,h+H0)}}}g0(),l0();function g0(){const y0=C,V0=n[y0(2989)]/3;if(f){let H0=0,Y0=G0*H0;for(let F0=0;F0<$;F0++){const $0=z[F0];bx($0[2]+Y0,$0[1]+Y0,$0[0]+Y0)}H0=d+m*2,Y0=G0*H0;for(let F0=0;F0<$;F0++){const $0=z[F0];bx($0[0]+Y0,$0[1]+Y0,$0[2]+Y0)}}else{for(let H0=0;H0<$;H0++){const Y0=z[H0];bx(Y0[2],Y0[1],Y0[0])}for(let H0=0;H0<$;H0++){const Y0=z[H0];bx(Y0[0]+G0*d,Y0[1]+G0*d,Y0[2]+G0*d)}}g.addGroup(V0,n[y0(2989)]/3-V0,0)}function l0(){const y0=C,V0=n[y0(2989)]/3;let H0=0;m0(b0,H0),H0+=b0[y0(2989)];for(let Y0=0,F0=O.length;Y0<F0;Y0++){const $0=O[Y0];m0($0,H0),H0+=$0[y0(2989)]}g.addGroup(V0,n[y0(2989)]/3-V0,1)}function m0(y0,V0){const H0=C;let Y0=y0[H0(2989)];for(;--Y0>=0;){const F0=Y0;let $0=Y0-1;$0<0&&($0=y0[H0(2989)]-1);for(let Q=0,R=d+m*2;Q<R;Q++){const T=G0*Q,F=G0*(Q+1),Z0=V0+F0+T,d0=V0+$0+T,w0=V0+$0+F,j0=V0+F0+F;C0(Z0,d0,w0,j0)}}}function M0(y0,V0,H0){r[C(3330)](y0),r.push(V0),r.push(H0)}function bx(y0,V0,H0){gx(y0),gx(V0),gx(H0);const Y0=n.length/3,F0=p.generateTopUV(g,n,Y0-3,Y0-2,Y0-1);ax(F0[0]),ax(F0[1]),ax(F0[2])}function C0(y0,V0,H0,Y0){const F0=C;gx(y0),gx(V0),gx(Y0),gx(V0),gx(H0),gx(Y0);const $0=n.length/3,Q=p[F0(2591)](g,n,$0-6,$0-3,$0-2,$0-1);ax(Q[0]),ax(Q[1]),ax(Q[3]),ax(Q[1]),ax(Q[2]),ax(Q[3])}function gx(y0){const V0=C;n[V0(3330)](r[y0*3+0]),n[V0(3330)](r[y0*3+1]),n[V0(3330)](r[y0*3+2])}function ax(y0){const V0=C;s.push(y0.x),s[V0(3330)](y0.y)}}}copy(x){const e=I;return super.copy(x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}[I(2054)](){const x=I,e=super[x(2054)](),t=this.parameters.shapes,g=this[x(361)].options;return GF(t,g,e)}static fromJSON(x,e){const t=I,g=[];for(let s=0,o=x[t(2386)][t(2989)];s<o;s++){const c=e[x[t(2386)][s]];g.push(c)}const n=x[t(1198)][t(3724)];return n!==void 0&&(x.options[t(3724)]=new n2[n[t(3505)]]().fromJSON(n)),new F2(g,x[t(1198)])}}const mF={generateTopUV:function(i,x,e,t,g){const n=x[e*3],s=x[e*3+1],o=x[t*3],c=x[t*3+1],C=x[g*3],r=x[g*3+1];return[new S0(n,s),new S0(o,c),new S0(C,r)]},generateSideWallUV:function(i,x,e,t,g,n){const s=x[e*3],o=x[e*3+1],c=x[e*3+2],C=x[t*3],r=x[t*3+1],A=x[t*3+2],d=x[g*3],h=x[g*3+1],f=x[g*3+2],B=x[n*3],Z=x[n*3+1],G=x[n*3+2];return Math.abs(o-r)<Math.abs(s-C)?[new S0(s,1-c),new S0(C,1-A),new S0(d,1-f),new S0(B,1-G)]:[new S0(o,1-c),new S0(r,1-A),new S0(h,1-f),new S0(Z,1-G)]}};function GF(i,x,e){const t=I;if(e[t(2386)]=[],Array.isArray(i))for(let g=0,n=i[t(2989)];g<n;g++){const s=i[g];e[t(2386)][t(3330)](s[t(296)])}else e.shapes[t(3330)](i.uuid);return e[t(1198)]=Object.assign({},x),x[t(3724)]!==void 0&&(e.options[t(3724)]=x[t(3724)].toJSON()),e}class z2 extends kn{constructor(x=1,e=0){const t=I,g=(1+Math.sqrt(5))/2,n=[-1,g,0,1,g,0,-1,-g,0,1,-g,0,0,-1,g,0,1,g,0,-1,-g,0,1,-g,g,0,-1,g,0,1,-g,0,-1,-g,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,s,x,e),this[t(3505)]=t(1228),this.parameters={radius:x,detail:e}}static[I(3385)](x){const e=I;return new z2(x[e(3015)],x.detail)}}class kC extends kn{constructor(x=1,e=0){const t=I,g=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(g,n,x,e),this[t(3505)]=t(1938),this.parameters={radius:x,detail:e}}static[I(3385)](x){const e=I;return new kC(x[e(3015)],x[e(2093)])}}class M2 extends vx{constructor(x=.5,e=1,t=32,g=1,n=0,s=Math.PI*2){const o=I;super(),this[o(3505)]="RingGeometry",this[o(361)]={innerRadius:x,outerRadius:e,thetaSegments:t,phiSegments:g,thetaStart:n,thetaLength:s},t=Math[o(1971)](3,t),g=Math[o(1971)](1,g);const c=[],C=[],r=[],A=[];let d=x;const h=(e-x)/g,f=new E,B=new S0;for(let Z=0;Z<=g;Z++){for(let G=0;G<=t;G++){const m=n+G/t*s;f.x=d*Math.cos(m),f.y=d*Math.sin(m),C.push(f.x,f.y,f.z),r[o(3330)](0,0,1),B.x=(f.x/e+1)/2,B.y=(f.y/e+1)/2,A.push(B.x,B.y)}d+=h}for(let Z=0;Z<g;Z++){const G=Z*(t+1);for(let m=0;m<t;m++){const v=m+G,p=v,w=v+t+1,V=v+t+2,N=v+1;c[o(3330)](p,w,N),c.push(w,V,N)}}this.setIndex(c),this[o(1236)](o(2817),new ix(C,3)),this[o(1236)](o(3204),new ix(r,3)),this[o(1236)]("uv",new ix(A,2))}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(361)]=Object.assign({},x[e(361)]),this}static[I(3385)](x){const e=I;return new M2(x.innerRadius,x.outerRadius,x[e(3706)],x.phiSegments,x.thetaStart,x.thetaLength)}}class L2 extends vx{constructor(x=new HI([new S0(0,.5),new S0(-.5,-.5),new S0(.5,-.5)]),e=12){const t=I;super(),this[t(3505)]=t(2701),this[t(361)]={shapes:x,curveSegments:e};const g=[],n=[],s=[],o=[];let c=0,C=0;if(Array[t(1987)](x)===!1)r(x);else for(let A=0;A<x[t(2989)];A++)r(x[A]),this.addGroup(c,C,A),c+=C,C=0;this[t(3317)](g),this[t(1236)](t(2817),new ix(n,3)),this.setAttribute(t(3204),new ix(s,3)),this[t(1236)]("uv",new ix(o,2));function r(A){const d=t,h=n[d(2989)]/3,f=A[d(2555)](e);let B=f.shape;const Z=f.holes;ri[d(1954)](B)===!1&&(B=B[d(3399)]());for(let m=0,v=Z[d(2989)];m<v;m++){const p=Z[m];ri[d(1954)](p)===!0&&(Z[m]=p[d(3399)]())}const G=ri[d(2371)](B,Z);for(let m=0,v=Z[d(2989)];m<v;m++){const p=Z[m];B=B[d(534)](p)}for(let m=0,v=B.length;m<v;m++){const p=B[m];n[d(3330)](p.x,p.y,0),s[d(3330)](0,0,1),o[d(3330)](p.x,p.y)}for(let m=0,v=G[d(2989)];m<v;m++){const p=G[m],w=p[0]+h,V=p[1]+h,N=p[2]+h;g[d(3330)](w,V,N),C+=3}}}copy(x){const e=I;return super.copy(x),this.parameters=Object[e(1859)]({},x.parameters),this}[I(2054)](){const x=I,e=super[x(2054)](),t=this[x(361)][x(2386)];return pF(t,e)}static[I(3385)](x,e){const t=I,g=[];for(let n=0,s=x[t(2386)].length;n<s;n++){const o=e[x.shapes[n]];g[t(3330)](o)}return new L2(g,x[t(1158)])}}function pF(i,x){const e=I;if(x[e(2386)]=[],Array[e(1987)](i))for(let t=0,g=i.length;t<g;t++){const n=i[t];x[e(2386)].push(n[e(296)])}else x[e(2386)][e(3330)](i[e(296)]);return x}class TC extends vx{constructor(x=1,e=32,t=16,g=0,n=Math.PI*2,s=0,o=Math.PI){const c=I;super(),this[c(3505)]=c(1656),this.parameters={radius:x,widthSegments:e,heightSegments:t,phiStart:g,phiLength:n,thetaStart:s,thetaLength:o},e=Math[c(1971)](3,Math[c(3143)](e)),t=Math[c(1971)](2,Math[c(3143)](t));const C=Math.min(s+o,Math.PI);let r=0;const A=[],d=new E,h=new E,f=[],B=[],Z=[],G=[];for(let m=0;m<=t;m++){const v=[],p=m/t;let w=0;m===0&&s===0?w=.5/e:m===t&&C===Math.PI&&(w=-.5/e);for(let V=0;V<=e;V++){const N=V/e;d.x=-x*Math[c(1563)](g+N*n)*Math[c(1996)](s+p*o),d.y=x*Math[c(1563)](s+p*o),d.z=x*Math[c(1996)](g+N*n)*Math[c(1996)](s+p*o),B[c(3330)](d.x,d.y,d.z),h[c(1493)](d)[c(3762)](),Z[c(3330)](h.x,h.y,h.z),G[c(3330)](N+w,1-p),v[c(3330)](r++)}A[c(3330)](v)}for(let m=0;m<t;m++)for(let v=0;v<e;v++){const p=A[m][v+1],w=A[m][v],V=A[m+1][v],N=A[m+1][v+1];(m!==0||s>0)&&f[c(3330)](p,w,N),(m!==t-1||C<Math.PI)&&f[c(3330)](w,V,N)}this[c(3317)](f),this[c(1236)](c(2817),new ix(B,3)),this[c(1236)](c(3204),new ix(Z,3)),this[c(1236)]("uv",new ix(G,2))}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(361)]=Object[e(1859)]({},x.parameters),this}static[I(3385)](x){const e=I;return new TC(x[e(3015)],x.widthSegments,x[e(3022)],x.phiStart,x[e(1453)],x.thetaStart,x[e(171)])}}class k2 extends kn{constructor(x=1,e=0){const t=I,g=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];super(g,n,x,e),this[t(3505)]=t(1374),this[t(361)]={radius:x,detail:e}}static fromJSON(x){const e=I;return new k2(x[e(3015)],x[e(2093)])}}class T2 extends vx{constructor(x=1,e=.4,t=12,g=48,n=Math.PI*2){const s=I;super(),this[s(3505)]=s(2020),this[s(361)]={radius:x,tube:e,radialSegments:t,tubularSegments:g,arc:n},t=Math.floor(t),g=Math[s(3143)](g);const o=[],c=[],C=[],r=[],A=new E,d=new E,h=new E;for(let f=0;f<=t;f++)for(let B=0;B<=g;B++){const Z=B/g*n,G=f/t*Math.PI*2;d.x=(x+e*Math.cos(G))*Math[s(1563)](Z),d.y=(x+e*Math.cos(G))*Math[s(1996)](Z),d.z=e*Math.sin(G),c.push(d.x,d.y,d.z),A.x=x*Math[s(1563)](Z),A.y=x*Math[s(1996)](Z),h[s(859)](d,A)[s(3762)](),C[s(3330)](h.x,h.y,h.z),r[s(3330)](B/g),r[s(3330)](f/t)}for(let f=1;f<=t;f++)for(let B=1;B<=g;B++){const Z=(g+1)*f+B-1,G=(g+1)*(f-1)+B-1,m=(g+1)*(f-1)+B,v=(g+1)*f+B;o[s(3330)](Z,G,v),o[s(3330)](G,m,v)}this[s(3317)](o),this[s(1236)](s(2817),new ix(c,3)),this[s(1236)](s(3204),new ix(C,3)),this[s(1236)]("uv",new ix(r,2))}[I(1493)](x){const e=I;return super.copy(x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static[I(3385)](x){const e=I;return new T2(x[e(3015)],x[e(627)],x[e(3513)],x.tubularSegments,x[e(874)])}}class J2 extends vx{constructor(x=1,e=.4,t=64,g=8,n=2,s=3){const o=I;super(),this.type=o(2867),this[o(361)]={radius:x,tube:e,tubularSegments:t,radialSegments:g,p:n,q:s},t=Math[o(3143)](t),g=Math[o(3143)](g);const c=[],C=[],r=[],A=[],d=new E,h=new E,f=new E,B=new E,Z=new E,G=new E,m=new E;for(let p=0;p<=t;++p){const w=p/t*n*Math.PI*2;v(w,n,s,x,f),v(w+.01,n,s,x,B),G[o(859)](B,f),m[o(3107)](B,f),Z[o(1604)](G,m),m.crossVectors(Z,G),Z[o(3762)](),m.normalize();for(let V=0;V<=g;++V){const N=V/g*Math.PI*2,X=-e*Math[o(1563)](N),M=e*Math[o(1996)](N);d.x=f.x+(X*m.x+M*Z.x),d.y=f.y+(X*m.y+M*Z.y),d.z=f.z+(X*m.z+M*Z.z),C[o(3330)](d.x,d.y,d.z),h[o(859)](d,f)[o(3762)](),r[o(3330)](h.x,h.y,h.z),A[o(3330)](p/t),A[o(3330)](V/g)}}for(let p=1;p<=t;p++)for(let w=1;w<=g;w++){const V=(g+1)*(p-1)+(w-1),N=(g+1)*p+(w-1),X=(g+1)*p+w,M=(g+1)*(p-1)+w;c[o(3330)](V,N,M),c.push(N,X,M)}this.setIndex(c),this[o(1236)](o(2817),new ix(C,3)),this[o(1236)](o(3204),new ix(r,3)),this[o(1236)]("uv",new ix(A,2));function v(p,w,V,N,X){const M=o,Y=Math[M(1563)](p),S=Math.sin(p),H=V/w*p,O=Math[M(1563)](H);X.x=N*(2+O)*.5*Y,X.y=N*(2+O)*S*.5,X.z=N*Math[M(1996)](H)*.5}}copy(x){const e=I;return super[e(1493)](x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}static[I(3385)](x){const e=I;return new J2(x[e(3015)],x[e(627)],x[e(3564)],x[e(3513)],x.p,x.q)}}class E2 extends vx{constructor(x=new Hf(new E(-1,-1,0),new E(-1,1,0),new E(1,1,0)),e=64,t=1,g=8,n=!1){const s=I;super(),this.type=s(3518),this[s(361)]={path:x,tubularSegments:e,radius:t,radialSegments:g,closed:n};const o=x[s(2305)](e,n);this[s(3781)]=o[s(3781)],this.normals=o[s(3172)],this.binormals=o.binormals;const c=new E,C=new E,r=new S0;let A=new E;const d=[],h=[],f=[],B=[];Z(),this[s(3317)](B),this[s(1236)](s(2817),new ix(d,3)),this[s(1236)](s(3204),new ix(h,3)),this[s(1236)]("uv",new ix(f,2));function Z(){for(let p=0;p<e;p++)G(p);G(n===!1?e:0),v(),m()}function G(p){const w=s;A=x.getPointAt(p/e,A);const V=o.normals[p],N=o[w(2254)][p];for(let X=0;X<=g;X++){const M=X/g*Math.PI*2,Y=Math[w(1996)](M),S=-Math[w(1563)](M);C.x=S*V.x+Y*N.x,C.y=S*V.y+Y*N.y,C.z=S*V.z+Y*N.z,C.normalize(),h[w(3330)](C.x,C.y,C.z),c.x=A.x+t*C.x,c.y=A.y+t*C.y,c.z=A.z+t*C.z,d[w(3330)](c.x,c.y,c.z)}}function m(){const p=s;for(let w=1;w<=e;w++)for(let V=1;V<=g;V++){const N=(g+1)*(w-1)+(V-1),X=(g+1)*w+(V-1),M=(g+1)*w+V,Y=(g+1)*(w-1)+V;B[p(3330)](N,X,Y),B[p(3330)](X,M,Y)}}function v(){const p=s;for(let w=0;w<=e;w++)for(let V=0;V<=g;V++)r.x=w/e,r.y=V/g,f[p(3330)](r.x,r.y)}}[I(1493)](x){const e=I;return super[e(1493)](x),this.parameters=Object[e(1859)]({},x[e(361)]),this}[I(2054)](){const x=I,e=super[x(2054)]();return e[x(3653)]=this.parameters[x(3653)][x(2054)](),e}static[I(3385)](x){const e=I;return new E2(new n2[x[e(3653)][e(3505)]]().fromJSON(x[e(3653)]),x[e(3564)],x[e(3015)],x[e(3513)],x[e(2379)])}}class x3 extends vx{constructor(x=null){const e=I;if(super(),this.type="WireframeGeometry",this[e(361)]={geometry:x},x!==null){const t=[],g=new Set,n=new E,s=new E;if(x[e(587)]!==null){const o=x[e(2593)][e(2817)],c=x.index;let C=x[e(919)];C[e(2989)]===0&&(C=[{start:0,count:c[e(3411)],materialIndex:0}]);for(let r=0,A=C[e(2989)];r<A;++r){const d=C[r],h=d.start,f=d[e(3411)];for(let B=h,Z=h+f;B<Z;B+=3)for(let G=0;G<3;G++){const m=c[e(1829)](B+G),v=c.getX(B+(G+1)%3);n[e(2404)](o,m),s[e(2404)](o,v),Pp(n,s,g)===!0&&(t[e(3330)](n.x,n.y,n.z),t.push(s.x,s.y,s.z))}}}else{const o=x[e(2593)][e(2817)];for(let c=0,C=o[e(3411)]/3;c<C;c++)for(let r=0;r<3;r++){const A=3*c+r,d=3*c+(r+1)%3;n[e(2404)](o,A),s[e(2404)](o,d),Pp(n,s,g)===!0&&(t[e(3330)](n.x,n.y,n.z),t.push(s.x,s.y,s.z))}}this[e(1236)](e(2817),new ix(t,3))}}[I(1493)](x){const e=I;return super.copy(x),this[e(361)]=Object[e(1859)]({},x[e(361)]),this}}function Pp(i,x,e){const t=I,g=i.x+","+i.y+","+i.z+"-"+x.x+","+x.y+","+x.z,n=x.x+","+x.y+","+x.z+"-"+i.x+","+i.y+","+i.z;return e[t(2489)](g)===!0||e[t(2489)](n)===!0?!1:(e[t(3014)](g),e[t(3014)](n),!0)}var Op=Object[I(776)]({__proto__:null,BoxGeometry:UI,CapsuleGeometry:X2,CircleGeometry:Y2,ConeGeometry:K2,CylinderGeometry:Ro,DodecahedronGeometry:H2,EdgesGeometry:Ov,ExtrudeGeometry:F2,IcosahedronGeometry:z2,LatheGeometry:LC,OctahedronGeometry:kC,PlaneGeometry:Wo,PolyhedronGeometry:kn,RingGeometry:M2,ShapeGeometry:L2,SphereGeometry:TC,TetrahedronGeometry:k2,TorusGeometry:T2,TorusKnotGeometry:J2,TubeGeometry:E2,WireframeGeometry:x3});class e3 extends lt{constructor(x){const e=I;super(),this[e(914)]=!0,this.type=e(2392),this[e(432)]=new Q0(0),this[e(3249)]=!0,this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(432)][e(1493)](x[e(432)]),this[e(1382)]=x[e(1382)],this}}class t3 extends Eg{constructor(x){const e=I;super(x),this[e(449)]=!0,this[e(3505)]=e(1836)}}class Ff extends lt{constructor(x){const e=I;super(),this.isMeshStandardMaterial=!0,this[e(3891)]={STANDARD:""},this[e(3505)]="MeshStandardMaterial",this[e(432)]=new Q0(16777215),this.roughness=1,this[e(1194)]=0,this.map=null,this[e(3997)]=null,this[e(899)]=1,this[e(2042)]=null,this[e(904)]=1,this[e(161)]=new Q0(0),this.emissiveIntensity=1,this[e(833)]=null,this[e(2210)]=null,this.bumpScale=1,this[e(2712)]=null,this.normalMapType=Mn,this[e(2733)]=new S0(1,1),this.displacementMap=null,this[e(2523)]=1,this.displacementBias=0,this[e(1372)]=null,this[e(2594)]=null,this.alphaMap=null,this.envMap=null,this[e(1043)]=new Tt,this[e(1639)]=1,this[e(2734)]=!1,this[e(1979)]=1,this[e(579)]=e(1008),this[e(1897)]=e(1008),this.flatShading=!1,this[e(1382)]=!0,this.setValues(x)}[I(1493)](x){const e=I;return super[e(1493)](x),this.defines={STANDARD:""},this[e(432)][e(1493)](x[e(432)]),this[e(1383)]=x[e(1383)],this[e(1194)]=x[e(1194)],this[e(3879)]=x[e(3879)],this[e(3997)]=x[e(3997)],this[e(899)]=x[e(899)],this[e(2042)]=x.aoMap,this.aoMapIntensity=x[e(904)],this.emissive[e(1493)](x[e(161)]),this[e(833)]=x[e(833)],this[e(747)]=x[e(747)],this.bumpMap=x[e(2210)],this[e(340)]=x.bumpScale,this.normalMap=x.normalMap,this[e(2308)]=x[e(2308)],this.normalScale[e(1493)](x.normalScale),this[e(1638)]=x.displacementMap,this[e(2523)]=x[e(2523)],this.displacementBias=x[e(977)],this[e(1372)]=x[e(1372)],this.metalnessMap=x[e(2594)],this[e(3709)]=x[e(3709)],this[e(1300)]=x[e(1300)],this[e(1043)][e(1493)](x[e(1043)]),this.envMapIntensity=x[e(1639)],this[e(2734)]=x[e(2734)],this[e(1979)]=x[e(1979)],this[e(579)]=x[e(579)],this[e(1897)]=x[e(1897)],this[e(280)]=x[e(280)],this.fog=x[e(1382)],this}}class g3 extends Ff{constructor(x){const e=I;super(),this[e(1755)]=!0,this[e(3891)]={STANDARD:"",PHYSICAL:""},this[e(3505)]="MeshPhysicalMaterial",this[e(1214)]=0,this[e(590)]=null,this.clearcoatMap=null,this[e(2893)]=0,this.clearcoatRoughnessMap=null,this[e(1402)]=new S0(1,1),this.clearcoatNormalMap=null,this[e(2592)]=1.5,Object.defineProperty(this,e(1695),{get:function(){return Ae(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){const g=e;this[g(2592)]=(1+.4*t)/(1-.4*t)}}),this[e(2374)]=null,this[e(3986)]=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this[e(179)]=new Q0(0),this[e(2416)]=null,this[e(2882)]=1,this[e(3990)]=null,this[e(3403)]=null,this.thickness=0,this[e(2200)]=null,this[e(1047)]=1/0,this[e(1207)]=new Q0(1,1,1),this[e(480)]=1,this[e(1499)]=null,this.specularColor=new Q0(1,1,1),this[e(1335)]=null,this[e(559)]=0,this._clearcoat=0,this[e(1415)]=0,this[e(2234)]=0,this[e(2624)]=0,this[e(512)]=0,this[e(3001)](x)}get[I(2651)](){return this._anisotropy}set[I(2651)](x){const e=I;this[e(559)]>0!=x>0&&this[e(1450)]++,this[e(559)]=x}get clearcoat(){return this._clearcoat}set clearcoat(x){const e=I;this[e(3964)]>0!=x>0&&this[e(1450)]++,this._clearcoat=x}get[I(3175)](){return this[I(2234)]}set[I(3175)](x){const e=I;this[e(2234)]>0!=x>0&&this[e(1450)]++,this[e(2234)]=x}get dispersion(){return this[I(1415)]}set[I(1625)](x){const e=I;this._dispersion>0!=x>0&&this[e(1450)]++,this[e(1415)]=x}get sheen(){return this[I(2624)]}set[I(691)](x){this[I(2624)]>0!=x>0&&this.version++,this._sheen=x}get[I(3820)](){return this._transmission}set transmission(x){const e=I;this._transmission>0!=x>0&&this[e(1450)]++,this[e(512)]=x}[I(1493)](x){const e=I;return super[e(1493)](x),this.defines={STANDARD:"",PHYSICAL:""},this[e(2651)]=x[e(2651)],this.anisotropyRotation=x[e(1214)],this[e(590)]=x[e(590)],this[e(3916)]=x[e(3916)],this.clearcoatMap=x[e(2539)],this[e(2893)]=x.clearcoatRoughness,this[e(241)]=x[e(241)],this.clearcoatNormalMap=x.clearcoatNormalMap,this.clearcoatNormalScale.copy(x[e(1402)]),this.dispersion=x[e(1625)],this[e(2592)]=x[e(2592)],this[e(3175)]=x.iridescence,this[e(2374)]=x.iridescenceMap,this[e(3986)]=x.iridescenceIOR,this[e(3739)]=[...x[e(3739)]],this.iridescenceThicknessMap=x.iridescenceThicknessMap,this[e(691)]=x[e(691)],this[e(179)][e(1493)](x[e(179)]),this.sheenColorMap=x[e(2416)],this.sheenRoughness=x[e(2882)],this.sheenRoughnessMap=x[e(3990)],this[e(3820)]=x[e(3820)],this.transmissionMap=x.transmissionMap,this.thickness=x[e(257)],this[e(2200)]=x[e(2200)],this.attenuationDistance=x.attenuationDistance,this[e(1207)][e(1493)](x[e(1207)]),this[e(480)]=x.specularIntensity,this[e(1499)]=x[e(1499)],this.specularColor[e(1493)](x[e(3525)]),this[e(1335)]=x[e(1335)],this}}class i3 extends lt{constructor(x){const e=I;super(),this.isMeshPhongMaterial=!0,this[e(3505)]="MeshPhongMaterial",this[e(432)]=new Q0(16777215),this[e(2204)]=new Q0(1118481),this.shininess=30,this[e(3879)]=null,this[e(3997)]=null,this[e(899)]=1,this[e(2042)]=null,this[e(904)]=1,this[e(161)]=new Q0(0),this.emissiveIntensity=1,this[e(833)]=null,this[e(2210)]=null,this[e(340)]=1,this.normalMap=null,this.normalMapType=Mn,this[e(2733)]=new S0(1,1),this[e(1638)]=null,this.displacementScale=1,this.displacementBias=0,this[e(2887)]=null,this.alphaMap=null,this[e(1300)]=null,this[e(1043)]=new Tt,this.combine=YC,this[e(1695)]=1,this[e(3241)]=.98,this[e(2734)]=!1,this.wireframeLinewidth=1,this[e(579)]=e(1008),this[e(1897)]=e(1008),this.flatShading=!1,this[e(1382)]=!0,this.setValues(x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(432)][e(1493)](x.color),this[e(2204)][e(1493)](x.specular),this[e(1169)]=x[e(1169)],this.map=x[e(3879)],this.lightMap=x[e(3997)],this.lightMapIntensity=x[e(899)],this[e(2042)]=x.aoMap,this[e(904)]=x[e(904)],this[e(161)].copy(x[e(161)]),this.emissiveMap=x[e(833)],this[e(747)]=x[e(747)],this[e(2210)]=x.bumpMap,this[e(340)]=x[e(340)],this.normalMap=x.normalMap,this[e(2308)]=x[e(2308)],this[e(2733)][e(1493)](x[e(2733)]),this[e(1638)]=x[e(1638)],this[e(2523)]=x[e(2523)],this.displacementBias=x[e(977)],this.specularMap=x[e(2887)],this[e(3709)]=x[e(3709)],this[e(1300)]=x.envMap,this[e(1043)].copy(x[e(1043)]),this[e(2667)]=x[e(2667)],this[e(1695)]=x[e(1695)],this[e(3241)]=x[e(3241)],this[e(2734)]=x[e(2734)],this[e(1979)]=x.wireframeLinewidth,this[e(579)]=x[e(579)],this[e(1897)]=x[e(1897)],this[e(280)]=x[e(280)],this[e(1382)]=x[e(1382)],this}}class n3 extends lt{constructor(x){const e=I;super(),this[e(2317)]=!0,this[e(3891)]={TOON:""},this.type="MeshToonMaterial",this[e(432)]=new Q0(16777215),this[e(3879)]=null,this[e(3023)]=null,this[e(3997)]=null,this[e(899)]=1,this[e(2042)]=null,this[e(904)]=1,this[e(161)]=new Q0(0),this[e(747)]=1,this[e(833)]=null,this.bumpMap=null,this[e(340)]=1,this[e(2712)]=null,this[e(2308)]=Mn,this[e(2733)]=new S0(1,1),this[e(1638)]=null,this.displacementScale=1,this[e(977)]=0,this.alphaMap=null,this.wireframe=!1,this[e(1979)]=1,this.wireframeLinecap="round",this.wireframeLinejoin=e(1008),this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super.copy(x),this.color[e(1493)](x[e(432)]),this[e(3879)]=x.map,this[e(3023)]=x[e(3023)],this[e(3997)]=x[e(3997)],this[e(899)]=x[e(899)],this[e(2042)]=x[e(2042)],this[e(904)]=x[e(904)],this.emissive[e(1493)](x[e(161)]),this[e(833)]=x[e(833)],this[e(747)]=x[e(747)],this[e(2210)]=x[e(2210)],this[e(340)]=x[e(340)],this.normalMap=x.normalMap,this[e(2308)]=x[e(2308)],this.normalScale.copy(x[e(2733)]),this[e(1638)]=x[e(1638)],this[e(2523)]=x.displacementScale,this[e(977)]=x[e(977)],this[e(3709)]=x.alphaMap,this.wireframe=x[e(2734)],this[e(1979)]=x.wireframeLinewidth,this[e(579)]=x[e(579)],this[e(1897)]=x.wireframeLinejoin,this[e(1382)]=x[e(1382)],this}}class I3 extends lt{constructor(x){const e=I;super(),this[e(827)]=!0,this[e(3505)]="MeshNormalMaterial",this[e(2210)]=null,this[e(340)]=1,this[e(2712)]=null,this[e(2308)]=Mn,this[e(2733)]=new S0(1,1),this.displacementMap=null,this[e(2523)]=1,this[e(977)]=0,this[e(2734)]=!1,this[e(1979)]=1,this.flatShading=!1,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(2210)]=x[e(2210)],this[e(340)]=x[e(340)],this[e(2712)]=x.normalMap,this.normalMapType=x[e(2308)],this.normalScale.copy(x[e(2733)]),this[e(1638)]=x.displacementMap,this[e(2523)]=x[e(2523)],this.displacementBias=x.displacementBias,this[e(2734)]=x[e(2734)],this[e(1979)]=x.wireframeLinewidth,this[e(280)]=x[e(280)],this}}class s3 extends lt{constructor(x){const e=I;super(),this.isMeshLambertMaterial=!0,this[e(3505)]="MeshLambertMaterial",this.color=new Q0(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this[e(2042)]=null,this.aoMapIntensity=1,this[e(161)]=new Q0(0),this[e(747)]=1,this[e(833)]=null,this[e(2210)]=null,this.bumpScale=1,this[e(2712)]=null,this[e(2308)]=Mn,this[e(2733)]=new S0(1,1),this[e(1638)]=null,this.displacementScale=1,this[e(977)]=0,this[e(2887)]=null,this.alphaMap=null,this[e(1300)]=null,this.envMapRotation=new Tt,this[e(2667)]=YC,this[e(1695)]=1,this[e(3241)]=.98,this[e(2734)]=!1,this[e(1979)]=1,this[e(579)]="round",this[e(1897)]=e(1008),this[e(280)]=!1,this[e(1382)]=!0,this.setValues(x)}copy(x){const e=I;return super[e(1493)](x),this.color[e(1493)](x[e(432)]),this[e(3879)]=x[e(3879)],this[e(3997)]=x[e(3997)],this[e(899)]=x[e(899)],this[e(2042)]=x[e(2042)],this[e(904)]=x.aoMapIntensity,this.emissive[e(1493)](x.emissive),this[e(833)]=x[e(833)],this[e(747)]=x[e(747)],this[e(2210)]=x[e(2210)],this[e(340)]=x[e(340)],this[e(2712)]=x.normalMap,this.normalMapType=x[e(2308)],this[e(2733)][e(1493)](x.normalScale),this[e(1638)]=x[e(1638)],this[e(2523)]=x.displacementScale,this[e(977)]=x.displacementBias,this[e(2887)]=x[e(2887)],this.alphaMap=x[e(3709)],this[e(1300)]=x[e(1300)],this[e(1043)].copy(x.envMapRotation),this[e(2667)]=x.combine,this[e(1695)]=x[e(1695)],this[e(3241)]=x.refractionRatio,this[e(2734)]=x[e(2734)],this.wireframeLinewidth=x.wireframeLinewidth,this.wireframeLinecap=x.wireframeLinecap,this[e(1897)]=x[e(1897)],this[e(280)]=x.flatShading,this.fog=x[e(1382)],this}}class o3 extends lt{constructor(x){const e=I;super(),this[e(908)]=!0,this[e(3891)]={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Q0(16777215),this.matcap=null,this.map=null,this[e(2210)]=null,this[e(340)]=1,this.normalMap=null,this.normalMapType=Mn,this[e(2733)]=new S0(1,1),this.displacementMap=null,this[e(2523)]=1,this.displacementBias=0,this.alphaMap=null,this[e(280)]=!1,this[e(1382)]=!0,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(3891)]={MATCAP:""},this.color.copy(x[e(432)]),this[e(126)]=x[e(126)],this[e(3879)]=x[e(3879)],this[e(2210)]=x[e(2210)],this[e(340)]=x[e(340)],this[e(2712)]=x.normalMap,this.normalMapType=x.normalMapType,this.normalScale.copy(x[e(2733)]),this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this[e(977)]=x[e(977)],this[e(3709)]=x[e(3709)],this[e(280)]=x[e(280)],this[e(1382)]=x[e(1382)],this}}class c3 extends vt{constructor(x){const e=I;super(),this.isLineDashedMaterial=!0,this.type=e(3921),this.scale=1,this[e(1361)]=3,this[e(1835)]=1,this[e(3001)](x)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(623)]=x[e(623)],this[e(1361)]=x.dashSize,this.gapSize=x[e(1835)],this}}function wI(i,x,e){const t=I;return!i||!e&&i[t(135)]===x?i:typeof x.BYTES_PER_ELEMENT=="number"?new x(i):Array.prototype.slice[t(2627)](i)}function C3(i){return ArrayBuffer[I(2780)](i)&&!(i instanceof DataView)}function l3(i){const x=I;function e(n,s){return i[n]-i[s]}const t=i[x(2989)],g=new Array(t);for(let n=0;n!==t;++n)g[n]=n;return g[x(3609)](e),g}function Ch(i,x,e){const t=I,g=i[t(2989)],n=new i[t(135)](g);for(let s=0,o=0;o!==g;++s){const c=e[s]*x;for(let C=0;C!==x;++C)n[o++]=i[c+C]}return n}function zf(i,x,e,t){const g=I;let n=1,s=i[0];for(;s!==void 0&&s[t]===void 0;)s=i[n++];if(s===void 0)return;let o=s[t];if(o!==void 0)if(Array[g(1987)](o))do o=s[t],o!==void 0&&(x.push(s[g(1163)]),e[g(3330)][g(1307)](e,o)),s=i[n++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[t],o!==void 0&&(x[g(3330)](s[g(1163)]),o[g(3904)](e,e[g(2989)])),s=i[n++];while(s!==void 0);else do o=s[t],o!==void 0&&(x[g(3330)](s[g(1163)]),e[g(3330)](o)),s=i[n++];while(s!==void 0)}function BF(i,x,e,t,g=30){const n=I,s=i.clone();s[n(1474)]=x;const o=[];for(let C=0;C<s[n(421)].length;++C){const r=s[n(421)][C],A=r[n(871)](),d=[],h=[];for(let f=0;f<r[n(985)].length;++f){const B=r.times[f]*g;if(!(B<e||B>=t)){d[n(3330)](r.times[f]);for(let Z=0;Z<A;++Z)h[n(3330)](r[n(2326)][f*A+Z])}}d[n(2989)]!==0&&(r[n(985)]=wI(d,r[n(985)].constructor),r[n(2326)]=wI(h,r[n(2326)].constructor),o[n(3330)](r))}s[n(421)]=o;let c=1/0;for(let C=0;C<s.tracks[n(2989)];++C)c>s.tracks[C][n(985)][0]&&(c=s[n(421)][C][n(985)][0]);for(let C=0;C<s[n(421)][n(2989)];++C)s[n(421)][C][n(214)](-1*c);return s[n(192)](),s}function ZF(i,x=0,e=i,t=30){const g=I;t<=0&&(t=30);const n=e.tracks[g(2989)],s=x/t;for(let o=0;o<n;++o){const c=e[g(421)][o],C=c[g(2203)];if(C===g(2262)||C==="string")continue;const r=i[g(421)][g(3553)](function(m){const v=g;return m[v(1474)]===c[v(1474)]&&m[v(2203)]===C});if(r===void 0)continue;let A=0;const d=c[g(871)]();c[g(935)][g(188)]&&(A=d/3);let h=0;const f=r[g(871)]();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const B=c.times.length-1;let Z;if(s<=c[g(985)][0]){const m=A,v=d-A;Z=c[g(2326)][g(1226)](m,v)}else if(s>=c[g(985)][B]){const m=B*d+A,v=m+d-A;Z=c.values.slice(m,v)}else{const m=c[g(935)](),v=A,p=d-A;m[g(1962)](s),Z=m.resultBuffer[g(1226)](v,p)}C===g(3915)&&new ot().fromArray(Z)[g(3762)]()[g(3597)]()[g(3904)](Z);const G=r[g(985)][g(2989)];for(let m=0;m<G;++m){const v=m*f+h;if(C===g(3915))ot[g(1375)](r[g(2326)],v,Z,0,r.values,v);else{const p=f-h*2;for(let w=0;w<p;++w)r[g(2326)][v+w]-=Z[w]}}}return i.blendMode=bf,i}const yF={convertArray:wI,isTypedArray:C3,getKeyframeOrder:l3,sortedArray:Ch,flattenJSON:zf,subclip:BF,makeClipAdditive:ZF};function I2(){const i=["clearViewOffset","300 es","color(","useTransition","addColors","setCrossOrigin","setEvents","HRTF","uniforms","onBeforeInput","total","toArray","forwards","stencilRef","startsWith","vertexUv1s","http://www.w3.org/1999/xhtml","VALIDATE_STATUS","setMediaElementSource","getObjectByProperty",`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,"cameraR","quaternion","clearcoat","isQuaternion",`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,` float;
	precision `,"clamp","LineDashedMaterial","return","ONE_MINUS_DST_COLOR","setFromRotationMatrix","SPHERE","_nActiveActions","_setValue_direct_setNeedsUpdate","componentDidUpdate","radiusBottom","outputColorSpace","setColorAt","bones","pointerenter","_addIndex","boxMax","depth","translateY","sub","blendSrc","arraybuffer","_setValue_unbound","_context","getNormal","LinearSRGBToLinearDisplayP3","SHADOWMAP_TYPE_VSM","aabbQuery","updateProjectionMatrix","isWebGLCubeRenderTarget","UNPACK_ALIGNMENT","Backspace","setMasterVolume","seeked","transitionend","FLOAT","preparePortalMount","depthStencilTexture","updateArcLengths","THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.","unstable_ImmediatePriority","eventObject","scissorTest","RG32F","#define ANISOTROPYMAP_UV ","_clearcoat","getContextAttributes","audio","linearFactor","disableVertexAttribArray","MEDIUM_FLOAT","filmGauge","invalidate","pointShadowMatrix","UNSAFE_componentWillUpdate","EXT_texture_filter_anisotropic","compute","filmOffset","THREE.Color: Unknown color ","wheelDeltaX","OpenGL ES","normalMapObjectSpace","zoom","BufferGeometry","port1","isTexture","isObject3D","iridescenceIOR","download","start","distanceToSphere","sheenRoughnessMap",`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,"Profiler","findBoundingRects","disable","CONVEXPOLYHEDRON","EllipseCurve","lightMap","updateRenderState","numSpotLightShadows",`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,"shaderCache","drop",`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,"multiDrawElementsInstancedWEBGL","#define textureCubeGradEXT textureGrad","added","scrollContainers","COMPRESSED_RGBA_ASTC_8x5_KHR","NeedsUpdate","halfWidth","vertexColors","defaultSelected","Audio","matcap","log2","_lerpAdditive","depthWrite","closestPointToPoint","Transition","tangent","clipAction","uniformMatrix3fv","constructor","getFirstHydratableChildWithinContainer","PolarGridHelper","idCounter","blurSamples","RGBA4","THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.","ratechange","PolyhedronGeometry","COMPRESSED_RGBA_ASTC_5x5_KHR",`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,"_mixer","setAllowSleep","translateZ","precision ","#define CLEARCOATMAP_UV ","alphaTest",`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,"#define USE_LOGDEPTHBUF","entanglements","THREE.KeyframeTrack: Out of order keys.","setVolume","rawListeners","firstBaseUpdate","clippingState","applyAxisAngle","emissive","propertyIndex","getLengths","setDrawingBufferSize","planes","physical","eventTime","vertexAttrib3fv","retryLane","ConcurrentRoot","thetaLength","totalSize","displacementMapTransform","clock","_setValue_array","eyeSep","accumulateAdditive","lengthSquared","sheenColor","image/jpeg","updateCamera","drawRanges","MIRRORED_REPEAT","addGroup","materialCache","mult","componentWillUpdate","isInterpolantFactoryMethodGLTFCubicSpline","getObjectForDistance","flushPassiveEffects","wheelDeltaY","resetDuration","animationiteration","setTime","defaultAttributeValues","http://www.w3.org/2000/svg","#elif defined( USE_COLOR )","setScissor","axisIndex","lerpVectors","DodecahedronGeometry","removeListener","cancelTimeout","onBeforeShadow","MAX_VARYING_VECTORS","unstable_pauseExecution","removeChild","Objects are not valid as a React child (found: ","toon","tension","crossFadeTo","Pause","worker","shift",`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,"setMask","screenX","BYTES_PER_ELEMENT","distanceModel","pointerId","ExtrudeGeometry","HemisphereLightHelper","#define METALNESSMAP_UV ","#define USE_SIZEATTENUATION","UNSIGNED_INT","isPlaying","domElement",`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,"	attribute vec3 color;","#define texture2DProjLodEXT textureProjLod","isLineCurve","allowSleep","flipY","unbind","BOX","outputEncoding","_setIdentity","getFilmHeight","_cacheIndex","camera","clearcoatRoughnessMap","anisotropyVector","translateX","setCollisionResponse","skinWeight","unstable_NormalPriority","isPrimaryRenderer","sheenRoughnessMapUv","getSpacedPoints","compositionupdate focusout keydown keypress keyup mousedown","mode","setGeometryAt","setRequestHeader","autoUpdate","aria-","AxesHelper","thickness","supportsVertexTextures","releaseStatesOfGeometry","intersectWorld","auto","power","useEffect","getFirstHydratableChild","getCurveLengths","autoClearStencil","createRenderbuffer","message","pointerup","ZXY","_controlInterpolants","BatchedMesh","hasAngularVelocity","collapsed","numRectAreaLights","updateBoundingSphereRadius","#define USE_SHEEN","pause","transmissionMapTransform","flatShading","#define USE_COLOR","formAction","uniform4f","supportsFiber","navigator","onCompositionStart","customSort","componentWillMount","extend","interpolation","last","_onChange",`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,"pendingLanes","__reactContainer$","uuid","isPointsMaterial","set","isMatrix4","_visibilityChanged","THREE.WebGLRenderer: A WebGL context could not be created. Reason: ","morphTargetsCount","preserveAlpha","numPointLights","BLEND","setAxisAngleFromQuaternion","#extension GL_ANGLE_multi_draw : require","GREATER","numDirLights","pointLights","default","getState","http://www.w3.org/1999/xlink","blending","array","morphTargetsRelative","preventDefault","__reactHandles$","copyPosition","defaultValue","lerpHSL","morphTextureStride","offsetTable","allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope","setFunc","getContext","multiply","sphereInitialized","transitions","numDirectionalShadows","vertexAttrib2fv",`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,"replace","dataReady","DEPTH_ATTACHMENT","addContactMaterial","isZero","memory","colorWrite","bumpScale",`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,"setValue",`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,"determinant","curveType","getAABB","_currentLevel","Error creating WebGL context with your selected attributes.","webkit","UNPACK_PREMULTIPLY_ALPHA_WEBGL","geometry","textures","_intersectTrimesh","WEBKIT_EXT_texture_filter_anisotropic","boundingSphereRadius","#define DITHERING","userData","focusNode","endShadows","parameters","#define USE_INSTANCING_COLOR","readyState","hideTextInstance","itemSize","coordinateSystem","subscribe_","keyCode","instance","tel","THREE.ObjectLoader: Undefined texture","bindBufferBase","order","#define AOMAP_UV ","depthPacking","shadowNormalBias","diffuse","PerspectiveCamera","POLYGON_OFFSET_FILL","isInputPending","InterpolantFactoryMethodSmooth","instancingMorph","_cachedIndex","componentDidCatch","BackgroundCubeMaterial","endingEnd","#define MORPHTARGETS_TEXTURE_STRIDE ","__hasExternalTextures","quadraticCurveTo","findFiberRoot","#define USE_SHADOWMAP","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","computeBoundingSphereRadius() not implemented for shape type ","link","enumerable","setVisibleAt","#define USE_INSTANCING_MORPH","setReferenceSpaceType","blendAlpha","getConvexTrianglePillar",`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,"directionalShadowMap","hitFaceIndex","setSleepSpeedLimit","vertexCount","hydrateInstance","ZXZ","clearSuspenseBoundary","focusin",`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,"UNPACK_SKIP_ROWS","url","meshtoon_frag","DEPTH_COMPONENT32F","interaction","MAX_VERTEX_ATTRIBS","opaque","_computeIntersections","#define USE_IRIDESCENCE_THICKNESSMAP","COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR","tracks","rayQuery","focusout","wheelDelta","roughnessMapTransform","commitTextUpdate","unsubscribe_","getVisibleAt","_select","acquireProgram","hitPointWorld","color","getOwnPropertyDescriptors",`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,"atan2","THREE.KeyframeTrack: Unsupported typeName: ",`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,"delta","interleaved","flipEnvMap","_removeInactiveAction","projectOnVector","autoplay","emissiveMapUv","__webglFramebuffer","mediaStreamNode","abs","COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR","isRawShaderMaterial","previousAttach","uniformsList","#define texture2D texture","_lendBinding","selectionStart","depthSegments",`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,"global",'The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ',"1418487negKJw","setFromBufferAttribute","uniform4iv","framebufferTexture2DMultisampleEXT","setFixedRotation","clearcoatNormalMapTransform","isData3DTexture","updateMatrix","_isActiveAction","createTextSelector","setColorName","tail","wrapT","json","panner","attribute vec2 uv;","		attribute vec3 morphNormal3;","getViewport",`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,"setFocusIfFocusable","threshold","specularIntensity","SpotLight","isLineLoop","Mesh","DirectionalLight","memoizedState","defaultPrevented","getChildContext","childadded","getVertex","baseState","referencePosition","polygonOffset","ELEMENT_ARRAY_BUFFER","internal","directionalShadowMatrix","deleteRenderbuffer","focusOffset","_removeInactiveBindingsForAction",`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`,"data-engine","	uniform sampler2D morphTexture;","dragenter","UNSIGNED_INT_24_8","eventTimes","removeFromParent","onChange","THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.","wakeUp","parameterPositions","isArrayCamera","DEFAULT_UP","_transmission","_accuIndex","RGB9_E5","spotLightMatrix","RGB","addRange","pointInTriangle","attemptHydrationAtCurrentPriority","faceNormals","toFixed","namespaceURI","cumulativeWeightAdditive","extensionMultiDraw","setFromProjectionMatrix","toggle","getPoints","_takeBackControlInterpolant","shadowBias","pointToLocalFrame",`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,"identity","attributeDivisors","concat","morphTargets","colorspace_pars_fragment","setClearColor",`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,"RED","aStartAngle","skinning","linejoin","unstable_UserBlockingPriority","onPointerMissed","element","KEEP","uniform mat3 normalMatrix;","stop","mediump","ArrowHelper","lastIndexOf","Cylinder","getStyle","srgb","calculateWorldAABB() not implemented for shape type ","subscribers","has no shadow.","setColors","_anisotropy","getHSL","mediaNode","setAxisIndex","_deactivateAction","Webkit","animationend"," at ","toneMappingExposure","LINEAR_MIPMAP_NEAREST","index is out of range: ","convertLinearToSRGB","Mode","toneMapped","color-profile","exp","<script><\/script>","alpha","isSpriteMaterial"," listeners ","wireframeLinecap","rendering","key","getMaxPrecision","mutableReadLanes","enableConstraintMotor","getShaderPrecisionFormat","unstable_wrapCallback","index","Linear","currentTarget","anisotropyMap","absellipse","copyFramebufferToTexture","morphAttributes","mipInt","setProperty","cloneElement","once","referenceCount","finished","( vec4 value ) { return ","targetContainers","SCISSOR_BOX","commitMount",'fetch for "',"bindBuffer","createObjectURL","eventCount","uniformMatrix2fv","isWebGLRenderer","setupView","Text","bevelEnabled","makeRotation","toDataURL","jointName","THREE.KeyframeTrack: no keyframes in track named ","currentTime","PointCloud","react.profiler","_setValue_arrayElement_setMatrixWorldNeedsUpdate","_setValue_array_setMatrixWorldNeedsUpdate","clearStencil","scale","naturalWidth","bindAttribLocation",".quaternion","tube","lightProbe","LineCurve","cumulativeWeight","_propertyBindings","ENVMAP_MODE_REFRACTION","sheenColorMapTransform","digest","bindMatrix","depthFar","unstable_renderSubtreeIntoContainer","transmissionSamplerSize","#define FOG_EXP2","#define DECODE_VIDEO_TEXTURE","alternate","morphNormals","Animation","updateRanges","setLinearDamping",'The "emitter" argument must be of type EventEmitter. Received type ',"maxTextures","divideScalar",`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,"intersectsSprite",`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,"callbackNode","domEventName","auxclick","getY","fromCubemap","jsx","isVector4","isPureReactComponent","MAX_TEXTURE_IMAGE_UNITS","contentEditable","solve","THREE.WebGLProgram: Unsupported color space:","spotShadow","parentWindow","_offsetPrev","probe","priority","clearGroups","getPublicInstance","font-face-src","cache","coneOuterGain","spotLights","setY","getBoundingBoxAt","COMPRESSED_RGB8_ETC2","findNode","setGlobalState","createContext","setRenderTarget","onEnded"," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively","setCount","_initMemoryManager","for","MAX_UNIFORM_BUFFER_BINDINGS","isNaN","setReferenceSpace","drawImage","sheen",`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,"bindFramebuffer","thumb-tip","getPoint","spotLightMap","roundToZero","dangerouslySetInnerHTML","__reactFiber$","expirationTime","UNPACK_ROW_LENGTH","modelViewMatrix",`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,"state","shadowRadius","#define USE_ALPHAHASH","iterations","#ifdef USE_SKINNING","isMeshDepthMaterial","_order","uniform3fv","clearContainer","blendFuncSeparate","linedashed_vert","bindTexture","isPointLight","_weightPrev","vertices","ellipse","iframe","vertex","_nActiveControlInterpolants","COMPRESSED_SRGB8_ETC2","internalFormat",`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,"translateOnAxis",'BatchedMesh: Added geometry missing "',"dashed","isMaterial","COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT","deferredUpdates","seqWithValue","vertexTangents","TransitionEnd","Naive","tailMode","_scheduleFading","vertexAttribDivisor","		attribute vec3 morphTarget7;","THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()","lerpColors","_cache","_progress","updateMatrices","#define MORPHTARGETS_TEXTURE","emissiveIntensity","uniform1f","THREE.WebGLRenderer: ","UNPACK_FLIP_Y_WEBGL","thicknessMapUv","collideBegin","drawRange","window","getShaderParameter","TEXTURE_MAX_ANISOTROPY_EXT","TEXTURE_CUBE_MAP","lightsStateVersion","aEndAngle","setTolerance","isFog","vertexStart",`
Error generating stack: `,"makeRotationFromQuaternion",`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,"blur","linecap","bindSkeletons","orientationX","__default","getReferenceSpace","dehydrated","nodeType","UNPACK_SKIP_IMAGES","lifespan","freeze","backgroundCube","div","settings","onMouseEnter","RGBA16F","XYZ","COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR","R3F: the args prop must be an array!","raycast","textureTypeReadable","clampPoint","DST_COLOR","touchend","unstable_getCurrentPriorityLevel","DEFAULT_MATERIAL_NAME","RGBA","RENDERBUFFER","LineCurve3","_origIndex","convert","CLOSEST","setMaxListeners","specularIntensityMapUv","setOptional","bottom","_setAdditiveIdentityNumeric","isFloat16BufferAttribute","makeTranslation","THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.","orientation","makeOrthographic","THREE.ImageBitmapLoader: createImageBitmap() not supported.","#ifdef USE_UV3","angularVelocity","deleteGeometry","COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR","ALL","LINE_LOOP","SuspenseList","raycaster","getShaderSource","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","shiftTable","spot","R16UI","unstable_shouldYield","attributeNamespace","suspendedLanes","refDistance","_workInProgressVersionSecondary","isMeshNormalMaterial","setRolloffFactor","mask","_updateWeight","abort","addScaledVector","emissiveMap","rotateTowards","byteLength","always","setVelocity","arr","THREE.Quaternion: .setFromEuler() encountered an unknown order: ","unit","repetitions","XZX","inputsourceschange","dragexit","react-dom","blendDstAlpha","react.portal","Over","texImage2D","useId","getFrequencyData","getRefDistance","RG32UI","implementation",`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,"pillarConvex","faces","#define gl_FragDepthEXT gl_FragDepth","subVectors","calculateLocalInertia","wrapS","COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR","specularColorMapTransform","18.3.1-next-f1338f8080-20240426","_multiDrawCount","18.3.1","_effectiveTimeScale","nextSibling","enabledAttributes","poleAxis","getValueSize","offset","atan","arc","onScroll","findDOMNode","depth_frag","getCenter","stores","RED_INTEGER","intersectBodies","cube_frag",`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,"priorityLevel","XZY","texStorage3D","groupOrder","queue","COMPRESSED_RGBA_ASTC_5x4_KHR","next","_currentValue","UNSIGNED_SHORT_4_4_4_4","target.depthTexture not supported in Cube render targets","	attribute vec2 uv2;","#define USE_CLEARCOAT","localClippingEnabled","addGeometry","_intersectConvex","lightMapIntensity","MAX_COMBINED_TEXTURE_IMAGE_UNITS","pingCache","pointer","stencilWrite","aoMapIntensity","done","boxInitialized","_sceneToCubeUV","isMeshMatcapMaterial","types","treeContext","unhideTextInstance","THREE.KeyframeTrack: Invalid value size in track.","TimeBufferType","isShadowMaterial","setRaycastVehicleBrake","perObjectFrustumCulled","dialog","onFocus","groups","maxVertexCount","exception","end",":has(","setInterpolation","parseFromString","blendEquationAlpha","UNSAFE_componentWillMount","_stringRef","cn3","customFragmentShaderID","muted","performance","clipping","callback","createInterpolant","_indicesByUUID","xml:base","updater","parseTextures","getFilter","backgroundCube_frag","onended","unstable_requestPaint","MatrixWorldNeedsUpdate","#define PREMULTIPLIED_ALPHA","setFoveation","compositionupdate","render","frame","RG16I","Insert","meshmatcap_vert","fogDensity","getBarycoord","batching","isBufferGeometry","#define LIGHTMAP_UV ","keys","isMeshDistanceMaterial","#define LEGACY_LIGHTS","makeRotationX","point","group","#define DISPLACEMENTMAP_UV ","sizeAttenuation","groundColor","transform","create","MAX_TEXTURE_SIZE","parsedPath","27827150iPqDwU","data-testname","onRecoverableError","CULL_FACE","customDistanceMaterial","listener","displacementBias","now","contextType","isCamera","substring","THREE.PropertyBinding: Can not bind to material as node does not have a material.","nCachedObjects_","Plane","times","extensions","_geometryCount","unstable_continueExecution","isBox2","iridescenceMapUv",`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,"hasEagerState","_status","makePerspective","multiDrawArraysInstancedWEBGL","compare","animation",".Provider","worldToLocal","setQuaternion","BatchedMesh: Maximum geometry count reached.","onCompositionUpdate",`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,"pointToWorldFrame","unpackAlignment","toLocalFrame","__THREE__","round","LatheGeometry","checked","object","RGBA8",`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,"filters","detectedPlanes","randomDirection","lastRenderedReducer","resizeObserver","size","changes","lightPlane","focusable","THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType.","xlinkHref","number","requestVideoFrameCallback","DEPTH24_STENCIL8","geometries","_bindAction","getRolloffFactor","isAnimationObjectGroup","setFromCoplanarPoints","increase limit","boundary","cancel","LINEAR","isScene","embed","setSleepTimeLimit","CubicBezierCurve3","bevelThickness","onmessage","envMapRotation","traverse","#define SHADER_NAME ","POINTS","attenuationDistance","onPointerOut","shapeOrientations",` int;
	precision `,"bumpMapTransform","useDeferredValue","FUNC_ADD","altKey","setupLightsView","extractBasis","setState",`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,` isampler2D;
	precision `,"DEFAULT_MAPPING","#define USE_UV2","#ifdef USE_TANGENT","getChildHostContext","parent","hasAttribute","BatchedMesh: Reserved space request exceeds the maximum buffer size.","mousemove","instanceMatrix","defaultView","ONE_MINUS_SRC_ALPHA","INT","_cubeDirections","applyLocalImpulse","Minified React error #","trace","resolve","drawElementsInstanced","isVideoTexture","sRGBToLinear","_nActiveBindings","meshmatcap_frag","THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.","computeVertexNormals","selector.role","objectName","manager","transmissionRenderTarget","THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733.","reduce","STENCIL_BUFFER_BIT","PMREM.Background","cross","after","specularmap","filter","getComponent","usedTimes","cancelAnimationFrame","DEPTH_COMPONENT","messageQueue","normalizeFast","stencilMask","iridescenceMapTransform","floatView","autoClear","setRotationFromQuaternion","catch","detached","[object Object]","pos","validate","makeRotationFromEuler","ValueBufferType","pushLight","click","saveOriginalState","getRenderTarget","sleep","beforeblur","submit","createGain","THREE.Audio: Audio is already playing.","uniform2uiv","call to abstract method","drawArraysInstanced","function","application/javascript","setFromMatrixScale","propertyIsEnumerable","createPortal","frustumCulled","lineTo","stateNode","intersectLine","setStart","http://www.w3.org/XML/1998/namespace","ENVMAP_TYPE_CUBE_UV","DEPTH_STENCIL_ATTACHMENT","fullHeight","lastEvent","insertInContainerBefore","__currentAnisotropy","objects",` sampler2DShadow;
	precision `,"directionalLength","isPoints","interpolate_","unsubscribe","httpEquiv","releaseShaderCache","distanceSqToSegment","getReader","body","locale","primaries","toWorldFrame","backwards","curveSegments","setupLights","	#else","userAgent","frames","time","discreteUpdates","LegacyRoot","commitUpdate","requestAnimationFrame","crossFadeFrom","shininess","bevelSize","Depth Texture with cube render targets is not supported","mouseout","findByName","DehydratedFragment",`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,"getW","	#ifdef USE_MORPHNORMALS","ALWAYS","blendDst","#define DOUBLE_SIDED","gpuType","bindMatrixInverse","WEBGL_depth_texture","intersect"," react-mount-point-unstable ","getViewSize","drag","[DEPRECATED] Please use `subscribeWithSelector` middleware","shadow_pass","memo","COMPRESSED_RGBA_ASTC_12x12_KHR","overflow","equirect_frag","metalness","overlaps","textInput",`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,"options","mapUv","removeAllListeners","lostpointercapture","directionalShadow","_startTime","flatMap","_byClipCacheIndex","commitHydratedContainer","attenuationColor","normalMatrix","return (function() ",'][type="radio"]',"eagerState",`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,"LESS","anisotropyRotation","polygonOffsetUnits","removeEventListener","match","hydrateSuspenseInstance","isEuler",`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,"unknown","connect","TEXTURE_COMPARE_FUNC","instanceColor","lowp","slice","unstable_Profiling","IcosahedronGeometry","BufferGeometry.toJSON","unproject","primitive","useMultisampledRTT","noTimeout",'" responded with ',"$&/","setAttribute","isFogExp2","forwardX","castShadow","onAnimationIteration","contentWindow","aoMapUv",'The value of "n" is out of range. It must be a non-negative number. Received ',"distanceRGBA","_matricesTexture","sphereCenter",`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,"parseAnimations","onBuild","_intersectHeightfield","copyArray","isValid","ray","COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT","display-p3","DEFAULT_IMAGE","#define USE_ALPHATEST","skipBackfaces","envMapMode","identifierPrefix","cacheArcLengths","OrthographicCamera","sibling","unstable_IdlePriority","broadphase","defineProperties","setTimeout","mouseup","openEnded","shadowCameraNear","cf4","THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.","SkinnedMesh","_localRoot","naturalHeight","NONE","getSize","numIntersection","details","instanceId","screenY"," not supported yet.","alphaToCoverage","NEAREST_MIPMAP_NEAREST","isWebGLRenderTarget","splineThru","isReactComponent","_intersectBox","THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.","firstChild","setFrictionGravity","R8UI","blendMode","uniformMatrix4fv","aClockwise",`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,"compileCubemapShader","intersectSphere","__data","envMap","_bounds","fov","isEmpty","calls","isSkinnedMesh","getUniformLocation","apply","toneMapping","isRenderTargetTexture","viewport","LinearDisplayP3ToLinearSRGB","_getValue_toArray","disableAll","response","isPropagationStopped","transfer","THREE.WebGLRenderer: Unsupported uniform value type.","THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.","terminate","getPixelRatio","_validateGeometry","hasHit","ACTIVE_UNIFORMS","_setValue_fromArray_setNeedsUpdate","uniform","applyMatrix3","unstable_now","nodeValue","href","yRadius","timeoutHandle","loopEnd","WEBKIT_WEBGL_compressed_texture_pvrtc","getSelection","specularColorMap","vectorToWorldFrame","None","THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ","onProgress","THREE.SkinnedMesh: Unrecognized bindMode: ",`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,"tolerance","uniform3iv","joints","compositionend focusout keydown keypress keyup mousedown","SpotLightHelper","uniform3f","levels","hovered",'The "listener" argument must be of type Function. Received type ',"deltaX","children"," keyframe track named ","setDrawRange","THREE.WebGLState: Invalid blending: ","scrollTop","removeAttribute","texSubImage2D","DST_ALPHA","rayFromWorld","dashSize","setClearAlpha","#define BUMPMAP_UV ","removeContactMaterial","createMediaStreamSource","Alt","child","meshbasic_vert","debounce","COMPARE_REF_TO_TEXTURE","sortObjects","roughnessMap","isWebGL3DRenderTarget","TetrahedronGeometry","multiplyQuaternionsFlat","_bindingsIndicesByPath","ForwardRef","ENVMAP_BLENDING_MIX","getViewerPose","img","#define USE_LIGHTMAP","fog","roughness","isLOD","137194cSxjBf","unstable_runWithPriority","#define USE_POINTS_UV","trim","colorMask","setRotation","THREE.WebXRManager: Cannot change reference space type while presenting.","sign","Tab","shadowMapSize","currentProgram","resetAfterCommit","clearcoatRoughnessMapUv","registerSuspenseInstanceRetry","_objects","shouldComponentUpdate","firstContext","clearcoatNormalScale","radio","_bindingsByRootAndName","box","hideInstance","far","isLight","offsetHeight","min","transformDirection","emit","uniform2iv","srgb-linear","_dispersion","rgb(","Object3D","multiplyMatrices","scene","THREE.AnimationObjectGroup: Different objects with the same UUID ","rendererExtensionParallelShaderCompile","uniform bool isOrthographic;","__DEFAULT","ambientLightColor","uv1","multiplyQuaternions","thetaStart","mipmapCount","_effectiveWeight","unbindTexture",`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,"delete","applyNormalMatrix",`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,"RG8I","setXY","baseTable",`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,"dispose","addScalar",`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,"xRadius","THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided","squeeze","getActiveMipmapLevel","compareFunction","onLostPointerCapture","_setValue_fromArray_setMatrixWorldNeedsUpdate","metalnessMapUv","version","toReference","cssFloat","phiLength","face","isOrthographicCamera","destroy","dispatchEvent","&args[]=","THREE.AnimationClip: No animation in JSONLoader data.","rgb","dependencies","setColor","#ifdef USE_UV1","objectIndex","https://reactjs.org/docs/error-decoder.html?invariant="," - ","triangles","removed","same-origin","execUnsafeLocalFunction","getMaxScaleOnAxis","enableConstraint","setComponent","name","disableConstraint","debug","FRAMEBUFFER","boneTexture","KHR_parallel_shader_compile","lights","addr","isDisabled","fragment","high-performance","fromScene","effects","		attribute vec3 morphNormal1;","rotation","cf2","__offset","DEFAULT_MATRIX_WORLD_AUTO_UPDATE","FUNC_REVERSE_SUBTRACT","copy","lengthSq","traverseVisible","product","halfHeight","toNonIndexed","specularIntensityMap","defaultChecked","DEPTH_BUFFER_BIT","leave","LineSegments","setUsage","roughnessMapUv","vertexUv2s","isAlreadyRendering","getValue","isPresenting","addRay","hemi","together","#define USE_IRIDESCENCE","compileAsync","PropertyBinding: Cannot parse trackName: ","playbackRate","COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT"," for the full message or use the non-minified dev environment for full errors and additional helpful warnings.","getObjectByName","_weightInterpolant","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","AudioListener","STENCIL_TEST","clearColor","_reactInternals","mutableSourceEagerHydrationData","MAX_TEXTURE_MAX_ANISOTROPY_EXT","cn2","pointToLocal","getEffectiveTimeScale","penumbra","Composite","framebufferTexture2D","TEXTURE_COMPARE_MODE","getArea","parseImagesAsync","getPrototypeOf","Children","makeXRCompatible","setRotationFromMatrix","_getValue_array","THREE.WebGLRenderer:","touchstart","relatedTarget","onMouseDownCapture","ArrowRight","_reservedRanges","lastEffect","colorSpace","autoClose","frequencyBinCount","pointMap","		attribute vec3 morphNormal2;","lastChild","steps","numPointLightShadows",`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,"computeTangents",`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,"_addInactiveAction",`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,"MeshDistanceMaterial","cos","listenerCount","responseType","prototype","WEBGL_clip_cull_distance",'". All geometries must have consistent attributes.',"hydrateTextInstance","#define USE_DISPERSION","Warning:","centripetal","disableConstraintMotor","stack","setPath","useRef","setFromMatrixPosition","#define USE_SHEEN_ROUGHNESSMAP","startTransition",'THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.',"onUpdate","isEllipseCurve","wrap","documentElement","holes","getUtoTmapping","postMessage"," samples when the maximum is set to ","normalMapUv","meshbasic_frag","getAabbAtIndex","COMPRESSED_SRGB_S3TC_DXT1_EXT","closestPointToPointParameter",`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,"environmentIntensity","$$typeof","tan","THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached.","forEach","bind","setIsTrigger","copyTexSubImage2D","prepareStackTrace","crossVectors","isSphericalHarmonics3","#ifdef USE_INSTANCING_MORPH","removeConstraint","Moz","getDerivedStateFromError","stopped","projectOnPlane","clampWhenFinished","MOZ_WEBGL_depth_texture",`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,"t2D","clearcoatMapUv","rotateZ","setViewOffset","#define texture2DGradEXT textureGrad","vec3 ","SplineCurve","isSphere","tagName","elementSize","dispersion","hsla","setTest","password",`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,"numPointShadows","cameraAutoUpdate","setFromVector3","halt","isUniformsGroup","attributesNum","onMouseUp","_takeBackAction","displacementMap","envMapIntensity","_setSize","MaxListenersExceededWarning","unstable_getFirstCallbackNode","loop","fallback","addHandler","seq","autoRemovedBeforeAppend","newAttributes","_targetRay","onAnimationEnd","__bindingPointIndex","THREE.Audio: this Audio has no playback control.","setMaxDistance",'BatchedMesh: Geometry cannot use attribute "',"CLAMP_TO_EDGE","SphereGeometry","THREE.Object3D.add: object not an instance of THREE.Object3D.","_blur","_interpolantSettings","setEnd","precision","THREE.KeyframeTrack:","change click focusin focusout input keydown keyup selectionchange","useSyncExternalStore","autoStart","setFromPoints","updateMorphTargets","computeBoundingSphere","compose","numSpotShadows","createTestNameSelector","copySampleValue_","setDirection","Points","#define OPAQUE","usage","dragleave","DefaultSettings_","isXRRenderTarget","sortIndex",` sampler2DArrayShadow;
	precision `,"useDebugValue",`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,"distanceToPlane","contains","rendererPackageName","renderMultiDrawInstances","drawElements","#define USE_INSTANCING","morphTargetBaseInfluence","transition","alphaMapUv","pointermove","lane","reflectivity","maxIndexCount","clearBufferiv","nextZ","logarithmicDepthBuffer","never","updateContainer","onPointerMove","statusMessage","COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR","#define USE_CLEARCOAT_ROUGHNESSMAP","batchingTexture","intensity","getIndexOfPosition","PARTICLE","_grip","setRotationFromAxisAngle","SRGB8_ALPHA8","weight","AgX","rowSpan","computeBoneTexture","THREE.WebGLProgram: Program Info Log:","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange","#define USE_THICKNESSMAP","style","matrix","inject","X-File-Size","getInstanceCountAt","applyRaycastVehicleEngineForce","setRaycastVehicleSteeringValue","vsub","store",` usampler2D;
	precision `,"createTextInstance","getModifierState","mouseover","webglcontextrestored","orientationHandler","autoReverse","_loopCount","_setAdditiveIdentityOther","shadow","scalar","#define THICKNESSMAP_UV ","DELETED","isShaderMaterial","instancing","uvTransform","renderTarget.depthTexture must be an instance of THREE.DepthTexture","COMPRESSED_RGBA_S3TC_DXT5_EXT","#define EMISSIVEMAP_UV ","navigationStart","#define TONE_MAPPING","removeBodies","event","meshtoon_vert","flushSync","isBatchedMesh","isMeshPhysicalMaterial","sampleValues","getInstanceFromNode","deleteProgram","lightMapUv","dot","makeScale","tEquirect","clippingPlanes","#define USE_TRANSMISSIONMAP","setDuration","getUniforms","THREE.KeyframeTrack: Time is not a valid number.","setFromMatrix3","reportIntersection","hemiLength","getVolume","clearcoatNormalMapUv","Curve","jointRadius","THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.",`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,"clearDepth","getClearColor","computeLineDistances","pendingChildren","image","Out","pointercancel","Box3Helper","wheel","autoClearColor","#define varying in","collisionResponse","Component","_bindings","LINE_STRIP","return;","onMouseMoveCapture","aomap","beforeinput","arcLengthDivisions","undefined","_slerp","xml:lang","YZX","manhattanDistanceTo","unmount","slerpFlat","setStyle","headers","ContinuousEventPriority","WCOD","SpriteMaterial","bevelOffset","mmult","scrollLeft","join","removeChildFromContainer","renderbufferStorage","returnValue","blendEquationSeparate","COMPRESSED_RGBA_ASTC_8x8_KHR","constant","popstate","eventNames","IdleEventPriority","flipSided","_maxListeners","isAntiparallelTo","THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.","metaKey","events","elapsedTime","getX","table","loadAsync","metadata","_paths","releaseStatesOfProgram","gapSize","RawShaderMaterial","move","getBoundingSphereAt","equ","penumbraCos","manual","setup","uncache","SRC_ALPHA_SATURATE","childremoved","setViewport","local-floor","isCompressedTexture","WEBGL_lose_context","PageDown","UNIT_Y","finishedWork","getGripSpace","setFromObject","setHSL","numLightProbes",`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,"_updateTimeScale","assign","select",`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,"onMouseDown","THREE.BoxHelper: .update() has no longer arguments.","#define SPECULAR_COLORMAP_UV ","_getValue_direct","#extension GL_ANGLE_clip_cull_distance : require","closePath","ENVMAP_TYPE_CUBE",`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,"FogExp2","root","( value ) ); }","isRunning","	attribute vec2 uv1;","THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()","__webglColorRenderbuffer","reset",'THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.',"basic","fromCharCode","clearcoatNormalMap","suppressHydrationWarning","LTC_HALF_1","COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR","mass","9jcOpYK","canHydrateInstance","BYTE","#define USE_UV3","isRenderTarget","pending","isColor","renderingStartTime","normalized","current","deleteShader","wireframeLinejoin","COLOR_ATTACHMENT0","depthBuffer","setPlaybackRate","uncacheRoot","createBufferSource","framebufferWidth","iridescenceThicknessMap","setFocalLength","ZYZ","unshift","bevelSegments","specularMapUv","nodeName","customProgramCacheKey","visibilityState","right",`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,"TEXTURE_2D","toAxisAngle","action","sleepSpeedLimit","startTime","setCollisionFilterMask","intersectObject","crossOrigin","getCurrentUpdatePriority","#define attribute in","compressedTexImage3D","ignoreDepthValues","selectstart","isPerspectiveCamera","uniform mat4 viewMatrix;","ownKeys","equirect_vert","getDepthInformation","mouseenter","THREE.ExtrudeGeometry: vec does not exist","cancelBubble","BoxGeometry","didNotMatchHydratedTextInstance","OctahedronGeometry","getMasterVolume","R16F","getOwnPropertySymbols","displacementMapUv","TextEvent","distanceSquared","CONSTANT_COLOR",`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,"stride","trunc","alpha-blend","DefaultInterpolation","containerInfo","dithering","linear","isClockWise","warned","setFromMatrix3Column","maxGeometryCount","UNSIGNED_SHORT","rootNode","onPointerOver","parseMaterials","evaluate","resetDefaultState","PLANE","], b=[","invalidateFramebuffer","line","Texture","isCubemap","shadowMapEnabled","max","expandByVector","data-","__useRenderToTexture","absarc","unknown-event","inputSource","sleepTimeLimit","wireframeLinewidth","Error creating WebGL context.","shouldStop","isGroup","subtreeFlags","connected","shadow_vert","forceUpdate","isArray",`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,"UVGenerator","activeMipmapLevel","storage","elementType","code","findHostInstanceWithWarning","selectend","sin","skinIndex","EquirectangularToCubeUV",`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,"updateCoordinateSystem","shadowMap","pointLightShadows","#define SHADER_TYPE ","_compileMaterial","Leave",`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,"setDistanceModel","COMPRESSED_RGBA_ASTC_8x6_KHR","R32UI","font-face","currentPoint","uniform4uiv","log","BoxHelper","morphColors",`
#define HIGH_PRECISION`,"TEXTURE0","Invalid component type.",", is too large and will clip, as it requested ","TorusGeometry","intersectBody","createMaterialFromType","createShader","hasDepthSensing","#define USE_METALNESSMAP","texImage3D","innerHTML","Camera","textContent","multiplyVectors","THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.","init","layout(location = 0) out highp vec4 pc_fragColor;","setLoopEnd","containsPoint","_payload","removeRay","setOpaqueSort","close","selectionRange","#define USE_SPECULAR_COLORMAP","aoMap","properties","LinearTransferOETF"," but it wasn't found.","dragstart","_viewports","moveTo","inverse","premultiply","_listeners","cn1","getCorners","toJSON",`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,"_reactRetry","#define USE_TANGENT","top","_clock","Portal","THREE.Color: Invalid hex color ","THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: ","isSpotLightShadow","phiStart","insertBefore","Suspense","previousSibling","convertSRGBToLinear","createContainer","ownerDocument","attributeName","useMemo","setAnimationLoop","uniform1iv","depthMask",`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,"vertexAlphas",`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,"onClickCapture","hand","Texture.toJSON","subPaths","toLowerCase","delay","hsl","shaderName","#define DEPTH_PACKING ","#define USE_MORPHTARGETS",`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,"scheduling","union","detail","getObjectById","upperBound",".shadowMap","rayhit","_multiDrawStarts","transmissionMapUv","moz","ONE_MINUS_CONSTANT_ALPHA","morphTargetsTextureSize","__webglInit","legacy","useCallback","background_vert","getViewSubImage","setLineWidth","stencilZFail","chordal","#define SHEEN_ROUGHNESSMAP_UV ",`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,"value",`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,"_alphaTest","oldTime","VERTEX_SHADER","decodeVideoTexture","offsetX","area","resolveStencilBuffer","lastBounds","toElement","deleteAttribute","documentMode","THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: ","_maxVertexCount","isCubicBezierCurve","exports","resetTextureUnits","rows","cone","pixelStorei","addEventListener","rotateAround","font-face-name","isInstancedBufferGeometry","collisionFilterMask","stencilFunc","textureWidth","colorTexture","getZ","_textureToCubeUV","updateWorldMatrix","unsupported interpolation for ","ENVMAP_BLENDING_MULTIPLY","ReactCurrentDispatcher","skeleton","gotpointercapture","R3F: The args prop must be an array!","intersection","collideEnd","setTextures","isLine","fullscreenchange","Group","getClip","initNonuniformCatmullRom","zeroSlopeAtEnd","Sprite","createContainerChildSet","_mixBufferRegion","ceil","Unknown","form","specularMapTransform","detune","channel","program","needsUpdate","createElement","audioNode",`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,"setFromColor","#define USE_SKINNING","SAMPLER_2D_SHADOW","CCW","setIterations","_hand","anisotropyMapTransform","vertexAttrib4fv","http://www.w3.org/1998/Math/MathML","supportsTestSelectors","slerpQuaternions","targetObject","isHemisphereLight","COLOR","removeRaycastVehicle","setHex","ENVMAP_BLENDING_NONE","resourcePath","getMatrixAt","createProgram","valueSize","React.Children.only expected to receive a single React element child.","selectionEnd","Enter","locationSize","FUNC_SUBTRACT","thicknessMap","THREE.WebGLState:","COMPRESSED_RGBA_ASTC_10x6_KHR","ValueTypeName","specular","setType","mapTransform","R3F: Hooks can only be used within the Canvas component!","remove","accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height","bumpMap","hemisphereLights","getCurrentEventPriority","#define MORPHTARGETS_COUNT ","vertexTextures","updateRenderTargetMipmap","gradientmap","input","__cache","normalBias","PointsMaterial","_startedAt","matrixWorldAutoUpdate","hasPlaybackControl","#define USE_UV1",` sampler2D;
	precision `,"framebufferRenderbuffer","_blurMaterial","_halfBlur","autoClearDepth","setTexture3D","PointLight","injectIntoDevTools","THREE.WebGLRenderer: Texture marked for update but no image data found.","_iridescence","applyQuaternion","distanceRGBA_frag","spotShadowMap","isReady","distanceSq","abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel","isMesh","vmult","__useDefaultFramebuffer","THREE.Color: Alpha component of ","getWorldDirection","R32I","PureComponent","getProgramParameter","onSelect","onCommitFiberUnmount","EdgesGeometry","detachDeletedInstance","getAverageFrequency","binormals","linedashed_frag","selector.component","XYX","setFromVectors","uniformsGroups","video","numClipIntersection","bool","dblclick",`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,"buffers","addToRenderList","list","images","_setValue_arrayElement","shallow","copySRGBToLinear","matrixAutoUpdate","RectAreaLight","text",`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,"collisionFilterGroup","COMPRESSED_RGBA_ASTC_4x4_KHR","_currentValue2","setResponseType","cut","THREE.WebGLTextures: Trying to use ","visibility","BatchedMesh: All attributes must have a consistent itemSize and normalized value.","boneInverses","HTMLIFrameElement","#define USE_BUMPMAP","getVertexShaderID","COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR","planesdetected","isDehydrated",`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,"boxMin","shouldSuspend","_setValue_array_setNeedsUpdate","createBuffer","		attribute vec3 morphTarget5;","resetState","setFromCenterAndSize","__cacheKey","setRenderTargetTextures","emissivemap","rgba","removeHandler","onStart","computeFrenetFrames","scl","setFromNormalAndCoplanarPoint","normalMapType","_cubeSize","parentNode","backgroundRotation","initialHits","bindMode","autoFocus","width","_updateTime","isMeshToonMaterial","updateDirection","blob","RG16F","Object3D.toJSON","onUpload","construct","observe","bounds","values","lines","getColorAt","pinching","expiredLanes","_result","#define USE_SPECULAR_INTENSITYMAP","multiplyScalar","then","encoding","dragend","itemEnd"," > ","isSprite","interleavedBuffers","update","#define IRIDESCENCEMAP_UV ","pendingProps","wasMultiple","activeTexture",`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,"THREE.PropertyBinding: Can not bind to objectName of node undefined.","arrayBuffers","normalizeNormals","setFromCylindrical","payload","clipIntersection","QuadraticBezierCurve3","touchcancel","_maxInstanceCount","onPointerLeave","RGBA32F","enqueueSetState","canvas","buffer","stopWarping","__reactInternalSnapshotBeforeUpdate",` usamplerCube;
	precision `,"isArcCurve","getControllerGrip","getFocalLength","COLOR_BUFFER_BIT","matrixWorld","isInstancedMesh","setFromSpherical","triangulateShape","_lodMax","pointLength","iridescenceMap","CatmullRomCurve3","nearDistance","indexOf","bufferData","closed","updateMultisampleRenderTarget",".bones[","sanitizeURL","#ifdef USE_INSTANCING_COLOR","localToWorld","_activateAction","shapes","COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR","000000","EntireArray","opacity","getScissor","ShadowMaterial","background","_mixBufferRegionAdditive","attemptContinuousHydration","_viewportCount","onorientationchange","getParameters","font-face-uri","fullWidth","rotateOnAxis","calculateInverses","numSpotLights","fromBufferAttribute","THREE.BufferAttribute: array should be a Typed Array.","UNIFORM_BUFFER","onAfterRender","shadowSide","_maxIndexCount","isPointLightShadow","ToneMapping( color ); }","disabled","DEPTH_COMPONENT16","search","COMPRESSED_RGBA_ASTC_10x5_KHR","sheenColorMap","__version","TEXTURE_MAG_FILTER","getBoundingClientRect","squeezestart","InterpolantFactoryMethodLinear","AmbientLight","useContext","Path","intersectsBox","paste","almostEquals","isDefaultPrevented","GEQUAL","setMatrixAt","compileShader","makeShear","uniform mat4 projectionMatrix;","statusText","deleteFramebuffer","flags","UNSIGNED_SHORT_5_5_5_1","DEPTH_STENCIL","recast","maxMip","THREE.WebGLProgram: Unsupported toneMapping:","onAnimationStart","clipShadows","renderBufferDirect","NEAREST","addSpring","_geometryInitialized","session","putImageData","unhideInstance","getTangentAt","ONE_MINUS_DST_ALPHA","cacheKey","timeDelta","rectAreaLTC1","rec709","cameras","_clip","R3F: Primitives without 'object' are invalid!","F10","WEBGL_compressed_texture_s3tc","DRAW_FRAMEBUFFER","4635228gBFkRJ","mustUseProperty","setAngularDamping","THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group.","webglcontextlost","materialIndex","_sigmas","enter","matchAccessibilityRole","forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported","COMPRESSED_SIGNED_RED_RGTC1_EXT","SCISSOR_TEST","forwardRef","getFindAllNodesFailureDescription","fogNear","unstable_strictMode","getFilmWidth","_lendControlInterpolant","port2","shaderType","invert",`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,"THREE.PropertyBinding: Trying to update property for track: ","afterblur","THREE.KeyframeTrack: Value is not a valid number.","addListener","has","getCamera","deleteTexture","unstable_scheduleHydration","UNSIGNED_INT_5_9_9_9_REV","removeSpring","Root","HALF_FLOAT","option","numHemiLights","hitNormalWorld","widthSegments","isLineCurve3","subScalar","setClear","getRGB","annotation-xml","setFramebufferScaleFactor","texelWidth","__webglTexture","useProgram","_workInProgressVersionPrimary","FLOAT_MAT3","hasEventListener","onMouseUpCapture","Euler order ",`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,"__cacheIndex","sessionstart",`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,"matrixWorldInverse","node","squeezeend","isBufferAttribute","displacementScale","100%","		attribute vec3 morphTarget4;","getSnapshot","_removeInactiveBinding","_setEndings","getPrimaries","createFactory","getFragmentShaderID","mesh","makeRotationZ","getBasisAt","setFilter","intersectsPlane","__webglDepthRenderbuffer","Context","clearcoatMap","duration","_takeBackBinding","#define USE_BATCHING","InterpolantFactoryMethodDiscrete","copyAt","HAVE_CURRENT_DATA","draggable","THREE.DataUtils.toHalfFloat(): Value out of range.","visible",`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,"depthTexture","volume() not implemented for shape type ","OES_texture_float_linear","antialias","_cleanup","extractPoints","renderLists","react.memo","charCode","#define ","roughnessmap","iridescenceThicknessMaximum","setFromEuler","steiner","pendingSuspenseBoundaries","HemisphereLight","isSuspenseInstanceFallback","angularFactor","isInterleavedBufferAttribute","#define USE_NORMALMAP_TANGENTSPACE","ReactNative"," at new ","COMPRESSED_RGBA_BPTC_UNORM_EXT","stencilFail","elements","onMouseLeave","_getValue_arrayElement","important","hidden",`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,"THREE.WebXRManager: Cannot change framebuffer scale while presenting.","__autoAllocateDepthBuffer","isValidElement","isQuadraticBezierCurve","matricesTexture","deltaY","drawcalls","distanceToPoint","cacheLengths","autoReset","ShapePath","generateSideWallUV","ior","attributes","metalnessMap","src",`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,"document","react.suspense","createHydrationContainer","equal","RGB5_A1","toWorkingColorSpace","fromEquirectangularTexture","Skeleton.toJSON","useLegacyLights","getAttribute","setW","none","beginShadows","deps","geometryCount","getPlane","fromReference","setSize","shadowMapType","_targetGroup","vectorToLocalFrame","MeshDepthMaterial","findFiberByHostInstance","isFrontFacing","matrixWorldNeedsUpdate","parseSkeletons","forceContextRestore","_sheen","hierarchy","object with keys {","call","StrictMode","plane","points","getCurrentViewport","isDirectionalLight","__size","applyLocalForce","toString","#define ROUGHNESSMAP_UV ","magFilter","doubleSided","COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR","selector.text","getWorldQuaternion",`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,"fromEquirectangular","CameraHelper","WEBGL_multisampled_render_to_texture","BackgroundMaterial","toEuler","enabled","keydown","onTransitionEnd","anisotropy","uint32View","location","createTexture","meshlambert_vert","math","numClippingPlanes","accumulate","uniform vec3 cameraPosition;","_init","SRC_ALPHA","getMaxListeners","This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills","addScaledSH","	attribute vec3 instanceColor;","compressedTexSubImage3D","combine",".position","layers","highp","ACESFilmic","unpackColorSpace","visible-blurred","lambert","CircleGeometry","bias","@@iterator","WEBGL_render_shared_exponent","memoized","light",`
#define LOW_PRECISION`,"getHand","Skeleton","setLoop","index0AttributeName","initialChecked","cloneHiddenInstance","renderInstances","_slerpAdditive","config","noscript","_drawRanges","UNSAFE_componentWillReceiveProps","relative","get","pointerout","__html","expandByScalar","density","EPSILON","ShapeGeometry","onPostCommitFiberRoot","added. Use emitter.setMaxListeners() to ","sessionend","COMPRESSED_SRGB8_ALPHA8_ETC2_EAC","active","DiscreteEventPriority","finalizeInitialChildren","THREE.ObjectLoader.parseTexture: Constant should be in numeric form.","decode","samples","normalMap","	attribute vec4 skinIndex;","LOD","createRange","deletions","removeFilter","numSpotMaps","Content-Length","specularIntensityMapTransform","direction","isTrigger","setUvTransform","collide","HORIZONTAL_PASS","frictionGravity","timeScale","view","programs","setRefDistance","environment","_getHandJoint","normalScale","wireframe","' has value of undefined.","setCollisionFilterGroup","#define USE_COLOR_ALPHA","previousRoot","decodeText","radiusTop","height","char","Line","fftSize","integrate","sourceType","gain","_weightNext","numSpotLightMaps","forwardZ","_intersectSphere","isVector3","setXYZW","canHydrateSuspenseInstance","DEFAULT_ORDER","coneCos","pointShadow","getNextHydratableInstanceAfterSuspenseInstance","normalmap","attribute","tonemapping_pars_fragment","selected","play","logDepthBufFC","lookAt","_multiDrawCounts","intervalChanged_","mipmaps","forceContextLoss","Consumer",`

No matching component was found for:
  `,"isBone","Provider","spotLength","onpropertychange","newListener","bundleType","true","#define USE_MAP","isView","boneMatrices","clampLength","itemError","flushControlled","UNIT_Z","End","generateMipmaps","THREE.Matrix4.makeOrthographic(): Invalid coordinate system: ","isBackwards","R8I","THREE.WebGLRenderer: Can't change size while VR device is presenting.","_sizeLods","fromArray","getClearAlpha","transpose","extensionClipCullDistance","THREE.Material: parameter '",`#version 300 es
`,"mapPass","getOutput","stencilOp","setFromQuaternion","zeroSlopeAtStart","gripSpace","#ifdef USE_INSTANCING","setPointerCapture","stats","isInterleavedBuffer","getNormalMatrix","contextmenu","file","svg","skeletons","setTexture2DArray","_updateRange","compile","position","curves","setZ","setTexture2D","__reactProps$","shaderSource","applyImpulse","lazy",`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,"allocateTextureUnit",`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,"button","views","getHex","COMPRESSED_RED_RGTC1_EXT","Module","	attribute vec4 color;","onClick","fun","setMode","promise","parseTrackName","react.provider","lanes","UNSIGNED_BYTE","blendSrcAlpha","pinchstart","getTangent","updateQueue","_events","COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR","directional","uniformsNeedUpdate","CubemapToCubeUV","setZero","#endif","_targetInst","#define USE_ROUGHNESSMAP","BROWSER_DEFAULT_WEBGL","isMeshLambertMaterial","TEXTURE_CUBE_MAP_NEGATIVE_Z","callbackPriority","catmullrom","running","	#endif","applyTorque","decay","mimeType","readPixels","COMPRESSED_RED_GREEN_RGTC2_EXT","TorusKnotGeometry","fromWorkingColorSpace","react.lazy","generateMipmap",`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,"refreshFogUniforms","clearTimeout","split","LineLoop","stencilBuffer","#define USE_AOMAP","resolveURL","getPointsHoles","iterator","left","sheenRoughness","_root","RG16UI","ArcCurve","getCurrentLevel","specularMap","MAX_VALUE","_setValue_direct","componentWillReceiveProps","morphTargetInfluences","charAt","clearcoatRoughness","shaderID","setTransparentSort","_maxGeometryCount","_actions","applyEuler","defineProperty","projectionMatrix","touchmove","pillarOffset","#define USE_FOG","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","getSettings_",'THREE.ObjectLoader: Unsupported geometry type "',"isDepthTexture","#define ALPHA_TO_COVERAGE","str","include","credentials","( vec3 color ) { return ","CreateFromMorphTargetSequence","subscribe","setupIntersectionObserver","getEffectiveFOV","three.js r","#define USE_TRANSMISSION","createFramebuffer","react.strict_mode","environmentBlendMode","THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.","CubemapFromEquirect","THREE.Color: Unknown color model ","getShaderInfoLog","getDerivedStateFromProps","LINES","paused","setRenderTargetFramebuffer","target","setRotationFromEuler","orientationchange","animations","shape","Direct","its-fine: useFiber must be called within a <FiberProvider />!","ReactCurrentOwner","random","capture","shared","#define USE_DISPLACEMENTMAP","uniform1uiv",`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,"ForwardRef(","translate","directionalLights","ArrowDown","clipboardData","unstable_batchedUpdates","focus","HEIGHTFIELD","InstancedMesh","NumLock","TEXTURE_2D_ARRAY","customVertexShaderID","Material.toJSON","projectionMatrixInverse","#define texture2DProj textureProj","alphaHash","splice","getParameter","className","error","#define USE_NORMALMAP","setOptions","enableAll","ltc_2","setSpringRestLength","_workIndex","AnimationEvent","getBoneByName","xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type","pushShadow","getProgramInfoLog","eventSystemFlags","keyup","data:","fromElement","_lodPlanes","shadowCameraFar","setMediaStreamSource","__proto__","parseObject","TEXTURE_3D","result","decompose","near","font-face-format","length","memoizedProps","setPosition","THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.","initTexture","ResizeObserver","some","polygonOffsetFactor","_frustum","currentPath","THREE.KeyframeTrack: track type undefined, can not parse",`void main() {
	gl_Position = vec4( position, 1.0 );
}`,"setValues","prependListener","THREE.ObjectLoader: Undefined material",`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,"setMaterial","intersectShape","_parsedPaths","maxCubemapSize","extractRotation","#define FLIP_SIDED","pmremVersion","dragover","invalid","add","radius","stopPropagation","registerMutableSourceForHydration","setPolygonOffset","missing-glyph","Control",`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,"heightSegments","gradientMap","UNPACK_IMAGE_HEIGHT","unstable_next","iridescenceThicknessMapTransform","manhattanLength","suppressContentEditableWarning","uniform1i","fired","onBeforeCompile","pendingContext","updateRange","makeRotationAxis","distance","bindRenderbuffer","indexStart","foreignObject","isInstancedInterleavedBuffer","EXT_texture_compression_rgtc","#define USE_GRADIENTMAP","_actionsByClip","load","setFromAttributeAndIndices","bumpMapUv","finishedLanes","createVertexArray","LN2","cullFace","clearUpdateRanges","_owner","contextTypes","before","clearcoatMapTransform","uniform mat4 modelMatrix;","removeAllRanges","mapSize","correspondingUseElement","instanceCount","fragmentShader","setConstraintMotorSpeed","stringify","ANY","texStorage2D","_visibility","getPointAt","CompositionEvent","_dispose","positionX","UNPACK_COLORSPACE_CONVERSION_WEBGL","__webglDepthbuffer","SHORT","parse","meshphysical_frag","applyMatrix4","almostZero","Fog","	attribute vec4 tangent;","isDataTexture","materials","knownActions","setXYZ","toStringTag","longitudinal","timeout","ColorManagement",'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',"displayName","#define USE_CLEARCOATMAP","NOTEQUAL","createMediaElementSource","getSnapshotBeforeUpdate","getViewBounds","http-equiv","containsBox","getPlaybackRate",".Consumer","fogExp2","mapping","getAttributes","#define USE_CLEARCOAT_NORMALMAP","acos","spotLightShadows","onclick","props","equals","addVectors","scissor","COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT","indices","onPointerEnter","MIN","faceList","shapeOffsets","resize","addLevel","isSplineCurve","ReactCurrentBatchConfig","sphere","getDetune","THREE.ObjectLoader: Undefined geometry","setAngularFactor","clone","Memo","boo","setX","THREE.KeyframeTrack: Track is empty.","setTargetAtTime","shadow_frag","_setAdditiveIdentityQuaternion","YXZ","blendColor","		attribute vec3 morphNormal0;","onAfterShadow","textureFormatReadable","Escape","stencilWriteMask",`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,"reference","unstable_cancelCallback","LightProbe","traverseAncestors","floor","#define USE_NORMALMAP_OBJECTSPACE","TRIMESH","_uuid","commitHydratedSuspenseInstance","cf3","gravity","parentElement","unstable_act","getActiveCubeFace",`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,"inputState","	attribute vec2 uv3;","_getValue_unavailable","enqueueReplaceState","findAllNodes","parseAsync","instead.","loseContext","WARNING: Multiple instances of Three.js being imported.","anchorOffset","initialDpr","164","bufferSubData","). If you meant to render a collection of children, use an array instead.","isQuadraticBezierCurve3","uniformBlockBinding","revealOrder",`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,"normals","pointToWorld","addUpdateRange","iridescence","renderTarget","rotateOnWorldAxis","pointerdown","useDepthPacking","checkShaderErrors","display","_addInactiveBinding","RG8","CYLINDER","clipCullDistance","getTransfer","querySelectorAll","meshPerAttribute","isScheduled","morphAttributeCount","getActiveUniform","linearRampToValueAtTime","exec","_outputColorSpace","intersectsSphere","lightmap","anchorNode","multiple","Scene",`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,"InstancedBufferGeometry","positionZ","F11","normal","Unidentified","THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device.","format","setMass","normalMapTransform","rangeCount","__bubble","__reactInternalMemoizedUnmaskedChildContext","setContext","Light","backgroundBlurriness","getInterpolation","negate","ENVMAP_MODE_REFLECTION","calc","_reactName","setWithCredentials","depthFunc","clear","TracingMarker","xlink:href","meshlambert_frag","THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '","intersectsLine","THREE.ObjectLoader: Can't load ","LTC_HALF_2","setLength","numPlanes","DirectionalLightHelper","scroll","react.fragment","stencil","focusedElem","renderOrder","onError","upZ","refractionRatio","phi",`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,"reorder","#define varying out","context","isGLBufferAttribute","smult","transparent","maxDistance","restoreOriginalState","UNPACK_SKIP_PIXELS","setScissorTest","getVertexPosition","COMPRESSED_RGBA_ASTC_6x6_KHR","lineDistance","READ_FRAMEBUFFER","getHandSpace","transformUv","timing","setPixelRatio","childLanes","compositionend","targetLine","block","pose",`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,"getIndex","THREE.Texture: Unable to serialize Texture.","MOZ_WEBGL_compressed_texture_s3tc","meshphysical_vert","source","#define USE_ANISOTROPY","useSphere args must be an array","numSpotLightShadowsWithMaps","pointShadowMap","setLoopStart","isCanvasTexture","AnimationEnd","@react-three/fiber","mantissaTable","expandByPoint","args","_getShaderCacheForMaterial","addBodies","_renderer","onPointerCancel","bindVertexArray","requestHeader","float","getFilters","LINK_STATUS","#define USE_ANISOTROPYMAP","intersectBox","depth_vert","_useLegacyLights","act","setFromSphericalCoords","sheenRoughnessMapTransform","morphTargetDictionary","cn4","isCompressedArrayTexture","</svg>","getRootHostContext",`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,"positionY","setSession","rotateY","repeat","MAX_VERTEX_TEXTURE_IMAGE_UNITS","off","fiber","Versioning",`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,"initCatmullRom","slerp","setIndex",`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,"setScalar","THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.","enqueue","numDirLightShadows","initialValue",`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,"FRAGMENT_SHADER","LINEAR_MIPMAP_LINEAR","finalizeContainerChildren","receiveShadow","depthTest","push",`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,"setFrameloop","webglcontextcreationerror","intersectsObject","convexPolyhedronRepresentation","xrCompatible","script","minFilter","movementY","rectAreaLights","LTC_FLOAT_2","displayWidth","isLineBasicMaterial","boundingBox","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","toShapes","textarea","isRectAreaLight","intersectsTriangle","parseShapes","thicknessMapTransform","Lazy","vertexShader","_setValue_arrayElement_setNeedsUpdate","TEXTURE_MIN_FILTER","createElementNS","rotate","sigmaRadians, ","isLineDashedMaterial","THREE.Curve: .getPoint() not implemented.","resolveDepthBuffer","setRGB","COMPRESSED_RGB_S3TC_DXT1_EXT","loopStart","isInteger","COMPRESSED_RGBA_ASTC_10x8_KHR","scheduleMicrotask","optimize","decodeAudioData","mousedown","#define CUBEUV_TEXEL_WIDTH ","COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT","_reactListening","forceSinglePass","image/png","appendChild","TRIANGLES","_workingColorSpace","supportsMutation","componentDidMount","react.element","_setValue_fromArray","TEXTURE_WRAP_R","getWorldScale","fromJSON","removeEmptyString","TEXTURE_WRAP_S","coefficients","#define CLEARCOAT_ROUGHNESSMAP_UV ","onUploadCallback","WEBGL_compressed_texture_pvrtc","hydratedSources","rectAreaLTC2","setAngularVelocity","pow","linearDamping","_eventsCount","tree","reverse","angleTo","THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.","Could not reverse! A=[","transmissionMap","sprite","setFromAxisAngle",`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,"getDataURL","SAMPLE_ALPHA_TO_COVERAGE","getElapsedTime","extractUrlBase","count","setSpringStiffness",`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,"resolution","WebGL","center","finally","span","setFilters","EventEmitter","addConstraint","angularDamping","_getShaderStage","uniform2ui","dispatch","Delete","TEXTURE_CUBE_MAP_POSITIVE_X","EXT_color_buffer_half_float","compressedTexImage2D","releaseProgram","faceIndex","#define USE_IRIDESCENCEMAP",`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,"_internalRoot","	attribute vec3 morphTarget0;","setUserData","onLoad","Scope","AudioContext",`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,"pointerover","transmissive","rectArea","getIrradianceAt","getEnvironmentBlendMode","propertyName","makeRotationY","which","_multiDrawInstances","offsetY","disconnected","isLightProbe","rendererConfig","lastRenderedState","aspect","aRotation","componentWillUnmount","getUniformBlockIndex","FLOAT_MAT4","drawBuffers","triangulate","__esModule","blur direction must be either latitudinal or longitudinal!","], A=[","Offscreen","getTargetRaySpace","tabIndex","Object","_fromTexture","onPointer","common","fps","getWireframeAttribute","normalMapTangentSpace","oninput","THREE.WebGLRenderer: Texture marked for update but image is incomplete","appendChildToContainerChildSet","angle","applyBoneTransform","material","compareDocumentPosition","Capture","THREE.Matrix4.makePerspective(): Invalid coordinate system: ","existingAction","positions","checkCollisionResponse","imul","texSubImage3D","distanceToSquared","#define SPECULAR_INTENSITYMAP_UV ","F12","setDetune","_applyPMREM","supportsMicrotasks","isFramebufferTexture","Program Info Log: ","isInstancedBufferAttribute","CurvePath","ARRAY_BUFFER","THREE.WebGLShadowMap:","selector.has_pseudo_class","SkeletonHelper","childContextTypes","coplanarPoint","type","setGravity","theta","destination","getPose",`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,"THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.",`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,"radialSegments","setFromCylindricalCoords","depthNear","Material Type: ","canHydrateTextInstance","TubeGeometry","origin","cloneHiddenTextInstance",`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',"253995JYqJXP","fixedFoveation","specularColor","segments",'{}.constructor("return this")( )',"getFrame","displacementmap","lastBaseUpdate","ConeGeometry","includes","useState","getDelta","pointerleave","stencilFuncMask","entries","WEBGL_compressed_texture_astc","setFromCartesianCoords","getRoot","act(...) is not supported in production builds of React.","enable","batchId","setFromMatrix4","geometryInitialized","rolloffFactor","#define TRANSMISSIONMAP_UV ","onBeforeRender","volume","rotateX","rectAreaLength","nativeEvent","find","updateMatrixWorld","maxTextureSize","setLinearFactor","DEPTH_COMPONENT24","setResourcePath","fadeIn","selectionchange","needsLights","_valueTracker","COMPRESSED_RGBA_S3TC_DXT1_EXT","tubularSegments","refreshMaterialUniforms","listeners","overlapsRay","points_vert","setAxisAngleFromRotationMatrix","8979848vtzHEf","MAX_CUBE_MAP_TEXTURE_SIZE","getMaxAnisotropy","disconnect","RG32I","configure","onDoubleClick","checkbox","timeStamp","pointsUvs","entangledLanes","environmentRotation","	attribute vec3 morphTarget3;","ZERO","expandByObject","anisotropyMapUv","unstable_LowPriority","uniform3uiv","modelMatrix","linearToOutputTexel",`
#define MEDIUM_PRECISION`,"renderbufferStorageMultisampleEXT","isMeshGouraudMaterial","expirationTimes","ambient","react.forward_ref","refs","conjugate","params","isWebGLArrayRenderTarget","clearcoatRoughnessMapTransform","side","setFromXRController","isSpotLight","pop","complete","__reactInternalMemoizedMergedChildContext","onCompositionEnd","_cubemapMaterial","sort","frameloop","clz32","useLayoutEffect","upload","glslVersion","pool","Material Name: ","vadd","info","endingStart","_wrapperState","analyser",`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,"class","getImageData","ctrlKey","hasLinearVelocity","useCount","batchedUpdates","asin","fadeOut","hasOwnProperty","pingedLanes","test",`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,"3475915yDmCBG","boundingSphere","#define USE_SHEEN_COLORMAP","FRONT","THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.","ArrowUp","sqrt","morphTexture","prev","diagnostics","_lendAction","weights","getPublicRootInstance","arrayBuffer","parseImages","getAt","WEBGL_multi_draw","resultBuffer","path","useFog","Box","nodes","Sphere","<anonymous>","iridescenceThicknessMinimum","12ADtszl","setFromCamera","initialClick","WEBGL_compressed_texture_s3tc_srgb","blendEquation","SHADOWMAP_TYPE_PCF","createProjectionLayer","deleteBuffer","capturedMap","needsPMREMUpdate","actionByRoot","THREE.Skeleton: No bone found with UUID:","_timeScaleInterpolant","bezierCurveTo","string","THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons","Fragment","createInstance","SetterByBindingTypeAndVersioning","isCubeTexture","handlers","_getValue_unbound","_equirectMaterial","normalizeSkinWeights","bodies","__reactEvents$","DefaultEventPriority",'THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',"register","wrapFn","prependOnceListener","#define USE_ALPHAMAP","indexCount","ONE_MINUS_SRC_COLOR","frontFace","useImperativeHandle","premultipliedAlpha","status","rebindTextures","getFrameExtents","_onChangeCallback","symbol","unstable_forceFrameRate","runWithPriority","__reactInternalMemoizedMaskedChildContext","textureHeight","thetaSegments","SHADOWMAP_TYPE_PCF_SOFT","distanceTo","alphaMap","mouseleave","CubeCamera","useReducer","getWorldPosition","THREE.WebGLRenderer: Context Lost.","dpr","#define SPECULARMAP_UV ","calculateLocalInertia() not implemented for shape type ","THREE.FileLoader: HTTP Status 0 received.",`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`,"lowerBound","premultiplyAlpha","' is not a property of THREE.","itemStart","extrudePath","linewidth","shadowsArray","dgst","isLineSegments","getLength","__r3f","isMeshBasicMaterial","setInstanceCountAt","bumpmap","makeEmpty","linearVelocity","getByteFrequencyData","setupDepthRenderbuffer","projectPoint","iridescenceThicknessRange","latitudinal","_intersectPlane","sheenColorMapUv","isMeshStandardMaterial","appendChildToContainer","intersectTriangle","obj","baseLanes","warn","_lerp"," will be ignored.","isHiddenSubtree","blockedOn","onCommitFiberRoot","attach","_update","setComponents","alphaMapTransform","ZYX","THREE.KeyframeTrack: track name is undefined","__webglMultisampledFramebuffer","_setValue_direct_setMatrixWorldNeedsUpdate","normalize","ONE","workingColorSpace","_active","Cache","directionalLightShadows","WEBGL_compressed_texture_etc","webgl2","react.suspense_list","getExtension","getHandler","toUpperCase","SphericalGaussianBlur","computeBoundingBox","CubicBezierCurve","children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style","texParameteri","DEPTH_TEST","hashchange","tangents","fogColor","#define CLEARCOAT_NORMALMAP_UV ","blendFunc","skyColor","ref","data","isOrthographic","BindingType","unstable_scheduleCallback","detected. Clean the caches or recreate your infrastructure when reloading scenes.","rayToWorld","renderbufferStorageMultisample","compositionstart","tag","2meEQoI","_getVersion","vmul","scheduleTimeout","_frameExtents","head","getMaxDistance","from","lastIndex","SRC_COLOR","TransitionEvent","setOrientation","setTextureCube","stencilZPass","resolvedProperty","vertexUv3s","THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,"lerp","LEQUAL","keypress","displayHeight","makeBasis","EXT_color_buffer_float","transmission","isDataArrayTexture","compressedTexSubImage2D",`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,"getLoop","NAMES","COMPRESSED_RGBA_ASTC_6x5_KHR","binding","accept-charset","fogFar","files","overrideMaterial","legacyMode","_reactRootContainer",` isampler2DArray;
	precision `,"sprite_frag","vector","setFromPointsAndIndices","isMeshPhongMaterial","num","texture","focusWithin","18.0.0-fc46dba67-20220329","_interpolants","backgroundIntensity","withCredentials","distanceSqToPoint","_offsetNext","change","_connected","setFromMatrixColumn","BACK","useInsertionEffect","not supported, using","background_frag","instancingColor","isVector2","VSM_SAMPLES","uniform2fv","MeshBasicMaterial","setBuffer","crossmat","detachEvent","capSegments","isAmbientLight","sprite_vert","createTextNode","stopFading","isMatrix3","webkitAudioContext","defaultProps","Could not solve equation! Got x=[","clampScalar","parseGeometries","RG_INTEGER","prevZ","_pingPongRenderTarget","rot","orientationY","map","hysteresis","cameraL","ArrowLeft","wrapR","addRaycastVehicle","envmap","#version ","velocity","baseQueue","boolean","getBoundingBox","defines","OptimizedCineon"];return I2=function(){return i},I2()}class JC{constructor(x,e,t,g){const n=I;this[n(509)]=x,this[n(383)]=0,this[n(3652)]=g!==void 0?g:new e[n(135)](t),this[n(1756)]=e,this[n(2194)]=t,this[n(779)]=null,this[n(1678)]={}}[I(1962)](x){const e=I,t=this[e(509)];let g=this[e(383)],n=t[g],s=t[g-1];x:{e:{let o;t:{g:if(!(x<n)){for(let c=g+2;;){if(n===void 0){if(x<s)break g;return g=t[e(2989)],this[e(383)]=g,this[e(1672)](g-1)}if(g===c)break;if(s=n,n=t[++g],x<n)break e}o=t.length;break t}if(!(x>=s)){const c=t[1];x<c&&(g=2,s=c);for(let C=g-2;;){if(s===void 0)return this[e(383)]=0,this[e(1672)](0);if(g===C)break;if(n=s,s=t[--g-1],x>=s)break e}o=g,g=0;break t}break x}for(;g<o;){const c=g+o>>>1;x<t[c]?o=c:g=c+1}if(n=t[g],s=t[g-1],s===void 0)return this[e(383)]=0,this[e(1672)](0);if(n===void 0)return g=t[e(2989)],this[e(383)]=g,this.copySampleValue_(g-1)}this[e(383)]=g,this[e(2767)](g,s,n)}return this[e(1147)](g,s,x,n)}[I(2905)](){const x=I;return this[x(779)]||this[x(1678)]}[I(1672)](x){const e=I,t=this[e(3652)],g=this.sampleValues,n=this[e(2194)],s=x*n;for(let o=0;o!==n;++o)t[o]=g[s+o];return t}[I(1147)](){const x=I;throw new Error(x(1124))}[I(2767)](){}}class a3 extends JC{constructor(x,e,t,g){const n=I;super(x,e,t,g),this[n(717)]=-0,this[n(666)]=-0,this[n(2748)]=-0,this[n(3847)]=-0,this[n(1678)]={endingStart:yI,endingEnd:yI}}[I(2767)](x,e,t){const g=I,n=this[g(509)];let s=x-2,o=x+1,c=n[s],C=n[o];if(c===void 0)switch(this.getSettings_()[g(3619)]){case vI:s=x,c=2*e-t;break;case rC:s=n.length-2,c=e+n[s]-n[s+1];break;default:s=x,c=t}if(C===void 0)switch(this[g(2905)]()[g(386)]){case vI:o=x,C=2*t-e;break;case rC:o=1,C=t+n[1]-n[0];break;default:o=x-1,C=e}const r=(t-e)*.5,A=this.valueSize;this[g(717)]=r/(e-c),this[g(2748)]=r/(C-t),this[g(666)]=s*A,this._offsetNext=o*A}[I(1147)](x,e,t,g){const n=I,s=this[n(3652)],o=this[n(1756)],c=this[n(2194)],C=x*c,r=C-c,A=this[n(666)],d=this[n(3847)],h=this[n(717)],f=this[n(2748)],B=(t-e)/(g-e),Z=B*B,G=Z*B,m=-h*G+2*h*Z-h*B,v=(1+h)*G+(-1.5-2*h)*Z+(-.5+h)*B+1,p=(-1-f)*G+(1.5+f)*Z+.5*B,w=f*G-f*Z;for(let V=0;V!==c;++V)s[V]=m*o[A+V]+v*o[r+V]+p*o[C+V]+w*o[d+V];return s}}class Mf extends JC{constructor(x,e,t,g){super(x,e,t,g)}[I(1147)](x,e,t,g){const n=I,s=this[n(3652)],o=this[n(1756)],c=this[n(2194)],C=x*c,r=C-c,A=(t-e)/(g-e),d=1-A;for(let h=0;h!==c;++h)s[h]=o[r+h]*d+o[C+h]*A;return s}}class r3 extends JC{constructor(x,e,t,g){super(x,e,t,g)}[I(1147)](x){return this[I(1672)](x-1)}}class kg{constructor(x,e,t,g){const n=I;if(x===void 0)throw new Error(n(3759));if(e===void 0||e[n(2989)]===0)throw new Error(n(616)+x);this.name=x,this[n(985)]=wI(e,this[n(913)]),this[n(2326)]=wI(t,this[n(1113)]),this[n(924)](g||this[n(1950)])}static[I(2054)](x){const e=I,t=x[e(135)];let g;if(t[e(2054)]!==this[e(2054)])g=t[e(2054)](x);else{g={name:x[e(1474)],times:wI(x.times,Array),values:wI(x[e(2326)],Array)};const n=x[e(3216)]();n!==x[e(1950)]&&(g.interpolation=n)}return g[e(3505)]=x.ValueTypeName,g}[I(2543)](x){const e=I;return new r3(this[e(985)],this.values,this.getValueSize(),x)}InterpolantFactoryMethodLinear(x){const e=I;return new Mf(this[e(985)],this[e(2326)],this[e(871)](),x)}InterpolantFactoryMethodSmooth(x){const e=I;return new a3(this[e(985)],this[e(2326)],this[e(871)](),x)}setInterpolation(x){const e=I;let t;switch(x){case lC:t=this[e(2543)];break;case aC:t=this.InterpolantFactoryMethodLinear;break;case Zr:t=this[e(381)];break}if(t===void 0){const g=e(2145)+this[e(2203)]+e(1353)+this[e(1474)];if(this.createInterpolant===void 0)if(x!==this.DefaultInterpolation)this[e(924)](this[e(1950)]);else throw new Error(g);return console[e(3748)](e(1662),g),this}return this[e(935)]=t,this}[I(3216)](){const x=I;switch(this[x(935)]){case this.InterpolantFactoryMethodDiscrete:return lC;case this.InterpolantFactoryMethodLinear:return aC;case this[x(381)]:return Zr}}[I(871)](){const x=I;return this[x(2326)].length/this[x(985)][x(2989)]}[I(214)](x){const e=I;if(x!==0){const t=this.times;for(let g=0,n=t[e(2989)];g!==n;++g)t[g]+=x}return this}[I(623)](x){const e=I;if(x!==1){const t=this[e(985)];for(let g=0,n=t[e(2989)];g!==n;++g)t[g]*=x}return this}[I(1388)](x,e){const t=I,g=this[t(985)],n=g[t(2989)];let s=0,o=n-1;for(;s!==n&&g[s]<x;)++s;for(;o!==-1&&g[o]>e;)--o;if(++o,s!==0||o!==n){s>=o&&(o=Math[t(1971)](o,1),s=o-1);const c=this[t(871)]();this.times=g.slice(s,o),this[t(2326)]=this[t(2326)][t(1226)](s*c,o*c)}return this}[I(1111)](){const x=I;let e=!0;const t=this[x(871)]();t-Math[x(3143)](t)!==0&&(console.error(x(912),this),e=!1);const g=this[x(985)],n=this[x(2326)],s=g[x(2989)];s===0&&(console.error(x(3127),this),e=!1);let o=null;for(let c=0;c!==s;c++){const C=g[c];if(typeof C===x(1025)&&isNaN(C)){console[x(2963)](x(1767),this,c,C),e=!1;break}if(o!==null&&o>C){console.error(x(155),this,c,C,o),e=!1;break}o=C}if(n!==void 0&&C3(n))for(let c=0,C=n.length;c!==C;++c){const r=n[c];if(isNaN(r)){console[x(2963)](x(2487),this,c,r),e=!1;break}}return e}[I(3368)](){const x=I,e=this[x(985)][x(1226)](),t=this[x(2326)][x(1226)](),g=this[x(871)](),n=this.getInterpolation()===Zr,s=e.length-1;let o=1;for(let c=1;c<s;++c){let C=!1;const r=e[c],A=e[c+1];if(r!==A&&(c!==1||r!==e[0]))if(n)C=!0;else{const d=c*g,h=d-g,f=d+g;for(let B=0;B!==g;++B){const Z=t[d+B];if(Z!==t[h+B]||Z!==t[f+B]){C=!0;break}}}if(C){if(c!==o){e[o]=e[c];const d=c*g,h=o*g;for(let f=0;f!==g;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let c=s*g,C=o*g,r=0;r!==g;++r)t[C+r]=t[c+r];++o}return o!==e[x(2989)]?(this[x(985)]=e[x(1226)](0,o),this[x(2326)]=t.slice(0,o*g)):(this[x(985)]=e,this[x(2326)]=t),this}[I(3123)](){const x=I,e=this[x(985)][x(1226)](),t=this[x(2326)][x(1226)](),g=this[x(135)],n=new g(this[x(1474)],e,t);return n[x(935)]=this[x(935)],n}}kg[I(1566)][I(913)]=Float32Array,kg[I(1566)][I(1113)]=Float32Array,kg[I(1566)][I(1950)]=aC;class hI extends kg{}hI.prototype[I(2203)]=I(2262),hI.prototype[I(1113)]=Array,hI[I(1566)][I(1950)]=lC,hI[I(1566)][I(2421)]=void 0,hI[I(1566)][I(381)]=void 0;class Lf extends kg{}Lf[I(1566)][I(2203)]=I(432);class ZC extends kg{}ZC.prototype[I(2203)]="number";class d3 extends JC{constructor(x,e,t,g){super(x,e,t,g)}[I(1147)](x,e,t,g){const n=I,s=this[n(3652)],o=this[n(1756)],c=this.valueSize,C=(t-e)/(g-e);let r=x*c;for(let A=r+c;r!==A;r+=4)ot[n(1803)](s,0,o,r-c,o,r,C);return s}}class oo extends kg{[I(2421)](x){const e=I;return new d3(this[e(985)],this[e(2326)],this[e(871)](),x)}}oo[I(1566)][I(2203)]=I(3915),oo[I(1566)][I(1950)]=aC,oo.prototype[I(381)]=void 0;class fI extends kg{}fI.prototype[I(2203)]=I(3674),fI[I(1566)][I(1113)]=Array,fI[I(1566)].DefaultInterpolation=lC,fI[I(1566)][I(2421)]=void 0,fI[I(1566)][I(381)]=void 0;class yC extends kg{}yC.prototype[I(2203)]="vector";class vC{constructor(x="",e=-1,t=[],g=p2){const n=I;this[n(1474)]=x,this[n(421)]=t,this[n(2540)]=e,this.blendMode=g,this[n(296)]=gg(),this[n(2540)]<0&&this[n(192)]()}static parse(x){const e=I,t=[],g=x[e(421)],n=1/(x[e(3472)]||1);for(let o=0,c=g[e(2989)];o!==c;++o)t[e(3330)](WF(g[o])[e(623)](n));const s=new this(x[e(1474)],x[e(2540)],t,x[e(1293)]);return s[e(296)]=x[e(296)],s}static[I(2054)](x){const e=I,t=[],g=x[e(421)],n={name:x[e(1474)],duration:x[e(2540)],tracks:t,uuid:x[e(296)],blendMode:x[e(1293)]};for(let s=0,o=g.length;s!==o;++s)t[e(3330)](kg[e(2054)](g[s]));return n}static[I(2913)](x,e,t,g){const n=I,s=e[n(2989)],o=[];for(let c=0;c<s;c++){let C=[],r=[];C[n(3330)]((c+s-1)%s,c,(c+1)%s),r[n(3330)](0,1,0);const A=l3(C);C=Ch(C,1,A),r=Ch(r,1,A),!g&&C[0]===0&&(C.push(s),r.push(r[0])),o[n(3330)](new ZC(".morphTargetInfluences["+e[c][n(1474)]+"]",C,r).scale(1/t))}return new this(x,-1,o)}static[I(1173)](x,e){const t=I;let g=x;if(!Array[t(1987)](x)){const n=x;g=n.geometry&&n[t(352)][t(2933)]||n[t(2933)]}for(let n=0;n<g[t(2989)];n++)if(g[n][t(1474)]===e)return g[n];return null}static CreateClipsFromMorphTargetSequences(x,e,t){const g=I,n={},s=/^([\w-]*?)([\d]+)$/;for(let c=0,C=x[g(2989)];c<C;c++){const r=x[c],A=r[g(1474)][g(1217)](s);if(A&&A[g(2989)]>1){const d=A[1];let h=n[d];!h&&(n[d]=h=[]),h[g(3330)](r)}}const o=[];for(const c in n)o[g(3330)](this.CreateFromMorphTargetSequence(c,n[c],e,t));return o}static parseAnimation(x,e){const t=I;if(!x)return console[t(2963)](t(1459)),null;const g=function(d,h,f,B,Z){const G=t;if(f[G(2989)]!==0){const m=[],v=[];zf(f,m,v,B),m[G(2989)]!==0&&Z[G(3330)](new d(h,m,v))}},n=[],s=x[t(1474)]||t(311),o=x[t(3472)]||30,c=x[t(1293)];let C=x[t(2989)]||-1;const r=x[t(2625)]||[];for(let d=0;d<r[t(2989)];d++){const h=r[d].keys;if(!(!h||h[t(2989)]===0))if(h[0][t(535)]){const f={};let B;for(B=0;B<h.length;B++)if(h[B][t(535)])for(let Z=0;Z<h[B][t(535)][t(2989)];Z++)f[h[B].morphTargets[Z]]=-1;for(const Z in f){const G=[],m=[];for(let v=0;v!==h[B][t(535)][t(2989)];++v){const p=h[B];G[t(3330)](p.time),m[t(3330)](p.morphTarget===Z?1:0)}n.push(new ZC(".morphTargetInfluence["+Z+"]",G,m))}C=f.length*o}else{const f=t(2381)+e[d][t(1474)]+"]";g(yC,f+t(2668),h,t(1110),n),g(oo,f+t(626),h,t(3877),n),g(yC,f+".scale",h,t(2306),n)}}return n.length===0?null:new this(s,C,n,c)}resetDuration(){const x=I,e=this[x(421)];let t=0;for(let g=0,n=e.length;g!==n;++g){const s=this[x(421)][g];t=Math.max(t,s[x(985)][s[x(985)][x(2989)]-1])}return this[x(2540)]=t,this}trim(){const x=I;for(let e=0;e<this[x(421)][x(2989)];e++)this.tracks[e][x(1388)](0,this[x(2540)]);return this}[I(1111)](){const x=I;let e=!0;for(let t=0;t<this[x(421)][x(2989)];t++)e=e&&this[x(421)][t].validate();return e}[I(3368)](){const x=I;for(let e=0;e<this.tracks[x(2989)];e++)this.tracks[e].optimize();return this}[I(3123)](){const x=I,e=[];for(let t=0;t<this[x(421)][x(2989)];t++)e.push(this[x(421)][t][x(3123)]());return new this[x(135)](this[x(1474)],this[x(2540)],e,this[x(1293)])}[I(2054)](){return this[I(135)].toJSON(this)}}function vF(i){const x=I;switch(i[x(2084)]()){case x(1739):case"double":case x(3290):case x(1025):case"integer":return ZC;case x(3836):case"vector2":case"vector3":case"vector4":return yC;case x(432):return Lf;case x(3915):return oo;case x(2262):case"boolean":return hI;case x(3674):return fI}throw new Error(x(436)+i)}function WF(i){const x=I;if(i.type===void 0)throw new Error(x(2999));const e=vF(i[x(3505)]);if(i[x(985)]===void 0){const t=[],g=[];zf(i[x(958)],t,g,x(2113)),i[x(985)]=t,i[x(2326)]=g}return e[x(3073)]!==void 0?e[x(3073)](i):new e(i[x(1474)],i[x(985)],i[x(2326)],i[x(290)])}const Ki={enabled:!1,files:{},add:function(i,x){const e=I;this[e(2648)]!==!1&&(this[e(3830)][i]=x)},get:function(i){if(this[I(2648)]!==!1)return this.files[i]},remove:function(i){const x=I;delete this[x(3830)][i]},clear:function(){const i=I;this[i(3830)]={}}};class kf{constructor(x,e,t){const g=I,n=this;let s=!1,o=0,c=0,C;const r=[];this.onStart=void 0,this[g(3437)]=x,this[g(1339)]=e,this[g(3239)]=t,this.itemStart=function(A){const d=g;c++,s===!1&&n.onStart!==void 0&&n[d(2304)](A,o,c),s=!0},this.itemEnd=function(A){const d=g;o++,n[d(1339)]!==void 0&&n.onProgress(A,o,c),o===c&&(s=!1,n[d(3437)]!==void 0&&n.onLoad())},this[g(2783)]=function(A){const d=g;n[d(3239)]!==void 0&&n[d(3239)](A)},this[g(2878)]=function(A){return C?C(A):A},this.setURLModifier=function(A){return C=A,this},this[g(1645)]=function(A,d){return r[g(3330)](A,d),this},this[g(2303)]=function(A){const d=g,h=r.indexOf(A);return h!==-1&&r[d(2960)](h,2),this},this[g(3772)]=function(A){const d=g;for(let h=0,f=r.length;h<f;h+=2){const B=r[h],Z=r[h+1];if(B[d(457)]&&(B[d(3804)]=0),B[d(3633)](A))return Z}return null}}}const A3=new kf;class Jt{constructor(x){const e=I;this[e(1086)]=x!==void 0?x:A3,this[e(1922)]="anonymous",this.withCredentials=!1,this[e(3653)]="",this[e(2191)]="",this[e(3289)]={}}[I(3043)](){}[I(1831)](x,e){const t=this;return new Promise(function(g,n){t.load(x,g,e,n)})}parse(){}[I(3898)](x){return this.crossOrigin=x,this}[I(3221)](x){return this.withCredentials=x,this}[I(1575)](x){const e=I;return this[e(3653)]=x,this}[I(3558)](x){return this.resourcePath=x,this}[I(253)](x){const e=I;return this[e(3289)]=x,this}}Jt[I(791)]=I(1423);const Wi={};class wF extends Error{constructor(x,e){const t=I;super(x),this[t(1314)]=e}}class Ui extends Jt{constructor(x){super(x)}[I(3043)](x,e,t,g){const n=I;x===void 0&&(x=""),this[n(3653)]!==void 0&&(x=this[n(3653)]+x),x=this[n(1086)][n(2878)](x);const s=Ki[n(2695)](x);if(s!==void 0)return this[n(1086)][n(3723)](x),setTimeout(()=>{e&&e(s),this.manager.itemEnd(x)},0),s;if(Wi[x]!==void 0){Wi[x].push({onLoad:e,onProgress:t,onError:g});return}Wi[x]=[],Wi[x].push({onLoad:e,onProgress:t,onError:g});const o=new Request(x,{headers:new Headers(this.requestHeader),credentials:this[n(3845)]?"include":n(1469)}),c=this[n(2864)],C=this[n(1565)];fetch(o)[n(2334)](r=>{const A=n;if(r[A(3697)]===200||r[A(3697)]===0){if(r[A(3697)]===0&&console[A(3748)](A(3718)),typeof ReadableStream===A(1797)||r[A(1153)]===void 0||r[A(1153)].getReader===void 0)return r;const d=Wi[x],h=r.body[A(1152)](),f=r.headers[A(2695)](A(1723))||r[A(1805)][A(2695)](A(2719)),B=f?parseInt(f):0,Z=B!==0;let G=0;const m=new ReadableStream({start(v){p();function p(){h.read().then(({done:w,value:V})=>{const N=i0;if(w)v[N(2039)]();else{G+=V[N(835)];const X=new ProgressEvent("progress",{lengthComputable:Z,loaded:G,total:B});for(let M=0,Y=d.length;M<Y;M++){const S=d[M];S[N(1339)]&&S.onProgress(X)}v[N(3321)](V),p()}})}}});return new Response(m)}else throw new wF(A(604)+r[A(412)]+A(1234)+r[A(3697)]+": "+r[A(2434)],r)})[n(2334)](r=>{const A=n;switch(C){case A(3940):return r.arrayBuffer();case A(2319):return r[A(2319)]();case A(2597):return r[A(2274)]().then(d=>{const h=A;return new DOMParser()[h(925)](d,c)});case"json":return r[A(472)]();default:if(c===void 0)return r.text();{const d=/charset="?([^;"\s]*)"?/i,h=d[A(3193)](c),f=h&&h[1]?h[1].toLowerCase():void 0,B=new TextDecoder(f);return r[A(3648)]().then(Z=>B.decode(Z))}}})[n(2334)](r=>{const A=n;Ki.add(x,r);const d=Wi[x];delete Wi[x];for(let h=0,f=d.length;h<f;h++){const B=d[h];B[A(3437)]&&B.onLoad(r)}})[n(1107)](r=>{const A=n,d=Wi[x];if(d===void 0)throw this[A(1086)].itemError(x),r;delete Wi[x];for(let h=0,f=d[A(2989)];h<f;h++){const B=d[h];B[A(3239)]&&B.onError(r)}this[A(1086)][A(2783)](x)})[n(3417)](()=>{const r=n;this[r(1086)][r(2337)](x)}),this[n(1086)][n(3723)](x)}[I(2279)](x){const e=I;return this[e(1565)]=x,this}setMimeType(x){const e=I;return this[e(2864)]=x,this}}class RF extends Jt{constructor(x){super(x)}load(x,e,t,g){const n=I,s=this,o=new Ui(this.manager);o[n(1575)](this[n(3653)]),o[n(253)](this[n(3289)]),o[n(3221)](this[n(3845)]),o[n(3043)](x,function(c){const C=n;try{e(s[C(3073)](JSON.parse(c)))}catch(r){g?g(r):console[C(2963)](r),s[C(1086)][C(2783)](x)}},t,g)}parse(x){const e=I,t=[];for(let g=0;g<x[e(2989)];g++){const n=vC.parse(x[g]);t[e(3330)](n)}return t}}class VF extends Jt{constructor(x){super(x)}[I(3043)](x,e,t,g){const n=I,s=this,o=[],c=new V2,C=new Ui(this[n(1086)]);C.setPath(this[n(3653)]),C[n(2279)]("arraybuffer"),C.setRequestHeader(this.requestHeader),C[n(3221)](s[n(3845)]);let r=0;function A(d){const h=n;C[h(3043)](x[d],function(f){const B=h,Z=s.parse(f,!0);o[d]={width:Z[B(2315)],height:Z.height,format:Z.format,mipmaps:Z[B(2768)]},r+=1,r===6&&(Z.mipmapCount===1&&(c[B(3338)]=Ze),c.image=o,c[B(3207)]=Z[B(3207)],c.needsUpdate=!0,e&&e(c))},t,g)}if(Array[n(1987)](x))for(let d=0,h=x[n(2989)];d<h;++d)A(d);else C[n(3043)](x,function(d){const h=n,f=s[h(3073)](d,!0);if(f[h(1969)]){const B=f[h(2768)][h(2989)]/f[h(1428)];for(let Z=0;Z<B;Z++){o[Z]={mipmaps:[]};for(let G=0;G<f[h(1428)];G++)o[Z].mipmaps.push(f.mipmaps[Z*f[h(1428)]+G]),o[Z][h(3207)]=f[h(3207)],o[Z][h(2315)]=f.width,o[Z][h(2741)]=f[h(2741)]}c[h(1781)]=o}else c[h(1781)].width=f[h(2315)],c[h(1781)][h(2741)]=f[h(2741)],c.mipmaps=f[h(2768)];f[h(1428)]===1&&(c[h(3338)]=Ze),c[h(3207)]=f[h(3207)],c[h(2170)]=!0,e&&e(c)},t,g);return c}}class WC extends Jt{constructor(x){super(x)}[I(3043)](x,e,t,g){const n=I;this[n(3653)]!==void 0&&(x=this[n(3653)]+x),x=this.manager.resolveURL(x);const s=this,o=Ki[n(2695)](x);if(o!==void 0)return s[n(1086)][n(3723)](x),setTimeout(function(){const d=n;e&&e(o),s[d(1086)].itemEnd(x)},0),o;const c=fC(n(1380));function C(){const d=n;A(),Ki[d(3014)](x,this),e&&e(this),s[d(1086)][d(2337)](x)}function r(d){const h=n;A(),g&&g(d),s.manager.itemError(x),s[h(1086)][h(2337)](x)}function A(){const d=n;c[d(1216)](d(3043),C,!1),c.removeEventListener(d(2963),r,!1)}return c[n(2134)](n(3043),C,!1),c.addEventListener("error",r,!1),x[n(1226)](0,5)!==n(2977)&&this.crossOrigin!==void 0&&(c[n(1922)]=this[n(1922)]),s.manager.itemStart(x),c.src=x,c}}class SF extends Jt{constructor(x){super(x)}[I(3043)](x,e,t,g){const n=I,s=new FC;s[n(1549)]=Ag;const o=new WC(this[n(1086)]);o[n(3898)](this[n(1922)]),o[n(1575)](this[n(3653)]);let c=0;function C(r){const A=n;o[A(3043)](x[r],function(d){const h=A;s[h(2268)][r]=d,c++,c===6&&(s[h(2170)]=!0,e&&e(s))},void 0,g)}for(let r=0;r<x[n(2989)];++r)C(r);return s}}class XF extends Jt{constructor(x){super(x)}[I(3043)](x,e,t,g){const n=I,s=this,o=new Xn,c=new Ui(this[n(1086)]);return c[n(2279)](n(3940)),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c[n(3221)](s[n(3845)]),c[n(3043)](x,function(C){const r=n;let A;try{A=s[r(3073)](C)}catch(d){if(g!==void 0)g(d);else{console[r(2963)](d);return}}A.image!==void 0?o[r(1781)]=A[r(1781)]:A[r(3787)]!==void 0&&(o.image[r(2315)]=A[r(2315)],o.image[r(2741)]=A.height,o[r(1781)][r(3787)]=A[r(3787)]),o.wrapS=A.wrapS!==void 0?A[r(861)]:Gg,o[r(471)]=A[r(471)]!==void 0?A[r(471)]:Gg,o.magFilter=A.magFilter!==void 0?A[r(2637)]:Ze,o.minFilter=A.minFilter!==void 0?A[r(3338)]:Ze,o[r(2651)]=A[r(2651)]!==void 0?A[r(2651)]:1,A[r(1549)]!==void 0&&(o.colorSpace=A.colorSpace),A.flipY!==void 0&&(o.flipY=A.flipY),A.format!==void 0&&(o.format=A[r(3207)]),A[r(3505)]!==void 0&&(o[r(3505)]=A[r(3505)]),A[r(2768)]!==void 0&&(o[r(2768)]=A.mipmaps,o.minFilter=oi),A.mipmapCount===1&&(o[r(3338)]=Ze),A.generateMipmaps!==void 0&&(o[r(2787)]=A[r(2787)]),o.needsUpdate=!0,e&&e(o,A)},t,g),o}}class YF extends Jt{constructor(x){super(x)}[I(3043)](x,e,t,g){const n=I,s=new ue,o=new WC(this.manager);return o[n(3898)](this.crossOrigin),o[n(1575)](this[n(3653)]),o[n(3043)](x,function(c){const C=n;s.image=c,s[C(2170)]=!0,e!==void 0&&e(s)},t,g),s}}class Tn extends Nx{constructor(x,e=1){const t=I;super(),this.isLight=!0,this.type=t(3214),this[t(432)]=new Q0(x),this[t(1707)]=e}[I(1439)](){}[I(1493)](x,e){const t=I;return super[t(1493)](x,e),this[t(432)][t(1493)](x[t(432)]),this[t(1707)]=x[t(1707)],this}[I(2054)](x){const e=I,t=super.toJSON(x);return t[e(1011)].color=this.color[e(2830)](),t[e(1011)][e(1707)]=this[e(1707)],this[e(966)]!==void 0&&(t[e(1011)].groundColor=this[e(966)][e(2830)]()),this[e(3035)]!==void 0&&(t[e(1011)][e(3035)]=this[e(3035)]),this[e(3478)]!==void 0&&(t[e(1011)][e(3478)]=this[e(3478)]),this[e(2863)]!==void 0&&(t[e(1011)].decay=this[e(2863)]),this.penumbra!==void 0&&(t[e(1011)][e(1531)]=this.penumbra),this[e(1738)]!==void 0&&(t[e(1011)][e(1738)]=this[e(1738)][e(2054)]()),t}}class u3 extends Tn{constructor(x,e,t){const g=I;super(x,t),this[g(2186)]=!0,this[g(3505)]=g(2565),this[g(2817)][g(1493)](Nx.DEFAULT_UP),this[g(466)](),this[g(966)]=new Q0(e)}[I(1493)](x,e){const t=I;return super[t(1493)](x,e),this[t(966)][t(1493)](x[t(966)]),this}}const ru=new dx,qp=new E,$p=new E;class Tf{constructor(x){const e=I;this.camera=x,this[e(2676)]=0,this[e(2219)]=0,this[e(3015)]=1,this[e(139)]=8,this[e(3057)]=new S0(512,512),this.map=null,this[e(2799)]=null,this[e(1721)]=new dx,this[e(254)]=!0,this.needsUpdate=!1,this[e(2997)]=new zC,this._frameExtents=new S0(1,1),this[e(2396)]=1,this[e(2047)]=[new Dx(0,0,1,1)]}getViewportCount(){return this[I(2396)]}getFrustum(){return this[I(2997)]}[I(745)](x){const e=I,t=this[e(240)],g=this[e(1721)];qp[e(1577)](x[e(2368)]),t.position.copy(qp),$p[e(1577)](x[e(2930)][e(2368)]),t[e(2765)]($p),t[e(3554)](),ru.multiplyMatrices(t.projectionMatrix,t[e(2519)]),this[e(2997)][e(525)](ru),g[e(298)](.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),g[e(327)](ru)}getViewport(x){return this[I(2047)][x]}[I(3699)](){return this[I(3800)]}[I(1439)](){const x=I;this[x(3879)]&&this[x(3879)][x(1439)](),this.mapPass&&this[x(2799)].dispose()}copy(x){const e=I;return this.camera=x.camera[e(3123)](),this[e(2676)]=x[e(2676)],this[e(3015)]=x[e(3015)],this[e(3057)].copy(x[e(3057)]),this}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}toJSON(){const x=I,e={};return this[x(2676)]!==0&&(e.bias=this[x(2676)]),this[x(2219)]!==0&&(e[x(2219)]=this.normalBias),this[x(3015)]!==1&&(e[x(3015)]=this[x(3015)]),(this.mapSize.x!==512||this[x(3057)].y!==512)&&(e.mapSize=this[x(3057)].toArray()),e.camera=this.camera.toJSON(!1)[x(1011)],delete e[x(240)][x(1721)],e}}class KF extends Tf{constructor(){const x=I;super(new ze(50,1,.5,500)),this[x(2063)]=!0,this[x(2950)]=1}[I(745)](x){const e=I,t=this[e(240)],g=ho*2*x[e(3478)]*this[e(2950)],n=this[e(3057)][e(2315)]/this.mapSize[e(2741)],s=x.distance||t[e(1407)];(g!==t.fov||n!==t.aspect||s!==t[e(1407)])&&(t[e(1302)]=g,t[e(3455)]=n,t[e(1407)]=s,t[e(3947)]()),super.updateMatrices(x)}copy(x){const e=I;return super[e(1493)](x),this[e(2950)]=x[e(2950)],this}}class b3 extends Tn{constructor(x,e,t=0,g=Math.PI/3,n=0,s=2){const o=I;super(x,e),this[o(3603)]=!0,this[o(3505)]=o(481),this[o(2817)][o(1493)](Nx[o(511)]),this[o(466)](),this.target=new Nx,this.distance=t,this[o(3478)]=g,this[o(1531)]=n,this.decay=s,this.map=null,this[o(1738)]=new KF}get power(){return this[I(1707)]*Math.PI}set[I(262)](x){const e=I;this[e(1707)]=x/Math.PI}[I(1439)](){const x=I;this[x(1738)][x(1439)]()}[I(1493)](x,e){const t=I;return super[t(1493)](x,e),this.distance=x.distance,this[t(3478)]=x[t(3478)],this[t(1531)]=x[t(1531)],this.decay=x[t(2863)],this[t(2930)]=x[t(2930)][t(3123)](),this[t(1738)]=x[t(1738)].clone(),this}}const jp=new dx,uc=new E,du=new E;class HF extends Tf{constructor(){const x=I;super(new ze(90,1,.5,500)),this[x(2410)]=!0,this[x(3800)]=new S0(4,2),this._viewportCount=6,this[x(2047)]=[new Dx(2,1,1,1),new Dx(0,1,1,1),new Dx(3,1,1,1),new Dx(1,1,1,1),new Dx(3,0,1,1),new Dx(1,0,1,1)],this[x(1072)]=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}[I(745)](x,e=0){const t=I,g=this[t(240)],n=this[t(1721)],s=x[t(3035)]||g[t(1407)];s!==g[t(1407)]&&(g.far=s,g[t(3947)]()),uc[t(1577)](x[t(2368)]),g[t(2817)][t(1493)](uc),du[t(1493)](g[t(2817)]),du[t(3014)](this[t(1072)][e]),g.up[t(1493)](this._cubeUps[e]),g[t(2765)](du),g[t(3554)](),n[t(804)](-uc.x,-uc.y,-uc.z),jp[t(1418)](g[t(2900)],g.matrixWorldInverse),this[t(2997)][t(525)](jp)}}class h3 extends Tn{constructor(x,e,t=0,g=2){const n=I;super(x,e),this[n(716)]=!0,this[n(3505)]=n(2231),this[n(3035)]=t,this[n(2863)]=g,this[n(1738)]=new HF}get power(){return this[I(1707)]*4*Math.PI}set[I(262)](x){this.intensity=x/(4*Math.PI)}[I(1439)](){const x=I;this[x(1738)][x(1439)]()}copy(x,e){const t=I;return super[t(1493)](x,e),this.distance=x[t(3035)],this[t(2863)]=x[t(2863)],this.shadow=x.shadow[t(3123)](),this}}class NF extends Tf{constructor(){super(new MC(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class f3 extends Tn{constructor(x,e){const t=I;super(x,e),this[t(2632)]=!0,this[t(3505)]=t(484),this[t(2817)][t(1493)](Nx[t(511)]),this.updateMatrix(),this[t(2930)]=new Nx,this[t(1738)]=new NF}[I(1439)](){const x=I;this[x(1738)][x(1439)]()}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(2930)]=x[e(2930)].clone(),this[e(1738)]=x[e(1738)].clone(),this}}class m3 extends Tn{constructor(x,e){const t=I;super(x,e),this[t(3864)]=!0,this[t(3505)]=t(2422)}}class G3 extends Tn{constructor(x,e,t=10,g=10){const n=I;super(x,e),this[n(3348)]=!0,this[n(3505)]=n(2273),this[n(2315)]=t,this[n(2741)]=g}get[I(262)](){const x=I;return this[x(1707)]*this[x(2315)]*this[x(2741)]*Math.PI}set[I(262)](x){const e=I;this.intensity=x/(this.width*this[e(2741)]*Math.PI)}[I(1493)](x){const e=I;return super[e(1493)](x),this[e(2315)]=x[e(2315)],this[e(2741)]=x[e(2741)],this}[I(2054)](x){const e=I,t=super[e(2054)](x);return t.object[e(2315)]=this[e(2315)],t[e(1011)][e(2741)]=this[e(2741)],t}}class p3{constructor(){const x=I;this[x(1605)]=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new E)}[I(298)](x){for(let e=0;e<9;e++)this.coefficients[e].copy(x[e]);return this}zero(){const x=I;for(let e=0;e<9;e++)this.coefficients[e][x(298)](0,0,0);return this}[I(3650)](x,e){const t=I,g=x.x,n=x.y,s=x.z,o=this[t(3388)];return e[t(1493)](o[0])[t(2333)](.282095),e[t(832)](o[1],.488603*n),e[t(832)](o[2],.488603*s),e[t(832)](o[3],.488603*g),e.addScaledVector(o[4],1.092548*(g*n)),e.addScaledVector(o[5],1.092548*(n*s)),e[t(832)](o[6],.315392*(3*s*s-1)),e.addScaledVector(o[7],1.092548*(g*s)),e.addScaledVector(o[8],.546274*(g*g-n*n)),e}[I(3444)](x,e){const t=I,g=x.x,n=x.y,s=x.z,o=this[t(3388)];return e[t(1493)](o[0])[t(2333)](.886227),e[t(832)](o[1],2*.511664*n),e[t(832)](o[2],2*.511664*s),e[t(832)](o[3],2*.511664*g),e.addScaledVector(o[4],2*.429043*g*n),e[t(832)](o[5],2*.429043*n*s),e[t(832)](o[6],.743125*s*s-.247708),e[t(832)](o[7],2*.429043*g*s),e[t(832)](o[8],.429043*(g*g-n*n)),e}add(x){for(let e=0;e<9;e++)this.coefficients[e].add(x.coefficients[e]);return this}[I(2664)](x,e){const t=I;for(let g=0;g<9;g++)this[t(3388)][g][t(832)](x[t(3388)][g],e);return this}scale(x){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(x);return this}[I(3814)](x,e){const t=I;for(let g=0;g<9;g++)this[t(3388)][g].lerp(x[t(3388)][g],e);return this}[I(3106)](x){const e=I;for(let t=0;t<9;t++)if(!this[e(3388)][t][e(3106)](x[e(3388)][t]))return!1;return!0}[I(1493)](x){const e=I;return this[e(298)](x[e(3388)])}clone(){const x=I;return new this[x(135)]()[x(1493)](this)}[I(2793)](x,e=0){const t=I,g=this[t(3388)];for(let n=0;n<9;n++)g[n][t(2793)](x,e+n*3);return this}toArray(x=[],e=0){const t=I,g=this[t(3388)];for(let n=0;n<9;n++)g[n][t(3904)](x,e+n*3);return x}static[I(2534)](x,e){const t=x.x,g=x.y,n=x.z;e[0]=.282095,e[1]=.488603*g,e[2]=.488603*n,e[3]=.488603*t,e[4]=1.092548*t*g,e[5]=1.092548*g*n,e[6]=.315392*(3*n*n-1),e[7]=1.092548*t*n,e[8]=.546274*(t*t-g*g)}}class B3 extends Tn{constructor(x=new p3,e=1){const t=I;super(void 0,e),this[t(3452)]=!0,this.sh=x}[I(1493)](x){const e=I;return super.copy(x),this.sh[e(1493)](x.sh),this}fromJSON(x){const e=I;return this[e(1707)]=x[e(1707)],this.sh.fromArray(x.sh),this}[I(2054)](x){const e=I,t=super[e(2054)](x);return t.object.sh=this.sh[e(3904)](),t}}class U2 extends Jt{constructor(x){const e=I;super(x),this[e(353)]={}}load(x,e,t,g){const n=I,s=this,o=new Ui(s.manager);o[n(1575)](s.path),o[n(253)](s[n(3289)]),o[n(3221)](s[n(3845)]),o[n(3043)](x,function(c){const C=n;try{e(s[C(3073)](JSON[C(3073)](c)))}catch(r){g?g(r):console[C(2963)](r),s[C(1086)].itemError(x)}},t,g)}[I(3073)](x){const e=I,t=this[e(353)];function g(s){const o=e;return t[s]===void 0&&console[o(3748)]("THREE.MaterialLoader: Undefined texture",s),t[s]}const n=U2[e(2022)](x[e(3505)]);if(x[e(296)]!==void 0&&(n.uuid=x[e(296)]),x[e(1474)]!==void 0&&(n.name=x[e(1474)]),x[e(432)]!==void 0&&n[e(432)]!==void 0&&n.color[e(2189)](x[e(432)]),x[e(1383)]!==void 0&&(n.roughness=x[e(1383)]),x.metalness!==void 0&&(n[e(1194)]=x[e(1194)]),x[e(691)]!==void 0&&(n[e(691)]=x.sheen),x[e(179)]!==void 0&&(n[e(179)]=new Q0()[e(2189)](x[e(179)])),x[e(2882)]!==void 0&&(n[e(2882)]=x[e(2882)]),x[e(161)]!==void 0&&n[e(161)]!==void 0&&n[e(161)].setHex(x[e(161)]),x[e(2204)]!==void 0&&n[e(2204)]!==void 0&&n.specular[e(2189)](x[e(2204)]),x[e(480)]!==void 0&&(n[e(480)]=x[e(480)]),x[e(3525)]!==void 0&&n.specularColor!==void 0&&n[e(3525)][e(2189)](x.specularColor),x[e(1169)]!==void 0&&(n[e(1169)]=x.shininess),x[e(3916)]!==void 0&&(n.clearcoat=x[e(3916)]),x.clearcoatRoughness!==void 0&&(n[e(2893)]=x[e(2893)]),x[e(1625)]!==void 0&&(n.dispersion=x[e(1625)]),x.iridescence!==void 0&&(n[e(3175)]=x.iridescence),x[e(3986)]!==void 0&&(n.iridescenceIOR=x[e(3986)]),x[e(3739)]!==void 0&&(n.iridescenceThicknessRange=x.iridescenceThicknessRange),x.transmission!==void 0&&(n[e(3820)]=x[e(3820)]),x.thickness!==void 0&&(n[e(257)]=x[e(257)]),x.attenuationDistance!==void 0&&(n[e(1047)]=x[e(1047)]),x[e(1207)]!==void 0&&n[e(1207)]!==void 0&&n.attenuationColor[e(2189)](x.attenuationColor),x[e(2651)]!==void 0&&(n[e(2651)]=x.anisotropy),x.anisotropyRotation!==void 0&&(n[e(1214)]=x.anisotropyRotation),x[e(1382)]!==void 0&&(n[e(1382)]=x[e(1382)]),x[e(280)]!==void 0&&(n.flatShading=x[e(280)]),x[e(314)]!==void 0&&(n[e(314)]=x[e(314)]),x.combine!==void 0&&(n[e(2667)]=x[e(2667)]),x.side!==void 0&&(n.side=x[e(3601)]),x[e(2408)]!==void 0&&(n[e(2408)]=x[e(2408)]),x[e(2390)]!==void 0&&(n[e(2390)]=x[e(2390)]),x.transparent!==void 0&&(n[e(3249)]=x.transparent),x[e(151)]!==void 0&&(n[e(151)]=x[e(151)]),x[e(2959)]!==void 0&&(n[e(2959)]=x[e(2959)]),x[e(3222)]!==void 0&&(n[e(3222)]=x[e(3222)]),x[e(3329)]!==void 0&&(n[e(3329)]=x[e(3329)]),x[e(129)]!==void 0&&(n[e(129)]=x[e(129)]),x[e(339)]!==void 0&&(n[e(339)]=x.colorWrite),x[e(3939)]!==void 0&&(n[e(3939)]=x[e(3939)]),x[e(1179)]!==void 0&&(n.blendDst=x.blendDst),x[e(3664)]!==void 0&&(n[e(3664)]=x[e(3664)]),x[e(2842)]!==void 0&&(n[e(2842)]=x[e(2842)]),x[e(846)]!==void 0&&(n[e(846)]=x[e(846)]),x[e(926)]!==void 0&&(n.blendEquationAlpha=x[e(926)]),x[e(3132)]!==void 0&&n[e(3132)]!==void 0&&n[e(3132)][e(2189)](x[e(3132)]),x.blendAlpha!==void 0&&(n[e(399)]=x[e(399)]),x.stencilWriteMask!==void 0&&(n.stencilWriteMask=x[e(3137)]),x.stencilFunc!==void 0&&(n[e(2139)]=x[e(2139)]),x[e(3906)]!==void 0&&(n[e(3906)]=x[e(3906)]),x.stencilFuncMask!==void 0&&(n[e(3536)]=x[e(3536)]),x.stencilFail!==void 0&&(n[e(2573)]=x[e(2573)]),x.stencilZFail!==void 0&&(n[e(2109)]=x[e(2109)]),x.stencilZPass!==void 0&&(n[e(3809)]=x[e(3809)]),x[e(903)]!==void 0&&(n[e(903)]=x[e(903)]),x[e(2734)]!==void 0&&(n.wireframe=x.wireframe),x[e(1979)]!==void 0&&(n[e(1979)]=x[e(1979)]),x.wireframeLinecap!==void 0&&(n.wireframeLinecap=x[e(579)]),x[e(1897)]!==void 0&&(n[e(1897)]=x[e(1897)]),x[e(1488)]!==void 0&&(n.rotation=x.rotation),x[e(3725)]!==void 0&&(n[e(3725)]=x.linewidth),x[e(1361)]!==void 0&&(n[e(1361)]=x[e(1361)]),x[e(1835)]!==void 0&&(n.gapSize=x[e(1835)]),x[e(623)]!==void 0&&(n[e(623)]=x[e(623)]),x.polygonOffset!==void 0&&(n[e(492)]=x[e(492)]),x[e(2996)]!==void 0&&(n.polygonOffsetFactor=x[e(2996)]),x[e(1215)]!==void 0&&(n[e(1215)]=x[e(1215)]),x[e(1952)]!==void 0&&(n[e(1952)]=x[e(1952)]),x[e(1283)]!==void 0&&(n[e(1283)]=x[e(1283)]),x[e(3696)]!==void 0&&(n[e(3696)]=x[e(3696)]),x[e(3374)]!==void 0&&(n[e(3374)]=x.forceSinglePass),x[e(2548)]!==void 0&&(n[e(2548)]=x.visible),x[e(572)]!==void 0&&(n[e(572)]=x[e(572)]),x[e(358)]!==void 0&&(n[e(358)]=x[e(358)]),x[e(123)]!==void 0&&(typeof x[e(123)]===e(1025)?n[e(123)]=x[e(123)]>0:n[e(123)]=x[e(123)]),x[e(3901)]!==void 0)for(const s in x.uniforms){const o=x[e(3901)][s];switch(n[e(3901)][s]={},o.type){case"t":n.uniforms[s].value=g(o[e(2113)]);break;case"c":n[e(3901)][s][e(2113)]=new Q0()[e(2189)](o[e(2113)]);break;case"v2":n[e(3901)][s][e(2113)]=new S0()[e(2793)](o.value);break;case"v3":n[e(3901)][s].value=new E()[e(2793)](o.value);break;case"v4":n[e(3901)][s][e(2113)]=new Dx()[e(2793)](o[e(2113)]);break;case"m3":n[e(3901)][s][e(2113)]=new px()[e(2793)](o[e(2113)]);break;case"m4":n[e(3901)][s].value=new dx()[e(2793)](o[e(2113)]);break;default:n[e(3901)][s].value=o[e(2113)]}}if(x.defines!==void 0&&(n.defines=x[e(3891)]),x[e(3353)]!==void 0&&(n[e(3353)]=x[e(3353)]),x[e(3060)]!==void 0&&(n[e(3060)]=x[e(3060)]),x[e(3614)]!==void 0&&(n[e(3614)]=x.glslVersion),x[e(986)]!==void 0)for(const s in x[e(986)])n[e(986)][s]=x.extensions[s];if(x.lights!==void 0&&(n[e(1480)]=x.lights),x[e(933)]!==void 0&&(n[e(933)]=x[e(933)]),x[e(1019)]!==void 0&&(n.size=x[e(1019)]),x[e(965)]!==void 0&&(n[e(965)]=x[e(965)]),x[e(3879)]!==void 0&&(n[e(3879)]=g(x.map)),x.matcap!==void 0&&(n.matcap=g(x[e(126)])),x.alphaMap!==void 0&&(n.alphaMap=g(x.alphaMap)),x.bumpMap!==void 0&&(n[e(2210)]=g(x[e(2210)])),x[e(340)]!==void 0&&(n[e(340)]=x[e(340)]),x[e(2712)]!==void 0&&(n[e(2712)]=g(x[e(2712)])),x[e(2308)]!==void 0&&(n[e(2308)]=x[e(2308)]),x[e(2733)]!==void 0){let s=x[e(2733)];Array[e(1987)](s)===!1&&(s=[s,s]),n.normalScale=new S0()[e(2793)](s)}return x.displacementMap!==void 0&&(n.displacementMap=g(x[e(1638)])),x.displacementScale!==void 0&&(n[e(2523)]=x[e(2523)]),x[e(977)]!==void 0&&(n[e(977)]=x.displacementBias),x[e(1372)]!==void 0&&(n[e(1372)]=g(x[e(1372)])),x[e(2594)]!==void 0&&(n[e(2594)]=g(x[e(2594)])),x[e(833)]!==void 0&&(n.emissiveMap=g(x[e(833)])),x[e(747)]!==void 0&&(n.emissiveIntensity=x[e(747)]),x.specularMap!==void 0&&(n[e(2887)]=g(x[e(2887)])),x[e(1499)]!==void 0&&(n[e(1499)]=g(x[e(1499)])),x[e(1335)]!==void 0&&(n[e(1335)]=g(x[e(1335)])),x[e(1300)]!==void 0&&(n[e(1300)]=g(x[e(1300)])),x[e(1043)]!==void 0&&n.envMapRotation[e(2793)](x.envMapRotation),x.envMapIntensity!==void 0&&(n[e(1639)]=x[e(1639)]),x.reflectivity!==void 0&&(n.reflectivity=x[e(1695)]),x[e(3241)]!==void 0&&(n[e(3241)]=x.refractionRatio),x[e(3997)]!==void 0&&(n.lightMap=g(x[e(3997)])),x[e(899)]!==void 0&&(n[e(899)]=x.lightMapIntensity),x[e(2042)]!==void 0&&(n.aoMap=g(x[e(2042)])),x[e(904)]!==void 0&&(n[e(904)]=x[e(904)]),x[e(3023)]!==void 0&&(n.gradientMap=g(x[e(3023)])),x[e(2539)]!==void 0&&(n[e(2539)]=g(x.clearcoatMap)),x[e(241)]!==void 0&&(n.clearcoatRoughnessMap=g(x[e(241)])),x[e(1881)]!==void 0&&(n[e(1881)]=g(x[e(1881)])),x[e(1402)]!==void 0&&(n[e(1402)]=new S0().fromArray(x[e(1402)])),x.iridescenceMap!==void 0&&(n[e(2374)]=g(x.iridescenceMap)),x[e(1904)]!==void 0&&(n.iridescenceThicknessMap=g(x[e(1904)])),x[e(3403)]!==void 0&&(n[e(3403)]=g(x[e(3403)])),x[e(2200)]!==void 0&&(n[e(2200)]=g(x[e(2200)])),x[e(590)]!==void 0&&(n[e(590)]=g(x[e(590)])),x.sheenColorMap!==void 0&&(n.sheenColorMap=g(x[e(2416)])),x[e(3990)]!==void 0&&(n[e(3990)]=g(x.sheenRoughnessMap)),n}setTextures(x){const e=I;return this[e(353)]=x,this}static[I(2022)](x){const e={ShadowMaterial:e3,SpriteMaterial:wf,RawShaderMaterial:t3,ShaderMaterial:Eg,PointsMaterial:Vf,MeshPhysicalMaterial:g3,MeshStandardMaterial:Ff,MeshPhongMaterial:i3,MeshToonMaterial:n3,MeshNormalMaterial:I3,MeshLambertMaterial:s3,MeshDepthMaterial:yf,MeshDistanceMaterial:vf,MeshBasicMaterial:Ln,MeshMatcapMaterial:o3,LineDashedMaterial:c3,LineBasicMaterial:vt,Material:lt};return new e[x]}}class lh{static[I(2739)](x){const e=I;if(typeof TextDecoder!==e(1797))return new TextDecoder()[e(2710)](x);let t="";for(let g=0,n=x[e(2989)];g<n;g++)t+=String[e(1880)](x[g]);try{return decodeURIComponent(escape(t))}catch{return t}}static[I(3410)](x){const e=I,t=x[e(551)]("/");return t===-1?"./":x[e(1226)](0,t+1)}static resolveURL(x,e){const t=I;return typeof x!==t(3674)||x===""?"":(/^https?:\/\//i[t(3633)](e)&&/^\//[t(3633)](x)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i[t(3633)](x)||/^data:.*,.*$/i[t(3633)](x)||/^blob:.*$/i.test(x)?x:e+x)}}class Z3 extends vx{constructor(){const x=I;super(),this.isInstancedBufferGeometry=!0,this[x(3505)]=x(3201),this.instanceCount=1/0}copy(x){const e=I;return super.copy(x),this[e(3059)]=x[e(3059)],this}toJSON(){const x=I,e=super[x(2054)]();return e.instanceCount=this[x(3059)],e[x(2137)]=!0,e}}class y3 extends Jt{constructor(x){super(x)}load(x,e,t,g){const n=I,s=this,o=new Ui(s.manager);o[n(1575)](s[n(3653)]),o[n(253)](s[n(3289)]),o[n(3221)](s[n(3845)]),o[n(3043)](x,function(c){const C=n;try{e(s[C(3073)](JSON[C(3073)](c)))}catch(r){g?g(r):console[C(2963)](r),s[C(1086)][C(2783)](x)}},t,g)}[I(3073)](x){const e=I,t={},g={};function n(f,B){const Z=i0;if(t[B]!==void 0)return t[B];const G=f[Z(2340)],m=G[B],v=s(f,m[Z(2360)]),p=Qs(m.type,v),w=new w2(p,m.stride);return w.uuid=m.uuid,t[B]=w,w}function s(f,B){const Z=i0;if(g[B]!==void 0)return g[B];const G=f.arrayBuffers,m=G[B],v=new Uint32Array(m)[Z(2360)];return g[B]=v,v}const o=x[e(2137)]?new Z3:new vx,c=x[e(3787)][e(587)];if(c!==void 0){const f=Qs(c[e(3505)],c[e(315)]);o.setIndex(new Px(f,1))}const C=x.data[e(2593)];for(const f in C){const B=C[f];let Z;if(B.isInterleavedBufferAttribute){const G=n(x[e(3787)],B[e(3787)]);Z=new TI(G,B[e(365)],B[e(872)],B[e(1894)])}else{const G=Qs(B.type,B.array),m=B[e(3497)]?mo:Px;Z=new m(G,B[e(365)],B[e(1894)])}B.name!==void 0&&(Z[e(1474)]=B[e(1474)]),B[e(1676)]!==void 0&&Z[e(1504)](B[e(1676)]),o.setAttribute(f,Z)}const r=x.data[e(593)];if(r)for(const f in r){const B=r[f],Z=[];for(let G=0,m=B.length;G<m;G++){const v=B[G];let p;if(v[e(2568)]){const w=n(x[e(3787)],v.data);p=new TI(w,v[e(365)],v[e(872)],v[e(1894)])}else{const w=Qs(v.type,v[e(315)]);p=new Px(w,v[e(365)],v.normalized)}v[e(1474)]!==void 0&&(p[e(1474)]=v[e(1474)]),Z[e(3330)](p)}o[e(593)][f]=Z}x[e(3787)][e(316)]&&(o[e(316)]=!0);const d=x.data[e(919)]||x[e(3787)][e(2586)]||x.data.offsets;if(d!==void 0)for(let f=0,B=d[e(2989)];f!==B;++f){const Z=d[f];o[e(184)](Z[e(3988)],Z[e(3411)],Z[e(2468)])}const h=x[e(3787)][e(3636)];if(h!==void 0){const f=new E;h[e(3416)]!==void 0&&f[e(2793)](h.center),o[e(3636)]=new ct(f,h[e(3015)])}return x[e(1474)]&&(o[e(1474)]=x[e(1474)]),x[e(358)]&&(o[e(358)]=x[e(358)]),o}}class FF extends Jt{constructor(x){super(x)}load(x,e,t,g){const n=I,s=this,o=this[n(3653)]===""?lh[n(3410)](x):this[n(3653)];this[n(2191)]=this[n(2191)]||o;const c=new Ui(this.manager);c[n(1575)](this[n(3653)]),c[n(253)](this[n(3289)]),c.setWithCredentials(this.withCredentials),c[n(3043)](x,function(C){const r=n;let A=null;try{A=JSON[r(3073)](C)}catch(h){g!==void 0&&g(h),console[r(2963)]("THREE:ObjectLoader: Can't parse "+x+".",h[r(268)]);return}const d=A[r(1832)];if(d===void 0||d[r(3505)]===void 0||d[r(3505)][r(2084)]()===r(352)){g!==void 0&&g(new Error(r(3229)+x)),console[r(2963)](r(3229)+x);return}s[r(3073)](A,e)},t,g)}async[I(1831)](x,e){const t=I,g=this,n=this[t(3653)]===""?lh[t(3410)](x):this[t(3653)];this[t(2191)]=this.resourcePath||n;const s=new Ui(this[t(1086)]);s[t(1575)](this[t(3653)]),s[t(253)](this[t(3289)]),s[t(3221)](this[t(3845)]);const o=await s[t(1831)](x,e),c=JSON.parse(o),C=c[t(1832)];if(C===void 0||C.type===void 0||C[t(3505)].toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+x);return await g[t(3159)](c)}[I(3073)](x,e){const t=I,g=this[t(1248)](x[t(2933)]),n=this[t(3350)](x[t(2386)]),s=this[t(3873)](x[t(1028)],n),o=this.parseImages(x[t(2268)],function(){e!==void 0&&e(r)}),c=this[t(939)](x[t(353)],o),C=this[t(1961)](x[t(3080)],c),r=this[t(2983)](x[t(1011)],s,C,c,g),A=this[t(2622)](x[t(2813)],r);if(this.bindSkeletons(r,A),e!==void 0){let d=!1;for(const h in o)if(o[h][t(3787)]instanceof HTMLImageElement){d=!0;break}d===!1&&e(r)}return r}async[I(3159)](x){const e=I,t=this[e(1248)](x[e(2933)]),g=this[e(3350)](x[e(2386)]),n=this.parseGeometries(x.geometries,g),s=await this[e(1536)](x[e(2268)]),o=this[e(939)](x[e(353)],s),c=this[e(1961)](x[e(3080)],o),C=this[e(2983)](x[e(1011)],n,c,o,t),r=this.parseSkeletons(x[e(2813)],C);return this[e(768)](C,r),C}[I(3350)](x){const e=I,t={};if(x!==void 0)for(let g=0,n=x[e(2989)];g<n;g++){const s=new HI()[e(3385)](x[g]);t[s[e(296)]]=s}return t}[I(2622)](x,e){const t=I,g={},n={};if(e.traverse(function(s){const o=i0;s.isBone&&(n[s[o(296)]]=s)}),x!==void 0)for(let s=0,o=x.length;s<o;s++){const c=new R2()[t(3385)](x[s],n);g[c[t(296)]]=c}return g}[I(3873)](x,e){const t=I,g={};if(x!==void 0){const n=new y3;for(let s=0,o=x.length;s<o;s++){let c;const C=x[s];switch(C[t(3505)]){case t(3982):case t(3201):c=n[t(3073)](C);break;default:C[t(3505)]in Op?c=Op[C[t(3505)]][t(3385)](C,e):console[t(3748)](t(2906)+C[t(3505)]+'"')}c.uuid=C[t(296)],C[t(1474)]!==void 0&&(c[t(1474)]=C[t(1474)]),C[t(358)]!==void 0&&(c.userData=C[t(358)]),g[C[t(296)]]=c}}return g}[I(1961)](x,e){const t=I,g={},n={};if(x!==void 0){const s=new U2;s[t(2153)](e);for(let o=0,c=x[t(2989)];o<c;o++){const C=x[o];g[C[t(296)]]===void 0&&(g[C[t(296)]]=s.parse(C)),n[C[t(296)]]=g[C[t(296)]]}}return n}[I(1248)](x){const e=I,t={};if(x!==void 0)for(let g=0;g<x[e(2989)];g++){const n=x[g],s=vC[e(3073)](n);t[s[e(296)]]=s}return t}[I(3649)](x,e){const t=I,g=this,n={};let s;function o(C){const r=i0;return g.manager[r(3723)](C),s[r(3043)](C,function(){const A=r;g[A(1086)][A(2337)](C)},void 0,function(){const A=r;g[A(1086)][A(2783)](C),g[A(1086)][A(2337)](C)})}function c(C){const r=i0;if(typeof C===r(3674)){const A=C,d=/^(\/\/)|([a-z]+:(\/\/)?)/i[r(3633)](A)?A:g.resourcePath+A;return o(d)}else return C[r(3787)]?{data:Qs(C[r(3505)],C[r(3787)]),width:C[r(2315)],height:C[r(2741)]}:null}if(x!==void 0&&x[t(2989)]>0){const C=new kf(e);s=new WC(C),s[t(3898)](this.crossOrigin);for(let r=0,A=x[t(2989)];r<A;r++){const d=x[r],h=d.url;if(Array[t(1987)](h)){const f=[];for(let B=0,Z=h.length;B<Z;B++){const G=h[B],m=c(G);m!==null&&(m instanceof HTMLImageElement?f.push(m):f.push(new Xn(m[t(3787)],m[t(2315)],m[t(2741)])))}n[d[t(296)]]=new WI(f)}else{const f=c(d[t(412)]);n[d.uuid]=new WI(f)}}}return n}async[I(1536)](x){const e=I,t=this,g={};let n;async function s(o){const c=i0;if(typeof o=="string"){const C=o,r=/^(\/\/)|([a-z]+:(\/\/)?)/i[c(3633)](C)?C:t.resourcePath+C;return await n.loadAsync(r)}else return o[c(3787)]?{data:Qs(o.type,o[c(3787)]),width:o[c(2315)],height:o[c(2741)]}:null}if(x!==void 0&&x.length>0){n=new WC(this[e(1086)]),n.setCrossOrigin(this[e(1922)]);for(let o=0,c=x[e(2989)];o<c;o++){const C=x[o],r=C[e(412)];if(Array.isArray(r)){const A=[];for(let d=0,h=r[e(2989)];d<h;d++){const f=r[d],B=await s(f);B!==null&&(B instanceof HTMLImageElement?A[e(3330)](B):A[e(3330)](new Xn(B[e(3787)],B[e(2315)],B[e(2741)])))}g[C[e(296)]]=new WI(A)}else{const A=await s(C[e(412)]);g[C.uuid]=new WI(A)}}}return g}[I(939)](x,e){const t=I;function g(s,o){const c=i0;return typeof s===c(1025)?s:(console[c(3748)](c(2709),s),o[s])}const n={};if(x!==void 0)for(let s=0,o=x[t(2989)];s<o;s++){const c=x[s];c[t(1781)]===void 0&&console[t(3748)]('THREE.ObjectLoader: No "image" specified for',c[t(296)]),e[c[t(1781)]]===void 0&&console[t(3748)]("THREE.ObjectLoader: Undefined image",c.image);const C=e[c[t(1781)]],r=C[t(3787)];let A;Array[t(1987)](r)?(A=new FC,r.length===6&&(A.needsUpdate=!0)):(r&&r[t(3787)]?A=new Xn:A=new ue,r&&(A.needsUpdate=!0)),A[t(3272)]=C,A[t(296)]=c.uuid,c.name!==void 0&&(A.name=c[t(1474)]),c.mapping!==void 0&&(A[t(3099)]=g(c[t(3099)],zF)),c[t(2168)]!==void 0&&(A[t(2168)]=c[t(2168)]),c[t(872)]!==void 0&&A[t(872)].fromArray(c[t(872)]),c.repeat!==void 0&&A[t(3309)][t(2793)](c[t(3309)]),c[t(3416)]!==void 0&&A.center[t(2793)](c.center),c[t(1488)]!==void 0&&(A.rotation=c[t(1488)]),c[t(1583)]!==void 0&&(A[t(861)]=g(c.wrap[0],xB),A.wrapT=g(c[t(1583)][1],xB)),c[t(3207)]!==void 0&&(A[t(3207)]=c[t(3207)]),c[t(724)]!==void 0&&(A[t(724)]=c[t(724)]),c[t(3505)]!==void 0&&(A[t(3505)]=c[t(3505)]),c[t(1549)]!==void 0&&(A[t(1549)]=c.colorSpace),c[t(3338)]!==void 0&&(A.minFilter=g(c[t(3338)],eB)),c[t(2637)]!==void 0&&(A.magFilter=g(c[t(2637)],eB)),c[t(2651)]!==void 0&&(A[t(2651)]=c[t(2651)]),c[t(233)]!==void 0&&(A[t(233)]=c.flipY),c[t(2787)]!==void 0&&(A[t(2787)]=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(A[t(3721)]=c.premultiplyAlpha),c[t(1005)]!==void 0&&(A[t(1005)]=c[t(1005)]),c[t(1446)]!==void 0&&(A[t(1446)]=c.compareFunction),c.userData!==void 0&&(A[t(358)]=c.userData),n[c[t(296)]]=A}return n}[I(2983)](x,e,t,g,n){const s=I;let o;function c(h){const f=i0;return e[h]===void 0&&console[f(3748)](f(3121),h),e[h]}function C(h){const f=i0;if(h!==void 0){if(Array.isArray(h)){const B=[];for(let Z=0,G=h[f(2989)];Z<G;Z++){const m=h[Z];t[m]===void 0&&console.warn(f(3003),m),B[f(3330)](t[m])}return B}return t[h]===void 0&&console[f(3748)](f(3003),h),t[h]}}function r(h){const f=i0;return g[h]===void 0&&console[f(3748)](f(371),h),g[h]}let A,d;switch(x[s(3505)]){case s(3199):o=new Wf,x[s(2393)]!==void 0&&(Number[s(3365)](x.background)?o[s(2393)]=new Q0(x[s(2393)]):o[s(2393)]=r(x[s(2393)])),x[s(2731)]!==void 0&&(o[s(2731)]=r(x[s(2731)])),x[s(1382)]!==void 0&&(x[s(1382)].type==="Fog"?o[s(1382)]=new W2(x[s(1382)][s(432)],x[s(1382)][s(2987)],x[s(1382)][s(1407)]):x.fog[s(3505)]==="FogExp2"&&(o[s(1382)]=new v2(x[s(1382)].color,x[s(1382)][s(2699)])),x[s(1382)][s(1474)]!==""&&(o[s(1382)][s(1474)]=x[s(1382)][s(1474)])),x[s(3215)]!==void 0&&(o[s(3215)]=x.backgroundBlurriness),x[s(3844)]!==void 0&&(o.backgroundIntensity=x[s(3844)]),x[s(2311)]!==void 0&&o[s(2311)][s(2793)](x[s(2311)]),x.environmentIntensity!==void 0&&(o[s(1595)]=x[s(1595)]),x[s(3581)]!==void 0&&o[s(3581)][s(2793)](x[s(3581)]);break;case s(378):o=new ze(x[s(1302)],x[s(3455)],x[s(2987)],x[s(1407)]),x.focus!==void 0&&(o.focus=x.focus),x[s(3981)]!==void 0&&(o[s(3981)]=x[s(3981)]),x[s(3970)]!==void 0&&(o[s(3970)]=x[s(3970)]),x[s(3976)]!==void 0&&(o[s(3976)]=x[s(3976)]),x[s(2728)]!==void 0&&(o.view=Object.assign({},x.view));break;case s(1262):o=new MC(x[s(2881)],x[s(1913)],x.top,x[s(801)],x[s(2987)],x[s(1407)]),x[s(3981)]!==void 0&&(o[s(3981)]=x.zoom),x[s(2728)]!==void 0&&(o[s(2728)]=Object[s(1859)]({},x[s(2728)]));break;case s(2422):o=new m3(x[s(432)],x[s(1707)]);break;case"DirectionalLight":o=new f3(x.color,x[s(1707)]);break;case"PointLight":o=new h3(x[s(432)],x[s(1707)],x[s(3035)],x.decay);break;case s(2273):o=new G3(x[s(432)],x[s(1707)],x.width,x[s(2741)]);break;case"SpotLight":o=new b3(x.color,x[s(1707)],x[s(3035)],x.angle,x[s(1531)],x[s(2863)]);break;case s(2565):o=new u3(x.color,x[s(966)],x[s(1707)]);break;case s(3141):o=new B3()[s(3385)](x);break;case s(1273):A=c(x.geometry),d=C(x[s(3480)]),o=new kv(A,d),x.bindMode!==void 0&&(o.bindMode=x[s(2313)]),x[s(635)]!==void 0&&o[s(635)][s(2793)](x[s(635)]),x[s(2148)]!==void 0&&(o[s(2148)]=x[s(2148)]);break;case s(483):A=c(x[s(352)]),d=C(x[s(3480)]),o=new ye(A,d);break;case s(2952):A=c(x[s(352)]),d=C(x[s(3480)]);const h=x[s(3411)],f=x[s(1068)],B=x[s(1224)];o=new so(A,d,h),o[s(1068)]=new mo(new Float32Array(f.array),16),B!==void 0&&(o[s(1224)]=new mo(new Float32Array(B[s(315)]),B[s(365)]));break;case s(272):A=c(x[s(352)]),d=C(x.material),o=new Tv(x[s(1957)],x[s(920)],x[s(1696)],d),o.geometry=A,o.perObjectFrustumCulled=x[s(916)],o[s(1371)]=x[s(1371)],o[s(2692)]=x[s(182)],o._reservedRanges=x.reservedRanges,o[s(3065)]=x[s(2282)],o[s(3765)]=x[s(2706)],o._bounds=x[s(2325)][s(3879)](Z=>{const G=s,m=new yt;m[G(1410)][G(2793)](Z[G(2292)]),m[G(1971)][G(2793)](Z[G(3935)]);const v=new ct;return v[G(3015)]=Z.sphereRadius,v[G(3416)][G(2793)](Z[G(1246)]),{boxInitialized:Z[G(906)],box:m,sphereInitialized:Z.sphereInitialized,sphere:v}}),o[s(2896)]=x[s(1957)],o._maxVertexCount=x[s(920)],o._maxIndexCount=x.maxIndexCount,o._geometryInitialized=x[s(3545)],o[s(987)]=x[s(2611)],o[s(1245)]=r(x[s(2584)][s(296)]);break;case s(2714):o=new Lv;break;case s(2743):o=new Nn(c(x[s(352)]),C(x[s(3480)]));break;case"LineLoop":o=new Jv(c(x[s(352)]),C(x[s(3480)]));break;case s(1503):o=new Ai(c(x.geometry),C(x.material));break;case s(618):case s(1674):o=new Ev(c(x[s(352)]),C(x[s(3480)]));break;case s(2160):o=new Mv(C(x.material));break;case s(2156):o=new Os;break;case"Bone":o=new Rf;break;default:o=new Nx}if(o[s(296)]=x.uuid,x[s(1474)]!==void 0&&(o[s(1474)]=x[s(1474)]),x[s(1721)]!==void 0?(o[s(1721)].fromArray(x[s(1721)]),x[s(2272)]!==void 0&&(o[s(2272)]=x[s(2272)]),o[s(2272)]&&o.matrix[s(2986)](o[s(2817)],o[s(3915)],o.scale)):(x[s(2817)]!==void 0&&o.position[s(2793)](x[s(2817)]),x[s(1488)]!==void 0&&o.rotation[s(2793)](x.rotation),x.quaternion!==void 0&&o[s(3915)].fromArray(x[s(3915)]),x[s(623)]!==void 0&&o[s(623)][s(2793)](x.scale)),x.up!==void 0&&o.up[s(2793)](x.up),x[s(1239)]!==void 0&&(o[s(1239)]=x[s(1239)]),x[s(3328)]!==void 0&&(o[s(3328)]=x[s(3328)]),x[s(1738)]&&(x[s(1738)][s(2676)]!==void 0&&(o[s(1738)][s(2676)]=x[s(1738)].bias),x[s(1738)][s(2219)]!==void 0&&(o.shadow.normalBias=x[s(1738)][s(2219)]),x[s(1738)][s(3015)]!==void 0&&(o[s(1738)].radius=x[s(1738)][s(3015)]),x[s(1738)].mapSize!==void 0&&o[s(1738)][s(3057)][s(2793)](x[s(1738)].mapSize),x[s(1738)][s(240)]!==void 0&&(o[s(1738)][s(240)]=this[s(2983)](x[s(1738)][s(240)]))),x[s(2548)]!==void 0&&(o.visible=x.visible),x[s(1131)]!==void 0&&(o.frustumCulled=x[s(1131)]),x.renderOrder!==void 0&&(o[s(3238)]=x[s(3238)]),x[s(358)]!==void 0&&(o[s(358)]=x[s(358)]),x[s(2669)]!==void 0&&(o[s(2669)][s(829)]=x[s(2669)]),x.children!==void 0){const h=x[s(1352)];for(let f=0;f<h[s(2989)];f++)o.add(this[s(2983)](h[f],e,t,g,n))}if(x.animations!==void 0){const h=x[s(2933)];for(let f=0;f<h[s(2989)];f++){const B=h[f];o.animations[s(3330)](n[B])}}if(x[s(3505)]===s(2714)){x.autoUpdate!==void 0&&(o.autoUpdate=x[s(254)]);const h=x[s(1348)];for(let f=0;f<h[s(2989)];f++){const B=h[f],Z=o.getObjectByProperty(s(296),B[s(1011)]);Z!==void 0&&o[s(3116)](Z,B[s(3035)],B[s(3880)])}}return o}[I(768)](x,e){const t=I;Object.keys(e)[t(2989)]!==0&&x[t(1044)](function(g){const n=t;if(g[n(1305)]===!0&&g[n(2148)]!==void 0){const s=e[g.skeleton];s===void 0?console[n(3748)]("THREE.ObjectLoader: No skeleton found with UUID:",g[n(2148)]):g[n(1600)](s,g[n(635)])}})}}const zF={UVMapping:G2,CubeReflectionMapping:Ei,CubeRefractionMapping:Hn,EquirectangularReflectionMapping:sC,EquirectangularRefractionMapping:oC,CubeUVReflectionMapping:Zo},xB={RepeatWrapping:cC,ClampToEdgeWrapping:Gg,MirroredRepeatWrapping:CC},eB={NearestFilter:Me,NearestMipmapNearestFilter:of,NearestMipmapLinearFilter:Ds,LinearFilter:Ze,LinearMipmapNearestFilter:Mc,LinearMipmapLinearFilter:oi};class MF extends Jt{constructor(x){const e=I;super(x),this.isImageBitmapLoader=!0,typeof createImageBitmap===e(1797)&&console[e(3748)](e(808)),typeof fetch===e(1797)&&console[e(3748)]("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:e(2608)}}[I(2965)](x){return this.options=x,this}load(x,e,t,g){const n=I;x===void 0&&(x=""),this[n(3653)]!==void 0&&(x=this[n(3653)]+x),x=this.manager.resolveURL(x);const s=this,o=Ki[n(2695)](x);if(o!==void 0){if(s[n(1086)].itemStart(x),o[n(2334)]){o[n(2334)](r=>{const A=n;e&&e(r),s[A(1086)][A(2337)](x)})[n(1107)](r=>{g&&g(r)});return}return setTimeout(function(){const r=n;e&&e(o),s.manager[r(2337)](x)},0),o}const c={};c[n(2911)]=this[n(1922)]==="anonymous"?"same-origin":n(2910),c[n(1805)]=this[n(3289)];const C=fetch(x,c)[n(2334)](function(r){return r[n(2319)]()})[n(2334)](function(r){const A=n;return createImageBitmap(r,Object[A(1859)](s[A(1198)],{colorSpaceConversion:A(2608)}))})[n(2334)](function(r){const A=n;return Ki[A(3014)](x,r),e&&e(r),s[A(1086)][A(2337)](x),r}).catch(function(r){const A=n;g&&g(r),Ki[A(2208)](x),s[A(1086)][A(2783)](x),s[A(1086)][A(2337)](x)});Ki[n(3014)](x,C),s[n(1086)][n(3723)](x)}}let Ua;class Jf{static[I(326)](){const x=I;return Ua===void 0&&(Ua=new(window[x(3439)]||window[x(3869)])),Ua}static[I(3213)](x){Ua=x}}class LF extends Jt{constructor(x){super(x)}load(x,e,t,g){const n=I,s=this,o=new Ui(this[n(1086)]);o[n(2279)](n(3940)),o[n(1575)](this[n(3653)]),o.setRequestHeader(this[n(3289)]),o[n(3221)](this[n(3845)]),o.load(x,function(C){const r=n;try{const A=C[r(1226)](0);Jf.getContext()[r(3369)](A,function(h){e(h)})[r(1107)](c)}catch(A){c(A)}},t,g);function c(C){const r=n;g?g(C):console[r(2963)](C),s[r(1086)].itemError(x)}}}const tB=new dx,gB=new dx,II=new dx;class kF{constructor(){const x=I;this[x(3505)]="StereoCamera",this[x(3455)]=1,this[x(176)]=.064,this[x(3881)]=new ze,this[x(3881)].layers[x(3542)](1),this[x(3881)].matrixAutoUpdate=!1,this[x(3914)]=new ze,this[x(3914)][x(2669)].enable(2),this[x(3914)][x(2272)]=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}[I(2341)](x){const e=I,t=this[e(743)];if(t.focus!==x[e(2950)]||t[e(1302)]!==x.fov||t.aspect!==x[e(3455)]*this[e(3455)]||t[e(2987)]!==x.near||t[e(1407)]!==x.far||t[e(3981)]!==x[e(3981)]||t.eyeSep!==this[e(176)]){t[e(2950)]=x[e(2950)],t[e(1302)]=x[e(1302)],t.aspect=x.aspect*this[e(3455)],t[e(2987)]=x[e(2987)],t[e(1407)]=x[e(1407)],t[e(3981)]=x[e(3981)],t[e(176)]=this.eyeSep,II[e(1493)](x[e(2900)]);const n=t[e(176)]/2,s=n*t[e(2987)]/t[e(2950)],o=t[e(2987)]*Math[e(1597)](YI*t[e(1302)]*.5)/t.zoom;let c,C;gB[e(2574)][12]=-n,tB[e(2574)][12]=n,c=-o*t.aspect+s,C=o*t[e(3455)]+s,II[e(2574)][0]=2*t[e(2987)]/(C-c),II[e(2574)][8]=(C+c)/(C-c),this[e(3881)][e(2900)][e(1493)](II),c=-o*t.aspect-s,C=o*t[e(3455)]-s,II[e(2574)][0]=2*t[e(2987)]/(C-c),II[e(2574)][8]=(C+c)/(C-c),this[e(3914)].projectionMatrix[e(1493)](II)}this.cameraL[e(2368)][e(1493)](x.matrixWorld)[e(327)](gB),this[e(3914)].matrixWorld[e(1493)](x[e(2368)])[e(327)](tB)}}class Ef{constructor(x=!0){const e=I;this.autoStart=x,this.startTime=0,this[e(2116)]=0,this[e(1828)]=0,this[e(2860)]=!1}[I(3988)](){const x=I;this[x(1919)]=iB(),this[x(2116)]=this.startTime,this[x(1828)]=0,this[x(2860)]=!0}stop(){const x=I;this[x(3409)](),this[x(2860)]=!1,this[x(1665)]=!1}getElapsedTime(){const x=I;return this[x(3534)](),this[x(1828)]}[I(3534)](){const x=I;let e=0;if(this[x(1665)]&&!this[x(2860)])return this[x(3988)](),0;if(this[x(2860)]){const t=iB();e=(t-this[x(2116)])/1e3,this[x(2116)]=t,this[x(1828)]+=e}return e}}function iB(){const i=I;return(typeof performance===i(1797)?Date:performance)[i(978)]()}const sI=new E,nB=new ot,TF=new E,oI=new E;class JF extends Nx{constructor(){const x=I;super(),this.type=x(1522),this[x(3246)]=Jf[x(326)](),this[x(2747)]=this.context.createGain(),this[x(2747)][x(1222)](this[x(3246)].destination),this.filter=null,this[x(2454)]=0,this[x(2059)]=new Ef}getInput(){return this[I(2747)]}[I(2717)](){const x=I;return this[x(1095)]!==null&&(this[x(2747)][x(3573)](this.filter),this[x(1095)][x(3573)](this.context[x(3508)]),this[x(2747)][x(1222)](this[x(3246)][x(3508)]),this[x(1095)]=null),this}[I(940)](){return this.filter}[I(2535)](x){const e=I;return this[e(1095)]!==null?(this[e(2747)][e(3573)](this.filter),this.filter[e(3573)](this[e(3246)][e(3508)])):this[e(2747)][e(3573)](this[e(3246)].destination),this[e(1095)]=x,this[e(2747)][e(1222)](this.filter),this.filter.connect(this[e(3246)][e(3508)]),this}[I(1939)](){const x=I;return this.gain[x(2747)][x(2113)]}[I(3951)](x){const e=I;return this[e(2747)][e(2747)][e(3128)](x,this[e(3246)][e(617)],.01),this}[I(3554)](x){const e=I;super[e(3554)](x);const t=this[e(3246)][e(976)],g=this.up;if(this[e(2454)]=this[e(2059)][e(3534)](),this[e(2368)][e(2986)](sI,nB,TF),oI[e(298)](0,0,-1)[e(2235)](nB),t[e(3069)]){const n=this[e(3246)][e(617)]+this[e(2454)];t.positionX[e(3192)](sI.x,n),t[e(3306)].linearRampToValueAtTime(sI.y,n),t[e(3202)][e(3192)](sI.z,n),t[e(1238)][e(3192)](oI.x,n),t.forwardY[e(3192)](oI.y,n),t[e(2750)][e(3192)](oI.z,n),t.upX[e(3192)](g.x,n),t.upY.linearRampToValueAtTime(g.y,n),t[e(3240)][e(3192)](g.z,n)}else t[e(2991)](sI.x,sI.y,sI.z),t[e(3807)](oI.x,oI.y,oI.z,g.x,g.y,g.z)}}class v3 extends Nx{constructor(x){const e=I;super(),this[e(3505)]=e(125),this[e(976)]=x,this[e(3246)]=x[e(3246)],this.gain=this.context[e(1121)](),this.gain[e(1222)](x.getInput()),this[e(443)]=!1,this[e(2360)]=null,this.detune=0,this[e(1643)]=!1,this[e(3364)]=0,this[e(1332)]=0,this[e(872)]=0,this[e(2540)]=void 0,this.playbackRate=1,this[e(226)]=!1,this[e(2223)]=!0,this[e(3272)]=null,this[e(2746)]="empty",this._startedAt=0,this[e(744)]=0,this[e(3849)]=!1,this[e(1014)]=[]}getOutput(){return this.gain}setNodeSource(x){const e=I;return this[e(2223)]=!1,this[e(2746)]=e(2172),this[e(3272)]=x,this[e(1222)](),this}[I(3911)](x){const e=I;return this[e(2223)]=!1,this[e(2746)]=e(561),this.source=this.context[e(3091)](x),this[e(1222)](),this}[I(2981)](x){const e=I;return this[e(2223)]=!1,this[e(2746)]=e(446),this.source=this[e(3246)][e(1365)](x),this.connect(),this}setBuffer(x){const e=I;return this[e(2360)]=x,this[e(2746)]=e(2360),this.autoplay&&this[e(2763)](),this}[I(2763)](x=0){const e=I;if(this.isPlaying===!0){console.warn(e(1122));return}if(this[e(2223)]===!1){console[e(3748)](e(1652));return}this._startedAt=this[e(3246)].currentTime+x;const t=this.context[e(1902)]();return t.buffer=this[e(2360)],t[e(1643)]=this[e(1643)],t.loopStart=this[e(3364)],t[e(1332)]=this[e(1332)],t[e(942)]=this[e(682)][e(1600)](this),t.start(this._startedAt,this._progress+this[e(872)],this.duration),this[e(226)]=!0,this[e(3272)]=t,this[e(3492)](this[e(2167)]),this[e(1900)](this[e(1516)]),this.connect()}[I(278)](){const x=I;if(this[x(2223)]===!1){console.warn(x(1652));return}return this[x(226)]===!0&&(this[x(744)]+=Math[x(1971)](this[x(3246)].currentTime-this[x(2221)],0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this[x(2540)]||this[x(2360)][x(2540)])),this.source.stop(),this.source[x(942)]=null,this[x(226)]=!1),this}[I(548)](){const x=I;if(this[x(2223)]===!1){console[x(3748)](x(1652));return}return this._progress=0,this[x(3272)]!==null&&(this[x(3272)].stop(),this[x(3272)].onended=null),this[x(226)]=!1,this}[I(1222)](){const x=I;if(this.filters[x(2989)]>0){this[x(3272)][x(1222)](this[x(1014)][0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1][x(1222)](this[x(1014)][e]);this[x(1014)][this[x(1014)].length-1][x(1222)](this[x(2800)]())}else this[x(3272)][x(1222)](this[x(2800)]());return this._connected=!0,this}[I(3573)](){const x=I;if(this[x(3849)]!==!1){if(this[x(1014)][x(2989)]>0){this[x(3272)].disconnect(this[x(1014)][0]);for(let e=1,t=this[x(1014)][x(2989)];e<t;e++)this[x(1014)][e-1][x(3573)](this[x(1014)][e]);this[x(1014)][this.filters.length-1][x(3573)](this[x(2800)]())}else this.source[x(3573)](this[x(2800)]());return this[x(3849)]=!1,this}}[I(3291)](){return this[I(1014)]}[I(3419)](x){const e=I;return x||(x=[]),this[e(3849)]===!0?(this[e(3573)](),this[e(1014)]=x[e(1226)](),this.connect()):this[e(1014)]=x[e(1226)](),this}[I(3492)](x){const e=I;return this[e(2167)]=x,this[e(226)]===!0&&this[e(3272)][e(2167)]!==void 0&&this[e(3272)][e(2167)][e(3128)](this.detune,this[e(3246)][e(617)],.01),this}[I(3120)](){return this[I(2167)]}[I(940)](){return this[I(3291)]()[0]}[I(2535)](x){return this[I(3419)](x?[x]:[])}[I(1900)](x){const e=I;if(this[e(2223)]===!1){console.warn(e(1652));return}return this[e(1516)]=x,this[e(226)]===!0&&this[e(3272)][e(1516)][e(3128)](this[e(1516)],this[e(3246)].currentTime,.01),this}[I(3096)](){return this[I(1516)]}[I(682)](){const x=I;this[x(226)]=!1}[I(3824)](){const x=I;return this[x(2223)]===!1?(console[x(3748)](x(1652)),!1):this.loop}setLoop(x){const e=I;if(this[e(2223)]===!1){console[e(3748)](e(1652));return}return this[e(1643)]=x,this.isPlaying===!0&&(this[e(3272)][e(1643)]=this[e(1643)]),this}[I(3277)](x){const e=I;return this[e(3364)]=x,this}[I(2034)](x){return this.loopEnd=x,this}[I(1771)](){const x=I;return this[x(2747)][x(2747)][x(2113)]}[I(156)](x){const e=I;return this.gain[e(2747)][e(3128)](x,this[e(3246)][e(617)],.01),this}}const cI=new E,IB=new ot,EF=new E,CI=new E;class UF extends v3{constructor(x){const e=I;super(x),this[e(473)]=this[e(3246)].createPanner(),this.panner.panningModel=e(3900),this.panner[e(1222)](this[e(2747)])}connect(){const x=I;super.connect(),this.panner[x(1222)](this[x(2747)])}[I(3573)](){const x=I;super.disconnect(),this[x(473)][x(3573)](this[x(2747)])}getOutput(){return this[I(473)]}[I(852)](){const x=I;return this.panner[x(825)]}[I(2730)](x){const e=I;return this[e(473)].refDistance=x,this}[I(1030)](){const x=I;return this.panner[x(3546)]}[I(828)](x){const e=I;return this[e(473)][e(3546)]=x,this}getDistanceModel(){const x=I;return this[x(473)][x(219)]}[I(2007)](x){const e=I;return this[e(473)][e(219)]=x,this}[I(3802)](){const x=I;return this[x(473)][x(3250)]}[I(1653)](x){const e=I;return this[e(473)][e(3250)]=x,this}setDirectionalCone(x,e,t){const g=I;return this[g(473)].coneInnerAngle=x,this[g(473)].coneOuterAngle=e,this.panner[g(673)]=t,this}updateMatrixWorld(x){const e=I;if(super[e(3554)](x),this[e(2223)]===!0&&this[e(226)]===!1)return;this.matrixWorld[e(2986)](cI,IB,EF),CI[e(298)](0,0,1)[e(2235)](IB);const t=this[e(473)];if(t[e(3069)]){const g=this[e(3246)].currentTime+this[e(976)].timeDelta;t[e(3069)][e(3192)](cI.x,g),t[e(3306)][e(3192)](cI.y,g),t[e(3202)].linearRampToValueAtTime(cI.z,g),t[e(769)][e(3192)](CI.x,g),t[e(3878)][e(3192)](CI.y,g),t.orientationZ[e(3192)](CI.z,g)}else t[e(2991)](cI.x,cI.y,cI.z),t[e(3807)](CI.x,CI.y,CI.z)}}class _F{constructor(x,e=2048){const t=I;this[t(3621)]=x[t(3246)].createAnalyser(),this[t(3621)][t(2744)]=e,this.data=new Uint8Array(this.analyser[t(1551)]),x[t(2800)]()[t(1222)](this[t(3621)])}getFrequencyData(){const x=I;return this[x(3621)][x(3736)](this[x(3787)]),this[x(3787)]}[I(2253)](){const x=I;let e=0;const t=this[x(851)]();for(let g=0;g<t.length;g++)e+=t[g];return e/t.length}}class W3{constructor(x,e,t){const g=I;this[g(3827)]=x,this[g(2194)]=t;let n,s,o;switch(e){case g(3915):n=this[g(1798)],s=this[g(2689)],o=this[g(3130)],this.buffer=new Float64Array(t*6),this[g(2969)]=5;break;case g(3674):case g(2262):n=this[g(429)],s=this[g(429)],o=this[g(1737)],this[g(2360)]=new Array(t*5);break;default:n=this._lerp,s=this[g(128)],o=this[g(802)],this[g(2360)]=new Float64Array(t*5)}this[g(2162)]=n,this[g(2394)]=s,this._setIdentity=o,this[g(795)]=3,this[g(3934)]=4,this[g(630)]=0,this[g(523)]=0,this[g(3627)]=0,this[g(598)]=0}[I(2658)](x,e){const t=I,g=this.buffer,n=this[t(2194)],s=x*n+n;let o=this[t(630)];if(o===0){for(let c=0;c!==n;++c)g[s+c]=g[c];o=e}else{o+=e;const c=e/o;this._mixBufferRegion(g,s,0,c,n)}this.cumulativeWeight=o}[I(177)](x){const e=I,t=this[e(2360)],g=this[e(2194)],n=g*this._addIndex;this[e(523)]===0&&this[e(237)](),this._mixBufferRegionAdditive(t,n,0,x,g),this[e(523)]+=x}[I(1307)](x){const e=I,t=this.valueSize,g=this[e(2360)],n=x*t+t,s=this.cumulativeWeight,o=this[e(523)],c=this[e(3827)];if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const C=t*this[e(795)];this[e(2162)](g,n,C,1-s,t)}o>0&&this._mixBufferRegionAdditive(g,n,this[e(3934)]*t,1,t);for(let C=t,r=t+t;C!==r;++C)if(g[C]!==g[C+t]){c.setValue(g,n);break}}[I(1116)](){const x=I,e=this[x(3827)],t=this[x(2360)],g=this.valueSize,n=g*this[x(795)];e[x(1508)](t,n);for(let s=g,o=n;s!==o;++s)t[s]=t[n+s%g];this[x(237)](),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}[I(3251)](){const x=I,e=this[x(2194)]*3;this[x(3827)][x(342)](this[x(2360)],e)}_setAdditiveIdentityNumeric(){const x=I,e=this[x(3934)]*this.valueSize,t=e+this[x(2194)];for(let g=e;g<t;g++)this.buffer[g]=0}[I(3130)](){const x=I;this[x(802)](),this[x(2360)][this[x(3934)]*this.valueSize+3]=1}[I(1737)](){const x=I,e=this[x(795)]*this[x(2194)],t=this._addIndex*this.valueSize;for(let g=0;g<this.valueSize;g++)this.buffer[t+g]=this[x(2360)][e+g]}[I(429)](x,e,t,g,n){if(g>=.5)for(let s=0;s!==n;++s)x[e+s]=x[t+s]}[I(1798)](x,e,t,g){ot[I(1803)](x,e,x,e,x,t,g)}[I(2689)](x,e,t,g,n){const s=I,o=this[s(2969)]*n;ot.multiplyQuaternionsFlat(x,o,x,e,x,t),ot.slerpFlat(x,e,x,e,x,o,g)}[I(3749)](x,e,t,g,n){const s=1-g;for(let o=0;o!==n;++o){const c=e+o;x[c]=x[c]*s+x[t+o]*g}}[I(128)](x,e,t,g,n){for(let s=0;s!==n;++s){const o=e+s;x[o]=x[o]+x[t+s]*g}}}const Uf="\\[\\]\\.:\\/",DF=new RegExp("["+Uf+"]","g"),_f="[^"+Uf+"]",QF="[^"+Uf[I(333)]("\\.","")+"]",PF=/((?:WC+[\/:])*)/[I(3272)][I(333)]("WC",_f),OF=/(WCOD+)?/[I(3272)].replace(I(1807),QF),qF=/(?:\.(WC+)(?:\[(.+)\])?)?/[I(3272)][I(333)]("WC",_f),$F=/\.(WC+)(?:\[(.+)\])?/.source[I(333)]("WC",_f),jF=new RegExp("^"+PF+OF+qF+$F+"$"),x4=[I(3480),"materials",I(3932),I(3879)];class e4{constructor(x,e,t){const g=I,n=t||zx[g(2838)](e);this[g(2616)]=x,this._bindings=x[g(367)](e,n)}[I(1508)](x,e){const t=I;this[t(1600)]();const g=this._targetGroup[t(983)],n=this._bindings[g];n!==void 0&&n[t(1508)](x,e)}[I(342)](x,e){const t=I,g=this[t(1790)];for(let n=this[t(2616)][t(983)],s=g[t(2989)];n!==s;++n)g[n][t(342)](x,e)}[I(1600)](){const x=I,e=this[x(1790)];for(let t=this[x(2616)][x(983)],g=e[x(2989)];t!==g;++t)e[t][x(1600)]()}[I(234)](){const x=I,e=this[x(1790)];for(let t=this[x(2616)].nCachedObjects_,g=e.length;t!==g;++t)e[t][x(234)]()}}class zx{constructor(x,e,t){const g=I;this[g(3653)]=e,this.parsedPath=t||zx[g(2838)](e),this[g(2520)]=zx[g(678)](x,this[g(970)][g(1910)]),this.rootNode=x,this[g(1508)]=this[g(3681)],this[g(342)]=this._setValue_unbound}static[I(968)](x,e,t){const g=I;return x&&x[g(1031)]?new zx[g(1532)](x,e,t):new zx(x,e,t)}static sanitizeNodeName(x){const e=I;return x[e(333)](/\s/g,"_")[e(333)](DF,"")}static parseTrackName(x){const e=I,t=jF[e(3193)](x);if(t===null)throw new Error(e(1515)+x);const g={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=g[e(1910)]&&g.nodeName[e(551)](".");if(n!==void 0&&n!==-1){const s=g[e(1910)].substring(n+1);x4[e(2377)](s)!==-1&&(g[e(1910)]=g[e(1910)].substring(0,n),g[e(1085)]=s)}if(g.propertyName===null||g[e(3446)].length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+x);return g}static[I(678)](x,e){const t=I;if(e===void 0||e===""||e==="."||e===-1||e===x.name||e===x.uuid)return x;if(x.skeleton){const g=x.skeleton.getBoneByName(e);if(g!==void 0)return g}if(x[t(1352)]){const g=function(s){const o=t;for(let c=0;c<s[o(2989)];c++){const C=s[c];if(C[o(1474)]===e||C.uuid===e)return C;const r=g(C[o(1352)]);if(r)return r}return null},n=g(x[t(1352)]);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}[I(1865)](x,e){const t=I;x[e]=this[t(2185)][this.propertyName]}[I(1541)](x,e){const t=I,g=this[t(3810)];for(let n=0,s=g.length;n!==s;++n)x[e++]=g[n]}[I(2576)](x,e){const t=I;x[e]=this[t(3810)][this.propertyIndex]}[I(1312)](x,e){const t=I;this[t(3810)][t(3904)](x,e)}[I(2889)](x,e){const t=I;this[t(2185)][this[t(3446)]]=x[e]}[I(3927)](x,e){const t=I;this[t(2185)][this[t(3446)]]=x[e],this[t(2185)][t(2170)]=!0}_setValue_direct_setMatrixWorldNeedsUpdate(x,e){const t=I;this[t(2185)][this[t(3446)]]=x[e],this.targetObject[t(2621)]=!0}[I(175)](x,e){const t=I,g=this[t(3810)];for(let n=0,s=g[t(2989)];n!==s;++n)g[n]=x[e++]}_setValue_array_setNeedsUpdate(x,e){const t=I,g=this.resolvedProperty;for(let n=0,s=g[t(2989)];n!==s;++n)g[n]=x[e++];this[t(2185)][t(2170)]=!0}[I(621)](x,e){const t=I,g=this[t(3810)];for(let n=0,s=g[t(2989)];n!==s;++n)g[n]=x[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(x,e){const t=I;this[t(3810)][this[t(162)]]=x[e]}_setValue_arrayElement_setNeedsUpdate(x,e){const t=I;this[t(3810)][this[t(162)]]=x[e],this[t(2185)].needsUpdate=!0}[I(620)](x,e){const t=I;this[t(3810)][this[t(162)]]=x[e],this[t(2185)][t(2621)]=!0}[I(3382)](x,e){const t=I;this[t(3810)][t(2793)](x,e)}_setValue_fromArray_setNeedsUpdate(x,e){const t=I;this[t(3810)][t(2793)](x,e),this[t(2185)].needsUpdate=!0}[I(1448)](x,e){const t=I;this[t(3810)][t(2793)](x,e),this[t(2185)][t(2621)]=!0}[I(3681)](x,e){const t=I;this[t(1600)](),this[t(1508)](x,e)}_setValue_unbound(x,e){const t=I;this[t(1600)](),this[t(342)](x,e)}[I(1600)](){const x=I;let e=this.node;const t=this[x(970)],g=t[x(1085)],n=t[x(3446)];let s=t[x(162)];if(!e&&(e=zx[x(678)](this.rootNode,t[x(1910)]),this[x(2520)]=e),this.getValue=this[x(3156)],this[x(342)]=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this[x(3653)]+".");return}if(g){let r=t[x(1464)];switch(g){case x(3080):if(!e[x(3480)]){console.error(x(982),this);return}if(!e.material[x(3080)]){console[x(2963)](x(2922),this);return}e=e[x(3480)][x(3080)];break;case x(3932):if(!e[x(2148)]){console[x(2963)](x(1825),this);return}e=e[x(2148)].bones;for(let A=0;A<e[x(2989)];A++)if(e[A][x(1474)]===r){r=A;break}break;case x(3879):if(x(3879)in e){e=e[x(3879)];break}if(!e[x(3480)]){console[x(2963)](x(982),this);return}if(!e[x(3480)][x(3879)]){console[x(2963)](x(1082),this);return}e=e.material[x(3879)];break;default:if(e[g]===void 0){console.error(x(2347),this);return}e=e[g]}if(r!==void 0){if(e[r]===void 0){console[x(2963)](x(3812),this,e);return}e=e[r]}}const o=e[n];if(o===void 0){const r=t[x(1910)];console[x(2963)](x(2485)+r+"."+n+x(2045),e);return}let c=this[x(3313)][x(1337)];this.targetObject=e,e[x(2170)]!==void 0?c=this[x(3313)][x(121)]:e[x(2621)]!==void 0&&(c=this[x(3313)][x(944)]);let C=this.BindingType[x(2935)];if(s!==void 0){if(n===x(2891)){if(!e.geometry){console[x(2963)](x(1289),this);return}if(!e[x(352)].morphAttributes){console[x(2963)](x(2992),this);return}e[x(3300)][s]!==void 0&&(s=e[x(3300)][s])}C=this[x(3789)].ArrayElement,this[x(3810)]=o,this[x(162)]=s}else o.fromArray!==void 0&&o[x(3904)]!==void 0?(C=this[x(3789)].HasFromToArray,this.resolvedProperty=o):Array[x(1987)](o)?(C=this[x(3789)][x(2389)],this[x(3810)]=o):this.propertyName=n;this[x(1508)]=this.GetterByBindingType[C],this[x(342)]=this[x(3678)][C][c]}[I(234)](){const x=I;this.node=null,this[x(1508)]=this[x(3681)],this.setValue=this[x(3941)]}}zx.Composite=e4,zx.prototype[I(3789)]={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},zx.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},zx[I(1566)].GetterByBindingType=[zx[I(1566)][I(1865)],zx.prototype[I(1541)],zx[I(1566)][I(2576)],zx[I(1566)][I(1312)]],zx[I(1566)].SetterByBindingTypeAndVersioning=[[zx.prototype[I(2889)],zx[I(1566)][I(3927)],zx.prototype[I(3761)]],[zx[I(1566)][I(175)],zx.prototype[I(2294)],zx[I(1566)]._setValue_array_setMatrixWorldNeedsUpdate],[zx[I(1566)][I(2269)],zx[I(1566)][I(3354)],zx[I(1566)]._setValue_arrayElement_setMatrixWorldNeedsUpdate],[zx[I(1566)][I(3382)],zx[I(1566)][I(1324)],zx[I(1566)][I(1448)]]];class t4{constructor(){const x=I;this[x(1031)]=!0,this.uuid=gg(),this._objects=Array[x(1566)][x(1226)].call(arguments),this[x(983)]=0;const e={};this[x(936)]=e;for(let g=0,n=arguments.length;g!==n;++g)e[arguments[g][x(296)]]=g;this[x(1833)]=[],this[x(3007)]=[],this[x(1790)]=[],this[x(1376)]={};const t=this;this[x(2807)]={objects:{get total(){const g=x;return t._objects[g(2989)]},get inUse(){const g=x;return this[g(3903)]-t[g(983)]}},get bindingsPerObject(){const g=x;return t[g(1790)][g(2989)]}}}[I(3014)](){const x=I,e=this[x(1399)],t=this._indicesByUUID,g=this._paths,n=this[x(3007)],s=this[x(1790)],o=s[x(2989)];let c,C=e.length,r=this.nCachedObjects_;for(let A=0,d=arguments[x(2989)];A!==d;++A){const h=arguments[A],f=h[x(296)];let B=t[f];if(B===void 0){B=C++,t[f]=B,e[x(3330)](h);for(let Z=0,G=o;Z!==G;++Z)s[Z][x(3330)](new zx(h,g[Z],n[Z]))}else if(B<r){c=e[B];const Z=--r,G=e[Z];t[G[x(296)]]=B,e[B]=G,t[f]=Z,e[Z]=h;for(let m=0,v=o;m!==v;++m){const p=s[m],w=p[Z];let V=p[B];p[B]=w,V===void 0&&(V=new zx(h,g[m],n[m])),p[Z]=V}}else e[B]!==c&&console[x(2963)](x(1420)+x(3791))}this[x(983)]=r}[I(2208)](){const x=I,e=this[x(1399)],t=this[x(936)],g=this[x(1790)],n=g[x(2989)];let s=this[x(983)];for(let o=0,c=arguments.length;o!==c;++o){const C=arguments[o],r=C[x(296)],A=t[r];if(A!==void 0&&A>=s){const d=s++,h=e[d];t[h[x(296)]]=A,e[A]=h,t[r]=d,e[d]=C;for(let f=0,B=n;f!==B;++f){const Z=g[f],G=Z[d],m=Z[A];Z[A]=G,Z[d]=m}}}this[x(983)]=s}[I(1843)](){const x=I,e=this[x(1399)],t=this._indicesByUUID,g=this[x(1790)],n=g[x(2989)];let s=this[x(983)],o=e.length;for(let c=0,C=arguments[x(2989)];c!==C;++c){const r=arguments[c],A=r[x(296)],d=t[A];if(d!==void 0)if(delete t[A],d<s){const h=--s,f=e[h],B=--o,Z=e[B];t[f[x(296)]]=d,e[d]=f,t[Z[x(296)]]=h,e[h]=Z,e[x(3604)]();for(let G=0,m=n;G!==m;++G){const v=g[G],p=v[h],w=v[B];v[d]=p,v[h]=w,v.pop()}}else{const h=--o,f=e[h];h>0&&(t[f.uuid]=d),e[d]=f,e[x(3604)]();for(let B=0,Z=n;B!==Z;++B){const G=g[B];G[d]=G[h],G.pop()}}}this[x(983)]=s}[I(367)](x,e){const t=I,g=this[t(1376)];let n=g[x];const s=this[t(1790)];if(n!==void 0)return s[n];const o=this[t(1833)],c=this._parsedPaths,C=this[t(1399)],r=C[t(2989)],A=this[t(983)],d=new Array(r);n=s.length,g[x]=n,o[t(3330)](x),c[t(3330)](e),s[t(3330)](d);for(let h=A,f=C.length;h!==f;++h){const B=C[h];d[h]=new zx(B,x,e)}return d}[I(427)](x){const e=I,t=this._bindingsIndicesByPath,g=t[x];if(g!==void 0){const n=this[e(1833)],s=this[e(3007)],o=this._bindings,c=o[e(2989)]-1,C=o[c],r=x[c];t[r]=g,o[g]=C,o[e(3604)](),s[g]=s[c],s[e(3604)](),n[g]=n[c],n.pop()}}}class w3{constructor(x,e,t=null,g=e[I(1293)]){const n=I;this[n(146)]=x,this._clip=e,this._localRoot=t,this[n(1293)]=g;const s=e[n(421)],o=s[n(2989)],c=new Array(o),C={endingStart:yI,endingEnd:yI};for(let r=0;r!==o;++r){const A=s[r].createInterpolant(null);c[r]=A,A.settings=C}this[n(1659)]=C,this[n(3843)]=c,this[n(631)]=new Array(o),this[n(239)]=null,this[n(1205)]=null,this[n(3672)]=null,this[n(1520)]=null,this[n(1643)]=Iv,this[n(1736)]=-1,this[n(1203)]=null,this[n(1163)]=0,this.timeScale=1,this[n(867)]=1,this.weight=1,this[n(1429)]=1,this.repetitions=1/0,this[n(2928)]=!1,this[n(2648)]=!0,this[n(1612)]=!1,this.zeroSlopeAtStart=!0,this[n(2159)]=!0}[I(2763)](){const x=I;return this._mixer[x(2385)](this),this}[I(548)](){const x=I;return this[x(146)]._deactivateAction(this),this[x(1877)]()}[I(1877)](){const x=I;return this[x(2928)]=!1,this[x(2648)]=!0,this[x(1163)]=0,this[x(1736)]=-1,this._startTime=null,this.stopFading()[x(2361)]()}[I(1873)](){const x=I;return this.enabled&&!this[x(2928)]&&this[x(2727)]!==0&&this[x(1203)]===null&&this[x(146)][x(467)](this)}[I(3189)](){return this._mixer._isActiveAction(this)}startAt(x){return this._startTime=x,this}[I(2684)](x,e){const t=I;return this.loop=x,this[t(841)]=e,this}setEffectiveWeight(x){const e=I;return this[e(1713)]=x,this[e(1429)]=this[e(2648)]?x:0,this[e(3867)]()}getEffectiveWeight(){return this[I(1429)]}[I(3559)](x){return this[I(738)](x,0,1)}[I(3630)](x){return this._scheduleFading(x,1,0)}[I(1168)](x,e,t){const g=I;if(x[g(3630)](e),this[g(3559)](e),t){const n=this[g(2458)][g(2540)],s=x._clip[g(2540)],o=s/n,c=n/s;x.warp(1,o,e),this.warp(c,1,e)}return this}[I(211)](x,e,t){return x[I(1168)](this,e,t)}[I(3867)](){const x=I,e=this[x(1520)];return e!==null&&(this[x(1520)]=null,this[x(146)][x(528)](e)),this}setEffectiveTimeScale(x){const e=I;return this.timeScale=x,this._effectiveTimeScale=this[e(2928)]?0:x,this.stopWarping()}[I(1530)](){return this[I(867)]}[I(1765)](x){const e=I;return this.timeScale=this[e(2458)][e(2540)]/x,this[e(2361)]()}syncWith(x){const e=I;return this[e(1163)]=x[e(1163)],this[e(2727)]=x.timeScale,this.stopWarping()}[I(1633)](x){const e=I;return this.warp(this[e(867)],0,x)}warp(x,e,t){const g=I,n=this._mixer,s=n[g(1163)],o=this[g(2727)];let c=this[g(3672)];c===null&&(c=n._lendControlInterpolant(),this[g(3672)]=c);const C=c[g(509)],r=c.sampleValues;return C[0]=s,C[1]=s+t,r[0]=x/o,r[1]=e/o,this}stopWarping(){const x=I,e=this[x(3672)];return e!==null&&(this._timeScaleInterpolant=null,this[x(146)][x(528)](e)),this}getMixer(){return this._mixer}[I(2157)](){return this[I(2458)]}getRoot(){const x=I;return this[x(1274)]||this[x(146)][x(2883)]}[I(3755)](x,e,t,g){const n=I;if(!this[n(2648)]){this[n(830)](x);return}const s=this[n(1203)];if(s!==null){const C=(x-s)*t;C<0||t===0?e=0:(this[n(1203)]=null,e=t*C)}e*=this[n(1858)](x);const o=this[n(2316)](e),c=this[n(830)](x);if(c>0){const C=this._interpolants,r=this._propertyBindings;switch(this[n(1293)]){case bf:for(let A=0,d=C[n(2989)];A!==d;++A)C[A][n(1962)](o),r[A].accumulateAdditive(c);break;case p2:default:for(let A=0,d=C[n(2989)];A!==d;++A)C[A][n(1962)](o),r[A][n(2658)](g,c)}}}[I(830)](x){const e=I;let t=0;if(this[e(2648)]){t=this[e(1713)];const g=this[e(1520)];if(g!==null){const n=g.evaluate(x)[0];t*=n,x>g[e(509)][1]&&(this[e(3867)](),n===0&&(this.enabled=!1))}}return this[e(1429)]=t,t}_updateTimeScale(x){const e=I;let t=0;if(!this[e(2928)]){t=this[e(2727)];const g=this[e(3672)];if(g!==null){const n=g[e(1962)](x)[0];t*=n,x>g[e(509)][1]&&(this[e(2361)](),t===0?this[e(2928)]=!0:this[e(2727)]=t)}}return this[e(867)]=t,t}[I(2316)](x){const e=I,t=this[e(2458)][e(2540)],g=this[e(1643)];let n=this.time+x,s=this[e(1736)];const o=g===sv;if(x===0)return s===-1?n:o&&(s&1)===1?t-n:n;if(g===nv){s===-1&&(this[e(1736)]=0,this._setEndings(!0,!0,!1));x:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break x}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this[e(1163)]=n,this[e(146)].dispatchEvent({type:"finished",action:this,direction:x<0?-1:1})}}else{if(s===-1&&(x>=0?(s=0,this[e(2528)](!0,this[e(841)]===0,o)):this[e(2528)](this[e(841)]===0,!0,o)),n>=t||n<0){const c=Math[e(3143)](n/t);n-=t*c,s+=Math[e(447)](c);const C=this[e(841)]-s;if(C<=0)this[e(1612)]?this.paused=!0:this[e(2648)]=!1,n=x>0?t:0,this[e(1163)]=n,this._mixer.dispatchEvent({type:e(599),action:this,direction:x>0?1:-1});else{if(C===1){const r=x<0;this[e(2528)](r,!r,o)}else this._setEndings(!1,!1,o);this[e(1736)]=s,this.time=n,this._mixer[e(1457)]({type:e(1643),action:this,loopDelta:c})}}else this[e(1163)]=n;if(o&&(s&1)===1)return t-n}return n}[I(2528)](x,e,t){const g=I,n=this[g(1659)];t?(n.endingStart=vI,n[g(386)]=vI):(x?n[g(3619)]=this[g(2803)]?vI:yI:n[g(3619)]=rC,e?n[g(386)]=this[g(2159)]?vI:yI:n[g(386)]=rC)}[I(738)](x,e,t){const g=I,n=this[g(146)],s=n[g(1163)];let o=this._weightInterpolant;o===null&&(o=n[g(2480)](),this._weightInterpolant=o);const c=o.parameterPositions,C=o.sampleValues;return c[0]=s,C[0]=e,c[1]=s+x,C[1]=t,this}}const g4=new Float32Array(1);class i4 extends Qi{constructor(x){const e=I;super(),this[e(2883)]=x,this[e(685)](),this[e(513)]=0,this[e(1163)]=0,this[e(2727)]=1}[I(1029)](x,e){const t=I,g=x[t(1274)]||this._root,n=x[t(2458)].tracks,s=n[t(2989)],o=x[t(631)],c=x[t(3843)],C=g.uuid,r=this._bindingsByRootAndName;let A=r[C];A===void 0&&(A={},r[C]=A);for(let d=0;d!==s;++d){const h=n[d],f=h.name;let B=A[f];if(B!==void 0)++B[t(598)],o[d]=B;else{if(B=o[d],B!==void 0){B[t(239)]===null&&(++B.referenceCount,this[t(3182)](B,C,f));continue}const Z=e&&e[t(631)][d][t(3827)][t(970)];B=new W3(zx[t(968)](g,f,Z),h[t(2203)],h[t(871)]()),++B.referenceCount,this[t(3182)](B,C,f),o[d]=B}c[d][t(3652)]=B[t(2360)]}}[I(2385)](x){const e=I;if(!this[e(467)](x)){if(x._cacheIndex===null){const g=(x[e(1274)]||this[e(2883)])[e(296)],n=x[e(2458)][e(296)],s=this[e(3042)][n];this._bindAction(x,s&&s[e(3081)][0]),this[e(1560)](x,n,g)}const t=x[e(631)];for(let g=0,n=t[e(2989)];g!==n;++g){const s=t[g];s[e(3627)]++===0&&(this[e(453)](s),s[e(1116)]())}this[e(3645)](x)}}[I(563)](x){const e=I;if(this[e(467)](x)){const t=x[e(631)];for(let g=0,n=t[e(2989)];g!==n;++g){const s=t[g];--s[e(3627)]===0&&(s[e(3251)](),this[e(2541)](s))}this[e(1637)](x)}}[I(685)](){const x=I;this[x(2897)]=[],this[x(3926)]=0,this[x(3042)]={},this[x(1790)]=[],this[x(1080)]=0,this[x(1404)]={},this[x(271)]=[],this[x(722)]=0;const e=this;this[x(2807)]={actions:{get total(){const t=x;return e[t(2897)][t(2989)]},get inUse(){return e._nActiveActions}},bindings:{get total(){const t=x;return e[t(1790)][t(2989)]},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){const t=x;return e._controlInterpolants[t(2989)]},get inUse(){return e[x(722)]}}}}[I(467)](x){const e=I,t=x[e(239)];return t!==null&&t<this._nActiveActions}[I(1560)](x,e,t){const g=I,n=this[g(2897)],s=this[g(3042)];let o=s[e];if(o===void 0)o={knownActions:[x],actionByRoot:{}},x[g(1205)]=0,s[e]=o;else{const c=o[g(3081)];x[g(1205)]=c[g(2989)],c[g(3330)](x)}x[g(239)]=n[g(2989)],n[g(3330)](x),o[g(3670)][t]=x}[I(441)](x){const e=I,t=this[e(2897)],g=t[t[e(2989)]-1],n=x._cacheIndex;g[e(239)]=n,t[n]=g,t[e(3604)](),x[e(239)]=null;const s=x[e(2458)].uuid,o=this[e(3042)],c=o[s],C=c.knownActions,r=C[C[e(2989)]-1],A=x[e(1205)];r[e(1205)]=A,C[A]=r,C[e(3604)](),x[e(1205)]=null;const d=c.actionByRoot,h=(x._localRoot||this[e(2883)])[e(296)];delete d[h],C[e(2989)]===0&&delete o[s],this._removeInactiveBindingsForAction(x)}[I(498)](x){const e=I,t=x[e(631)];for(let g=0,n=t[e(2989)];g!==n;++g){const s=t[g];--s.referenceCount===0&&this._removeInactiveBinding(s)}}[I(3645)](x){const e=I,t=this._actions,g=x[e(239)],n=this[e(3926)]++,s=t[n];x[e(239)]=n,t[n]=x,s[e(239)]=g,t[g]=s}_takeBackAction(x){const e=I,t=this[e(2897)],g=x[e(239)],n=--this[e(3926)],s=t[n];x[e(239)]=n,t[n]=x,s[e(239)]=g,t[g]=s}[I(3182)](x,e,t){const g=I,n=this[g(1404)],s=this[g(1790)];let o=n[e];o===void 0&&(o={},n[e]=o),o[t]=x,x[g(239)]=s[g(2989)],s[g(3330)](x)}[I(2527)](x){const e=I,t=this[e(1790)],g=x[e(3827)],n=g[e(1959)][e(296)],s=g.path,o=this[e(1404)],c=o[n],C=t[t[e(2989)]-1],r=x[e(239)];C._cacheIndex=r,t[r]=C,t[e(3604)](),delete c[s],Object.keys(c)[e(2989)]===0&&delete o[n]}[I(453)](x){const e=I,t=this._bindings,g=x[e(239)],n=this[e(1080)]++,s=t[n];x._cacheIndex=n,t[n]=x,s[e(239)]=g,t[g]=s}[I(2541)](x){const e=I,t=this[e(1790)],g=x[e(239)],n=--this._nActiveBindings,s=t[n];x[e(239)]=n,t[n]=x,s._cacheIndex=g,t[g]=s}[I(2480)](){const x=I,e=this[x(271)],t=this._nActiveControlInterpolants++;let g=e[t];return g===void 0&&(g=new Mf(new Float32Array(2),new Float32Array(2),1,g4),g[x(2516)]=t,e[t]=g),g}[I(528)](x){const e=I,t=this._controlInterpolants,g=x[e(2516)],n=--this[e(722)],s=t[n];x[e(2516)]=n,t[n]=x,s[e(2516)]=g,t[g]=s}[I(133)](x,e,t){const g=I,n=e||this._root,s=n[g(296)];let o=typeof x===g(3674)?vC[g(1173)](n,x):x;const c=o!==null?o[g(296)]:x,C=this[g(3042)][c];let r=null;if(t===void 0&&(o!==null?t=o[g(1293)]:t=p2),C!==void 0){const d=C[g(3670)][s];if(d!==void 0&&d[g(1293)]===t)return d;r=C[g(3081)][0],o===null&&(o=r[g(2458)])}if(o===null)return null;const A=new w3(this,o,e,t);return this[g(1029)](A,r),this[g(1560)](A,c,s),A}[I(3484)](x,e){const t=I,g=e||this[t(2883)],n=g[t(296)],s=typeof x===t(3674)?vC[t(1173)](g,x):x,o=s?s.uuid:x,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[n]||null}stopAllAction(){const x=I,e=this[x(2897)],t=this._nActiveActions;for(let g=t-1;g>=0;--g)e[g].stop();return this}update(x){const e=I;x*=this[e(2727)];const t=this[e(2897)],g=this[e(3926)],n=this[e(1163)]+=x,s=Math[e(1392)](x),o=this[e(513)]^=1;for(let r=0;r!==g;++r)t[r][e(3755)](n,x,s,o);const c=this[e(1790)],C=this[e(1080)];for(let r=0;r!==C;++r)c[r][e(1307)](o);return this}[I(194)](x){const e=I;this[e(1163)]=0;for(let t=0;t<this[e(2897)][e(2989)];t++)this._actions[t][e(1163)]=0;return this.update(x)}[I(3540)](){return this._root}uncacheClip(x){const e=I,t=this[e(2897)],g=x[e(296)],n=this._actionsByClip,s=n[g];if(s!==void 0){const o=s[e(3081)];for(let c=0,C=o[e(2989)];c!==C;++c){const r=o[c];this[e(563)](r);const A=r[e(239)],d=t[t[e(2989)]-1];r[e(239)]=null,r[e(1205)]=null,d[e(239)]=A,t[A]=d,t[e(3604)](),this[e(498)](r)}delete n[g]}}[I(1901)](x){const e=I,t=x[e(296)],g=this._actionsByClip;for(const o in g){const c=g[o].actionByRoot,C=c[t];C!==void 0&&(this[e(563)](C),this[e(441)](C))}const n=this._bindingsByRootAndName,s=n[t];if(s!==void 0)for(const o in s){const c=s[o];c[e(3251)](),this[e(2527)](c)}}uncacheAction(x,e){const t=I,g=this[t(3484)](x,e);g!==null&&(this[t(563)](g),this[t(441)](g))}}class Df{constructor(x){const e=I;this[e(2113)]=x}[I(3123)](){const x=I;return new Df(this[x(2113)][x(3123)]===void 0?this.value:this[x(2113)][x(3123)]())}}let n4=0;class I4 extends Qi{constructor(){const x=I;super(),this[x(1634)]=!0,Object[x(2899)](this,"id",{value:n4++}),this[x(1474)]="",this.usage=bC,this[x(3901)]=[]}[I(3014)](x){const e=I;return this[e(3901)][e(3330)](x),this}[I(2208)](x){const e=I,t=this.uniforms[e(2377)](x);return t!==-1&&this[e(3901)][e(2960)](t,1),this}setName(x){const e=I;return this[e(1474)]=x,this}[I(1504)](x){const e=I;return this[e(1676)]=x,this}dispose(){const x=I;return this[x(1457)]({type:x(1439)}),this}[I(1493)](x){const e=I;this[e(1474)]=x[e(1474)],this[e(1676)]=x[e(1676)];const t=x[e(3901)];this[e(3901)].length=0;for(let g=0,n=t[e(2989)];g<n;g++){const s=Array.isArray(t[g])?t[g]:[t[g]];for(let o=0;o<s[e(2989)];o++)this.uniforms[e(3330)](s[o][e(3123)]())}return this}[I(3123)](){const x=I;return new this.constructor()[x(1493)](this)}}class s4 extends w2{constructor(x,e,t=1){const g=I;super(x,e),this.isInstancedInterleavedBuffer=!0,this[g(3188)]=t}[I(1493)](x){const e=I;return super[e(1493)](x),this.meshPerAttribute=x[e(3188)],this}[I(3123)](x){const e=I,t=super[e(3123)](x);return t[e(3188)]=this.meshPerAttribute,t}[I(2054)](x){const e=I,t=super[e(2054)](x);return t[e(3039)]=!0,t[e(3188)]=this.meshPerAttribute,t}}class o4{constructor(x,e,t,g,n){const s=I;this[s(3247)]=!0,this[s(1474)]="",this[s(2360)]=x,this.type=e,this[s(365)]=t,this[s(1624)]=g,this[s(3411)]=n,this[s(1450)]=0}set[I(2170)](x){const e=I;x===!0&&this[e(1450)]++}[I(3860)](x){const e=I;return this[e(2360)]=x,this}[I(2205)](x,e){const t=I;return this.type=x,this[t(1624)]=e,this}setItemSize(x){const e=I;return this[e(365)]=x,this}[I(684)](x){const e=I;return this[e(3411)]=x,this}}const sB=new dx;class R3{constructor(x,e,t=0,g=1/0){const n=I;this[n(1253)]=new vo(x,e),this[n(2987)]=t,this[n(1407)]=g,this[n(240)]=null,this[n(2669)]=new KI,this[n(3598)]={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}[I(298)](x,e){this.ray.set(x,e)}setFromCamera(x,e){const t=I;e[t(1928)]?(this[t(1253)][t(3519)][t(1577)](e[t(2368)]),this[t(1253)][t(2721)][t(298)](x.x,x.y,.5)[t(1230)](e)[t(3938)](this[t(1253)].origin)[t(3762)](),this[t(240)]=e):e[t(1455)]?(this.ray.origin.set(x.x,x.y,(e.near+e[t(1407)])/(e.near-e[t(1407)]))[t(1230)](e),this[t(1253)].direction[t(298)](0,0,-1)[t(1411)](e[t(2368)]),this[t(240)]=e):console[t(2963)]("THREE.Raycaster: Unsupported camera type: "+e.type)}[I(3602)](x){const e=I;return sB[e(532)]()[e(3009)](x[e(2368)]),this.ray.origin[e(1577)](x[e(2368)]),this[e(1253)][e(2721)][e(298)](0,0,-1)[e(3075)](sB),this}[I(1921)](x,e=!0,t=[]){const g=I;return ah(x,this,t,e),t[g(3609)](oB),t}intersectObjects(x,e=!0,t=[]){const g=I;for(let n=0,s=x[g(2989)];n<s;n++)ah(x[n],this,t,e);return t[g(3609)](oB),t}}function oB(i,x){return i[I(3035)]-x.distance}function ah(i,x,e,t){const g=I;if(i[g(2669)][g(3633)](x[g(2669)])&&i[g(785)](x,e),t===!0){const n=i[g(1352)];for(let s=0,o=n[g(2989)];s<o;s++)ah(n[s],x,e,!0)}}class c4{constructor(x=1,e=0,t=0){const g=I;return this[g(3015)]=x,this[g(3242)]=e,this[g(3507)]=t,this}set(x,e,t){const g=I;return this[g(3015)]=x,this[g(3242)]=e,this[g(3507)]=t,this}[I(1493)](x){const e=I;return this.radius=x[e(3015)],this[e(3242)]=x[e(3242)],this.theta=x.theta,this}makeSafe(){const x=I,e=1e-6;return this[x(3242)]=Math[x(1971)](e,Math[x(1410)](Math.PI-e,this[x(3242)])),this}[I(1632)](x){return this[I(3539)](x.x,x.y,x.z)}[I(3539)](x,e,t){const g=I;return this[g(3015)]=Math[g(3641)](x*x+e*e+t*t),this[g(3015)]===0?(this[g(3507)]=0,this[g(3242)]=0):(this[g(3507)]=Math.atan2(x,t),this.phi=Math[g(3102)](Ae(e/this.radius,-1,1))),this}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}}class C4{constructor(x=1,e=0,t=0){const g=I;return this[g(3015)]=x,this[g(3507)]=e,this.y=t,this}[I(298)](x,e,t){const g=I;return this[g(3015)]=x,this[g(3507)]=e,this.y=t,this}[I(1493)](x){const e=I;return this[e(3015)]=x.radius,this[e(3507)]=x[e(3507)],this.y=x.y,this}setFromVector3(x){return this.setFromCartesianCoords(x.x,x.y,x.z)}setFromCartesianCoords(x,e,t){const g=I;return this[g(3015)]=Math[g(3641)](x*x+t*t),this[g(3507)]=Math[g(435)](x,t),this.y=e,this}[I(3123)](){const x=I;return new this[x(135)]()[x(1493)](this)}}const cB=new S0;class l4{constructor(x=new S0(1/0,1/0),e=new S0(-1/0,-1/0)){const t=I;this[t(989)]=!0,this.min=x,this[t(1971)]=e}set(x,e){const t=I;return this[t(1410)][t(1493)](x),this[t(1971)].copy(e),this}setFromPoints(x){const e=I;this[e(3734)]();for(let t=0,g=x[e(2989)];t<g;t++)this[e(3282)](x[t]);return this}[I(2298)](x,e){const t=I,g=cB[t(1493)](e).multiplyScalar(.5);return this[t(1410)][t(1493)](x)[t(3938)](g),this[t(1971)][t(1493)](x).add(g),this}clone(){const x=I;return new this[x(135)]()[x(1493)](this)}[I(1493)](x){const e=I;return this.min[e(1493)](x[e(1410)]),this[e(1971)].copy(x.max),this}makeEmpty(){const x=I;return this[x(1410)].x=this[x(1410)].y=1/0,this[x(1971)].x=this[x(1971)].y=-1/0,this}[I(1303)](){const x=I;return this[x(1971)].x<this.min.x||this[x(1971)].y<this[x(1410)].y}getCenter(x){const e=I;return this[e(1303)]()?x[e(298)](0,0):x[e(3107)](this[e(1410)],this[e(1971)])[e(2333)](.5)}[I(1277)](x){const e=I;return this[e(1303)]()?x[e(298)](0,0):x.subVectors(this.max,this.min)}expandByPoint(x){const e=I;return this[e(1410)][e(1410)](x),this.max[e(1971)](x),this}[I(1972)](x){const e=I;return this.min.sub(x),this[e(1971)][e(3014)](x),this}[I(2698)](x){const e=I;return this[e(1410)].addScalar(-x),this[e(1971)].addScalar(x),this}[I(2035)](x){const e=I;return!(x.x<this[e(1410)].x||x.x>this[e(1971)].x||x.y<this[e(1410)].y||x.y>this[e(1971)].y)}[I(3095)](x){const e=I;return this[e(1410)].x<=x[e(1410)].x&&x[e(1971)].x<=this[e(1971)].x&&this.min.y<=x[e(1410)].y&&x[e(1971)].y<=this[e(1971)].y}[I(2961)](x,e){const t=I;return e[t(298)]((x.x-this[t(1410)].x)/(this[t(1971)].x-this[t(1410)].x),(x.y-this[t(1410)].y)/(this[t(1971)].y-this[t(1410)].y))}[I(2425)](x){const e=I;return!(x[e(1971)].x<this.min.x||x[e(1410)].x>this[e(1971)].x||x[e(1971)].y<this[e(1410)].y||x[e(1410)].y>this[e(1971)].y)}[I(787)](x,e){const t=I;return e[t(1493)](x)[t(3920)](this[t(1410)],this[t(1971)])}[I(2587)](x){const e=I;return this[e(787)](x,cB)[e(3708)](x)}[I(1184)](x){const e=I;return this[e(1410)][e(1971)](x.min),this[e(1971)][e(1410)](x[e(1971)]),this[e(1303)]()&&this[e(3734)](),this}[I(2092)](x){const e=I;return this.min[e(1410)](x.min),this[e(1971)].max(x[e(1971)]),this}translate(x){const e=I;return this[e(1410)].add(x),this[e(1971)][e(3014)](x),this}equals(x){const e=I;return x[e(1410)][e(3106)](this[e(1410)])&&x.max[e(3106)](this[e(1971)])}}const CB=new E,_a=new E;class a4{constructor(x=new E,e=new E){const t=I;this[t(3988)]=x,this[t(922)]=e}[I(298)](x,e){const t=I;return this[t(3988)][t(1493)](x),this[t(922)][t(1493)](e),this}copy(x){const e=I;return this.start.copy(x[e(3988)]),this.end[e(1493)](x[e(922)]),this}[I(878)](x){const e=I;return x[e(3107)](this[e(3988)],this.end)[e(2333)](.5)}[I(438)](x){const e=I;return x[e(859)](this[e(922)],this.start)}[I(2239)](){const x=I;return this[x(3988)][x(3489)](this[x(922)])}distance(){const x=I;return this.start.distanceTo(this[x(922)])}at(x,e){const t=I;return this[t(438)](e).multiplyScalar(x).add(this[t(3988)])}[I(1593)](x,e){const t=I;CB[t(859)](x,this[t(3988)]),_a[t(859)](this.end,this[t(3988)]);const g=_a[t(1760)](_a);let s=_a[t(1760)](CB)/g;return e&&(s=Ae(s,0,1)),s}closestPointToPoint(x,e,t){const g=I,n=this.closestPointToPointParameter(x,e);return this[g(438)](t)[g(2333)](n)[g(3014)](this[g(3988)])}[I(3075)](x){const e=I;return this[e(3988)][e(3075)](x),this[e(922)][e(3075)](x),this}[I(3106)](x){const e=I;return x.start[e(3106)](this[e(3988)])&&x[e(922)][e(3106)](this.end)}[I(3123)](){const x=I;return new this[x(135)]().copy(this)}}const lB=new E;class r4 extends Nx{constructor(x,e){const t=I;super(),this[t(2680)]=x,this[t(2272)]=!1,this[t(432)]=e,this.type=t(1346);const g=new vx,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,C=32;o<C;o++,c++){const r=o/C*Math.PI*2,A=c/C*Math.PI*2;n[t(3330)](Math[t(1563)](r),Math[t(1996)](r),1,Math[t(1563)](A),Math.sin(A),1)}g[t(1236)]("position",new ix(n,3));const s=new vt({fog:!1,toneMapped:!1});this.cone=new Ai(g,s),this.add(this.cone),this[t(2341)]()}[I(1439)](){const x=I;this[x(2132)][x(352)].dispose(),this.cone[x(3480)][x(1439)]()}[I(2341)](){const x=I;this[x(2680)][x(2144)](!0,!1),this[x(2680)][x(2930)][x(2144)](!0,!1),this[x(1064)]?(this.parent[x(2144)](!0),this[x(1721)][x(1493)](this.parent[x(2368)])[x(2483)]()[x(327)](this.light[x(2368)])):this.matrix[x(1493)](this[x(2680)][x(2368)]),this[x(2368)][x(1493)](this.light[x(2368)]);const e=this.light.distance?this.light[x(3035)]:1e3,t=e*Math[x(1597)](this[x(2680)][x(3478)]);this[x(2132)][x(623)][x(298)](t,t,e),lB.setFromMatrixPosition(this.light[x(2930)].matrixWorld),this[x(2132)][x(2765)](lB),this[x(432)]!==void 0?this[x(2132)][x(3480)][x(432)][x(298)](this[x(432)]):this.cone[x(3480)][x(432)].copy(this.light[x(432)])}}const dn=new E,Da=new dx,Au=new dx;class d4 extends Ai{constructor(x){const e=I,t=V3(x),g=new vx,n=[],s=[],o=new Q0(0,0,1),c=new Q0(0,1,0);for(let r=0;r<t[e(2989)];r++){const A=t[r];A[e(1064)]&&A[e(1064)][e(2772)]&&(n.push(0,0,0),n[e(3330)](0,0,0),s.push(o.r,o.g,o.b),s[e(3330)](c.r,c.g,c.b))}g[e(1236)](e(2817),new ix(n,3)),g[e(1236)]("color",new ix(s,3));const C=new vt({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(g,C),this.isSkeletonHelper=!0,this[e(3505)]=e(3502),this[e(1871)]=x,this.bones=t,this.matrix=x.matrixWorld,this[e(2272)]=!1}[I(3554)](x){const e=I,t=this[e(3932)],g=this[e(352)],n=g[e(2606)]("position");Au[e(1493)](this[e(1871)].matrixWorld)[e(2483)]();for(let s=0,o=0;s<t[e(2989)];s++){const c=t[s];c[e(1064)]&&c[e(1064)][e(2772)]&&(Da[e(1418)](Au,c[e(2368)]),dn[e(1577)](Da),n[e(3082)](o,dn.x,dn.y,dn.z),Da.multiplyMatrices(Au,c.parent.matrixWorld),dn.setFromMatrixPosition(Da),n.setXYZ(o+1,dn.x,dn.y,dn.z),o+=2)}g[e(2606)](e(2817)).needsUpdate=!0,super[e(3554)](x)}[I(1439)](){const x=I;this.geometry[x(1439)](),this[x(3480)][x(1439)]()}}function V3(i){const x=I,e=[];i[x(2772)]===!0&&e[x(3330)](i);for(let t=0;t<i[x(1352)][x(2989)];t++)e[x(3330)][x(1307)](e,V3(i[x(1352)][t]));return e}class A4 extends ye{constructor(x,e,t){const g=I,n=new TC(e,4,2),s=new Ln({wireframe:!0,fog:!1,toneMapped:!1});super(n,s),this[g(2680)]=x,this.color=t,this[g(3505)]="PointLightHelper",this[g(1721)]=this[g(2680)].matrixWorld,this[g(2272)]=!1,this[g(2341)]()}[I(1439)](){const x=I;this[x(352)][x(1439)](),this.material.dispose()}[I(2341)](){const x=I;this[x(2680)].updateWorldMatrix(!0,!1),this[x(432)]!==void 0?this.material.color[x(298)](this[x(432)]):this.material[x(432)][x(1493)](this[x(2680)][x(432)])}}const u4=new E,aB=new Q0,rB=new Q0;class b4 extends Nx{constructor(x,e,t){const g=I;super(),this[g(2680)]=x,this[g(1721)]=x[g(2368)],this[g(2272)]=!1,this.color=t,this[g(3505)]=g(222);const n=new kC(e);n[g(3308)](Math.PI*.5),this[g(3480)]=new Ln({wireframe:!0,fog:!1,toneMapped:!1}),this[g(432)]===void 0&&(this.material[g(123)]=!0);const s=n[g(2606)](g(2817)),o=new Float32Array(s[g(3411)]*3);n.setAttribute(g(432),new Px(o,3)),this[g(3014)](new ye(n,this[g(3480)])),this[g(2341)]()}dispose(){const x=I;this[x(1352)][0][x(352)][x(1439)](),this[x(1352)][0].material.dispose()}[I(2341)](){const x=I,e=this[x(1352)][0];if(this[x(432)]!==void 0)this[x(3480)][x(432)][x(298)](this[x(432)]);else{const t=e.geometry[x(2606)]("color");aB[x(1493)](this[x(2680)][x(432)]),rB.copy(this[x(2680)][x(966)]);for(let g=0,n=t[x(3411)];g<n;g++){const s=g<n/2?aB:rB;t[x(3082)](g,s.r,s.g,s.b)}t[x(2170)]=!0}this[x(2680)].updateWorldMatrix(!0,!1),e.lookAt(u4[x(1577)](this[x(2680)][x(2368)])[x(3217)]())}}class h4 extends Ai{constructor(x=10,e=10,t=4473924,g=8947848){const n=I;t=new Q0(t),g=new Q0(g);const s=e/2,o=x/e,c=x/2,C=[],r=[];for(let h=0,f=0,B=-c;h<=e;h++,B+=o){C[n(3330)](-c,0,B,c,0,B),C[n(3330)](B,0,-c,B,0,c);const Z=h===s?t:g;Z[n(3904)](r,f),f+=3,Z.toArray(r,f),f+=3,Z[n(3904)](r,f),f+=3,Z[n(3904)](r,f),f+=3}const A=new vx;A[n(1236)]("position",new ix(C,3)),A[n(1236)](n(432),new ix(r,3));const d=new vt({vertexColors:!0,toneMapped:!1});super(A,d),this[n(3505)]="GridHelper"}[I(1439)](){const x=I;this.geometry[x(1439)](),this[x(3480)].dispose()}}class f4 extends Ai{constructor(x=10,e=16,t=8,g=64,n=4473924,s=8947848){const o=I;n=new Q0(n),s=new Q0(s);const c=[],C=[];if(e>1)for(let d=0;d<e;d++){const h=d/e*(Math.PI*2),f=Math.sin(h)*x,B=Math[o(1563)](h)*x;c[o(3330)](0,0,0),c[o(3330)](f,0,B);const Z=d&1?n:s;C[o(3330)](Z.r,Z.g,Z.b),C.push(Z.r,Z.g,Z.b)}for(let d=0;d<t;d++){const h=d&1?n:s,f=x-x/t*d;for(let B=0;B<g;B++){let Z=B/g*(Math.PI*2),G=Math[o(1996)](Z)*f,m=Math[o(1563)](Z)*f;c[o(3330)](G,0,m),C[o(3330)](h.r,h.g,h.b),Z=(B+1)/g*(Math.PI*2),G=Math.sin(Z)*f,m=Math[o(1563)](Z)*f,c[o(3330)](G,0,m),C[o(3330)](h.r,h.g,h.b)}}const r=new vx;r[o(1236)](o(2817),new ix(c,3)),r[o(1236)]("color",new ix(C,3));const A=new vt({vertexColors:!0,toneMapped:!1});super(r,A),this.type=o(137)}[I(1439)](){const x=I;this[x(352)][x(1439)](),this.material[x(1439)]()}}const dB=new E,Qa=new E,AB=new E;class m4 extends Nx{constructor(x,e,t){const g=I;super(),this[g(2680)]=x,this[g(1721)]=x.matrixWorld,this[g(2272)]=!1,this.color=t,this[g(3505)]=g(3233),e===void 0&&(e=1);let n=new vx;n[g(1236)]("position",new ix([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const s=new vt({fog:!1,toneMapped:!1});this[g(1021)]=new Nn(n,s),this[g(3014)](this[g(1021)]),n=new vx,n[g(1236)](g(2817),new ix([0,0,0,0,0,1],3)),this[g(3264)]=new Nn(n,s),this[g(3014)](this.targetLine),this[g(2341)]()}[I(1439)](){const x=I;this[x(1021)][x(352)].dispose(),this[x(1021)].material[x(1439)](),this[x(3264)][x(352)][x(1439)](),this[x(3264)][x(3480)].dispose()}[I(2341)](){const x=I;this.light[x(2144)](!0,!1),this.light[x(2930)][x(2144)](!0,!1),dB[x(1577)](this[x(2680)][x(2368)]),Qa[x(1577)](this.light[x(2930)].matrixWorld),AB.subVectors(Qa,dB),this[x(1021)][x(2765)](Qa),this[x(432)]!==void 0?(this[x(1021)][x(3480)][x(432)].set(this[x(432)]),this.targetLine[x(3480)][x(432)].set(this[x(432)])):(this[x(1021)].material[x(432)][x(1493)](this[x(2680)][x(432)]),this.targetLine[x(3480)][x(432)][x(1493)](this[x(2680)][x(432)])),this[x(3264)][x(2765)](Qa),this.targetLine[x(623)].z=AB.length()}}const Pa=new E,re=new NC;class G4 extends Ai{constructor(x){const e=I,t=new vx,g=new vt({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],s=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c(e(2052),e(1528)),c(e(929),e(3301)),c("cf1",e(1489)),c(e(3148),e(1271));function c(B,Z){C(B),C(Z)}function C(B){const Z=e;n[Z(3330)](0,0,0),s.push(0,0,0),o[B]===void 0&&(o[B]=[]),o[B][Z(3330)](n[Z(2989)]/3-1)}t[e(1236)](e(2817),new ix(n,3)),t[e(1236)](e(432),new ix(s,3)),super(t,g),this.type=e(2644),this[e(240)]=x,this[e(240)][e(3947)]&&this.camera[e(3947)](),this.matrix=x[e(2368)],this[e(2272)]=!1,this[e(1552)]=o,this[e(2341)]();const r=new Q0(16755200),A=new Q0(16711680),d=new Q0(43775),h=new Q0(16777215),f=new Q0(3355443);this[e(558)](r,A,d,h,f)}[I(558)](x,e,t,g,n){const s=I,o=this.geometry,c=o.getAttribute(s(432));c[s(3082)](0,x.r,x.g,x.b),c[s(3082)](1,x.r,x.g,x.b),c[s(3082)](2,x.r,x.g,x.b),c[s(3082)](3,x.r,x.g,x.b),c[s(3082)](4,x.r,x.g,x.b),c[s(3082)](5,x.r,x.g,x.b),c[s(3082)](6,x.r,x.g,x.b),c[s(3082)](7,x.r,x.g,x.b),c[s(3082)](8,x.r,x.g,x.b),c[s(3082)](9,x.r,x.g,x.b),c[s(3082)](10,x.r,x.g,x.b),c[s(3082)](11,x.r,x.g,x.b),c[s(3082)](12,x.r,x.g,x.b),c.setXYZ(13,x.r,x.g,x.b),c[s(3082)](14,x.r,x.g,x.b),c[s(3082)](15,x.r,x.g,x.b),c.setXYZ(16,x.r,x.g,x.b),c[s(3082)](17,x.r,x.g,x.b),c[s(3082)](18,x.r,x.g,x.b),c[s(3082)](19,x.r,x.g,x.b),c[s(3082)](20,x.r,x.g,x.b),c.setXYZ(21,x.r,x.g,x.b),c.setXYZ(22,x.r,x.g,x.b),c[s(3082)](23,x.r,x.g,x.b),c[s(3082)](24,e.r,e.g,e.b),c[s(3082)](25,e.r,e.g,e.b),c.setXYZ(26,e.r,e.g,e.b),c[s(3082)](27,e.r,e.g,e.b),c.setXYZ(28,e.r,e.g,e.b),c.setXYZ(29,e.r,e.g,e.b),c[s(3082)](30,e.r,e.g,e.b),c.setXYZ(31,e.r,e.g,e.b),c.setXYZ(32,t.r,t.g,t.b),c[s(3082)](33,t.r,t.g,t.b),c[s(3082)](34,t.r,t.g,t.b),c[s(3082)](35,t.r,t.g,t.b),c.setXYZ(36,t.r,t.g,t.b),c[s(3082)](37,t.r,t.g,t.b),c[s(3082)](38,g.r,g.g,g.b),c[s(3082)](39,g.r,g.g,g.b),c[s(3082)](40,n.r,n.g,n.b),c[s(3082)](41,n.r,n.g,n.b),c[s(3082)](42,n.r,n.g,n.b),c[s(3082)](43,n.r,n.g,n.b),c[s(3082)](44,n.r,n.g,n.b),c.setXYZ(45,n.r,n.g,n.b),c[s(3082)](46,n.r,n.g,n.b),c[s(3082)](47,n.r,n.g,n.b),c[s(3082)](48,n.r,n.g,n.b),c[s(3082)](49,n.r,n.g,n.b),c[s(2170)]=!0}[I(2341)](){const x=I,e=this[x(352)],t=this.pointMap,g=1,n=1;re[x(2957)][x(1493)](this[x(240)][x(2957)]),he("c",t,e,re,0,0,-1),he("t",t,e,re,0,0,1),he("n1",t,e,re,-g,-n,-1),he("n2",t,e,re,g,-n,-1),he("n3",t,e,re,-g,n,-1),he("n4",t,e,re,g,n,-1),he("f1",t,e,re,-g,-n,1),he("f2",t,e,re,g,-n,1),he("f3",t,e,re,-g,n,1),he("f4",t,e,re,g,n,1),he("u1",t,e,re,g*.7,n*1.1,-1),he("u2",t,e,re,-g*.7,n*1.1,-1),he("u3",t,e,re,0,n*2,-1),he("cf1",t,e,re,-g,0,1),he(x(1489),t,e,re,g,0,1),he(x(3148),t,e,re,0,-n,1),he(x(1271),t,e,re,0,n,1),he(x(2052),t,e,re,-g,0,-1),he("cn2",t,e,re,g,0,-1),he("cn3",t,e,re,0,-n,-1),he(x(3301),t,e,re,0,n,-1),e[x(2606)](x(2817))[x(2170)]=!0}[I(1439)](){const x=I;this[x(352)][x(1439)](),this[x(3480)][x(1439)]()}}function he(i,x,e,t,g,n,s){const o=I;Pa.set(g,n,s)[o(1230)](t);const c=x[i];if(c!==void 0){const C=e.getAttribute(o(2817));for(let r=0,A=c[o(2989)];r<A;r++)C.setXYZ(c[r],Pa.x,Pa.y,Pa.z)}}const Oa=new yt;class p4 extends Ai{constructor(x,e=16776960){const t=I,g=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(8*3),s=new vx;s[t(3317)](new Px(g,1)),s[t(1236)](t(2817),new Px(n,3)),super(s,new vt({color:e,toneMapped:!1})),this[t(1011)]=x,this[t(3505)]=t(2014),this[t(2272)]=!1,this[t(2341)]()}update(x){const e=I;if(x!==void 0&&console[e(3748)](e(1863)),this[e(1011)]!==void 0&&Oa[e(1854)](this.object),Oa[e(1303)]())return;const t=Oa.min,g=Oa[e(1971)],n=this[e(352)][e(2593)][e(2817)],s=n.array;s[0]=g.x,s[1]=g.y,s[2]=g.z,s[3]=t.x,s[4]=g.y,s[5]=g.z,s[6]=t.x,s[7]=t.y,s[8]=g.z,s[9]=g.x,s[10]=t.y,s[11]=g.z,s[12]=g.x,s[13]=g.y,s[14]=t.z,s[15]=t.x,s[16]=g.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=g.x,s[22]=t.y,s[23]=t.z,n[e(2170)]=!0,this.geometry[e(1668)]()}[I(1854)](x){const e=I;return this[e(1011)]=x,this[e(2341)](),this}copy(x,e){const t=I;return super[t(1493)](x,e),this[t(1011)]=x[t(1011)],this}dispose(){const x=I;this[x(352)][x(1439)](),this.material.dispose()}}class B4 extends Ai{constructor(x,e=16776960){const t=I,g=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new vx;s[t(3317)](new Px(g,1)),s[t(1236)]("position",new ix(n,3)),super(s,new vt({color:e,toneMapped:!1})),this[t(1405)]=x,this.type=t(1784),this[t(352)][t(1668)]()}updateMatrixWorld(x){const e=I,t=this[e(1405)];t.isEmpty()||(t[e(878)](this[e(2817)]),t[e(1277)](this[e(623)]),this[e(623)][e(2333)](.5),super[e(3554)](x))}[I(1439)](){const x=I;this[x(352)][x(1439)](),this[x(3480)][x(1439)]()}}class Z4 extends Nn{constructor(x,e=1,t=16776960){const g=I,n=t,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new vx;o[g(1236)]("position",new ix(s,3)),o.computeBoundingSphere(),super(o,new vt({color:n,toneMapped:!1})),this[g(3505)]="PlaneHelper",this[g(2629)]=x,this[g(1019)]=e;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],C=new vx;C[g(1236)](g(2817),new ix(c,3)),C[g(1668)](),this[g(3014)](new ye(C,new Ln({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}[I(3554)](x){const e=I;this[e(2817)][e(298)](0,0,0),this.scale.set(.5*this[e(1019)],.5*this[e(1019)],1),this[e(2765)](this[e(2629)].normal),this[e(148)](-this.plane[e(1818)]),super[e(3554)](x)}dispose(){const x=I;this[x(352)][x(1439)](),this[x(3480)][x(1439)](),this[x(1352)][0][x(352)][x(1439)](),this[x(1352)][0][x(3480)][x(1439)]()}}const uB=new E;let qa,uu;class y4 extends Nx{constructor(x=new E(0,0,1),e=new E(0,0,0),t=1,g=16776960,n=t*.2,s=n*.2){const o=I;super(),this[o(3505)]=o(550),qa===void 0&&(qa=new vx,qa[o(1236)](o(2817),new ix([0,0,0,0,1,0],3)),uu=new Ro(0,.5,1,5,1),uu[o(2945)](0,-.5,0)),this.position.copy(e),this.line=new Nn(qa,new vt({color:g,toneMapped:!1})),this[o(1967)][o(2272)]=!1,this[o(3014)](this.line),this.cone=new ye(uu,new Ln({color:g,toneMapped:!1})),this[o(2132)][o(2272)]=!1,this[o(3014)](this[o(2132)]),this[o(1673)](x),this[o(3231)](t,n,s)}[I(1673)](x){const e=I;if(x.y>.99999)this[e(3915)][e(298)](0,0,0,1);else if(x.y<-.99999)this[e(3915)].set(1,0,0,0);else{uB.set(x.z,0,-x.x)[e(3762)]();const t=Math[e(3102)](x.y);this.quaternion.setFromAxisAngle(uB,t)}}[I(3231)](x,e=x*.2,t=e*.2){const g=I;this.line[g(623)][g(298)](1,Math[g(1971)](1e-4,x-e),1),this.line[g(466)](),this[g(2132)].scale[g(298)](t,e,t),this[g(2132)][g(2817)].y=x,this.cone[g(466)]()}[I(1462)](x){const e=I;this.line[e(3480)].color[e(298)](x),this[e(2132)][e(3480)].color[e(298)](x)}[I(1493)](x){const e=I;return super[e(1493)](x,!1),this[e(1967)][e(1493)](x[e(1967)]),this[e(2132)][e(1493)](x[e(2132)]),this}[I(1439)](){const x=I;this[x(1967)][x(352)].dispose(),this[x(1967)].material.dispose(),this[x(2132)].geometry[x(1439)](),this.cone[x(3480)][x(1439)]()}}class v4 extends Ai{constructor(x=1){const e=I,t=[0,0,0,x,0,0,0,0,0,0,x,0,0,0,0,0,0,x],g=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new vx;n[e(1236)](e(2817),new ix(t,3)),n[e(1236)](e(432),new ix(g,3));const s=new vt({vertexColors:!0,toneMapped:!1});super(n,s),this[e(3505)]=e(256)}[I(558)](x,e,t){const g=I,n=new Q0,s=this.geometry.attributes[g(432)][g(315)];return n[g(298)](x),n[g(3904)](s,0),n[g(3904)](s,3),n[g(298)](e),n.toArray(s,6),n[g(3904)](s,9),n[g(298)](t),n[g(3904)](s,12),n[g(3904)](s,15),this[g(352)][g(2593)].color.needsUpdate=!0,this}[I(1439)](){const x=I;this[x(352)][x(1439)](),this[x(3480)][x(1439)]()}}class W4{constructor(){const x=I;this[x(3505)]=x(2590),this[x(432)]=new Q0,this[x(2083)]=[],this[x(2998)]=null}[I(2048)](x,e){const t=I;return this[t(2998)]=new mC,this.subPaths[t(3330)](this[t(2998)]),this.currentPath[t(2048)](x,e),this}[I(1132)](x,e){const t=I;return this[t(2998)][t(1132)](x,e),this}quadraticCurveTo(x,e,t,g){const n=I;return this[n(2998)][n(389)](x,e,t,g),this}[I(3673)](x,e,t,g,n,s){const o=I;return this[o(2998)][o(3673)](x,e,t,g,n,s),this}[I(1286)](x){const e=I;return this[e(2998)][e(1286)](x),this}[I(3346)](x){const e=I;function t(m){const v=i0,p=[];for(let w=0,V=m[v(2989)];w<V;w++){const N=m[w],X=new HI;X[v(2818)]=N[v(2818)],p[v(3330)](X)}return p}function g(m,v){const p=i0,w=v[p(2989)];let V=!1;for(let N=w-1,X=0;X<w;N=X++){let M=v[N],Y=v[X],S=Y.x-M.x,H=Y.y-M.y;if(Math[p(447)](H)>Number[p(2700)]){if(H<0&&(M=v[X],S=-S,Y=v[N],H=-H),m.y<M.y||m.y>Y.y)continue;if(m.y===M.y){if(m.x===M.x)return!0}else{const O=H*(m.x-M.x)-S*(m.y-M.y);if(O===0)return!0;if(O<0)continue;V=!V}}else{if(m.y!==M.y)continue;if(Y.x<=m.x&&m.x<=M.x||M.x<=m.x&&m.x<=Y.x)return!0}}return V}const n=ri[e(1954)],s=this[e(2083)];if(s[e(2989)]===0)return[];let o,c,C;const r=[];if(s[e(2989)]===1)return c=s[0],C=new HI,C.curves=c[e(2818)],r.push(C),r;let A=!n(s[0][e(527)]());A=x?!A:A;const d=[],h=[];let f=[],B=0,Z;h[B]=void 0,f[B]=[];for(let m=0,v=s.length;m<v;m++)c=s[m],Z=c.getPoints(),o=n(Z),o=x?!o:o,o?(!A&&h[B]&&B++,h[B]={s:new HI,p:Z},h[B].s.curves=c[e(2818)],A&&B++,f[B]=[]):f[B].push({h:c,p:Z[0]});if(!h[0])return t(s);if(h[e(2989)]>1){let m=!1,v=0;for(let p=0,w=h[e(2989)];p<w;p++)d[p]=[];for(let p=0,w=h.length;p<w;p++){const V=f[p];for(let N=0;N<V.length;N++){const X=V[N];let M=!0;for(let Y=0;Y<h[e(2989)];Y++)g(X.p,h[Y].p)&&(p!==Y&&v++,M?(M=!1,d[Y][e(3330)](X)):m=!0);M&&d[p].push(X)}}v>0&&m===!1&&(f=d)}let G;for(let m=0,v=h[e(2989)];m<v;m++){C=h[m].s,r[e(3330)](C),G=f[m];for(let p=0,w=G.length;p<w;p++)C.holes.push(G[p].h)}return r}}class w4 extends Jg{constructor(x=1,e=1,t=1,g={}){const n=I;console[n(3748)](n(1878)),super(x,e,{...g,count:t}),this.isWebGLMultipleRenderTargets=!0}get[I(3840)](){return this[I(353)]}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__[I(1457)](new CustomEvent(I(3688),{detail:{revision:f2}}));typeof window!==I(1797)&&(window[I(1007)]?console[I(3748)](I(3162)):window[I(1007)]=f2);const R4=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:sf,AddEquation:Gn,AddOperation:Ty,AdditiveAnimationBlendMode:bf,AdditiveBlending:Wb,AgXToneMapping:Dy,AlphaFormat:jy,AlwaysCompare:bv,AlwaysDepth:Hy,AlwaysStencilFunc:gh,AmbientLight:m3,AnimationAction:w3,AnimationClip:vC,AnimationLoader:RF,AnimationMixer:i4,AnimationObjectGroup:t4,AnimationUtils:yF,ArcCurve:Uv,ArrayCamera:Nv,ArrowHelper:y4,AttachedBindMode:Vb,Audio:v3,AudioAnalyser:_F,AudioContext:Jf,AudioListener:JF,AudioLoader:LF,AxesHelper:v4,BackSide:Zt,BasicDepthPacking:ov,BasicShadowMap:Ay,BatchedMesh:Tv,Bone:Rf,BooleanKeyframeTrack:hI,Box2:l4,Box3:yt,Box3Helper:B4,BoxGeometry:UI,BoxHelper:p4,BufferAttribute:Px,BufferGeometry:vx,BufferGeometryLoader:y3,ByteType:Oy,Cache:Ki,Camera:NC,CameraHelper:G4,CanvasTexture:PN,CapsuleGeometry:X2,CatmullRomCurve3:_v,CineonToneMapping:Uy,CircleGeometry:Y2,ClampToEdgeWrapping:Gg,Clock:Ef,Color:Q0,ColorKeyframeTrack:Lf,ColorManagement:_x,CompressedArrayTexture:DN,CompressedCubeTexture:QN,CompressedTexture:V2,CompressedTextureLoader:VF,ConeGeometry:K2,ConstantAlphaFactor:Xy,ConstantColorFactor:Vy,CubeCamera:Wv,CubeReflectionMapping:Ei,CubeRefractionMapping:Hn,CubeTexture:FC,CubeTextureLoader:SF,CubeUVReflectionMapping:Zo,CubicBezierCurve:Xf,CubicBezierCurve3:Dv,CubicInterpolant:a3,CullFaceBack:vb,CullFaceFront:dy,CullFaceFrontBack:FV,CullFaceNone:ry,Curve:Ug,CurvePath:Pv,CustomBlending:uy,CustomToneMapping:_y,CylinderGeometry:Ro,Cylindrical:C4,Data3DTexture:mf,DataArrayTexture:Z2,DataTexture:Xn,DataTextureLoader:XF,DataUtils:US,DecrementStencilOp:QV,DecrementWrapStencilOp:OV,DefaultLoadingManager:A3,DepthFormat:XI,DepthStencilFormat:bo,DepthTexture:Zf,DetachedBindMode:Py,DirectionalLight:f3,DirectionalLightHelper:m4,DiscreteInterpolant:r3,DisplayP3ColorSpace:B2,DodecahedronGeometry:H2,DoubleSide:si,DstAlphaFactor:yy,DstColorFactor:Wy,DynamicCopyUsage:CS,DynamicDrawUsage:hv,DynamicReadUsage:sS,EdgesGeometry:Ov,EllipseCurve:S2,EqualCompare:rv,EqualDepth:Fy,EqualStencilFunc:xS,EquirectangularReflectionMapping:sC,EquirectangularRefractionMapping:oC,Euler:Tt,EventDispatcher:Qi,ExtrudeGeometry:F2,FileLoader:Ui,Float16BufferAttribute:qS,Float32BufferAttribute:ix,FloatType:pg,Fog:W2,FogExp2:v2,FramebufferTexture:_N,FrontSide:Ji,Frustum:zC,GLBufferAttribute:o4,GLSL1:aS,GLSL3:ih,GreaterCompare:dv,GreaterDepth:My,GreaterEqualCompare:uv,GreaterEqualDepth:zy,GreaterEqualStencilFunc:iS,GreaterStencilFunc:tS,GridHelper:h4,Group:Os,HalfFloatType:KC,HemisphereLight:u3,HemisphereLightHelper:b4,IcosahedronGeometry:z2,ImageBitmapLoader:MF,ImageLoader:WC,ImageUtils:pv,IncrementStencilOp:DV,IncrementWrapStencilOp:PV,InstancedBufferAttribute:mo,InstancedBufferGeometry:Z3,InstancedInterleavedBuffer:s4,InstancedMesh:so,Int16BufferAttribute:PS,Int32BufferAttribute:OS,Int8BufferAttribute:_S,IntType:Cf,InterleavedBuffer:w2,InterleavedBufferAttribute:TI,Interpolant:JC,InterpolateDiscrete:lC,InterpolateLinear:aC,InterpolateSmooth:Zr,InvertStencilOp:qV,KeepStencilOp:dI,KeyframeTrack:kg,LOD:Lv,LatheGeometry:LC,Layers:KI,LessCompare:av,LessDepth:Ny,LessEqualCompare:hf,LessEqualDepth:IC,LessEqualStencilFunc:eS,LessStencilFunc:jV,Light:Tn,LightProbe:B3,Line:Nn,Line3:a4,LineBasicMaterial:vt,LineCurve:Yf,LineCurve3:Qv,LineDashedMaterial:c3,LineLoop:Jv,LineSegments:Ai,LinearDisplayP3ColorSpace:HC,LinearFilter:Ze,LinearInterpolant:Mf,LinearMipMapLinearFilter:kV,LinearMipMapNearestFilter:LV,LinearMipmapLinearFilter:oi,LinearMipmapNearestFilter:Mc,LinearSRGBColorSpace:Di,LinearToneMapping:Jy,LinearTransfer:dC,Loader:Jt,LoaderUtils:lh,LoadingManager:kf,LoopOnce:nv,LoopPingPong:sv,LoopRepeat:Iv,LuminanceAlphaFormat:tv,LuminanceFormat:ev,MOUSE:HV,Material:lt,MaterialLoader:U2,MathUtils:RS,Matrix3:px,Matrix4:dx,MaxEquation:my,Mesh:ye,MeshBasicMaterial:Ln,MeshDepthMaterial:yf,MeshDistanceMaterial:vf,MeshLambertMaterial:s3,MeshMatcapMaterial:o3,MeshNormalMaterial:I3,MeshPhongMaterial:i3,MeshPhysicalMaterial:g3,MeshStandardMaterial:Ff,MeshToonMaterial:n3,MinEquation:fy,MirroredRepeatWrapping:CC,MixOperation:ky,MultiplyBlending:Rb,MultiplyOperation:YC,NearestFilter:Me,NearestMipMapLinearFilter:MV,NearestMipMapNearestFilter:zV,NearestMipmapLinearFilter:Ds,NearestMipmapNearestFilter:of,NeutralToneMapping:Qy,NeverCompare:lv,NeverDepth:Ky,NeverStencilFunc:$V,NoBlending:Li,NoColorSpace:Vi,NoToneMapping:ai,NormalAnimationBlendMode:p2,NormalBlending:SI,NotEqualCompare:Av,NotEqualDepth:Ly,NotEqualStencilFunc:gS,NumberKeyframeTrack:ZC,Object3D:Nx,ObjectLoader:FF,ObjectSpaceNormalMap:Cv,OctahedronGeometry:kC,OneFactor:py,OneMinusConstantAlphaFactor:Yy,OneMinusConstantColorFactor:Sy,OneMinusDstAlphaFactor:vy,OneMinusDstColorFactor:wy,OneMinusSrcAlphaFactor:t2,OneMinusSrcColorFactor:Zy,OrthographicCamera:MC,P3Primaries:uC,PCFShadowMap:m2,PCFSoftShadowMap:zc,PMREMGenerator:nh,Path:mC,PerspectiveCamera:ze,Plane:hn,PlaneGeometry:Wo,PlaneHelper:Z4,PointLight:h3,PointLightHelper:A4,Points:Ev,PointsMaterial:Vf,PolarGridHelper:f4,PolyhedronGeometry:kn,PositionalAudio:UF,PropertyBinding:zx,PropertyMixer:W3,QuadraticBezierCurve:Kf,QuadraticBezierCurve3:Hf,Quaternion:ot,QuaternionKeyframeTrack:oo,QuaternionLinearInterpolant:d3,RED_GREEN_RGTC2_Format:eh,RED_RGTC1_Format:iv,REVISION:f2,RGBADepthPacking:cv,RGBAFormat:zt,RGBAIntegerFormat:uf,RGBA_ASTC_10x10_Format:Pb,RGBA_ASTC_10x5_Format:_b,RGBA_ASTC_10x6_Format:Db,RGBA_ASTC_10x8_Format:Qb,RGBA_ASTC_12x10_Format:Ob,RGBA_ASTC_12x12_Format:qb,RGBA_ASTC_4x4_Format:zb,RGBA_ASTC_5x4_Format:Mb,RGBA_ASTC_5x5_Format:Lb,RGBA_ASTC_6x5_Format:kb,RGBA_ASTC_6x6_Format:Tb,RGBA_ASTC_8x5_Format:Jb,RGBA_ASTC_8x6_Format:Eb,RGBA_ASTC_8x8_Format:Ub,RGBA_BPTC_Format:Br,RGBA_ETC2_EAC_Format:Fb,RGBA_PVRTC_2BPPV1_Format:Kb,RGBA_PVRTC_4BPPV1_Format:Yb,RGBA_S3TC_DXT1_Format:mr,RGBA_S3TC_DXT3_Format:Gr,RGBA_S3TC_DXT5_Format:pr,RGBFormat:xv,RGB_BPTC_SIGNED_Format:$b,RGB_BPTC_UNSIGNED_Format:jb,RGB_ETC1_Format:Hb,RGB_ETC2_Format:Nb,RGB_PVRTC_2BPPV1_Format:Xb,RGB_PVRTC_4BPPV1_Format:Sb,RGB_S3TC_DXT1_Format:fr,RGFormat:gv,RGIntegerFormat:Af,RawShaderMaterial:t3,Ray:vo,Raycaster:R3,Rec709Primaries:AC,RectAreaLight:G3,RedFormat:rf,RedIntegerFormat:df,ReinhardToneMapping:Ey,RenderTarget:Bv,RepeatWrapping:cC,ReplaceStencilOp:_V,ReverseSubtractEquation:hy,RingGeometry:M2,SIGNED_RED_GREEN_RGTC2_Format:th,SIGNED_RED_RGTC1_Format:xh,SRGBColorSpace:Ag,SRGBTransfer:qx,Scene:Wf,ShaderChunk:Zx,ShaderLib:zg,ShaderMaterial:Eg,ShadowMaterial:e3,Shape:HI,ShapeGeometry:L2,ShapePath:W4,ShapeUtils:ri,ShortType:qy,Skeleton:R2,SkeletonHelper:d4,SkinnedMesh:kv,Source:WI,Sphere:ct,SphereGeometry:TC,Spherical:c4,SphericalHarmonics3:p3,SplineCurve:Nf,SpotLight:b3,SpotLightHelper:r4,Sprite:Mv,SpriteMaterial:wf,SrcAlphaFactor:e2,SrcAlphaSaturateFactor:Ry,SrcColorFactor:By,StaticCopyUsage:cS,StaticDrawUsage:bC,StaticReadUsage:IS,StereoCamera:kF,StreamCopyUsage:lS,StreamDrawUsage:nS,StreamReadUsage:oS,StringKeyframeTrack:fI,SubtractEquation:by,SubtractiveBlending:wb,TOUCH:NV,TangentSpaceNormalMap:Mn,TetrahedronGeometry:k2,Texture:ue,TextureLoader:YF,TorusGeometry:T2,TorusKnotGeometry:J2,Triangle:xg,TriangleFanDrawMode:EV,TriangleStripDrawMode:JV,TrianglesDrawMode:TV,TubeGeometry:E2,UVMapping:G2,Uint16BufferAttribute:Gf,Uint32BufferAttribute:pf,Uint8BufferAttribute:DS,Uint8ClampedBufferAttribute:QS,Uniform:Df,UniformsGroup:I4,UniformsLib:T0,UniformsUtils:vv,UnsignedByteType:di,UnsignedInt248Type:yo,UnsignedInt5999Type:$y,UnsignedIntType:kI,UnsignedShort4444Type:lf,UnsignedShort5551Type:af,UnsignedShortType:cf,VSMShadowMap:Hg,Vector2:S0,Vector3:E,Vector4:Dx,VectorKeyframeTrack:yC,VideoTexture:UN,WebGL3DRenderTarget:HS,WebGLArrayRenderTarget:KS,WebGLCoordinateSystem:ci,WebGLCubeRenderTarget:wv,WebGLMultipleRenderTargets:w4,WebGLRenderTarget:Jg,WebGLRenderer:Fv,WebGLUtils:Hv,WebGPUCoordinateSystem:hC,WireframeGeometry:x3,WrapAroundEnding:rC,ZeroCurvatureEnding:yI,ZeroFactor:Gy,ZeroSlopeEnding:vI,ZeroStencilOp:UV,createCanvasElement:mv},Symbol[I(3083)],{value:I(2832)}));var S3={exports:{}},uI={};/**
* @license React
* react-reconciler-constants.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/uI.ConcurrentRoot=1,uI[I(1806)]=4,uI[I(3686)]=16,uI[I(2707)]=1,uI[I(1821)]=536870912,uI[I(1165)]=0;S3[I(2129)]=uI;var $s=S3.exports;function V4(i){const x=I;let e;const t=new Set,g=(r,A)=>{const d=i0,h=typeof r===d(1126)?r(e):r;if(h!==e){const f=e;e=A?h:Object[d(1859)]({},e,h),t[d(1599)](B=>B(e,f))}},n=()=>e,s=(r,A=n,d=Object.is)=>{const h=i0;console[h(3748)](h(1188));let f=A(e);function B(){const Z=A(e);if(!d(f,Z)){const G=f;r(f=Z,G)}}return t[h(3014)](B),()=>t[h(1432)](B)},o=(r,A,d)=>{const h=i0;return A||d?s(r,A,d):(t[h(3014)](r),()=>t[h(1432)](r))},c=()=>t[x(3223)](),C={setState:g,getState:n,subscribe:o,destroy:c};return e=i(g,n,C),C}const S4=typeof window===I(1797)||!window[I(285)]||/ServerSideRendering|^Deno\//[I(3633)](window[I(285)][I(1161)]),bB=S4?_0[I(263)]:_0[I(3612)];function X4(i){const x=I,e=typeof i===x(1126)?V4(i):i,t=(g=e.getState,n=Object.is)=>{const s=x,[,o]=_0.useReducer(m=>m+1,0),c=e.getState(),C=_0.useRef(c),r=_0[s(1576)](g),A=_0[s(1576)](n),d=_0[s(1576)](!1),h=_0[s(1576)]();h[s(1895)]===void 0&&(h[s(1895)]=g(c));let f,B=!1;(C.current!==c||r[s(1895)]!==g||A.current!==n||d[s(1895)])&&(f=g(c),B=!n(h[s(1895)],f)),bB(()=>{const m=s;B&&(h[m(1895)]=f),C[m(1895)]=c,r[m(1895)]=g,A.current=n,d.current=!1});const Z=_0[s(1576)](c);bB(()=>{const m=()=>{const p=i0;try{const w=e[p(312)](),V=r[p(1895)](w);!A[p(1895)](h.current,V)&&(C[p(1895)]=w,h.current=V,o())}catch{d[p(1895)]=!0,o()}},v=e.subscribe(m);return e.getState()!==Z.current&&m(),v},[]);const G=B?f:h[s(1895)];return _0[s(1682)](G),G};return Object.assign(t,e),t[Symbol[x(2880)]]=function(){const g=x;console[g(3748)]("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const s=g,o=n[s(2989)]<=0;return{value:n[s(214)](),done:o}}}},t}const Y4=i=>typeof i===I(1011)&&typeof i.then=="function",$a=[];function K4(i,x,e=(t,g)=>t===g){if(i===x)return!0;if(!i||!x)return!1;const t=i.length;if(x.length!==t)return!1;for(let g=0;g<t;g++)if(!e(i[g],x[g]))return!1;return!0}function H4(i,x=null,e=!1,t={}){const g=I;x===null&&(x=[i]);for(const s of $a)if(K4(x,s[g(958)],s[g(2600)])){if(e)return;if(Object[g(1566)].hasOwnProperty[g(2627)](s,"error"))throw s.error;if(Object.prototype.hasOwnProperty[g(2627)](s,g(1314)))return t[g(775)]&&t.lifespan>0&&(s[g(3085)]&&clearTimeout(s[g(3085)]),s[g(3085)]=setTimeout(s[g(2208)],t[g(775)])),s[g(1314)];if(!e)throw s[g(2837)]}const n={keys:x,equal:t.equal,remove:()=>{const s=g,o=$a[s(2377)](n);o!==-1&&$a[s(2960)](o,1)},promise:(Y4(i)?i:i(...x))[g(2334)](s=>{const o=g;n[o(1314)]=s,t[o(775)]&&t[o(775)]>0&&(n[o(3085)]=setTimeout(n.remove,t[o(775)]))})[g(1107)](s=>n[g(2963)]=s)};if($a.push(n),!e)throw n.promise}const kM=(i,x,e)=>H4(i,x,!1,e);var X3={exports:{}},Y3={exports:{}},K3={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(i){const x=I;function e($,j){var c0=$[i0(2989)];$.push(j);x:for(;0<c0;){var h0=c0-1>>>1,X0=$[h0];if(0<n(X0,j))$[h0]=j,$[c0]=X0,c0=h0;else break x}}function t($){return $[i0(2989)]===0?null:$[0]}function g($){if($[i0(2989)]===0)return null;var x0=$[0],c0=$.pop();if(c0!==x0){$[0]=c0;x:for(var h0=0,X0=$.length,n0=X0>>>1;h0<n0;){var g0=2*(h0+1)-1,l0=$[g0],m0=g0+1,M0=$[m0];if(0>n(l0,c0))m0<X0&&0>n(M0,l0)?($[h0]=M0,$[m0]=c0,h0=m0):($[h0]=l0,$[g0]=c0,h0=g0);else if(m0<X0&&0>n(M0,c0))$[h0]=M0,$[m0]=c0,h0=m0;else break x}}return x0}function n($,j){var c0=$[i0(1680)]-j.sortIndex;return c0!==0?c0:$.id-j.id}if(x(1011)===typeof performance&&x(1126)===typeof performance[x(978)]){var s=performance;i[x(1327)]=function(){return s[x(978)]()}}else{var o=Date,c=o[x(978)]();i[x(1327)]=function(){return o[x(978)]()-c}}var C=[],r=[],A=1,d=null,h=3,f=!1,B=!1,Z=!1,G=x(1126)===typeof setTimeout?setTimeout:null,m=x(1126)===typeof clearTimeout?clearTimeout:null,v=x(1797)!==typeof setImmediate?setImmediate:null;x(1797)!==typeof navigator&&navigator[x(2091)]!==void 0&&navigator[x(2091)][x(380)]!==void 0&&navigator[x(2091)][x(380)][x(1600)](navigator.scheduling);function p($){const j=x;for(var x0=t(r);x0!==null;){if(x0.callback===null)g(r);else if(x0[j(1919)]<=$)g(r),x0.sortIndex=x0[j(700)],e(C,x0);else break;x0=t(r)}}function w($){const j=x;if(Z=!1,p($),!B)if(t(C)!==null)B=!0,f0(V);else{var x0=t(r);x0!==null&&G0(w,x0[j(1919)]-$)}}function V($,j){const x0=x;B=!1,Z&&(Z=!1,m(M),M=-1),f=!0;var c0=h;try{for(p(j),d=t(C);d!==null&&(!(d[x0(700)]>j)||$&&!H());){var h0=d[x0(934)];if(typeof h0=="function"){d[x0(934)]=null,h=d[x0(884)];var X0=h0(d[x0(700)]<=j);j=i.unstable_now(),typeof X0=="function"?d[x0(934)]=X0:d===t(C)&&g(C),p(j)}else g(C);d=t(C)}if(d!==null)var n0=!0;else{var g0=t(r);g0!==null&&G0(w,g0.startTime-j),n0=!1}return n0}finally{d=null,h=c0,f=!1}}var N=!1,X=null,M=-1,Y=5,S=-1;function H(){return!(i[x(1327)]()-S<Y)}function O(){if(X!==null){var $=i.unstable_now();S=$;var j=!0;try{j=X(!0,$)}finally{j?I0():(N=!1,X=null)}}else N=!1}var I0;if(x(1126)===typeof v)I0=function(){v(O)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,b0=z[x(2481)];z[x(3983)][x(1042)]=O,I0=function(){b0[x(1587)](null)}}else I0=function(){G(O,0)};function f0($){X=$,N||(N=!0,I0())}function G0($,j){M=G(function(){$(i[i0(1327)]())},j)}i[x(1264)]=5,i.unstable_ImmediatePriority=1,i[x(3586)]=4,i[x(246)]=3,i[x(1227)]=null,i[x(543)]=2,i.unstable_cancelCallback=function($){const j=x;$[j(934)]=null},i[x(988)]=function(){B||f||(B=!0,f0(V))},i[x(3702)]=function($){const j=x;0>$||125<$?console[j(2963)](j(2472)):Y=0<$?Math[j(3143)](1e3/$):5},i[x(790)]=function(){return h},i[x(1642)]=function(){return t(C)},i[x(3025)]=function($){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var x0=h;h=j;try{return $()}finally{h=x0}},i[x(206)]=function(){},i[x(943)]=function(){},i[x(1386)]=function($,j){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var x0=h;h=$;try{return j()}finally{h=x0}},i.unstable_scheduleCallback=function($,j,x0){const c0=x;var h0=i[c0(1327)]();switch(typeof x0=="object"&&x0!==null?(x0=x0.delay,x0=c0(1025)===typeof x0&&0<x0?h0+x0:h0):x0=h0,$){case 1:var X0=-1;break;case 2:X0=250;break;case 5:X0=1073741823;break;case 4:X0=1e4;break;default:X0=5e3}return X0=x0+X0,$={id:A++,callback:j,priorityLevel:$,startTime:x0,expirationTime:X0,sortIndex:-1},x0>h0?($.sortIndex=x0,e(r,$),t(C)===null&&$===t(r)&&(Z?(m(M),M=-1):Z=!0,G0(w,x0-h0))):($.sortIndex=X0,e(C,$),B||f||(B=!0,f0(V))),$},i[x(822)]=H,i[x(586)]=function($){var j=h;return function(){var x0=h;h=j;try{return $.apply(this,arguments)}finally{h=x0}}}})(K3);Y3[I(2129)]=K3;var rh=Y3[I(2129)],N4=function(x){const e=I;var t={},g=_0,n=rh,s=Object[e(1859)];function o(a){const l=e;for(var u=l(1465)+a,b=1;b<arguments[l(2989)];b++)u+=l(1458)+encodeURIComponent(arguments[b]);return"Minified React error #"+a+"; visit "+u+l(1518)}var c=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol[e(686)](e(3381)),r=Symbol[e(686)](e(847)),A=Symbol[e(686)](e(3235)),d=Symbol[e(686)](e(2920)),h=Symbol[e(686)](e(619)),f=Symbol[e(686)](e(2839)),B=Symbol[e(686)]("react.context"),Z=Symbol[e(686)](e(3595)),G=Symbol[e(686)]("react.suspense"),m=Symbol[e(686)]("react.suspense_list"),v=Symbol[e(686)](e(2557)),p=Symbol.for(e(2869)),w=Symbol[e(686)]("react.offscreen"),V=Symbol.iterator;function N(a){const l=e;return a===null||l(1011)!==typeof a?null:(a=V&&a[V]||a[l(2677)],typeof a=="function"?a:null)}function X(a){const l=e;if(a==null)return null;if(l(1126)===typeof a)return a[l(3088)]||a[l(1474)]||null;if(l(3674)===typeof a)return a;switch(a){case A:return"Fragment";case r:return"Portal";case h:return"Profiler";case d:return"StrictMode";case G:return l(2066);case m:return l(815)}if(l(1011)===typeof a)switch(a[l(1596)]){case B:return(a[l(3088)]||l(2538))+".Consumer";case f:return(a[l(3942)].displayName||"Context")+l(998);case Z:var u=a[l(948)];return a=a[l(3088)],a||(a=u[l(3088)]||u[l(1474)]||"",a=a!==""?l(2944)+a+")":l(1377)),a;case v:return u=a[l(3088)]||null,u!==null?u:X(a[l(3505)])||l(3124);case p:u=a[l(2036)],a=a[l(2660)];try{return X(a(u))}catch{}}return null}function M(a){const l=e;var u=a.type;switch(a.tag){case 24:return l(3766);case 9:return(u.displayName||l(2538))+l(3097);case 10:return(u._context.displayName||l(2538))+l(998);case 18:return l(1174);case 11:return a=u[l(948)],a=a[l(3088)]||a[l(1474)]||"",u.displayName||(a!==""?l(2944)+a+")":l(1377));case 7:return l(3676);case 5:return u;case 4:return l(2060);case 3:return l(2495);case 6:return l(611);case 16:return X(u);case 8:return l(u===d?2628:571);case 22:return l(3465);case 12:return l(3992);case 21:return l(3438);case 13:return l(2066);case 19:return"SuspenseList";case 25:return l(3224);case 1:case 0:case 17:case 2:case 14:case 15:if(l(1126)===typeof u)return u[l(3088)]||u.name||null;if(typeof u=="string")return u}return null}function Y(a){const l=e;var u=a,b=a;if(a[l(641)])for(;u[l(3922)];)u=u.return;else{a=u;do u=a,u[l(2436)]&4098&&(b=u[l(3922)]),a=u[l(3922)];while(a)}return u[l(3795)]===3?b:null}function S(a){if(Y(a)!==a)throw Error(o(188))}function H(a){const l=e;var u=a[l(641)];if(!u){if(u=Y(a),u===null)throw Error(o(188));return u!==a?null:a}for(var b=a,y=u;;){var W=b.return;if(W===null)break;var K=W[l(641)];if(K===null){if(y=W[l(3922)],y!==null){b=y;continue}break}if(W[l(1367)]===K[l(1367)]){for(K=W[l(1367)];K;){if(K===b)return S(W),a;if(K===y)return S(W),u;K=K[l(1263)]}throw Error(o(188))}if(b[l(3922)]!==y.return)b=W,y=K;else{for(var P=!1,s0=W[l(1367)];s0;){if(s0===b){P=!0,b=W,y=K;break}if(s0===y){P=!0,y=W,b=K;break}s0=s0.sibling}if(!P){for(s0=K[l(1367)];s0;){if(s0===b){P=!0,b=K,y=W;break}if(s0===y){P=!0,y=K,b=W;break}s0=s0[l(1263)]}if(!P)throw Error(o(189))}}if(b[l(641)]!==y)throw Error(o(190))}if(b[l(3795)]!==3)throw Error(o(188));return b.stateNode[l(1895)]===b?a:u}function O(a){return a=H(a),a!==null?I0(a):null}function I0(a){const l=e;if(a[l(3795)]===5||a[l(3795)]===6)return a;for(a=a.child;a!==null;){var u=I0(a);if(u!==null)return u;a=a[l(1263)]}return null}function z(a){const l=e;if(a.tag===5||a[l(3795)]===6)return a;for(a=a.child;a!==null;){if(a[l(3795)]!==4){var u=z(a);if(u!==null)return u}a=a[l(1263)]}return null}var b0=Array[e(1987)],f0=x[e(670)],G0=x[e(3304)],$=x[e(1063)],j=x.prepareForCommit,x0=x[e(1396)],c0=x[e(3677)],h0=x.appendInitialChild,X0=x[e(2708)],n0=x.prepareUpdate,g0=x.shouldSetTextContent,l0=x[e(1730)],m0=x[e(3799)],M0=x[e(203)],bx=x[e(1233)],C0=x[e(247)],gx=x[e(3379)],ax=x.supportsPersistence,y0=x.supportsHydration,V0=x[e(1757)],H0=x[e(3955)],Y0=x[e(2212)],F0=x[e(2252)],$0=x[e(3494)],Q=x[e(3367)],R=x[e(2183)],T=x[e(390)],F=x.getBoundingRect,Z0=x.getTextContent,d0=x[e(3751)],w0=x[e(2471)],j0=x[e(478)],L0=x[e(2915)],J0=x[e(3376)],hx=x[e(3744)],U0=x[e(426)],Cx=x[e(603)],Rx=x[e(1166)],nx=x[e(2065)],xx=x[e(1141)],Vx=x[e(207)],Hx=x[e(1813)],Sx=x.resetTextContent,q=x[e(1406)],v0=x[e(364)],A0=x[e(2450)],W0=x[e(911)],R0=x[e(712)],P0=x.cloneInstance,Yx=x[e(2161)],Ex=x[e(3477)],Pe=x[e(3327)],Kx=x.replaceContainerChildren,Ix=x[e(2687)],Se=x[e(3520)],Vo=x[e(1887)],UC=x[e(3517)],_C=x[e(2754)],Jn=x.isSuspenseInstancePending,_I=x[e(2566)],DI=x[e(1398)],Pi=x.getNextHydratableSibling,DC=x[e(264)],D2=x[e(136)],Q2=x.getFirstHydratableChildWithinSuspenseInstance,P2=x[e(406)],L=x[e(1569)],t0=x[e(1218)],e0=x[e(2758)],k=x[e(1206)],D=x[e(3147)],J=x[e(408)],a0=x.clearSuspenseBoundaryFromContainer,k0=x.shouldDeleteUnhydratedTailInstances,ex=x.didNotMatchHydratedContainerTextInstance,lx=x[e(1937)],Ax;function ux(a){const l=e;if(Ax===void 0)try{throw Error()}catch(b){var u=b[l(1574)][l(1388)]().match(/\n( *(at )?)/);Ax=u&&u[1]||""}return`
`+Ax+a}var fx=!1;function ge(a,l){const u=e;if(!a||fx)return"";fx=!0;var b=Error[u(1603)];Error[u(1603)]=void 0;try{if(l)if(l=function(){throw Error()},Object[u(2899)](l.prototype,u(3105),{set:function(){throw Error()}}),u(1011)===typeof Reflect&&Reflect.construct){try{Reflect[u(2323)](l,[])}catch(z0){var y=z0}Reflect[u(2323)](a,[],l)}else{try{l[u(2627)]()}catch(z0){y=z0}a[u(2627)](l[u(1566)])}else{try{throw Error()}catch(z0){y=z0}a()}}catch(z0){if(z0&&y&&u(3674)===typeof z0.stack){for(var W=z0.stack.split(`
`),K=y[u(1574)].split(`
`),P=W[u(2989)]-1,s0=K[u(2989)]-1;1<=P&&0<=s0&&W[P]!==K[s0];)s0--;for(;1<=P&&0<=s0;P--,s0--)if(W[P]!==K[s0]){if(P!==1||s0!==1)do if(P--,s0--,0>s0||W[P]!==K[s0]){var p0=`
`+W[P][u(333)](u(2571),u(566));return a[u(3088)]&&p0[u(3532)](u(3658))&&(p0=p0[u(333)](u(3658),a.displayName)),p0}while(1<=P&&0<=s0);break}}}finally{fx=!1,Error[u(1603)]=b}return(a=a?a[u(3088)]||a[u(1474)]:"")?ux(a):""}var Xe=Object[e(1566)][e(3631)],ke=[],Oe=-1;function Wx(a){return{current:a}}function D0(a){const l=e;0>Oe||(a[l(1895)]=ke[Oe],ke[Oe]=null,Oe--)}function Lx(a,l){const u=e;Oe++,ke[Oe]=a[u(1895)],a[u(1895)]=l}var Fx={},ie=Wx(Fx),Te=Wx(!1),Et=Fx;function _g(a,l){const u=e;var b=a[u(3505)].contextTypes;if(!b)return Fx;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===l)return y[u(3704)];var W={},K;for(K in b)W[K]=l[K];return y&&(a=a[u(1133)],a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=W),W}function Ux(a){return a=a[e(3503)],a!=null}function Ut(){D0(Te),D0(ie)}function QI(a,l,u){if(ie.current!==Fx)throw Error(o(168));Lx(ie,l),Lx(Te,u)}function at(a,l,u){const b=e;var y=a[b(1133)];if(l=l[b(3503)],b(1126)!==typeof y[b(487)])return u;y=y.getChildContext();for(var W in y)if(!(W in l))throw Error(o(108,M(a)||b(2164),W));return s({},u,y)}function Oi(a){const l=e;return a=(a=a.stateNode)&&a[l(3606)]||Fx,Et=ie.current,Lx(ie,a),Lx(Te,Te[l(1895)]),!0}function QC(a,l,u){const b=e;var y=a[b(1133)];if(!y)throw Error(o(169));u?(a=at(a,l,Et),y[b(3606)]=a,D0(Te),D0(ie),Lx(ie,a)):D0(Te),Lx(Te,u)}var Wt=Math[e(3611)]?Math[e(3611)]:hW,uW=Math[e(2013)],bW=Math[e(3048)];function hW(a){return a>>>=0,a===0?32:31-(uW(a)/bW|0)|0}var PC=64,OC=4194304;function So(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function qC(a,l){const u=e;var b=a[u(294)];if(b===0)return 0;var y=0,W=a[u(824)],K=a[u(3632)],P=b&268435455;if(P!==0){var s0=P&~W;s0!==0?y=So(s0):(K&=P,K!==0&&(y=So(K)))}else P=b&~W,P!==0?y=So(P):K!==0&&(y=So(K));if(y===0)return 0;if(l!==0&&l!==y&&!(l&W)&&(W=y&-y,K=l&-l,W>=K||W===16&&(K&4194240)!==0))return l;if(y&4&&(y|=b&16),l=a[u(3580)],l!==0)for(a=a.entanglements,l&=y;0<l;)b=31-Wt(l),W=1<<b,y|=a[b],l&=~W;return y}function fW(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mW(a,l){const u=e;for(var b=a[u(824)],y=a.pingedLanes,W=a[u(3593)],K=a[u(294)];0<K;){var P=31-Wt(K),s0=1<<P,p0=W[P];p0===-1?(!(s0&b)||s0&y)&&(W[P]=fW(s0,l)):p0<=l&&(a[u(2330)]|=s0),K&=~s0}}function O2(a){return a=a[e(294)]&-1073741825,a!==0?a:a&1073741824?1073741824:0}function q2(a){const l=e;for(var u=[],b=0;31>b;b++)u[l(3330)](a);return u}function Xo(a,l,u){const b=e;a.pendingLanes|=l,l!==536870912&&(a[b(824)]=0,a[b(3632)]=0),a=a.eventTimes,l=31-Wt(l),a[l]=u}function GW(a,l){const u=e;var b=a[u(294)]&~l;a[u(294)]=l,a.suspendedLanes=0,a[u(3632)]=0,a.expiredLanes&=l,a[u(583)]&=l,a.entangledLanes&=l,l=a[u(154)];var y=a.eventTimes;for(a=a[u(3593)];0<b;){var W=31-Wt(b),K=1<<W;l[W]=0,y[W]=-1,a[W]=-1,b&=~K}}function $2(a,l){var u=a.entangledLanes|=l;for(a=a.entanglements;u;){var b=31-Wt(u),y=1<<b;y&l|a[b]&l&&(a[b]|=l),u&=~y}}var kx=0;function Of(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var j2=n[e(3790)],qf=n[e(3140)],pW=n[e(822)],BW=n[e(943)],Ye=n[e(1327)],xd=n[e(3959)],ZW=n[e(543)],ed=n.unstable_NormalPriority,yW=n.unstable_IdlePriority,$C=null,Dg=null;function vW(a){const l=e;if(Dg&&typeof Dg[l(3753)]=="function")try{Dg[l(3753)]($C,a,void 0,(a[l(1895)].flags&128)===128)}catch{}}function WW(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Qg=e(1126)===typeof Object.is?Object.is:WW,ui=null,jC=!1,td=!1;function $f(a){ui===null?ui=[a]:ui[e(3330)](a)}function wW(a){jC=!0,$f(a)}function Pg(){const a=e;if(!td&&ui!==null){td=!0;var l=0,u=kx;try{var b=ui;for(kx=1;l<b.length;l++){var y=b[l];do y=y(!0);while(y!==null)}ui=null,jC=!1}catch(W){throw ui!==null&&(ui=ui[a(1226)](l+1)),j2(xd,Pg),W}finally{kx=u,td=!1}}return null}var RW=c[e(3118)];function xl(a,l){const u=e;if(Qg(a,l))return!0;if(u(1011)!==typeof a||a===null||typeof l!="object"||l===null)return!1;var b=Object[u(958)](a),y=Object.keys(l);if(b[u(2989)]!==y[u(2989)])return!1;for(y=0;y<b[u(2989)];y++){var W=b[y];if(!Xe.call(l,W)||!Qg(a[W],l[W]))return!1}return!0}function VW(a){const l=e;switch(a.tag){case 5:return ux(a[l(3505)]);case 16:return ux(l(3352));case 13:return ux(l(2066));case 19:return ux(l(815));case 0:case 2:case 15:return a=ge(a.type,!1),a;case 11:return a=ge(a[l(3505)][l(948)],!1),a;case 1:return a=ge(a[l(3505)],!0),a;default:return""}}function vg(a,l){const u=e;if(a&&a[u(3870)]){l=s({},l),a=a[u(3870)];for(var b in a)l[b]===void 0&&(l[b]=a[b]);return l}return l}var el=Wx(null),tl=null,PI=null,gd=null;function id(){gd=PI=tl=null}function jf(a,l,u){const b=e;C0?(Lx(el,l[b(891)]),l[b(891)]=u):(Lx(el,l[b(2278)]),l[b(2278)]=u)}function nd(a){const l=e;var u=el.current;D0(el),C0?a._currentValue=u:a[l(2278)]=u}function Id(a,l,u){const b=e;for(;a!==null;){var y=a[b(641)];if((a[b(3262)]&l)!==l?(a[b(3262)]|=l,y!==null&&(y[b(3262)]|=l)):y!==null&&(y.childLanes&l)!==l&&(y.childLanes|=l),a===u)break;a=a[b(3922)]}}function OI(a,l){const u=e;tl=a,gd=PI=null,a=a[u(1461)],a!==null&&a[u(1401)]!==null&&(a[u(2840)]&l&&(Qt=!0),a[u(1401)]=null)}function Ig(a){var u=C0?a[e(891)]:a._currentValue2;if(gd!==a)if(a={context:a,memoizedValue:u,next:null},PI===null){if(tl===null)throw Error(o(308));PI=a,tl.dependencies={lanes:0,firstContext:a}}else PI=PI.next=a;return u}var Og=null,qi=!1;function sd(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x9(a,l){const u=e;a=a.updateQueue,l[u(2845)]===a&&(l[u(2845)]={baseState:a[u(490)],firstBaseUpdate:a[u(158)],lastBaseUpdate:a[u(3530)],shared:a[u(2940)],effects:a[u(1486)]})}function bi(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function $i(a,l){const u=e;var b=a[u(2845)];b!==null&&(b=b[u(2940)],me!==null&&a[u(251)]&1&&!(wx&2)?(a=b[u(439)],a===null?(l[u(890)]=l,Og===null?Og=[b]:Og[u(3330)](b)):(l[u(890)]=a[u(890)],a[u(890)]=l),b[u(439)]=l):(a=b[u(1891)],a===null?l.next=l:(l[u(890)]=a[u(890)],a.next=l),b[u(1891)]=l))}function gl(a,l,u){const b=e;if(l=l[b(2845)],l!==null&&(l=l[b(2940)],(u&4194240)!==0)){var y=l[b(2840)];y&=a[b(294)],u|=y,l[b(2840)]=u,$2(a,u)}}function e9(a,l){const u=e;var b=a[u(2845)],y=a[u(641)];if(y!==null&&(y=y.updateQueue,b===y)){var W=null,K=null;if(b=b[u(158)],b!==null){do{var P={eventTime:b.eventTime,lane:b.lane,tag:b[u(3795)],payload:b.payload,callback:b[u(934)],next:null};K===null?W=K=P:K=K[u(890)]=P,b=b[u(890)]}while(b!==null);K===null?W=K=l:K=K[u(890)]=l}else W=K=l;b={baseState:y[u(490)],firstBaseUpdate:W,lastBaseUpdate:K,shared:y[u(2940)],effects:y[u(1486)]},a[u(2845)]=b;return}a=b[u(3530)],a===null?b[u(158)]=l:a[u(890)]=l,b[u(3530)]=l}function il(a,l,u,b){const y=e;var W=a[y(2845)];qi=!1;var K=W[y(158)],P=W[y(3530)],s0=W[y(2940)][y(1891)];if(s0!==null){W.shared[y(1891)]=null;var p0=s0,z0=p0[y(890)];p0.next=null,P===null?K=z0:P.next=z0,P=p0;var q0=a[y(641)];q0!==null&&(q0=q0[y(2845)],s0=q0[y(3530)],s0!==P&&(s0===null?q0[y(158)]=z0:s0[y(890)]=z0,q0[y(3530)]=p0))}if(K!==null){var mx=W[y(490)];P=0,q0=z0=p0=null,s0=K;do{var rx=s0.lane,jx=s0[y(167)];if((b&rx)===rx){q0!==null&&(q0=q0.next={eventTime:jx,lane:0,tag:s0[y(3795)],payload:s0[y(2351)],callback:s0[y(934)],next:null});x:{var cx=a,Ee=s0;switch(rx=l,jx=u,Ee[y(3795)]){case 1:if(cx=Ee[y(2351)],typeof cx=="function"){mx=cx[y(2627)](jx,mx,rx);break x}mx=cx;break x;case 3:cx[y(2436)]=cx[y(2436)]&-65537|128;case 0:if(cx=Ee[y(2351)],rx=typeof cx=="function"?cx[y(2627)](jx,mx,rx):cx,rx==null)break x;mx=s({},mx,rx);break x;case 2:qi=!0}}s0.callback!==null&&s0.lane!==0&&(a[y(2436)]|=64,rx=W[y(1486)],rx===null?W[y(1486)]=[s0]:rx[y(3330)](s0))}else jx={eventTime:jx,lane:rx,tag:s0.tag,payload:s0[y(2351)],callback:s0[y(934)],next:null},q0===null?(z0=q0=jx,p0=mx):q0=q0[y(890)]=jx,P|=rx;if(s0=s0[y(890)],s0===null){if(s0=W[y(2940)][y(1891)],s0===null)break;rx=s0,s0=rx.next,rx[y(890)]=null,W[y(3530)]=rx,W[y(2940)][y(1891)]=null}}while(!0);if(q0===null&&(p0=mx),W.baseState=p0,W[y(158)]=z0,W[y(3530)]=q0,l=W[y(2940)].interleaved,l!==null){W=l;do P|=W[y(1694)],W=W[y(890)];while(W!==l)}else K===null&&(W.shared[y(2840)]=0);ns|=P,a.lanes=P,a[y(485)]=mx}}function t9(a,l,u){const b=e;if(a=l[b(1486)],l[b(1486)]=null,a!==null)for(l=0;l<a[b(2989)];l++){var y=a[l],W=y[b(934)];if(W!==null){if(y[b(934)]=null,y=u,b(1126)!==typeof W)throw Error(o(191,W));W.call(y)}}}var g9=new g[e(1789)]()[e(3596)];function od(a,l,u,b){const y=e;l=a[y(485)],u=u(b,l),u=u==null?l:s({},l,u),a[y(485)]=u,a[y(2840)]===0&&(a[y(2845)].baseState=u)}var nl={isMounted:function(a){return(a=a[e(1525)])?Y(a)===a:!1},enqueueSetState:function(a,l,u){const b=e;a=a[b(1525)];var y=dt(),W=en(a),K=bi(y,W);K[b(2351)]=l,u!=null&&(K[b(934)]=u),$i(a,K),l=lg(a,W,y),l!==null&&gl(l,a,W)},enqueueReplaceState:function(a,l,u){const b=e;a=a[b(1525)];var y=dt(),W=en(a),K=bi(y,W);K.tag=1,K.payload=l,u!=null&&(K[b(934)]=u),$i(a,K),l=lg(a,W,y),l!==null&&gl(l,a,W)},enqueueForceUpdate:function(a,l){a=a[e(1525)];var b=dt(),y=en(a),W=bi(b,y);W.tag=2,l!=null&&(W.callback=l),$i(a,W),l=lg(a,y,b),l!==null&&gl(l,a,y)}};function i9(a,l,u,b,y,W,K){const P=e;return a=a[P(1133)],P(1126)===typeof a[P(1400)]?a[P(1400)](b,W,K):l[P(1566)]&&l[P(1566)][P(659)]?!xl(u,b)||!xl(y,W):!0}function n9(a,l,u){const b=e;var y=!1,W=Fx,K=l[b(979)];return b(1011)===typeof K&&K!==null?K=Ig(K):(W=Ux(l)?Et:ie[b(1895)],y=l[b(3052)],K=(y=y!=null)?_g(a,W):Fx),l=new l(u,K),a[b(485)]=l.state!==null&&l[b(704)]!==void 0?l[b(704)]:null,l[b(938)]=nl,a[b(1133)]=l,l[b(1525)]=a,y&&(a=a.stateNode,a[b(3212)]=W,a.__reactInternalMemoizedMaskedChildContext=K),l}function I9(a,l,u,b){const y=e;a=l[y(704)],y(1126)===typeof l.componentWillReceiveProps&&l.componentWillReceiveProps(u,b),y(1126)===typeof l.UNSAFE_componentWillReceiveProps&&l.UNSAFE_componentWillReceiveProps(u,b),l[y(704)]!==a&&nl[y(3157)](l,l[y(704)],null)}function cd(a,l,u,b){const y=e;var W=a.stateNode;W[y(3105)]=u,W[y(704)]=a[y(485)],W[y(3596)]=g9,sd(a);var K=l[y(979)];y(1011)===typeof K&&K!==null?W.context=Ig(K):(K=Ux(l)?Et:ie[y(1895)],W[y(3246)]=_g(a,K)),W.state=a[y(485)],K=l[y(2926)],y(1126)===typeof K&&(od(a,l,K,u),W[y(704)]=a.memoizedState),y(1126)===typeof l[y(2926)]||typeof W[y(3092)]=="function"||y(1126)!==typeof W[y(927)]&&typeof W[y(288)]!="function"||(l=W[y(704)],y(1126)===typeof W.componentWillMount&&W[y(288)](),y(1126)===typeof W[y(927)]&&W[y(927)](),l!==W[y(704)]&&nl.enqueueReplaceState(W,W[y(704)],null),il(a,u,W,b),W[y(704)]=a[y(485)]),y(1126)===typeof W[y(3380)]&&(a[y(2436)]|=4194308)}var qI=[],$I=0,Il=null,sl=0,sg=[],og=0,En=null,hi=1,fi="";function Un(a,l){qI[$I++]=sl,qI[$I++]=Il,Il=a,sl=l}function s9(a,l,u){const b=e;sg[og++]=hi,sg[og++]=fi,sg[og++]=En,En=a;var y=hi;a=fi;var W=32-Wt(y)-1;y&=~(1<<W),u+=1;var K=32-Wt(l)+W;if(30<K){var P=W-W%5;K=(y&(1<<P)-1)[b(2635)](32),y>>=P,W-=P,hi=1<<32-Wt(l)+W|u<<W|y,fi=K+a}else hi=1<<K|u<<W|y,fi=a}function Cd(a){a[e(3922)]!==null&&(Un(a,1),s9(a,1,0))}function ld(a){for(;a===Il;)Il=qI[--$I],qI[$I]=null,sl=qI[--$I],qI[$I]=null;for(;a===En;)En=sg[--og],sg[og]=null,fi=sg[--og],sg[og]=null,hi=sg[--og],sg[og]=null}var _t=null,Dt=null,ne=!1,Yo=!1,Wg=null;function o9(a,l){const u=e;var b=ag(5,null,null,0);b[u(1992)]=u(1741),b[u(1133)]=l,b[u(3922)]=a,l=a[u(2716)],l===null?(a[u(2716)]=[b],a[u(2436)]|=16):l[u(3330)](b)}function c9(a,l){const u=e;switch(a[u(3795)]){case 5:return l=Vo(l,a[u(3505)],a[u(2343)]),l!==null?(a[u(1133)]=l,_t=a,Dt=DC(l),!0):!1;case 6:return l=UC(l,a.pendingProps),l!==null?(a[u(1133)]=l,_t=a,Dt=null,!0):!1;case 13:if(l=_C(l),l!==null){var b=En!==null?{id:hi,overflow:fi}:null;return a[u(485)]={dehydrated:l,treeContext:b,retryLane:1073741824},b=ag(18,null,null,0),b[u(1133)]=l,b[u(3922)]=a,a[u(1367)]=b,_t=a,Dt=null,!0}return!1;default:return!1}}function ad(a){return(a[e(251)]&1)!==0&&(a.flags&128)===0}function rd(a){const l=e;if(ne){var u=Dt;if(u){var b=u;if(!c9(a,u)){if(ad(a))throw Error(o(418));u=Pi(b);var y=_t;u&&c9(a,u)?o9(y,b):(a[l(2436)]=a.flags&-4097|2,ne=!1,_t=a)}}else{if(ad(a))throw Error(o(418));a[l(2436)]=a[l(2436)]&-4097|2,ne=!1,_t=a}}}function C9(a){const l=e;for(a=a.return;a!==null&&a.tag!==5&&a[l(3795)]!==3&&a.tag!==13;)a=a[l(3922)];_t=a}function Ko(a){const l=e;if(!y0||a!==_t)return!1;if(!ne)return C9(a),ne=!0,!1;if(a[l(3795)]!==3&&(a[l(3795)]!==5||k0(a[l(3505)])&&!g0(a[l(3505)],a[l(2990)]))){var u=Dt;if(u){if(ad(a)){for(a=Dt;a;)a=Pi(a);throw Error(o(418))}for(;u;)o9(a,u),u=Pi(u)}}if(C9(a),a.tag===13){if(!y0)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));Dt=e0(a)}else Dt=_t?Pi(a.stateNode):null;return!0}function jI(){y0&&(Dt=_t=null,Yo=ne=!1)}function dd(a){Wg===null?Wg=[a]:Wg.push(a)}function Ho(a,l,u){const b=e;if(a=u[b(3786)],a!==null&&b(1126)!==typeof a&&typeof a!="object"){if(u[b(3051)]){if(u=u[b(3051)],u){if(u[b(3795)]!==1)throw Error(o(309));var y=u[b(1133)]}if(!y)throw Error(o(147,a));var W=y,K=""+a;return l!==null&&l[b(3786)]!==null&&b(1126)===typeof l.ref&&l[b(3786)][b(928)]===K?l[b(3786)]:(l=function(P){const s0=b;var p0=W[s0(3596)];p0===g9&&(p0=W[s0(3596)]={}),P===null?delete p0[K]:p0[K]=P},l[b(928)]=K,l)}if(b(3674)!==typeof a)throw Error(o(284));if(!u[b(3051)])throw Error(o(290,a))}return a}function ol(a,l){const u=e;throw a=Object[u(1566)][u(2635)][u(2627)](l),Error(o(31,u(1109)===a?u(2626)+Object[u(958)](l)[u(1812)](", ")+"}":a))}function l9(a){var u=a[e(2660)];return u(a._payload)}function a9(a){function l(r0,o0){const u0=i0;if(a){var K0=r0[u0(2716)];K0===null?(r0[u0(2716)]=[o0],r0[u0(2436)]|=16):K0[u0(3330)](o0)}}function u(r0,o0){const u0=i0;if(!a)return null;for(;o0!==null;)l(r0,o0),o0=o0[u0(1263)];return null}function b(r0,o0){const u0=i0;for(r0=new Map;o0!==null;)o0.key!==null?r0[u0(298)](o0[u0(581)],o0):r0[u0(298)](o0[u0(587)],o0),o0=o0[u0(1263)];return r0}function y(r0,o0){const u0=i0;return r0=gn(r0,o0),r0[u0(587)]=0,r0[u0(1263)]=null,r0}function W(r0,o0,u0){const K0=i0;return r0[K0(587)]=u0,a?(u0=r0.alternate,u0!==null?(u0=u0.index,u0<o0?(r0[K0(2436)]|=2,o0):u0):(r0[K0(2436)]|=2,o0)):(r0[K0(2436)]|=1048576,o0)}function K(r0){const o0=i0;return a&&r0[o0(641)]===null&&(r0[o0(2436)]|=2),r0}function P(r0,o0,u0,K0){const B0=i0;return o0===null||o0[B0(3795)]!==6?(o0=qd(u0,r0.mode,K0),o0[B0(3922)]=r0,o0):(o0=y(o0,u0),o0.return=r0,o0)}function s0(r0,o0,u0,K0){const B0=i0;var tx=u0[B0(3505)];return tx===A?z0(r0,o0,u0[B0(3105)].children,K0,u0[B0(581)]):o0!==null&&(o0[B0(1992)]===tx||B0(1011)===typeof tx&&tx!==null&&tx.$$typeof===p&&l9(tx)===o0[B0(3505)])?(K0=y(o0,u0[B0(3105)]),K0[B0(3786)]=Ho(r0,o0,u0),K0[B0(3922)]=r0,K0):(K0=Ml(u0[B0(3505)],u0[B0(581)],u0.props,null,r0[B0(251)],K0),K0[B0(3786)]=Ho(r0,o0,u0),K0[B0(3922)]=r0,K0)}function p0(r0,o0,u0,K0){const B0=i0;return o0===null||o0[B0(3795)]!==4||o0[B0(1133)].containerInfo!==u0[B0(1951)]||o0.stateNode[B0(854)]!==u0.implementation?(o0=$d(u0,r0[B0(251)],K0),o0[B0(3922)]=r0,o0):(o0=y(o0,u0[B0(1352)]||[]),o0.return=r0,o0)}function z0(r0,o0,u0,K0,B0){const tx=i0;return o0===null||o0[tx(3795)]!==7?(o0=$n(u0,r0[tx(251)],K0,B0),o0.return=r0,o0):(o0=y(o0,u0),o0.return=r0,o0)}function q0(r0,o0,u0){const K0=i0;if(K0(3674)===typeof o0&&o0!==""||K0(1025)===typeof o0)return o0=qd(""+o0,r0.mode,u0),o0[K0(3922)]=r0,o0;if(typeof o0=="object"&&o0!==null){switch(o0[K0(1596)]){case C:return u0=Ml(o0[K0(3505)],o0[K0(581)],o0[K0(3105)],null,r0[K0(251)],u0),u0[K0(3786)]=Ho(r0,null,o0),u0[K0(3922)]=r0,u0;case r:return o0=$d(o0,r0[K0(251)],u0),o0[K0(3922)]=r0,o0;case p:var B0=o0[K0(2660)];return q0(r0,B0(o0[K0(2036)]),u0)}if(b0(o0)||N(o0))return o0=$n(o0,r0[K0(251)],u0,null),o0[K0(3922)]=r0,o0;ol(r0,o0)}return null}function mx(r0,o0,u0,K0){const B0=i0;var tx=o0!==null?o0[B0(581)]:null;if(B0(3674)===typeof u0&&u0!==""||B0(1025)===typeof u0)return tx!==null?null:P(r0,o0,""+u0,K0);if(B0(1011)===typeof u0&&u0!==null){switch(u0[B0(1596)]){case C:return u0[B0(581)]===tx?s0(r0,o0,u0,K0):null;case r:return u0.key===tx?p0(r0,o0,u0,K0):null;case p:return tx=u0[B0(2660)],mx(r0,o0,tx(u0[B0(2036)]),K0)}if(b0(u0)||N(u0))return tx!==null?null:z0(r0,o0,u0,K0,null);ol(r0,u0)}return null}function rx(r0,o0,u0,K0,B0){const tx=i0;if(typeof K0=="string"&&K0!==""||typeof K0=="number")return r0=r0[tx(2695)](u0)||null,P(o0,r0,""+K0,B0);if(tx(1011)===typeof K0&&K0!==null){switch(K0.$$typeof){case C:return r0=r0[tx(2695)](K0.key===null?u0:K0[tx(581)])||null,s0(o0,r0,K0,B0);case r:return r0=r0[tx(2695)](K0.key===null?u0:K0[tx(581)])||null,p0(o0,r0,K0,B0);case p:var yx=K0[tx(2660)];return rx(r0,o0,u0,yx(K0._payload),B0)}if(b0(K0)||N(K0))return r0=r0[tx(2695)](u0)||null,z0(o0,r0,K0,B0,null);ol(o0,K0)}return null}function jx(r0,o0,u0,K0){const B0=i0;for(var tx=null,yx=null,Gx=o0,Tx=o0=0,He=null;Gx!==null&&Tx<u0[B0(2989)];Tx++){Gx[B0(587)]>Tx?(He=Gx,Gx=null):He=Gx.sibling;var Jx=mx(r0,Gx,u0[Tx],K0);if(Jx===null){Gx===null&&(Gx=He);break}a&&Gx&&Jx[B0(641)]===null&&l(r0,Gx),o0=W(Jx,o0,Tx),yx===null?tx=Jx:yx[B0(1263)]=Jx,yx=Jx,Gx=He}if(Tx===u0[B0(2989)])return u(r0,Gx),ne&&Un(r0,Tx),tx;if(Gx===null){for(;Tx<u0.length;Tx++)Gx=q0(r0,u0[Tx],K0),Gx!==null&&(o0=W(Gx,o0,Tx),yx===null?tx=Gx:yx[B0(1263)]=Gx,yx=Gx);return ne&&Un(r0,Tx),tx}for(Gx=b(r0,Gx);Tx<u0[B0(2989)];Tx++)He=rx(Gx,r0,Tx,u0[Tx],K0),He!==null&&(a&&He[B0(641)]!==null&&Gx[B0(1432)](He[B0(581)]===null?Tx:He[B0(581)]),o0=W(He,o0,Tx),yx===null?tx=He:yx[B0(1263)]=He,yx=He);return a&&Gx[B0(1599)](function(nn){return l(r0,nn)}),ne&&Un(r0,Tx),tx}function cx(r0,o0,u0,K0){const B0=i0;var tx=N(u0);if(B0(1126)!==typeof tx)throw Error(o(150));if(u0=tx.call(u0),u0==null)throw Error(o(151));for(var yx=tx=null,Gx=o0,Tx=o0=0,He=null,Jx=u0[B0(890)]();Gx!==null&&!Jx[B0(905)];Tx++,Jx=u0[B0(890)]()){Gx.index>Tx?(He=Gx,Gx=null):He=Gx[B0(1263)];var nn=mx(r0,Gx,Jx.value,K0);if(nn===null){Gx===null&&(Gx=He);break}a&&Gx&&nn[B0(641)]===null&&l(r0,Gx),o0=W(nn,o0,Tx),yx===null?tx=nn:yx.sibling=nn,yx=nn,Gx=He}if(Jx[B0(905)])return u(r0,Gx),ne&&Un(r0,Tx),tx;if(Gx===null){for(;!Jx[B0(905)];Tx++,Jx=u0[B0(890)]())Jx=q0(r0,Jx[B0(2113)],K0),Jx!==null&&(o0=W(Jx,o0,Tx),yx===null?tx=Jx:yx[B0(1263)]=Jx,yx=Jx);return ne&&Un(r0,Tx),tx}for(Gx=b(r0,Gx);!Jx.done;Tx++,Jx=u0[B0(890)]())Jx=rx(Gx,r0,Tx,Jx[B0(2113)],K0),Jx!==null&&(a&&Jx[B0(641)]!==null&&Gx[B0(1432)](Jx[B0(581)]===null?Tx:Jx[B0(581)]),o0=W(Jx,o0,Tx),yx===null?tx=Jx:yx[B0(1263)]=Jx,yx=Jx);return a&&Gx.forEach(function(Iw){return l(r0,Iw)}),ne&&Un(r0,Tx),tx}function Ee(r0,o0,u0,K0){const B0=i0;if(B0(1011)===typeof u0&&u0!==null&&u0[B0(3505)]===A&&u0[B0(581)]===null&&(u0=u0[B0(3105)].children),B0(1011)===typeof u0&&u0!==null){switch(u0[B0(1596)]){case C:x:{for(var tx=u0[B0(581)],yx=o0;yx!==null;){if(yx.key===tx){if(tx=u0[B0(3505)],tx===A){if(yx[B0(3795)]===7){u(r0,yx[B0(1263)]),o0=y(yx,u0[B0(3105)][B0(1352)]),o0[B0(3922)]=r0,r0=o0;break x}}else if(yx.elementType===tx||B0(1011)===typeof tx&&tx!==null&&tx.$$typeof===p&&l9(tx)===yx[B0(3505)]){u(r0,yx[B0(1263)]),o0=y(yx,u0[B0(3105)]),o0[B0(3786)]=Ho(r0,yx,u0),o0[B0(3922)]=r0,r0=o0;break x}u(r0,yx);break}else l(r0,yx);yx=yx.sibling}u0[B0(3505)]===A?(o0=$n(u0[B0(3105)][B0(1352)],r0[B0(251)],K0,u0[B0(581)]),o0[B0(3922)]=r0,r0=o0):(K0=Ml(u0[B0(3505)],u0[B0(581)],u0[B0(3105)],null,r0[B0(251)],K0),K0.ref=Ho(r0,o0,u0),K0[B0(3922)]=r0,r0=K0)}return K(r0);case r:x:{for(yx=u0.key;o0!==null;){if(o0[B0(581)]===yx)if(o0[B0(3795)]===4&&o0[B0(1133)][B0(1951)]===u0[B0(1951)]&&o0[B0(1133)][B0(854)]===u0.implementation){u(r0,o0[B0(1263)]),o0=y(o0,u0[B0(1352)]||[]),o0[B0(3922)]=r0,r0=o0;break x}else{u(r0,o0);break}else l(r0,o0);o0=o0[B0(1263)]}o0=$d(u0,r0[B0(251)],K0),o0[B0(3922)]=r0,r0=o0}return K(r0);case p:return yx=u0[B0(2660)],Ee(r0,o0,yx(u0[B0(2036)]),K0)}if(b0(u0))return jx(r0,o0,u0,K0);if(N(u0))return cx(r0,o0,u0,K0);ol(r0,u0)}return B0(3674)===typeof u0&&u0!==""||B0(1025)===typeof u0?(u0=""+u0,o0!==null&&o0[B0(3795)]===6?(u(r0,o0[B0(1263)]),o0=y(o0,u0),o0.return=r0,r0=o0):(u(r0,o0),o0=qd(u0,r0.mode,K0),o0.return=r0,r0=o0),K(r0)):u(r0,o0)}return Ee}var xs=a9(!0),r9=a9(!1),No={},cg=Wx(No),Fo=Wx(No),es=Wx(No);function qg(a){if(a===No)throw Error(o(174));return a}function Ad(a,l){Lx(es,l),Lx(Fo,a),Lx(cg,No),a=G0(l),D0(cg),Lx(cg,a)}function ts(){D0(cg),D0(Fo),D0(es)}function d9(a){const l=e;var u=qg(es[l(1895)]),b=qg(cg.current);u=$(b,a[l(3505)],u),b!==u&&(Lx(Fo,a),Lx(cg,u))}function ud(a){Fo[e(1895)]===a&&(D0(cg),D0(Fo))}var se=Wx(0);function cl(a){const l=e;for(var u=a;u!==null;){if(u.tag===13){var b=u.memoizedState;if(b!==null&&(b=b[l(772)],b===null||Jn(b)||_I(b)))return u}else if(u.tag===19&&u[l(2990)].revealOrder!==void 0){if(u[l(2436)]&128)return u}else if(u[l(1367)]!==null){u[l(1367)].return=u,u=u[l(1367)];continue}if(u===a)break;for(;u[l(1263)]===null;){if(u.return===null||u[l(3922)]===a)return null;u=u[l(3922)]}u[l(1263)].return=u[l(3922)],u=u[l(1263)]}return null}var bd=[];function hd(){const a=e;for(var l=0;l<bd[a(2989)];l++){var u=bd[l];C0?u[a(2510)]=null:u[a(826)]=null}bd.length=0}var Cl=c[e(2147)],Cg=c.ReactCurrentBatchConfig,gs=0,ae=null,qe=null,Ke=null,ll=!1,zo=!1,Mo=0,SW=0;function $e(){throw Error(o(321))}function fd(a,l){const u=e;if(l===null)return!1;for(var b=0;b<l[u(2989)]&&b<a[u(2989)];b++)if(!Qg(a[b],l[b]))return!1;return!0}function md(a,l,u,b,y,W){const K=e;if(gs=W,ae=l,l[K(485)]=null,l.updateQueue=null,l[K(2840)]=0,Cl[K(1895)]=a===null||a[K(485)]===null?HW:NW,a=u(b,y),zo){W=0;do{if(zo=!1,Mo=0,25<=W)throw Error(o(301));W+=1,Ke=qe=null,l[K(2845)]=null,Cl[K(1895)]=FW,a=u(b,y)}while(zo)}if(Cl[K(1895)]=ul,l=qe!==null&&qe.next!==null,gs=0,Ke=qe=ae=null,ll=!1,l)throw Error(o(300));return a}function Gd(){var a=Mo!==0;return Mo=0,a}function mi(){const a=e;var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ke===null?ae[a(485)]=Ke=l:Ke=Ke[a(890)]=l,Ke}function $g(){const a=e;if(qe===null){var l=ae[a(641)];l=l!==null?l[a(485)]:null}else l=qe.next;var u=Ke===null?ae[a(485)]:Ke[a(890)];if(u!==null)Ke=u,qe=l;else{if(l===null)throw Error(o(310));qe=l,l={memoizedState:qe[a(485)],baseState:qe[a(490)],baseQueue:qe.baseQueue,queue:qe.queue,next:null},Ke===null?ae[a(485)]=Ke=l:Ke=Ke[a(890)]=l}return Ke}function _n(a,l){return e(1126)===typeof l?l(a):l}function al(a){const l=e;var u=$g(),b=u[l(888)];if(b===null)throw Error(o(311));b[l(1017)]=a;var y=qe,W=y[l(3888)],K=b[l(1891)];if(K!==null){if(W!==null){var P=W[l(890)];W.next=K[l(890)],K[l(890)]=P}y.baseQueue=W=K,b[l(1891)]=null}if(W!==null){K=W[l(890)],y=y.baseState;var s0=P=null,p0=null,z0=K;do{var q0=z0[l(1694)];if((gs&q0)===q0)p0!==null&&(p0=p0[l(890)]={lane:0,action:z0[l(1917)],hasEagerState:z0[l(992)],eagerState:z0[l(1211)],next:null}),y=z0[l(992)]?z0[l(1211)]:a(y,z0[l(1917)]);else{var mx={lane:q0,action:z0[l(1917)],hasEagerState:z0[l(992)],eagerState:z0[l(1211)],next:null};p0===null?(s0=p0=mx,P=y):p0=p0[l(890)]=mx,ae[l(2840)]|=q0,ns|=q0}z0=z0[l(890)]}while(z0!==null&&z0!==K);p0===null?P=y:p0.next=s0,Qg(y,u[l(485)])||(Qt=!0),u[l(485)]=y,u[l(490)]=P,u[l(3888)]=p0,b.lastRenderedState=y}if(a=b[l(439)],a!==null){W=a;do K=W[l(1694)],ae.lanes|=K,ns|=K,W=W[l(890)];while(W!==a)}else W===null&&(b[l(2840)]=0);return[u[l(485)],b.dispatch]}function rl(a){const l=e;var u=$g(),b=u[l(888)];if(b===null)throw Error(o(311));b[l(1017)]=a;var y=b.dispatch,W=b[l(1891)],K=u.memoizedState;if(W!==null){b[l(1891)]=null;var P=W=W[l(890)];do K=a(K,P[l(1917)]),P=P[l(890)];while(P!==W);Qg(K,u[l(485)])||(Qt=!0),u.memoizedState=K,u[l(3888)]===null&&(u[l(490)]=K),b[l(3454)]=K}return[K,y]}function A9(){}function u9(a,l){const u=e;var b=ae,y=$g(),W=l(),K=!Qg(y.memoizedState,W);if(K&&(y.memoizedState=W,Qt=!0),y=y.queue,ko(f9[u(1600)](null,b,y,a),[a]),y[u(2526)]!==l||K||Ke!==null&&Ke[u(485)][u(3795)]&1){if(b[u(2436)]|=2048,Lo(9,h9.bind(null,b,y,W,l),void 0,null),me===null)throw Error(o(349));gs&30||b9(b,l,W)}return W}function b9(a,l,u){const b=e;a.flags|=16384,a={getSnapshot:l,value:u},l=ae[b(2845)],l===null?(l={lastEffect:null,stores:null},ae[b(2845)]=l,l[b(879)]=[a]):(u=l[b(879)],u===null?l.stores=[a]:u[b(3330)](a))}function h9(a,l,u,b){l.value=u,l.getSnapshot=b,m9(l)&&lg(a,1,-1)}function f9(a,l,u){return u(function(){m9(l)&&lg(a,1,-1)})}function m9(a){var u=a[e(2526)];a=a.value;try{var b=u();return!Qg(a,b)}catch{return!0}}function pd(a){const l=e;var u=mi();return l(1126)===typeof a&&(a=a()),u[l(485)]=u[l(490)]=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:a},u[l(888)]=a,a=a[l(3425)]=KW[l(1600)](null,ae,a),[u[l(485)],a]}function Lo(a,l,u,b){const y=e;return a={tag:a,create:l,destroy:u,deps:b,next:null},l=ae[y(2845)],l===null?(l={lastEffect:null,stores:null},ae[y(2845)]=l,l[y(1548)]=a[y(890)]=a):(u=l.lastEffect,u===null?l.lastEffect=a[y(890)]=a:(b=u[y(890)],u[y(890)]=a,a[y(890)]=b,l[y(1548)]=a)),a}function G9(){const a=e;return $g()[a(485)]}function dl(a,l,u,b){const y=e;var W=mi();ae[y(2436)]|=a,W[y(485)]=Lo(1|l,u,void 0,b===void 0?null:b)}function Al(a,l,u,b){const y=e;var W=$g();b=b===void 0?null:b;var K=void 0;if(qe!==null){var P=qe[y(485)];if(K=P[y(1456)],b!==null&&fd(b,P[y(2610)])){W[y(485)]=Lo(l,u,K,b);return}}ae.flags|=a,W[y(485)]=Lo(1|l,u,K,b)}function Bd(a,l){return dl(8390656,8,a,l)}function ko(a,l){return Al(2048,8,a,l)}function p9(a,l){return Al(4,2,a,l)}function B9(a,l){return Al(4,4,a,l)}function Z9(a,l){const u=e;if(u(1126)===typeof l)return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l[u(1895)]=a,function(){l.current=null}}function y9(a,l,u){const b=e;return u=u!=null?u[b(534)]([a]):null,Al(4,4,Z9[b(1600)](null,l,a),u)}function Zd(){}function v9(a,l){const u=e;var b=$g();l=l===void 0?null:l;var y=b.memoizedState;return y!==null&&l!==null&&fd(l,y[1])?y[0]:(b[u(485)]=[a,l],a)}function W9(a,l){const u=e;var b=$g();l=l===void 0?null:l;var y=b[u(485)];return y!==null&&l!==null&&fd(l,y[1])?y[0]:(a=a(),b[u(485)]=[a,l],a)}function XW(a,l){const u=e;var b=kx;kx=b!==0&&4>b?b:4,a(!0);var y=Cg[u(1691)];Cg[u(1691)]={};try{a(!1),l()}finally{kx=b,Cg[u(1691)]=y}}function w9(){const a=e;return $g()[a(485)]}function YW(a,l,u){var b=en(a);u={lane:b,action:u,hasEagerState:!1,eagerState:null,next:null},R9(a)?V9(l,u):(S9(a,l,u),u=dt(),a=lg(a,b,u),a!==null&&X9(a,l,b))}function KW(a,l,u){const b=e;var y=en(a),W={lane:y,action:u,hasEagerState:!1,eagerState:null,next:null};if(R9(a))V9(l,W);else{S9(a,l,W);var K=a[b(641)];if(a[b(2840)]===0&&(K===null||K.lanes===0)&&(K=l[b(1017)],K!==null))try{var P=l[b(3454)],s0=K(P,u);if(W[b(992)]=!0,W[b(1211)]=s0,Qg(s0,P))return}catch{}finally{}u=dt(),a=lg(a,y,u),a!==null&&X9(a,l,y)}}function R9(a){var u=a[e(641)];return a===ae||u!==null&&u===ae}function V9(a,l){const u=e;zo=ll=!0;var b=a[u(1891)];b===null?l[u(890)]=l:(l[u(890)]=b[u(890)],b.next=l),a[u(1891)]=l}function S9(a,l,u){const b=e;me!==null&&a.mode&1&&!(wx&2)?(a=l[b(439)],a===null?(u[b(890)]=u,Og===null?Og=[l]:Og.push(l)):(u.next=a[b(890)],a.next=u),l[b(439)]=u):(a=l[b(1891)],a===null?u[b(890)]=u:(u[b(890)]=a.next,a[b(890)]=u),l[b(1891)]=u)}function X9(a,l,u){const b=e;if(u&4194240){var y=l[b(2840)];y&=a.pendingLanes,u|=y,l.lanes=u,$2(a,u)}}var ul={readContext:Ig,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useInsertionEffect:$e,useLayoutEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useDeferredValue:$e,useTransition:$e,useMutableSource:$e,useSyncExternalStore:$e,useId:$e,unstable_isNewReconciler:!1},HW={readContext:Ig,useCallback:function(a,l){const u=e;return mi()[u(485)]=[a,l===void 0?null:l],a},useContext:Ig,useEffect:Bd,useImperativeHandle:function(a,l,u){const b=e;return u=u!=null?u[b(534)]([a]):null,dl(4194308,4,Z9[b(1600)](null,l,a),u)},useLayoutEffect:function(a,l){return dl(4194308,4,a,l)},useInsertionEffect:function(a,l){return dl(4,2,a,l)},useMemo:function(a,l){const u=e;var b=mi();return l=l===void 0?null:l,a=a(),b[u(485)]=[a,l],a},useReducer:function(a,l,u){const b=e;var y=mi();return l=u!==void 0?u(l):l,y.memoizedState=y.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},y[b(888)]=a,a=a[b(3425)]=YW[b(1600)](null,ae,a),[y.memoizedState,a]},useRef:function(a){const l=e;var u=mi();return a={current:a},u[l(485)]=a},useState:pd,useDebugValue:Zd,useDeferredValue:function(a){var l=pd(a),u=l[0],b=l[1];return Bd(function(){const y=i0;var W=Cg[y(1691)];Cg[y(1691)]={};try{b(a)}finally{Cg[y(1691)]=W}},[a]),u},useTransition:function(){const a=e;var l=pd(!1),u=l[0];return l=XW[a(1600)](null,l[1]),mi().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(a,l,u){const b=e;var y=ae,W=mi();if(ne){if(u===void 0)throw Error(o(407));u=u()}else{if(u=l(),me===null)throw Error(o(349));gs&30||b9(y,l,u)}W[b(485)]=u;var K={value:u,getSnapshot:l};return W[b(888)]=K,Bd(f9[b(1600)](null,y,K,a),[a]),y[b(2436)]|=2048,Lo(9,h9[b(1600)](null,y,K,u,l),void 0,null),u},useId:function(){const a=e;var l=mi(),u=me[a(1260)];if(ne){var b=fi,y=hi;b=(y&~(1<<32-Wt(y)-1))[a(2635)](32)+b,u=":"+u+"R"+b,b=Mo++,0<b&&(u+="H"+b[a(2635)](32)),u+=":"}else b=SW++,u=":"+u+"r"+b[a(2635)](32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},NW={readContext:Ig,useCallback:v9,useContext:Ig,useEffect:ko,useImperativeHandle:y9,useInsertionEffect:p9,useLayoutEffect:B9,useMemo:W9,useReducer:al,useRef:G9,useState:function(){return al(_n)},useDebugValue:Zd,useDeferredValue:function(a){var l=al(_n),u=l[0],b=l[1];return ko(function(){const y=i0;var W=Cg.transition;Cg[y(1691)]={};try{b(a)}finally{Cg[y(1691)]=W}},[a]),u},useTransition:function(){const a=e;var l=al(_n)[0],u=$g()[a(485)];return[l,u]},useMutableSource:A9,useSyncExternalStore:u9,useId:w9,unstable_isNewReconciler:!1},FW={readContext:Ig,useCallback:v9,useContext:Ig,useEffect:ko,useImperativeHandle:y9,useInsertionEffect:p9,useLayoutEffect:B9,useMemo:W9,useReducer:rl,useRef:G9,useState:function(){return rl(_n)},useDebugValue:Zd,useDeferredValue:function(a){var l=rl(_n),u=l[0],b=l[1];return ko(function(){const y=i0;var W=Cg[y(1691)];Cg[y(1691)]={};try{b(a)}finally{Cg[y(1691)]=W}},[a]),u},useTransition:function(){const a=e;var l=rl(_n)[0],u=$g()[a(485)];return[l,u]},useMutableSource:A9,useSyncExternalStore:u9,useId:w9,unstable_isNewReconciler:!1};function yd(a,l){const u=e;try{var b="",y=l;do b+=VW(y),y=y[u(3922)];while(y);var W=b}catch(K){W=`
Error generating stack: `+K[u(268)]+`
`+K.stack}return{value:a,source:l,stack:W}}function vd(a,l){const u=e;try{console[u(2963)](l[u(2113)])}catch(b){setTimeout(function(){throw b})}}var zW=typeof WeakMap=="function"?WeakMap:Map;function Y9(a,l,u){const b=e;u=bi(-1,u),u[b(3795)]=3,u[b(2351)]={element:null};var y=l[b(2113)];return u[b(934)]=function(){Xl||(Xl=!0,Ed=y),vd(a,l)},u}function K9(a,l,u){const b=e;u=bi(-1,u),u[b(3795)]=3;var y=a[b(3505)].getDerivedStateFromError;if(b(1126)===typeof y){var W=l[b(2113)];u.payload=function(){return y(W)},u[b(934)]=function(){vd(a,l)}}var K=a[b(1133)];return K!==null&&b(1126)===typeof K[b(384)]&&(u.callback=function(){const P=b;vd(a,l),P(1126)!==typeof y&&(ji===null?ji=new Set([this]):ji[P(3014)](this));var s0=l.stack;this[P(384)](l.value,{componentStack:s0!==null?s0:""})}),u}function H9(a,l,u){const b=e;var y=a[b(901)];if(y===null){y=a[b(901)]=new zW;var W=new Set;y[b(298)](l,W)}else W=y[b(2695)](l),W===void 0&&(W=new Set,y[b(298)](l,W));W[b(2489)](u)||(W[b(3014)](u),a=$W[b(1600)](null,a,l,u),l[b(2334)](a,a))}function N9(a){const l=e;do{var u;if((u=a[l(3795)]===13)&&(u=a[l(485)],u=u!==null?u[l(772)]!==null:!0),u)return a;a=a[l(3922)]}while(a!==null);return null}function F9(a,l,u,b,y){const W=e;return a.mode&1?(a[W(2436)]|=65536,a[W(2840)]=y,a):(a===l?a[W(2436)]|=65536:(a.flags|=128,u.flags|=131072,u[W(2436)]&=-52805,u.tag===1&&(u[W(641)]===null?u.tag=17:(l=bi(-1,1),l.tag=2,$i(u,l))),u[W(2840)]|=1),a)}function jg(a){const l=e;a[l(2436)]|=4}function z9(a,l){const u=e;if(a!==null&&a[u(1367)]===l[u(1367)])return!0;if(l[u(2436)]&16)return!1;for(a=l.child;a!==null;){if(a.flags&12854||a[u(1983)]&12854)return!1;a=a[u(1263)]}return!0}var To,Jo,bl,hl;if(gx)To=function(a,l){const u=e;for(var b=l[u(1367)];b!==null;){if(b[u(3795)]===5||b[u(3795)]===6)h0(a,b[u(1133)]);else if(b.tag!==4&&b.child!==null){b[u(1367)][u(3922)]=b,b=b.child;continue}if(b===l)break;for(;b[u(1263)]===null;){if(b[u(3922)]===null||b.return===l)return;b=b[u(3922)]}b[u(1263)][u(3922)]=b[u(3922)],b=b[u(1263)]}},Jo=function(){},bl=function(a,l,u,b,y){const W=e;if(a=a[W(2990)],a!==b){var K=l[W(1133)],P=qg(cg[W(1895)]);u=n0(K,u,a,b,y,P),(l[W(2845)]=u)&&jg(l)}},hl=function(a,l,u,b){u!==b&&jg(l)};else if(ax){To=function(a,l,u,b){const y=e;for(var W=l[y(1367)];W!==null;){if(W[y(3795)]===5){var K=W.stateNode;u&&b&&(K=Ix(K,W[y(3505)],W[y(2990)],W)),h0(a,K)}else if(W[y(3795)]===6)K=W.stateNode,u&&b&&(K=Se(K,W[y(2990)],W)),h0(a,K);else if(W[y(3795)]!==4){if(W.tag===22&&W[y(485)]!==null)K=W[y(1367)],K!==null&&(K[y(3922)]=W),To(a,W,!0,!0);else if(W[y(1367)]!==null){W[y(1367)][y(3922)]=W,W=W[y(1367)];continue}}if(W===l)break;for(;W[y(1263)]===null;){if(W.return===null||W.return===l)return;W=W[y(3922)]}W[y(1263)][y(3922)]=W.return,W=W[y(1263)]}};var M9=function(a,l,u,b){const y=e;for(var W=l[y(1367)];W!==null;){if(W[y(3795)]===5){var K=W[y(1133)];u&&b&&(K=Ix(K,W[y(3505)],W[y(2990)],W)),Ex(a,K)}else if(W.tag===6)K=W.stateNode,u&&b&&(K=Se(K,W.memoizedProps,W)),Ex(a,K);else if(W.tag!==4){if(W.tag===22&&W.memoizedState!==null)K=W.child,K!==null&&(K[y(3922)]=W),M9(a,W,!0,!0);else if(W.child!==null){W[y(1367)][y(3922)]=W,W=W[y(1367)];continue}}if(W===l)break;for(;W.sibling===null;){if(W[y(3922)]===null||W[y(3922)]===l)return;W=W.return}W[y(1263)][y(3922)]=W[y(3922)],W=W[y(1263)]}};Jo=function(a,l){const u=e;var b=l.stateNode;if(!z9(a,l)){a=b[u(1951)];var y=Yx(a);M9(y,l,!1,!1),b[u(1780)]=y,jg(l),Pe(a,y)}},bl=function(a,l,u,b,y){const W=e;var K=a[W(1133)],P=a[W(2990)];if((a=z9(a,l))&&P===b)l[W(1133)]=K;else{var s0=l.stateNode,p0=qg(cg[W(1895)]),z0=null;P!==b&&(z0=n0(s0,u,P,b,y,p0)),a&&z0===null?l[W(1133)]=K:(K=P0(K,z0,u,P,b,l,a,s0),X0(K,u,b,y,p0)&&jg(l),l.stateNode=K,a?jg(l):To(K,l,!1,!1))}},hl=function(a,l,u,b){const y=e;u!==b?(a=qg(es[y(1895)]),u=qg(cg.current),l.stateNode=l0(b,a,u,l),jg(l)):l[y(1133)]=a.stateNode}}else Jo=function(){},bl=function(){},hl=function(){};function Eo(a,l){const u=e;if(!ne)switch(a[u(737)]){case"hidden":l=a[u(470)];for(var b=null;l!==null;)l.alternate!==null&&(b=l),l=l[u(1263)];b===null?a[u(470)]=null:b[u(1263)]=null;break;case u(274):b=a[u(470)];for(var y=null;b!==null;)b[u(641)]!==null&&(y=b),b=b[u(1263)];y===null?l||a.tail===null?a[u(470)]=null:a.tail[u(1263)]=null:y[u(1263)]=null}}function je(a){const l=e;var u=a.alternate!==null&&a[l(641)][l(1367)]===a[l(1367)],b=0,y=0;if(u)for(var W=a[l(1367)];W!==null;)b|=W.lanes|W.childLanes,y|=W[l(1983)]&14680064,y|=W[l(2436)]&14680064,W.return=a,W=W[l(1263)];else for(W=a[l(1367)];W!==null;)b|=W[l(2840)]|W.childLanes,y|=W.subtreeFlags,y|=W[l(2436)],W[l(3922)]=a,W=W.sibling;return a[l(1983)]|=y,a[l(3262)]=b,u}function MW(a,l,u){const b=e;var y=l[b(2343)];switch(ld(l),l[b(3795)]){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return je(l),null;case 1:return Ux(l[b(3505)])&&Ut(),je(l),null;case 3:return y=l[b(1133)],ts(),D0(Te),D0(ie),hd(),y[b(3032)]&&(y[b(3246)]=y[b(3032)],y[b(3032)]=null),(a===null||a[b(1367)]===null)&&(Ko(l)?jg(l):a===null||a.memoizedState[b(2290)]&&!(l[b(2436)]&256)||(l[b(2436)]|=1024,Wg!==null&&(Dd(Wg),Wg=null))),Jo(a,l),je(l),null;case 5:ud(l),u=qg(es[b(1895)]);var W=l.type;if(a!==null&&l[b(1133)]!=null)bl(a,l,W,y,u),a[b(3786)]!==l.ref&&(l[b(2436)]|=512,l.flags|=2097152);else{if(!y){if(l[b(1133)]===null)throw Error(o(166));return je(l),null}if(a=qg(cg[b(1895)]),Ko(l)){if(!y0)throw Error(o(175));a=P2(l[b(1133)],l[b(3505)],l[b(2990)],u,a,l,!Yo),l[b(2845)]=a,a!==null&&jg(l)}else{var K=c0(W,y,u,a,l);To(K,l,!1,!1),l.stateNode=K,X0(K,W,y,u,a)&&jg(l)}l[b(3786)]!==null&&(l.flags|=512,l[b(2436)]|=2097152)}return je(l),null;case 6:if(a&&l[b(1133)]!=null)hl(a,l,a.memoizedProps,y);else{if(b(3674)!==typeof y&&l[b(1133)]===null)throw Error(o(166));if(a=qg(es.current),u=qg(cg.current),Ko(l)){if(!y0)throw Error(o(176));if(a=l[b(1133)],y=l[b(2990)],(u=L(a,y,l,!Yo))&&(W=_t,W!==null))switch(K=(W[b(251)]&1)!==0,W[b(3795)]){case 3:ex(W[b(1133)].containerInfo,a,y,K);break;case 5:lx(W[b(3505)],W[b(2990)],W[b(1133)],a,y,K)}u&&jg(l)}else l[b(1133)]=l0(y,a,u,l)}return je(l),null;case 13:if(D0(se),y=l[b(485)],ne&&Dt!==null&&l[b(251)]&1&&!(l[b(2436)]&128)){for(a=Dt;a;)a=Pi(a);return jI(),l[b(2436)]|=98560,l}if(y!==null&&y[b(772)]!==null){if(y=Ko(l),a===null){if(!y)throw Error(o(318));if(!y0)throw Error(o(344));if(a=l.memoizedState,a=a!==null?a[b(772)]:null,!a)throw Error(o(317));t0(a,l)}else jI(),!(l.flags&128)&&(l[b(485)]=null),l[b(2436)]|=4;return je(l),null}return Wg!==null&&(Dd(Wg),Wg=null),l[b(2436)]&128?(l[b(2840)]=u,l):(y=y!==null,u=!1,a===null?Ko(l):u=a.memoizedState!==null,y&&!u&&(l[b(1367)][b(2436)]|=8192,l[b(251)]&1&&(a===null||se[b(1895)]&1?ve===0&&(ve=3):Pd())),l[b(2845)]!==null&&(l[b(2436)]|=4),je(l),null);case 4:return ts(),Jo(a,l),a===null&&H0(l[b(1133)].containerInfo),je(l),null;case 10:return nd(l[b(3505)][b(3942)]),je(l),null;case 17:return Ux(l[b(3505)])&&Ut(),je(l),null;case 19:if(D0(se),W=l[b(485)],W===null)return je(l),null;if(y=(l[b(2436)]&128)!==0,K=W[b(580)],K===null)if(y)Eo(W,!1);else{if(ve!==0||a!==null&&a[b(2436)]&128)for(a=l[b(1367)];a!==null;){if(K=cl(a),K!==null){for(l[b(2436)]|=128,Eo(W,!1),a=K.updateQueue,a!==null&&(l.updateQueue=a,l[b(2436)]|=4),l[b(1983)]=0,a=u,y=l[b(1367)];y!==null;)u=y,W=a,u.flags&=14680066,K=u[b(641)],K===null?(u.childLanes=0,u[b(2840)]=W,u[b(1367)]=null,u[b(1983)]=0,u[b(2990)]=null,u[b(485)]=null,u[b(2845)]=null,u[b(1461)]=null,u.stateNode=null):(u[b(3262)]=K[b(3262)],u.lanes=K.lanes,u[b(1367)]=K[b(1367)],u[b(1983)]=0,u[b(2716)]=null,u[b(2990)]=K[b(2990)],u[b(485)]=K[b(485)],u.updateQueue=K[b(2845)],u[b(3505)]=K[b(3505)],W=K[b(1461)],u[b(1461)]=W===null?null:{lanes:W[b(2840)],firstContext:W[b(1401)]}),y=y.sibling;return Lx(se,se[b(1895)]&1|2),l.child}a=a.sibling}W.tail!==null&&Ye()>Jd&&(l[b(2436)]|=128,y=!0,Eo(W,!1),l[b(2840)]=4194304)}else{if(!y)if(a=cl(K),a!==null){if(l[b(2436)]|=128,y=!0,a=a[b(2845)],a!==null&&(l[b(2845)]=a,l[b(2436)]|=4),Eo(W,!0),W[b(470)]===null&&W.tailMode==="hidden"&&!K[b(641)]&&!ne)return je(l),null}else 2*Ye()-W.renderingStartTime>Jd&&u!==1073741824&&(l[b(2436)]|=128,y=!0,Eo(W,!1),l[b(2840)]=4194304);W[b(2789)]?(K.sibling=l[b(1367)],l.child=K):(a=W.last,a!==null?a[b(1263)]=K:l.child=K,W[b(291)]=K)}return W.tail!==null?(l=W.tail,W[b(580)]=l,W.tail=l[b(1263)],W[b(1893)]=Ye(),l.sibling=null,a=se[b(1895)],Lx(se,y?a&1|2:a&1),l):(je(l),null);case 22:case 23:return Qd(),y=l.memoizedState!==null,a!==null&&a[b(485)]!==null!==y&&(l.flags|=8192),y&&l[b(251)]&1?Pt&1073741824&&(je(l),gx&&l[b(1983)]&6&&(l[b(2436)]|=8192)):je(l),null;case 24:return null;case 25:return null}throw Error(o(156,l[b(3795)]))}var LW=c.ReactCurrentOwner,Qt=!1;function rt(a,l,u,b){const y=e;l[y(1367)]=a===null?r9(l,null,u,b):xs(l,a[y(1367)],u,b)}function L9(a,l,u,b,y){const W=e;u=u[W(948)];var K=l[W(3786)];return OI(l,y),b=md(a,l,u,b,K,y),u=Gd(),a!==null&&!Qt?(l[W(2845)]=a.updateQueue,l[W(2436)]&=-2053,a.lanes&=~y,Gi(a,l,y)):(ne&&u&&Cd(l),l[W(2436)]|=1,rt(a,l,b,y),l[W(1367)])}function k9(a,l,u,b,y){const W=e;if(a===null){var K=u.type;return W(1126)===typeof K&&!Od(K)&&K[W(3870)]===void 0&&u.compare===null&&u.defaultProps===void 0?(l[W(3795)]=15,l[W(3505)]=K,T9(a,l,K,b,y)):(a=Ml(u[W(3505)],null,b,l,l[W(251)],y),a[W(3786)]=l[W(3786)],a[W(3922)]=l,l[W(1367)]=a)}if(K=a[W(1367)],!(a[W(2840)]&y)){var P=K[W(2990)];if(u=u[W(996)],u=u!==null?u:xl,u(P,b)&&a[W(3786)]===l.ref)return Gi(a,l,y)}return l[W(2436)]|=1,a=gn(K,b),a.ref=l[W(3786)],a[W(3922)]=l,l[W(1367)]=a}function T9(a,l,u,b,y){const W=e;if(a!==null&&xl(a[W(2990)],b)&&a[W(3786)]===l[W(3786)])if(Qt=!1,(a[W(2840)]&y)!==0)a[W(2436)]&131072&&(Qt=!0);else return l[W(2840)]=a[W(2840)],Gi(a,l,y);return Wd(a,l,u,b,y)}function J9(a,l,u){const b=e;var y=l.pendingProps,W=y[b(1352)],K=a!==null?a[b(485)]:null;if(b(2578)===y[b(251)])if(!(l.mode&1))l[b(485)]={baseLanes:0,cachePool:null},Lx(is,Pt),Pt|=u;else if(u&1073741824)l[b(485)]={baseLanes:0,cachePool:null},y=K!==null?K[b(3747)]:u,Lx(is,Pt),Pt|=y;else return a=K!==null?K[b(3747)]|u:u,l[b(2840)]=l[b(3262)]=1073741824,l[b(485)]={baseLanes:a,cachePool:null},l[b(2845)]=null,Lx(is,Pt),Pt|=a,null;else K!==null?(y=K[b(3747)]|u,l[b(485)]=null):y=u,Lx(is,Pt),Pt|=y;return rt(a,l,W,u),l[b(1367)]}function E9(a,l){const u=e;var b=l[u(3786)];(a===null&&b!==null||a!==null&&a.ref!==b)&&(l[u(2436)]|=512,l[u(2436)]|=2097152)}function Wd(a,l,u,b,y){const W=e;var K=Ux(u)?Et:ie[W(1895)];return K=_g(l,K),OI(l,y),u=md(a,l,u,b,K,y),b=Gd(),a!==null&&!Qt?(l[W(2845)]=a[W(2845)],l[W(2436)]&=-2053,a[W(2840)]&=~y,Gi(a,l,y)):(ne&&b&&Cd(l),l[W(2436)]|=1,rt(a,l,u,y),l[W(1367)])}function U9(a,l,u,b,y){const W=e;if(Ux(u)){var K=!0;Oi(l)}else K=!1;if(OI(l,y),l[W(1133)]===null)a!==null&&(a[W(641)]=null,l.alternate=null,l[W(2436)]|=2),n9(l,u,b),cd(l,u,b,y),b=!0;else if(a===null){var P=l[W(1133)],s0=l[W(2990)];P[W(3105)]=s0;var p0=P.context,z0=u[W(979)];W(1011)===typeof z0&&z0!==null?z0=Ig(z0):(z0=Ux(u)?Et:ie[W(1895)],z0=_g(l,z0));var q0=u[W(2926)],mx=typeof q0=="function"||W(1126)===typeof P.getSnapshotBeforeUpdate;mx||W(1126)!==typeof P.UNSAFE_componentWillReceiveProps&&W(1126)!==typeof P.componentWillReceiveProps||(s0!==b||p0!==z0)&&I9(l,P,b,z0),qi=!1;var rx=l.memoizedState;P[W(704)]=rx,il(l,b,P,y),p0=l[W(485)],s0!==b||rx!==p0||Te[W(1895)]||qi?(W(1126)===typeof q0&&(od(l,u,q0,b),p0=l[W(485)]),(s0=qi||i9(l,u,s0,b,rx,p0,z0))?(mx||W(1126)!==typeof P[W(927)]&&W(1126)!==typeof P[W(288)]||(typeof P[W(288)]=="function"&&P[W(288)](),W(1126)===typeof P.UNSAFE_componentWillMount&&P[W(927)]()),typeof P.componentDidMount=="function"&&(l[W(2436)]|=4194308)):(W(1126)===typeof P[W(3380)]&&(l[W(2436)]|=4194308),l[W(2990)]=b,l[W(485)]=p0),P.props=b,P[W(704)]=p0,P.context=z0,b=s0):(typeof P[W(3380)]=="function"&&(l[W(2436)]|=4194308),b=!1)}else{P=l[W(1133)],x9(a,l),s0=l[W(2990)],z0=l[W(3505)]===l[W(1992)]?s0:vg(l[W(3505)],s0),P.props=z0,mx=l[W(2343)],rx=P[W(3246)],p0=u[W(979)],W(1011)===typeof p0&&p0!==null?p0=Ig(p0):(p0=Ux(u)?Et:ie[W(1895)],p0=_g(l,p0));var jx=u[W(2926)];(q0=typeof jx=="function"||typeof P[W(3092)]=="function")||W(1126)!==typeof P[W(2693)]&&W(1126)!==typeof P[W(2890)]||(s0!==mx||rx!==p0)&&I9(l,P,b,p0),qi=!1,rx=l[W(485)],P[W(704)]=rx,il(l,b,P,y);var cx=l[W(485)];s0!==mx||rx!==cx||Te[W(1895)]||qi?(typeof jx=="function"&&(od(l,u,jx,b),cx=l[W(485)]),(z0=qi||i9(l,u,z0,b,rx,cx,p0)||!1)?(q0||W(1126)!==typeof P[W(3973)]&&W(1126)!==typeof P[W(187)]||(W(1126)===typeof P.componentWillUpdate&&P[W(187)](b,cx,p0),W(1126)===typeof P[W(3973)]&&P[W(3973)](b,cx,p0)),W(1126)===typeof P[W(3928)]&&(l[W(2436)]|=4),typeof P[W(3092)]=="function"&&(l[W(2436)]|=1024)):(W(1126)!==typeof P[W(3928)]||s0===a[W(2990)]&&rx===a.memoizedState||(l[W(2436)]|=4),W(1126)!==typeof P.getSnapshotBeforeUpdate||s0===a.memoizedProps&&rx===a[W(485)]||(l[W(2436)]|=1024),l[W(2990)]=b,l[W(485)]=cx),P.props=b,P[W(704)]=cx,P[W(3246)]=p0,b=z0):(W(1126)!==typeof P[W(3928)]||s0===a[W(2990)]&&rx===a.memoizedState||(l.flags|=4),W(1126)!==typeof P.getSnapshotBeforeUpdate||s0===a[W(2990)]&&rx===a.memoizedState||(l[W(2436)]|=1024),b=!1)}return wd(a,l,u,b,K,y)}function wd(a,l,u,b,y,W){const K=e;E9(a,l);var P=(l[K(2436)]&128)!==0;if(!b&&!P)return y&&QC(l,u,!1),Gi(a,l,W);b=l[K(1133)],LW.current=l;var s0=P&&K(1126)!==typeof u[K(1609)]?null:b[K(948)]();return l[K(2436)]|=1,a!==null&&P?(l[K(1367)]=xs(l,a[K(1367)],null,W),l[K(1367)]=xs(l,null,s0,W)):rt(a,l,s0,W),l[K(485)]=b[K(704)],y&&QC(l,u,!0),l.child}function _9(a){const l=e;var u=a[l(1133)];u[l(3032)]?QI(a,u.pendingContext,u.pendingContext!==u[l(3246)]):u[l(3246)]&&QI(a,u[l(3246)],!1),Ad(a,u[l(1951)])}function D9(a,l,u,b,y){const W=e;return jI(),dd(y),l[W(2436)]|=256,rt(a,l,u,b),l[W(1367)]}var fl={dehydrated:null,treeContext:null,retryLane:0};function ml(a){return{baseLanes:a,cachePool:null}}function Q9(a,l,u){const b=e;var y=l[b(2343)],W=se[b(1895)],K=!1,P=(l[b(2436)]&128)!==0,s0;if((s0=P)||(s0=a!==null&&a.memoizedState===null?!1:(W&2)!==0),s0?(K=!0,l[b(2436)]&=-129):(a===null||a[b(485)]!==null)&&(W|=1),Lx(se,W&1),a===null)return rd(l),a=l[b(485)],a!==null&&(a=a.dehydrated,a!==null)?(l[b(251)]&1?_I(a)?l[b(2840)]=8:l[b(2840)]=1073741824:l[b(2840)]=1,null):(W=y[b(1352)],a=y[b(1644)],K?(y=l[b(251)],K=l.child,W={mode:b(2578),children:W},!(y&1)&&K!==null?(K[b(3262)]=0,K.pendingProps=W):K=Ll(W,y,0,null),a=$n(a,y,u,null),K[b(3922)]=l,a[b(3922)]=l,K[b(1263)]=a,l[b(1367)]=K,l.child[b(485)]=ml(u),l[b(485)]=fl,a):Rd(l,W));if(W=a[b(485)],W!==null){if(s0=W[b(772)],s0!==null){if(P)return l[b(2436)]&256?(l.flags&=-257,Gl(a,l,u,Error(o(422)))):l[b(485)]!==null?(l.child=a[b(1367)],l[b(2436)]|=128,null):(K=y.fallback,W=l[b(251)],y=Ll({mode:"visible",children:y[b(1352)]},W,0,null),K=$n(K,W,u,null),K[b(2436)]|=2,y.return=l,K[b(3922)]=l,y[b(1263)]=K,l[b(1367)]=y,l.mode&1&&xs(l,a.child,null,u),l[b(1367)][b(485)]=ml(u),l[b(485)]=fl,K);if(!(l[b(251)]&1))l=Gl(a,l,u,null);else if(_I(s0))l=Gl(a,l,u,Error(o(419)));else if(y=(u&a[b(3262)])!==0,Qt||y){if(y=me,y!==null){switch(u&-u){case 4:K=2;break;case 16:K=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:K=32;break;case 536870912:K=268435456;break;default:K=0}y=K&(y[b(824)]|u)?0:K,y!==0&&y!==W.retryLane&&(W[b(169)]=y,lg(a,y,-1))}Pd(),l=Gl(a,l,u,Error(o(421)))}else Jn(s0)?(l[b(2436)]|=128,l[b(1367)]=a.child,l=jW[b(1600)](null,a),DI(s0,l),l=null):(u=W[b(910)],y0&&(Dt=Q2(s0),_t=l,ne=!0,Wg=null,Yo=!1,u!==null&&(sg[og++]=hi,sg[og++]=fi,sg[og++]=En,hi=u.id,fi=u[b(1192)],En=l)),l=Rd(l,l[b(2343)][b(1352)]),l[b(2436)]|=4096);return l}return K?(y=O9(a,l,y[b(1352)],y[b(1644)],u),K=l[b(1367)],W=a[b(1367)][b(485)],K[b(485)]=W===null?ml(u):{baseLanes:W[b(3747)]|u,cachePool:null},K[b(3262)]=a[b(3262)]&~u,l[b(485)]=fl,y):(u=P9(a,l,y[b(1352)],u),l[b(485)]=null,u)}return K?(y=O9(a,l,y[b(1352)],y.fallback,u),K=l.child,W=a[b(1367)][b(485)],K[b(485)]=W===null?ml(u):{baseLanes:W[b(3747)]|u,cachePool:null},K[b(3262)]=a.childLanes&~u,l[b(485)]=fl,y):(u=P9(a,l,y[b(1352)],u),l[b(485)]=null,u)}function Rd(a,l){const u=e;return l=Ll({mode:u(2548),children:l},a[u(251)],0,null),l[u(3922)]=a,a[u(1367)]=l}function P9(a,l,u,b){const y=e;var W=a[y(1367)];return a=W[y(1263)],u=gn(W,{mode:y(2548),children:u}),!(l[y(251)]&1)&&(u.lanes=b),u[y(3922)]=l,u[y(1263)]=null,a!==null&&(b=l[y(2716)],b===null?(l.deletions=[a],l.flags|=16):b[y(3330)](a)),l.child=u}function O9(a,l,u,b,y){const W=e;var K=l.mode;a=a[W(1367)];var P=a.sibling,s0={mode:W(2578),children:u};return!(K&1)&&l[W(1367)]!==a?(u=l.child,u[W(3262)]=0,u[W(2343)]=s0,l[W(2716)]=null):(u=gn(a,s0),u[W(1983)]=a[W(1983)]&14680064),P!==null?b=gn(P,b):(b=$n(b,K,y,null),b[W(2436)]|=2),b[W(3922)]=l,u[W(3922)]=l,u[W(1263)]=b,l[W(1367)]=u,b}function Gl(a,l,u,b){const y=e;return b!==null&&dd(b),xs(l,a[y(1367)],null,u),a=Rd(l,l[y(2343)][y(1352)]),a.flags|=2,l.memoizedState=null,a}function q9(a,l,u){const b=e;a[b(2840)]|=l;var y=a[b(641)];y!==null&&(y.lanes|=l),Id(a[b(3922)],l,u)}function Vd(a,l,u,b,y){const W=e;var K=a[W(485)];K===null?a[W(485)]={isBackwards:l,rendering:null,renderingStartTime:0,last:b,tail:u,tailMode:y}:(K[W(2789)]=l,K.rendering=null,K.renderingStartTime=0,K[W(291)]=b,K[W(470)]=u,K[W(737)]=y)}function $9(a,l,u){const b=e;var y=l.pendingProps,W=y[b(3170)],K=y[b(470)];if(rt(a,l,y[b(1352)],u),y=se[b(1895)],y&2)y=y&1|2,l[b(2436)]|=128;else{if(a!==null&&a[b(2436)]&128)x:for(a=l[b(1367)];a!==null;){if(a[b(3795)]===13)a.memoizedState!==null&&q9(a,u,l);else if(a[b(3795)]===19)q9(a,u,l);else if(a.child!==null){a.child.return=a,a=a[b(1367)];continue}if(a===l)break x;for(;a[b(1263)]===null;){if(a[b(3922)]===null||a[b(3922)]===l)break x;a=a[b(3922)]}a.sibling.return=a[b(3922)],a=a[b(1263)]}y&=1}if(Lx(se,y),!(l.mode&1))l[b(485)]=null;else switch(W){case b(3905):for(u=l[b(1367)],W=null;u!==null;)a=u.alternate,a!==null&&cl(a)===null&&(W=u),u=u[b(1263)];u=W,u===null?(W=l.child,l[b(1367)]=null):(W=u.sibling,u[b(1263)]=null),Vd(l,!1,W,u,K);break;case b(1157):for(u=null,W=l[b(1367)],l.child=null;W!==null;){if(a=W.alternate,a!==null&&cl(a)===null){l[b(1367)]=W;break}a=W[b(1263)],W[b(1263)]=u,u=W,W=a}Vd(l,!0,u,null,K);break;case b(1512):Vd(l,!1,null,null,void 0);break;default:l[b(485)]=null}return l[b(1367)]}function Gi(a,l,u){const b=e;if(a!==null&&(l[b(1461)]=a.dependencies),ns|=l[b(2840)],!(u&l[b(3262)]))return null;if(a!==null&&l.child!==a.child)throw Error(o(153));if(l[b(1367)]!==null){for(a=l[b(1367)],u=gn(a,a.pendingProps),l.child=u,u[b(3922)]=l;a.sibling!==null;)a=a[b(1263)],u=u[b(1263)]=gn(a,a.pendingProps),u.return=l;u.sibling=null}return l[b(1367)]}function kW(a,l,u){const b=e;switch(l.tag){case 3:_9(l),jI();break;case 5:d9(l);break;case 1:Ux(l[b(3505)])&&Oi(l);break;case 4:Ad(l,l[b(1133)][b(1951)]);break;case 10:jf(l,l[b(3505)][b(3942)],l[b(2990)][b(2113)]);break;case 13:var y=l.memoizedState;if(y!==null)return y.dehydrated!==null?(Lx(se,se[b(1895)]&1),l[b(2436)]|=128,null):u&l.child.childLanes?Q9(a,l,u):(Lx(se,se[b(1895)]&1),a=Gi(a,l,u),a!==null?a[b(1263)]:null);Lx(se,se[b(1895)]&1);break;case 19:if(y=(u&l[b(3262)])!==0,a.flags&128){if(y)return $9(a,l,u);l[b(2436)]|=128}var W=l[b(485)];if(W!==null&&(W[b(580)]=null,W[b(470)]=null,W[b(1548)]=null),Lx(se,se[b(1895)]),y)break;return null;case 22:case 23:return l[b(2840)]=0,J9(a,l,u)}return Gi(a,l,u)}function TW(a,l){const u=e;switch(ld(l),l[u(3795)]){case 1:return Ux(l[u(3505)])&&Ut(),a=l[u(2436)],a&65536?(l.flags=a&-65537|128,l):null;case 3:return ts(),D0(Te),D0(ie),hd(),a=l[u(2436)],a&65536&&!(a&128)?(l[u(2436)]=a&-65537|128,l):null;case 5:return ud(l),null;case 13:if(D0(se),a=l[u(485)],a!==null&&a[u(772)]!==null){if(l[u(641)]===null)throw Error(o(340));jI()}return a=l[u(2436)],a&65536?(l.flags=a&-65537|128,l):null;case 19:return D0(se),null;case 4:return ts(),null;case 10:return nd(l[u(3505)][u(3942)]),null;case 22:case 23:return Qd(),null;case 24:return null;default:return null}}var pl=!1,Dn=!1,JW=e(1126)===typeof WeakSet?WeakSet:Set,E0=null;function Bl(a,l){const u=e;var b=a[u(3786)];if(b!==null)if(u(1126)===typeof b)try{b(null)}catch(y){Vt(a,l,y)}else b[u(1895)]=null}function Sd(a,l,u){try{u()}catch(b){Vt(a,l,b)}}var j9=!1;function EW(a,l){const u=e;for(j(a[u(1951)]),E0=l;E0!==null;)if(a=E0,l=a.child,(a[u(1983)]&1028)!==0&&l!==null)l.return=a,E0=l;else for(;E0!==null;){a=E0;try{var b=a[u(641)];if(a[u(2436)]&1024)switch(a[u(3795)]){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b[u(2990)],W=b[u(485)],K=a[u(1133)],P=K[u(3092)](a[u(1992)]===a[u(3505)]?y:vg(a[u(3505)],y),W);K[u(2362)]=P}break;case 3:gx&&R0(a[u(1133)][u(1951)]);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(s0){Vt(a,a.return,s0)}if(l=a[u(1263)],l!==null){l[u(3922)]=a[u(3922)],E0=l;break}E0=a.return}return b=j9,j9=!1,b}function Qn(a,l,u){const b=e;var y=l[b(2845)];if(y=y!==null?y[b(1548)]:null,y!==null){var W=y=y[b(890)];do{if((W[b(3795)]&a)===a){var K=W[b(1456)];W[b(1456)]=void 0,K!==void 0&&Sd(l,u,K)}W=W[b(890)]}while(W!==y)}}function Uo(a,l){const u=e;if(l=l.updateQueue,l=l!==null?l[u(1548)]:null,l!==null){var b=l=l[u(890)];do{if((b[u(3795)]&a)===a){var y=b[u(968)];b[u(1456)]=y()}b=b.next}while(b!==l)}}function Xd(a){const l=e;var u=a[l(3786)];if(u!==null){var b=a[l(1133)];switch(a[l(3795)]){case 5:a=f0(b);break;default:a=b}l(1126)===typeof u?u(a):u[l(1895)]=a}}function xm(a,l,u){const b=e;if(Dg&&typeof Dg[b(2250)]=="function")try{Dg[b(2250)]($C,l)}catch{}switch(l[b(3795)]){case 0:case 11:case 14:case 15:if(a=l[b(2845)],a!==null&&(a=a[b(1548)],a!==null)){var y=a=a[b(890)];do{var W=y,K=W[b(1456)];W=W[b(3795)],K!==void 0&&(W&2||W&4)&&Sd(l,u,K),y=y[b(890)]}while(y!==a)}break;case 1:if(Bl(l,u),a=l.stateNode,b(1126)===typeof a[b(3457)])try{a.props=l[b(2990)],a[b(704)]=l[b(485)],a.componentWillUnmount()}catch(P){Vt(l,u,P)}break;case 5:Bl(l,u);break;case 4:gx?Im(a,l,u):ax&&ax&&(l=l[b(1133)][b(1951)],u=Yx(l),Kx(l,u))}}function em(a,l,u){const b=e;for(var y=l;;)if(xm(a,y,u),y[b(1367)]===null||gx&&y.tag===4){if(y===l)break;for(;y[b(1263)]===null;){if(y.return===null||y[b(3922)]===l)return;y=y[b(3922)]}y[b(1263)][b(3922)]=y.return,y=y[b(1263)]}else y[b(1367)].return=y,y=y[b(1367)]}function tm(a){const l=e;var u=a[l(641)];u!==null&&(a[l(641)]=null,tm(u)),a.child=null,a[l(2716)]=null,a[l(1263)]=null,a[l(3795)]===5&&(u=a[l(1133)],u!==null&&F0(u)),a[l(1133)]=null,a[l(3922)]=null,a[l(1461)]=null,a[l(2990)]=null,a[l(485)]=null,a[l(2343)]=null,a[l(1133)]=null,a[l(2845)]=null}function gm(a){return a[e(3795)]===5||a.tag===3||a.tag===4}function im(a){const l=e;x:for(;;){for(;a[l(1263)]===null;){if(a.return===null||gm(a.return))return null;a=a.return}for(a[l(1263)][l(3922)]=a[l(3922)],a=a.sibling;a[l(3795)]!==5&&a.tag!==6&&a[l(3795)]!==18;){if(a[l(2436)]&2||a[l(1367)]===null||a[l(3795)]===4)continue x;a[l(1367)].return=a,a=a[l(1367)]}if(!(a[l(2436)]&2))return a.stateNode}}function nm(a){const l=e;if(gx){x:{for(var u=a[l(3922)];u!==null;){if(gm(u))break x;u=u[l(3922)]}throw Error(o(160))}var b=u;switch(b[l(3795)]){case 5:u=b.stateNode,b[l(2436)]&32&&(Sx(u),b[l(2436)]&=-33),b=im(a),Kd(a,b,u);break;case 3:case 4:u=b[l(1133)][l(1951)],b=im(a),Yd(a,b,u);break;default:throw Error(o(161))}}}function Yd(a,l,u){const b=e;var y=a[b(3795)];if(y===5||y===6)a=a.stateNode,l?xx(u,a,l):hx(u,a);else if(y!==4&&(a=a[b(1367)],a!==null))for(Yd(a,l,u),a=a[b(1263)];a!==null;)Yd(a,l,u),a=a[b(1263)]}function Kd(a,l,u){const b=e;var y=a.tag;if(y===5||y===6)a=a[b(1133)],l?nx(u,a,l):J0(u,a);else if(y!==4&&(a=a[b(1367)],a!==null))for(Kd(a,l,u),a=a[b(1263)];a!==null;)Kd(a,l,u),a=a[b(1263)]}function Im(a,l,u){const b=e;for(var y=l,W=!1,K,P;;){if(!W){W=y[b(3922)];x:for(;;){if(W===null)throw Error(o(160));switch(K=W[b(1133)],W[b(3795)]){case 5:P=!1;break x;case 3:K=K[b(1951)],P=!0;break x;case 4:K=K[b(1951)],P=!0;break x}W=W[b(3922)]}W=!0}if(y[b(3795)]===5||y[b(3795)]===6)em(a,y,u),P?Hx(K,y[b(1133)]):Vx(K,y.stateNode);else if(y[b(3795)]===18)P?a0(K,y[b(1133)]):J(K,y.stateNode);else if(y[b(3795)]===4){if(y[b(1367)]!==null){K=y[b(1133)][b(1951)],P=!0,y[b(1367)][b(3922)]=y,y=y[b(1367)];continue}}else if(xm(a,y,u),y[b(1367)]!==null){y[b(1367)][b(3922)]=y,y=y.child;continue}if(y===l)break;for(;y[b(1263)]===null;){if(y[b(3922)]===null||y[b(3922)]===l)return;y=y[b(3922)],y[b(3795)]===4&&(W=!1)}y[b(1263)][b(3922)]=y[b(3922)],y=y[b(1263)]}}function Hd(a,l){const u=e;if(gx){switch(l[u(3795)]){case 0:case 11:case 14:case 15:Qn(3,l,l.return),Uo(3,l),Qn(5,l,l[u(3922)]);return;case 1:return;case 5:var b=l[u(1133)];if(b!=null){var y=l[u(2990)];a=a!==null?a[u(2990)]:y;var W=l[u(3505)],K=l[u(2845)];l[u(2845)]=null,K!==null&&Rx(b,K,W,a,y,l)}return;case 6:if(l[u(1133)]===null)throw Error(o(162));b=l[u(2990)],U0(l.stateNode,a!==null?a.memoizedProps:b,b);return;case 3:y0&&a!==null&&a[u(485)][u(2290)]&&k(l[u(1133)][u(1951)]);return;case 12:return;case 13:Zl(l);return;case 19:Zl(l);return;case 17:return}throw Error(o(163))}switch(l[u(3795)]){case 0:case 11:case 14:case 15:Qn(3,l,l.return),Uo(3,l),Qn(5,l,l[u(3922)]);return;case 12:return;case 13:Zl(l);return;case 19:Zl(l);return;case 3:y0&&a!==null&&a[u(485)][u(2290)]&&k(l[u(1133)][u(1951)]);break;case 22:case 23:return}x:if(ax){switch(l[u(3795)]){case 1:case 5:case 6:break x;case 3:case 4:l=l.stateNode,Kx(l[u(1951)],l.pendingChildren);break x}throw Error(o(163))}}function Zl(a){const l=e;var u=a[l(2845)];if(u!==null){a[l(2845)]=null;var b=a[l(1133)];b===null&&(b=a[l(1133)]=new JW),u[l(1599)](function(y){const W=l;var K=xw.bind(null,a,y);b[W(2489)](y)||(b[W(3014)](y),y[W(2334)](K,K))})}}function UW(a,l){const u=e;for(E0=l;E0!==null;){l=E0;var b=l[u(2716)];if(b!==null)for(var y=0;y<b.length;y++){var W=b[y];try{var K=a;gx?Im(K,W,l):em(K,W,l);var P=W.alternate;P!==null&&(P.return=null),W[u(3922)]=null}catch(tx){Vt(W,l,tx)}}if(b=l[u(1367)],l.subtreeFlags&12854&&b!==null)b[u(3922)]=l,E0=b;else for(;E0!==null;){l=E0;try{var s0=l.flags;if(s0&32&&gx&&Sx(l[u(1133)]),s0&512){var p0=l[u(641)];if(p0!==null){var z0=p0.ref;z0!==null&&(u(1126)===typeof z0?z0(null):z0[u(1895)]=null)}}if(s0&8192)switch(l[u(3795)]){case 13:if(l[u(485)]!==null){var q0=l[u(641)];(q0===null||q0[u(485)]===null)&&(Td=Ye())}break;case 22:var mx=l.memoizedState!==null,rx=l[u(641)],jx=rx!==null&&rx.memoizedState!==null;if(b=l,gx){x:if(y=b,W=mx,K=null,gx)for(var cx=y;;){if(cx[u(3795)]===5){if(K===null){K=cx;var Ee=cx[u(1133)];W?q(Ee):A0(cx[u(1133)],cx[u(2990)])}}else if(cx[u(3795)]===6){if(K===null){var r0=cx.stateNode;W?v0(r0):W0(r0,cx[u(2990)])}}else if((cx[u(3795)]!==22&&cx[u(3795)]!==23||cx[u(485)]===null||cx===y)&&cx.child!==null){cx.child[u(3922)]=cx,cx=cx[u(1367)];continue}if(cx===y)break;for(;cx.sibling===null;){if(cx.return===null||cx[u(3922)]===y)break x;K===cx&&(K=null),cx=cx[u(3922)]}K===cx&&(K=null),cx[u(1263)][u(3922)]=cx[u(3922)],cx=cx[u(1263)]}}if(mx&&!jx&&b.mode&1){E0=b;for(var o0=b[u(1367)];o0!==null;){for(b=E0=o0;E0!==null;){y=E0;var u0=y[u(1367)];switch(y[u(3795)]){case 0:case 11:case 14:case 15:Qn(4,y,y[u(3922)]);break;case 1:Bl(y,y[u(3922)]);var K0=y.stateNode;if(typeof K0.componentWillUnmount=="function"){var B0=y.return;try{K0[u(3105)]=y[u(2990)],K0[u(704)]=y.memoizedState,K0[u(3457)]()}catch(tx){Vt(y,B0,tx)}}break;case 5:Bl(y,y[u(3922)]);break;case 22:if(y[u(485)]!==null){cm(b);continue}}u0!==null?(u0[u(3922)]=y,E0=u0):cm(b)}o0=o0.sibling}}}switch(s0&4102){case 2:nm(l),l[u(2436)]&=-3;break;case 6:nm(l),l[u(2436)]&=-3,Hd(l.alternate,l);break;case 4096:l[u(2436)]&=-4097;break;case 4100:l[u(2436)]&=-4097,Hd(l[u(641)],l);break;case 4:Hd(l[u(641)],l)}}catch(tx){Vt(l,l[u(3922)],tx)}if(b=l[u(1263)],b!==null){b[u(3922)]=l[u(3922)],E0=b;break}E0=l[u(3922)]}}}function _W(a,l,u){E0=a,sm(a)}function sm(a,l,u){const b=e;for(var y=(a[b(251)]&1)!==0;E0!==null;){var W=E0,K=W.child;if(W[b(3795)]===22&&y){var P=W[b(485)]!==null||pl;if(!P){var s0=W[b(641)],p0=s0!==null&&s0[b(485)]!==null||Dn;s0=pl;var z0=Dn;if(pl=P,(Dn=p0)&&!z0)for(E0=W;E0!==null;)P=E0,p0=P[b(1367)],P[b(3795)]===22&&P[b(485)]!==null?Cm(W):p0!==null?(p0[b(3922)]=P,E0=p0):Cm(W);for(;K!==null;)E0=K,sm(K),K=K[b(1263)];E0=W,pl=s0,Dn=z0}om(a)}else W[b(1983)]&8772&&K!==null?(K[b(3922)]=W,E0=K):om(a)}}function om(a){const l=e;for(;E0!==null;){var u=E0;if(u[l(2436)]&8772){var b=u.alternate;try{if(u[l(2436)]&8772)switch(u.tag){case 0:case 11:case 15:Dn||Uo(5,u);break;case 1:var y=u[l(1133)];if(u[l(2436)]&4&&!Dn)if(b===null)y.componentDidMount();else{var W=u[l(1992)]===u[l(3505)]?b[l(2990)]:vg(u[l(3505)],b.memoizedProps);y[l(3928)](W,b.memoizedState,y[l(2362)])}var K=u[l(2845)];K!==null&&t9(u,K,y);break;case 3:var P=u[l(2845)];if(P!==null){if(b=null,u[l(1367)]!==null)switch(u[l(1367)][l(3795)]){case 5:b=f0(u.child[l(1133)]);break;case 1:b=u.child[l(1133)]}t9(u,P,b)}break;case 5:var s0=u[l(1133)];b===null&&u[l(2436)]&4&&Cx(s0,u[l(3505)],u[l(2990)],u);break;case 6:break;case 4:break;case 12:break;case 13:if(y0&&u.memoizedState===null){var p0=u.alternate;if(p0!==null){var z0=p0[l(485)];if(z0!==null){var q0=z0[l(772)];q0!==null&&D(q0)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Dn||u[l(2436)]&512&&Xd(u)}catch(mx){Vt(u,u[l(3922)],mx)}}if(u===a){E0=null;break}if(b=u[l(1263)],b!==null){b[l(3922)]=u.return,E0=b;break}E0=u.return}}function cm(a){const l=e;for(;E0!==null;){var u=E0;if(u===a){E0=null;break}var b=u[l(1263)];if(b!==null){b[l(3922)]=u[l(3922)],E0=b;break}E0=u[l(3922)]}}function Cm(a){const l=e;for(;E0!==null;){var u=E0;try{switch(u[l(3795)]){case 0:case 11:case 15:var b=u[l(3922)];try{Uo(4,u)}catch(p0){Vt(u,b,p0)}break;case 1:var y=u[l(1133)];if(l(1126)===typeof y[l(3380)]){var W=u[l(3922)];try{y.componentDidMount()}catch(p0){Vt(u,W,p0)}}var K=u.return;try{Xd(u)}catch(p0){Vt(u,K,p0)}break;case 5:var P=u[l(3922)];try{Xd(u)}catch(p0){Vt(u,P,p0)}}}catch(p0){Vt(u,u[l(3922)],p0)}if(u===a){E0=null;break}var s0=u.sibling;if(s0!==null){s0[l(3922)]=u[l(3922)],E0=s0;break}E0=u[l(3922)]}}var yl=0,vl=1,Wl=2,wl=3,Rl=4;if(e(1126)===typeof Symbol&&Symbol[e(686)]){var _o=Symbol.for;yl=_o(e(2256)),vl=_o(e(3501)),Wl=_o(e(1084)),wl=_o("selector.test_id"),Rl=_o(e(2640))}function Nd(a){const l=e;var u=V0(a);if(u!=null){if(l(3674)!==typeof u[l(2990)][l(972)])throw Error(o(364));return u}if(a=T(a),a===null)throw Error(o(362));return a[l(1133)][l(1895)]}function Fd(a,l){const u=e;switch(l.$$typeof){case yl:if(a[u(3505)]===l.value)return!0;break;case vl:x:{l=l.value,a=[a,0];for(var b=0;b<a[u(2989)];){var y=a[b++],W=a[b++],K=l[W];if(y[u(3795)]!==5||!d0(y)){for(;K!=null&&Fd(y,K);)W++,K=l[W];if(W===l[u(2989)]){l=!0;break x}else for(y=y.child;y!==null;)a[u(3330)](y,W),y=y[u(1263)]}}l=!1}return l;case Wl:if(a[u(3795)]===5&&w0(a[u(1133)],l[u(2113)]))return!0;break;case Rl:if((a[u(3795)]===5||a[u(3795)]===6)&&(a=Z0(a),a!==null&&0<=a.indexOf(l[u(2113)])))return!0;break;case wl:if(a[u(3795)]===5&&(a=a[u(2990)][u(972)],u(3674)===typeof a&&a[u(2084)]()===l[u(2113)][u(2084)]()))return!0;break;default:throw Error(o(365))}return!1}function zd(a){const l=e;switch(a[l(1596)]){case yl:return"<"+(X(a[l(2113)])||"Unknown")+">";case vl:return l(923)+(zd(a)||"")+")";case Wl:return'[role="'+a.value+'"]';case Rl:return'"'+a[l(2113)]+'"';case wl:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function lm(a,l){const u=e;var b=[];a=[a,0];for(var y=0;y<a[u(2989)];){var W=a[y++],K=a[y++],P=l[K];if(W[u(3795)]!==5||!d0(W)){for(;P!=null&&Fd(W,P);)K++,P=l[K];if(K===l[u(2989)])b[u(3330)](W);else for(W=W[u(1367)];W!==null;)a[u(3330)](W,K),W=W.sibling}}return b}function Md(a,l){const u=e;if(!R)throw Error(o(363));a=Nd(a),a=lm(a,l),l=[],a=Array[u(3803)](a);for(var b=0;b<a[u(2989)];){var y=a[b++];if(y.tag===5)d0(y)||l.push(y[u(1133)]);else for(y=y[u(1367)];y!==null;)a[u(3330)](y),y=y[u(1263)]}return l}var DW=Math[e(2163)],Vl=c[e(2147)],Ld=c[e(2937)],be=c[e(3118)],wx=0,me=null,Ge=null,Je=0,Pt=0,is=Wx(0),ve=0,Do=null,ns=0,Sl=0,kd=0,Qo=null,wt=null,Td=0,Jd=1/0;function Is(){Jd=Ye()+500}var Xl=!1,Ed=null,ji=null,Yl=!1,xn=null,Kl=0,Po=0,Ud=null,Hl=-1,Nl=0;function dt(){return wx&6?Ye():Hl!==-1?Hl:Hl=Ye()}function en(a){return a[e(251)]&1?wx&2&&Je!==0?Je&-Je:RW.transition!==null?(Nl===0&&(a=PC,PC<<=1,!(PC&4194240)&&(PC=64),Nl=a),Nl):(a=kx,a!==0?a:Y0()):1}function lg(a,l,u){const b=e;if(50<Po)throw Po=0,Ud=null,Error(o(185));var y=Fl(a,l);return y===null?null:(Xo(y,l,u),(!(wx&2)||y!==me)&&(y===me&&(!(wx&2)&&(Sl|=l),ve===4&&tn(y,Je)),Rt(y,u),l===1&&wx===0&&!(a[b(251)]&1)&&(Is(),jC&&Pg())),y)}function Fl(a,l){const u=e;a[u(2840)]|=l;var b=a[u(641)];for(b!==null&&(b[u(2840)]|=l),b=a,a=a[u(3922)];a!==null;)a.childLanes|=l,b=a[u(641)],b!==null&&(b[u(3262)]|=l),b=a,a=a[u(3922)];return b[u(3795)]===3?b.stateNode:null}function Rt(a,l){const u=e;var b=a[u(652)];mW(a,l);var y=qC(a,a===me?Je:0);if(y===0)b!==null&&qf(b),a[u(652)]=null,a[u(2858)]=0;else if(l=y&-y,a.callbackPriority!==l){if(b!=null&&qf(b),l===1)a.tag===0?wW(rm[u(1600)](null,a)):$f(rm[u(1600)](null,a)),$0?Q(function(){wx===0&&Pg()}):j2(xd,Pg),b=null;else{switch(Of(y)){case 1:b=xd;break;case 4:b=ZW;break;case 16:b=ed;break;case 536870912:b=yW;break;default:b=ed}b=pm(b,am[u(1600)](null,a))}a[u(2858)]=l,a[u(652)]=b}}function am(a,l){const u=e;if(Hl=-1,Nl=0,wx&6)throw Error(o(327));var b=a[u(652)];if(qn()&&a[u(652)]!==b)return null;var y=qC(a,a===me?Je:0);if(y===0)return null;if(y&30||y&a.expiredLanes||l)l=zl(a,y);else{l=y;var W=wx;wx|=2;var K=um();(me!==a||Je!==l)&&(Is(),Pn(a,l));do try{OW();break}catch(s0){Am(a,s0)}while(!0);id(),Vl[u(1895)]=K,wx=W,Ge!==null?l=0:(me=null,Je=0,l=ve)}if(l!==0){if(l===2&&(W=O2(a),W!==0&&(y=W,l=_d(a,W))),l===1)throw b=Do,Pn(a,0),tn(a,y),Rt(a,Ye()),b;if(l===6)tn(a,y);else{if(W=a[u(1895)][u(641)],!(y&30)&&!QW(W)&&(l=zl(a,y),l===2&&(K=O2(a),K!==0&&(y=K,l=_d(a,K))),l===1))throw b=Do,Pn(a,0),tn(a,y),Rt(a,Ye()),b;switch(a.finishedWork=W,a[u(3046)]=y,l){case 0:case 1:throw Error(o(345));case 2:On(a,wt);break;case 3:if(tn(a,y),(y&130023424)===y&&(l=Td+500-Ye(),10<l)){if(qC(a,0)!==0)break;if(W=a[u(824)],(W&y)!==y){dt(),a[u(3632)]|=a[u(824)]&W;break}a[u(1331)]=m0(On[u(1600)](null,a,wt),l);break}On(a,wt);break;case 4:if(tn(a,y),(y&4194240)===y)break;for(l=a[u(504)],W=-1;0<y;){var P=31-Wt(y);K=1<<P,P=l[P],P>W&&(W=P),y&=~K}if(y=W,y=Ye()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*DW(y/1960))-y,10<y){a.timeoutHandle=m0(On[u(1600)](null,a,wt),y);break}On(a,wt);break;case 5:On(a,wt);break;default:throw Error(o(329))}}}return Rt(a,Ye()),a.callbackNode===b?am[u(1600)](null,a):null}function _d(a,l){const u=e;var b=Qo;return a[u(1895)].memoizedState.isDehydrated&&(Pn(a,l)[u(2436)]|=256),a=zl(a,l),a!==2&&(l=wt,wt=b,l!==null&&Dd(l)),a}function Dd(a){const l=e;wt===null?wt=a:wt[l(3330)][l(1307)](wt,a)}function QW(a){const l=e;for(var u=a;;){if(u.flags&16384){var b=u[l(2845)];if(b!==null&&(b=b.stores,b!==null))for(var y=0;y<b[l(2989)];y++){var W=b[y],K=W.getSnapshot;W=W[l(2113)];try{if(!Qg(K(),W))return!1}catch{return!1}}}if(b=u.child,u[l(1983)]&16384&&b!==null)b[l(3922)]=u,u=b;else{if(u===a)break;for(;u[l(1263)]===null;){if(u.return===null||u[l(3922)]===a)return!0;u=u[l(3922)]}u[l(1263)][l(3922)]=u[l(3922)],u=u[l(1263)]}}return!0}function tn(a,l){const u=e;for(l&=~kd,l&=~Sl,a[u(824)]|=l,a[u(3632)]&=~l,a=a[u(3593)];0<l;){var b=31-Wt(l),y=1<<b;a[b]=-1,l&=~y}}function rm(a){const l=e;if(wx&6)throw Error(o(327));qn();var u=qC(a,0);if(!(u&1))return Rt(a,Ye()),null;var b=zl(a,u);if(a[l(3795)]!==0&&b===2){var y=O2(a);y!==0&&(u=y,b=_d(a,y))}if(b===1)throw b=Do,Pn(a,0),tn(a,u),Rt(a,Ye()),b;if(b===6)throw Error(o(345));return a.finishedWork=a.current[l(641)],a[l(3046)]=u,On(a,wt),Rt(a,Ye()),null}function dm(a){const l=e;xn!==null&&xn.tag===0&&!(wx&6)&&qn();var u=wx;wx|=1;var b=be[l(1691)],y=kx;try{if(be.transition=null,kx=1,a)return a()}finally{kx=y,be[l(1691)]=b,wx=u,!(wx&6)&&Pg()}}function Qd(){Pt=is[e(1895)],D0(is)}function Pn(a,l){const u=e;a.finishedWork=null,a[u(3046)]=0;var b=a[u(1331)];if(b!==bx&&(a[u(1331)]=bx,M0(b)),Ge!==null)for(b=Ge[u(3922)];b!==null;){var y=b;switch(ld(y),y[u(3795)]){case 1:y=y[u(3505)][u(3503)],y!=null&&Ut();break;case 3:ts(),D0(Te),D0(ie),hd();break;case 5:ud(y);break;case 4:ts();break;case 13:D0(se);break;case 19:D0(se);break;case 10:nd(y[u(3505)]._context);break;case 22:case 23:Qd()}b=b.return}if(me=a,Ge=a=gn(a[u(1895)],null),Je=Pt=l,ve=0,Do=null,kd=Sl=ns=0,wt=Qo=null,Og!==null){for(l=0;l<Og[u(2989)];l++)if(b=Og[l],y=b[u(439)],y!==null){b[u(439)]=null;var W=y[u(890)],K=b[u(1891)];if(K!==null){var P=K[u(890)];K[u(890)]=W,y[u(890)]=P}b.pending=y}Og=null}return a}function Am(a,l){const u=e;do{var b=Ge;try{if(id(),Cl.current=ul,ll){for(var y=ae[u(485)];y!==null;){var W=y[u(888)];W!==null&&(W[u(1891)]=null),y=y.next}ll=!1}if(gs=0,Ke=qe=ae=null,zo=!1,Mo=0,Ld[u(1895)]=null,b===null||b[u(3922)]===null){ve=1,Do=l,Ge=null;break}x:{var K=a,P=b.return,s0=b,p0=l;if(l=Je,s0[u(2436)]|=32768,p0!==null&&u(1011)===typeof p0&&u(1126)===typeof p0[u(2334)]){var z0=p0,q0=s0,mx=q0[u(3795)];if(!(q0[u(251)]&1)&&(mx===0||mx===11||mx===15)){var rx=q0[u(641)];rx?(q0[u(2845)]=rx.updateQueue,q0[u(485)]=rx[u(485)],q0[u(2840)]=rx[u(2840)]):(q0[u(2845)]=null,q0[u(485)]=null)}var jx=N9(P);if(jx!==null){jx.flags&=-257,F9(jx,P,s0,K,l),jx[u(251)]&1&&H9(K,z0,l),l=jx,p0=z0;var cx=l.updateQueue;if(cx===null){var Ee=new Set;Ee[u(3014)](p0),l.updateQueue=Ee}else cx[u(3014)](p0);break x}else{if(!(l&1)){H9(K,z0,l),Pd();break x}p0=Error(o(426))}}else if(ne&&s0[u(251)]&1){var r0=N9(P);if(r0!==null){!(r0[u(2436)]&65536)&&(r0.flags|=256),F9(r0,P,s0,K,l),dd(p0);break x}}K=p0,ve!==4&&(ve=2),Qo===null?Qo=[K]:Qo[u(3330)](K),p0=yd(p0,s0),s0=P;do{switch(s0[u(3795)]){case 3:s0.flags|=65536,l&=-l,s0[u(2840)]|=l;var o0=Y9(s0,p0,l);e9(s0,o0);break x;case 1:K=p0;var u0=s0[u(3505)],K0=s0[u(1133)];if(!(s0[u(2436)]&128)&&(u(1126)===typeof u0.getDerivedStateFromError||K0!==null&&u(1126)===typeof K0[u(384)]&&(ji===null||!ji[u(2489)](K0)))){s0.flags|=65536,l&=-l,s0[u(2840)]|=l;var B0=K9(s0,K,l);e9(s0,B0);break x}}s0=s0[u(3922)]}while(s0!==null)}hm(b)}catch(tx){l=tx,Ge===b&&b!==null&&(Ge=b=b[u(3922)]);continue}break}while(!0)}function um(){const a=e;var l=Vl[a(1895)];return Vl[a(1895)]=ul,l===null?ul:l}function Pd(){(ve===0||ve===3||ve===2)&&(ve=4),me===null||!(ns&268435455)&&!(Sl&268435455)||tn(me,Je)}function zl(a,l){const u=e;var b=wx;wx|=2;var y=um();me===a&&Je===l||Pn(a,l);do try{PW();break}catch(W){Am(a,W)}while(!0);if(id(),wx=b,Vl[u(1895)]=y,Ge!==null)throw Error(o(261));return me=null,Je=0,ve}function PW(){for(;Ge!==null;)bm(Ge)}function OW(){for(;Ge!==null&&!pW();)bm(Ge)}function bm(a){const l=e;var u=Gm(a[l(641)],a,Pt);a[l(2990)]=a[l(2343)],u===null?hm(a):Ge=u,Ld[l(1895)]=null}function hm(a){const l=e;var u=a;do{var b=u[l(641)];if(a=u.return,u[l(2436)]&32768){if(b=TW(b,u),b!==null){b[l(2436)]&=32767,Ge=b;return}if(a!==null)a[l(2436)]|=32768,a.subtreeFlags=0,a[l(2716)]=null;else{ve=6,Ge=null;return}}else if(b=MW(b,u,Pt),b!==null){Ge=b;return}if(u=u[l(1263)],u!==null){Ge=u;return}Ge=u=a}while(u!==null);ve===0&&(ve=5)}function On(a,l){const u=e;var b=kx,y=be.transition;try{be[u(1691)]=null,kx=1,qW(a,l,b)}finally{be[u(1691)]=y,kx=b}return null}function qW(a,l,u){const b=e;do qn();while(xn!==null);if(wx&6)throw Error(o(327));var y=a[b(1852)],W=a[b(3046)];if(y===null)return null;if(a[b(1852)]=null,a[b(3046)]=0,y===a[b(1895)])throw Error(o(177));a[b(652)]=null,a.callbackPriority=0;var K=y[b(2840)]|y[b(3262)];if(GW(a,K),a===me&&(Ge=me=null,Je=0),!(y.subtreeFlags&2064)&&!(y[b(2436)]&2064)||Yl||(Yl=!0,pm(ed,function(){return qn(),null})),K=(y[b(2436)]&15990)!==0,y[b(1983)]&15990||K){K=be.transition,be[b(1691)]=null;var P=kx;kx=1;var s0=wx;wx|=4,Ld[b(1895)]=null,EW(a,y),UW(a,y),x0(a[b(1951)]),a[b(1895)]=y,_W(y),BW(),wx=s0,kx=P,be[b(1691)]=K}else a[b(1895)]=y;if(Yl&&(Yl=!1,xn=a,Kl=W),K=a[b(294)],K===0&&(ji=null),vW(y.stateNode),Rt(a,Ye()),l!==null)for(u=a[b(973)],y=0;y<l[b(2989)];y++)u(l[y]);if(Xl)throw Xl=!1,a=Ed,Ed=null,a;return Kl&1&&a.tag!==0&&qn(),K=a.pendingLanes,K&1?a===Ud?Po++:(Po=0,Ud=a):Po=0,Pg(),null}function qn(){const a=e;if(xn!==null){var l=Of(Kl),u=be[a(1691)],b=kx;try{if(be[a(1691)]=null,kx=16>l?16:l,xn===null)var y=!1;else{if(l=xn,xn=null,Kl=0,wx&6)throw Error(o(331));var W=wx;for(wx|=4,E0=l[a(1895)];E0!==null;){var K=E0,P=K[a(1367)];if(E0[a(2436)]&16){var s0=K.deletions;if(s0!==null){for(var p0=0;p0<s0[a(2989)];p0++){var z0=s0[p0];for(E0=z0;E0!==null;){var q0=E0;switch(q0[a(3795)]){case 0:case 11:case 15:Qn(8,q0,K)}var mx=q0.child;if(mx!==null)mx.return=q0,E0=mx;else for(;E0!==null;){q0=E0;var rx=q0.sibling,jx=q0[a(3922)];if(tm(q0),q0===z0){E0=null;break}if(rx!==null){rx[a(3922)]=jx,E0=rx;break}E0=jx}}}var cx=K[a(641)];if(cx!==null){var Ee=cx[a(1367)];if(Ee!==null){cx[a(1367)]=null;do{var r0=Ee[a(1263)];Ee[a(1263)]=null,Ee=r0}while(Ee!==null)}}E0=K}}if(K[a(1983)]&2064&&P!==null)P[a(3922)]=K,E0=P;else x:for(;E0!==null;){if(K=E0,K[a(2436)]&2048)switch(K[a(3795)]){case 0:case 11:case 15:Qn(9,K,K[a(3922)])}var o0=K.sibling;if(o0!==null){o0[a(3922)]=K[a(3922)],E0=o0;break x}E0=K[a(3922)]}}var u0=l[a(1895)];for(E0=u0;E0!==null;){P=E0;var K0=P[a(1367)];if(P[a(1983)]&2064&&K0!==null)K0.return=P,E0=K0;else x:for(P=u0;E0!==null;){if(s0=E0,s0[a(2436)]&2048)try{switch(s0[a(3795)]){case 0:case 11:case 15:Uo(9,s0)}}catch(tx){Vt(s0,s0.return,tx)}if(s0===P){E0=null;break x}var B0=s0[a(1263)];if(B0!==null){B0[a(3922)]=s0.return,E0=B0;break x}E0=s0[a(3922)]}}if(wx=W,Pg(),Dg&&typeof Dg[a(2702)]=="function")try{Dg[a(2702)]($C,l)}catch{}y=!0}return y}finally{kx=b,be[a(1691)]=u}}return!1}function fm(a,l,u){l=yd(u,l),l=Y9(a,l,1),$i(a,l),l=dt(),a=Fl(a,1),a!==null&&(Xo(a,1,l),Rt(a,l))}function Vt(a,l,u){const b=e;if(a[b(3795)]===3)fm(a,a,u);else for(;l!==null;){if(l[b(3795)]===3){fm(l,a,u);break}else if(l[b(3795)]===1){var y=l.stateNode;if(b(1126)===typeof l[b(3505)][b(1609)]||b(1126)===typeof y[b(384)]&&(ji===null||!ji[b(2489)](y))){a=yd(u,a),a=K9(l,a,1),$i(l,a),a=dt(),l=Fl(l,1),l!==null&&(Xo(l,1,a),Rt(l,a));break}}l=l[b(3922)]}}function $W(a,l,u){const b=e;var y=a[b(901)];y!==null&&y[b(1432)](l),l=dt(),a[b(3632)]|=a[b(824)]&u,me===a&&(Je&u)===u&&(ve===4||ve===3&&(Je&130023424)===Je&&500>Ye()-Td?Pn(a,0):kd|=u),Rt(a,l)}function mm(a,l){l===0&&(a[e(251)]&1?(l=OC,OC<<=1,!(OC&130023424)&&(OC=4194304)):l=1);var b=dt();a=Fl(a,l),a!==null&&(Xo(a,l,b),Rt(a,b))}function jW(a){var u=a[e(485)],b=0;u!==null&&(b=u.retryLane),mm(a,b)}function xw(a,l){const u=e;var b=0;switch(a.tag){case 13:var y=a[u(1133)],W=a[u(485)];W!==null&&(b=W[u(169)]);break;case 19:y=a[u(1133)];break;default:throw Error(o(314))}y!==null&&y.delete(l),mm(a,b)}var Gm;Gm=function(a,l,u){const b=e;if(a!==null)if(a[b(2990)]!==l[b(2343)]||Te[b(1895)])Qt=!0;else{if(!(a[b(2840)]&u)&&!(l[b(2436)]&128))return Qt=!1,kW(a,l,u);Qt=!!(a.flags&131072)}else Qt=!1,ne&&l[b(2436)]&1048576&&s9(l,sl,l[b(587)]);switch(l.lanes=0,l.tag){case 2:var y=l[b(3505)];a!==null&&(a.alternate=null,l[b(641)]=null,l[b(2436)]|=2),a=l[b(2343)];var W=_g(l,ie.current);OI(l,u),W=md(null,l,y,a,W,u);var K=Gd();return l[b(2436)]|=1,typeof W=="object"&&W!==null&&b(1126)===typeof W.render&&W[b(1596)]===void 0?(l[b(3795)]=1,l[b(485)]=null,l[b(2845)]=null,Ux(y)?(K=!0,Oi(l)):K=!1,l[b(485)]=W.state!==null&&W[b(704)]!==void 0?W[b(704)]:null,sd(l),W.updater=nl,l[b(1133)]=W,W._reactInternals=l,cd(l,y,a,u),l=wd(null,l,y,!0,K,u)):(l[b(3795)]=0,ne&&K&&Cd(l),rt(null,l,W,u),l=l[b(1367)]),l;case 16:y=l[b(1992)];x:{switch(a!==null&&(a[b(641)]=null,l[b(641)]=null,l[b(2436)]|=2),a=l[b(2343)],W=y[b(2660)],y=W(y._payload),l[b(3505)]=y,W=l[b(3795)]=tw(y),a=vg(y,a),W){case 0:l=Wd(null,l,y,a,u);break x;case 1:l=U9(null,l,y,a,u);break x;case 11:l=L9(null,l,y,a,u);break x;case 14:l=k9(null,l,y,vg(y.type,a),u);break x}throw Error(o(306,y,""))}return l;case 0:return y=l[b(3505)],W=l[b(2343)],W=l.elementType===y?W:vg(y,W),Wd(a,l,y,W,u);case 1:return y=l[b(3505)],W=l[b(2343)],W=l.elementType===y?W:vg(y,W),U9(a,l,y,W,u);case 3:x:{if(_9(l),a===null)throw Error(o(387));y=l[b(2343)],K=l[b(485)],W=K[b(545)],x9(a,l),il(l,y,null,u);var P=l.memoizedState;if(y=P.element,y0&&K.isDehydrated)if(K={element:y,isDehydrated:!1,cache:P[b(672)],transitions:P[b(329)]},l[b(2845)].baseState=K,l.memoizedState=K,l[b(2436)]&256){W=Error(o(423)),l=D9(a,l,y,u,W);break x}else if(y!==W){W=Error(o(424)),l=D9(a,l,y,u,W);break x}else for(y0&&(Dt=D2(l.stateNode.containerInfo),_t=l,ne=!0,Wg=null,Yo=!1),u=r9(l,null,y,u),l[b(1367)]=u;u;)u.flags=u.flags&-3|4096,u=u[b(1263)];else{if(jI(),y===W){l=Gi(a,l,u);break x}rt(a,l,y,u)}l=l.child}return l;case 5:return d9(l),a===null&&rd(l),y=l.type,W=l[b(2343)],K=a!==null?a[b(2990)]:null,P=W[b(1352)],g0(y,W)?P=null:K!==null&&g0(y,K)&&(l[b(2436)]|=32),E9(a,l),rt(a,l,P,u),l[b(1367)];case 6:return a===null&&rd(l),null;case 13:return Q9(a,l,u);case 4:return Ad(l,l[b(1133)][b(1951)]),y=l[b(2343)],a===null?l.child=xs(l,null,y,u):rt(a,l,y,u),l[b(1367)];case 11:return y=l[b(3505)],W=l[b(2343)],W=l[b(1992)]===y?W:vg(y,W),L9(a,l,y,W,u);case 7:return rt(a,l,l[b(2343)],u),l[b(1367)];case 8:return rt(a,l,l[b(2343)][b(1352)],u),l[b(1367)];case 12:return rt(a,l,l[b(2343)][b(1352)],u),l[b(1367)];case 10:x:{if(y=l.type[b(3942)],W=l[b(2343)],K=l[b(2990)],P=W[b(2113)],jf(l,y,P),K!==null)if(Qg(K[b(2113)],P)){if(K[b(1352)]===W[b(1352)]&&!Te[b(1895)]){l=Gi(a,l,u);break x}}else for(K=l[b(1367)],K!==null&&(K[b(3922)]=l);K!==null;){var s0=K[b(1461)];if(s0!==null){P=K[b(1367)];for(var p0=s0[b(1401)];p0!==null;){if(p0[b(3246)]===y){if(K[b(3795)]===1){p0=bi(-1,u&-u),p0[b(3795)]=2;var z0=K.updateQueue;if(z0!==null){z0=z0[b(2940)];var q0=z0[b(1891)];q0===null?p0[b(890)]=p0:(p0[b(890)]=q0[b(890)],q0.next=p0),z0[b(1891)]=p0}}K[b(2840)]|=u,p0=K[b(641)],p0!==null&&(p0.lanes|=u),Id(K.return,u,l),s0[b(2840)]|=u;break}p0=p0[b(890)]}}else if(K[b(3795)]===10)P=K[b(3505)]===l[b(3505)]?null:K[b(1367)];else if(K[b(3795)]===18){if(P=K[b(3922)],P===null)throw Error(o(341));P[b(2840)]|=u,s0=P[b(641)],s0!==null&&(s0[b(2840)]|=u),Id(P,u,l),P=K[b(1263)]}else P=K[b(1367)];if(P!==null)P[b(3922)]=K;else for(P=K;P!==null;){if(P===l){P=null;break}if(K=P[b(1263)],K!==null){K.return=P[b(3922)],P=K;break}P=P[b(3922)]}K=P}rt(a,l,W[b(1352)],u),l=l[b(1367)]}return l;case 9:return W=l[b(3505)],y=l[b(2343)].children,OI(l,u),W=Ig(W),y=y(W),l[b(2436)]|=1,rt(a,l,y,u),l[b(1367)];case 14:return y=l[b(3505)],W=vg(y,l[b(2343)]),W=vg(y[b(3505)],W),k9(a,l,y,W,u);case 15:return T9(a,l,l[b(3505)],l.pendingProps,u);case 17:return y=l[b(3505)],W=l[b(2343)],W=l[b(1992)]===y?W:vg(y,W),a!==null&&(a[b(641)]=null,l.alternate=null,l[b(2436)]|=2),l[b(3795)]=1,Ux(y)?(a=!0,Oi(l)):a=!1,OI(l,u),n9(l,y,W),cd(l,y,W,u),wd(null,l,y,!0,a,u);case 19:return $9(a,l,u);case 22:return J9(a,l,u)}throw Error(o(156,l.tag))};function pm(a,l){return j2(a,l)}function ew(a,l,u,b){const y=e;this[y(3795)]=a,this.key=u,this[y(1263)]=this.child=this[y(3922)]=this.stateNode=this.type=this[y(1992)]=null,this[y(587)]=0,this[y(3786)]=null,this[y(2343)]=l,this[y(1461)]=this[y(485)]=this[y(2845)]=this.memoizedProps=null,this[y(251)]=b,this[y(1983)]=this[y(2436)]=0,this.deletions=null,this[y(3262)]=this[y(2840)]=0,this[y(641)]=null}function ag(a,l,u,b){return new ew(a,l,u,b)}function Od(a){const l=e;return a=a.prototype,!(!a||!a[l(1287)])}function tw(a){if(e(1126)===typeof a)return Od(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Z)return 11;if(a===v)return 14}return 2}function gn(a,l){const u=e;var b=a[u(641)];return b===null?(b=ag(a.tag,l,a[u(581)],a[u(251)]),b[u(1992)]=a[u(1992)],b[u(3505)]=a[u(3505)],b[u(1133)]=a[u(1133)],b[u(641)]=a,a[u(641)]=b):(b[u(2343)]=l,b[u(3505)]=a[u(3505)],b[u(2436)]=0,b[u(1983)]=0,b[u(2716)]=null),b.flags=a[u(2436)]&14680064,b[u(3262)]=a.childLanes,b[u(2840)]=a[u(2840)],b[u(1367)]=a[u(1367)],b[u(2990)]=a[u(2990)],b[u(485)]=a[u(485)],b.updateQueue=a.updateQueue,l=a[u(1461)],b.dependencies=l===null?null:{lanes:l[u(2840)],firstContext:l[u(1401)]},b[u(1263)]=a[u(1263)],b[u(587)]=a[u(587)],b[u(3786)]=a[u(3786)],b}function Ml(a,l,u,b,y,W){const K=e;var P=2;if(b=a,K(1126)===typeof a)Od(a)&&(P=1);else if(typeof a=="string")P=5;else x:switch(a){case A:return $n(u.children,y,W,l);case d:P=8,y|=8;break;case h:return a=ag(12,u,l,y|2),a.elementType=h,a[K(2840)]=W,a;case G:return a=ag(13,u,l,y),a[K(1992)]=G,a[K(2840)]=W,a;case m:return a=ag(19,u,l,y),a[K(1992)]=m,a[K(2840)]=W,a;case w:return Ll(u,y,W,l);default:if(K(1011)===typeof a&&a!==null)switch(a[K(1596)]){case f:P=10;break x;case B:P=9;break x;case Z:P=11;break x;case v:P=14;break x;case p:P=16,b=null;break x}throw Error(o(130,a==null?a:typeof a,""))}return l=ag(P,u,l,y),l[K(1992)]=a,l.type=b,l[K(2840)]=W,l}function $n(a,l,u,b){const y=e;return a=ag(7,a,b,l),a[y(2840)]=u,a}function Ll(a,l,u,b){const y=e;return a=ag(22,a,b,l),a[y(1992)]=w,a[y(2840)]=u,a[y(1133)]={},a}function qd(a,l,u){const b=e;return a=ag(6,a,null,l),a[b(2840)]=u,a}function $d(a,l,u){const b=e;return l=ag(4,a[b(1352)]!==null?a.children:[],a[b(581)],l),l[b(2840)]=u,l[b(1133)]={containerInfo:a[b(1951)],pendingChildren:null,implementation:a[b(854)]},l}function gw(a,l,u,b,y){const W=e;this[W(3795)]=l,this[W(1951)]=a,this[W(1852)]=this[W(901)]=this[W(1895)]=this[W(1780)]=null,this.timeoutHandle=bx,this[W(652)]=this[W(3032)]=this.context=null,this[W(2858)]=0,this[W(504)]=q2(0),this[W(3593)]=q2(-1),this[W(3580)]=this[W(3046)]=this[W(583)]=this[W(2330)]=this[W(3632)]=this[W(824)]=this[W(294)]=0,this[W(154)]=q2(0),this[W(1260)]=b,this[W(973)]=y,y0&&(this[W(1526)]=null)}function Bm(a,l,u,b,y,W,K,P,s0){const p0=e;return a=new gw(a,l,u,P,s0),l===1?(l=1,W===!0&&(l|=8)):l=0,W=ag(3,null,null,l),a[p0(1895)]=W,W[p0(1133)]=a,W[p0(485)]={element:b,isDehydrated:u,cache:null,transitions:null},sd(W),a}function Zm(a){const l=e;if(!a)return Fx;a=a[l(1525)];x:{if(Y(a)!==a||a[l(3795)]!==1)throw Error(o(170));var u=a;do{switch(u.tag){case 3:u=u[l(1133)][l(3246)];break x;case 1:if(Ux(u[l(3505)])){u=u[l(1133)][l(3606)];break x}}u=u.return}while(u!==null);throw Error(o(171))}if(a.tag===1){var b=a.type;if(Ux(b))return at(a,b,u)}return u}function ym(a){const l=e;var u=a[l(1525)];if(u===void 0)throw typeof a[l(948)]=="function"?Error(o(188)):(a=Object[l(958)](a).join(","),Error(o(268,a)));return a=O(u),a===null?null:a[l(1133)]}function vm(a,l){const u=e;if(a=a.memoizedState,a!==null&&a[u(772)]!==null){var b=a[u(169)];a[u(169)]=b!==0&&b<l?b:l}}function jd(a,l){const u=e;vm(a,l),(a=a[u(641)])&&vm(a,l)}function iw(a){const l=e;return a=O(a),a===null?null:a[l(1133)]}function nw(){return null}return t[e(2395)]=function(a){if(a[e(3795)]===13){var u=dt();lg(a,134217728,u),jd(a,134217728)}},t[e(519)]=function(a){if(a[e(3795)]===13){var u=dt(),b=en(a);lg(a,b,u),jd(a,b)}},t.attemptSynchronousHydration=function(a){const l=e;switch(a[l(3795)]){case 3:var u=a.stateNode;if(u[l(1895)][l(485)].isDehydrated){var b=So(u[l(294)]);b!==0&&($2(u,b|1),Rt(u,Ye()),!(wx&6)&&(Is(),Pg()))}break;case 13:var y=dt();dm(function(){return lg(a,1,y)}),jd(a,1)}},t[e(3628)]=function(a,l){var u=wx;wx|=1;try{return a(l)}finally{wx=u,wx===0&&(Is(),jC&&Pg())}},t.createComponentSelector=function(a){return{$$typeof:yl,value:a}},t[e(2069)]=function(a,l,u,b,y,W,K){return Bm(a,l,!1,null,u,b,y,W,K)},t.createHasPseudoClassSelector=function(a){return{$$typeof:vl,value:a}},t[e(2599)]=function(a,l,u,b,y,W,K,P,s0){const p0=e;return a=Bm(u,b,!0,a,y,W,K,P,s0),a[p0(3246)]=Zm(null),u=a.current,b=dt(),y=en(u),W=bi(b,y),W.callback=l??null,$i(u,W),a[p0(1895)][p0(2840)]=y,Xo(a,y,b),Rt(a,b),a},t[e(1130)]=function(a,l,u){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:a,containerInfo:l,implementation:u}},t.createRoleSelector=function(a){return{$$typeof:Wl,value:a}},t[e(1671)]=function(a){return{$$typeof:wl,value:a}},t[e(468)]=function(a){return{$$typeof:Rl,value:a}},t[e(732)]=function(a){const l=e;var u=kx,b=be[l(1691)];try{return be[l(1691)]=null,kx=16,a()}finally{kx=u,be[l(1691)]=b}},t[e(1164)]=function(a,l,u,b,y){const W=e;var K=kx,P=be.transition;try{return be[W(1691)]=null,kx=1,a(l,u,b,y)}finally{kx=K,be[W(1691)]=P,wx===0&&Is()}},t[e(3158)]=Md,t[e(3993)]=function(a,l){const u=e;if(!R)throw Error(o(363));l=Md(a,l),a=[];for(var b=0;b<l[u(2989)];b++)a[u(3330)](F(l[b]));for(l=a[u(2989)]-1;0<l;l--){b=a[l];for(var y=b.x,W=y+b[u(2315)],K=b.y,P=K+b[u(2741)],s0=l-1;0<=s0;s0--)if(l!==s0){var p0=a[s0],z0=p0.x,q0=z0+p0[u(2315)],mx=p0.y,rx=mx+p0.height;if(y>=z0&&K>=mx&&W<=q0&&P<=rx){a[u(2960)](l,1);break}else if(y!==z0||b.width!==p0[u(2315)]||rx<K||mx>P){if(!(K!==mx||b[u(2741)]!==p0[u(2741)]||q0<y||z0>W)){z0>y&&(p0.width+=z0-y,p0.x=y),q0<W&&(p0[u(2315)]=W-z0),a[u(2960)](l,1);break}}else{mx>K&&(p0[u(2741)]+=mx-K,p0.y=K),rx<P&&(p0[u(2741)]=P-mx),a[u(2960)](l,1);break}}}return a},t.findHostInstance=ym,t.findHostInstanceWithNoPortals=function(a){const l=e;return a=H(a),a=a!==null?z(a):null,a===null?null:a[l(1133)]},t[e(1994)]=function(a){return ym(a)},t[e(2784)]=function(a){const l=e;var u=wx;wx|=1;var b=be[l(1691)],y=kx;try{be[l(1691)]=null,kx=1,a()}finally{kx=y,be[l(1691)]=b,wx=u,wx===0&&(Is(),Pg())}},t[e(190)]=qn,t[e(1753)]=dm,t[e(3841)]=function(a,l){const u=e;if(!R)throw Error(o(363));for(a=Nd(a),l=lm(a,l),l=Array[u(3803)](l),a=0;a<l[u(2989)];){var b=l[a++];if(!d0(b)){if(b[u(3795)]===5&&j0(b[u(1133)]))return!0;for(b=b[u(1367)];b!==null;)l.push(b),b=b[u(1263)]}}return!1},t[e(1923)]=function(){return kx},t[e(2476)]=function(a,l){const u=e;if(!R)throw Error(o(363));var b=0,y=[];a=[Nd(a),0];for(var W=0;W<a.length;){var K=a[W++],P=a[W++],s0=l[P];if((K.tag!==5||!d0(K))&&(Fd(K,s0)&&(y[u(3330)](zd(s0)),P++,P>b&&(b=P)),P<l[u(2989)]))for(K=K[u(1367)];K!==null;)a[u(3330)](K,P),K=K.sibling}if(b<l[u(2989)]){for(a=[];b<l[u(2989)];b++)a[u(3330)](zd(l[b]));return`findAllNodes was able to match part of the selector:
  `+(y[u(1812)](u(2338))+u(2771))+a[u(1812)](" > ")}return null},t[e(3647)]=function(a){const l=e;if(a=a[l(1895)],!a[l(1367)])return null;switch(a[l(1367)][l(3795)]){case 5:return f0(a[l(1367)][l(1133)]);default:return a.child[l(1133)]}},t[e(2232)]=function(a){const l=e;if(a={bundleType:a.bundleType,version:a[l(1450)],rendererPackageName:a[l(1686)],rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c[l(2147)],findHostInstanceByFiber:iw,findFiberByHostInstance:a[l(2619)]||nw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:l(3842)},l(1797)===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)a=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u[l(284)])a=!0;else{try{$C=u[l(1722)](a),Dg=u}catch{}a=!!u.checkDCE}}return a},t[e(1507)]=function(){return!1},t.observeVisibleRects=function(a,l,u,b){if(!R)throw Error(o(363));a=Md(a,l);var y=L0(a,u,b).disconnect;return{disconnect:function(){y()}}},t[e(3017)]=function(a,l){const u=e;var b=l[u(3797)];b=b(l._source),a[u(1526)]==null?a[u(1526)]=[l,b]:a[u(1526)].push(l,b)},t[e(3703)]=function(a,l){var u=kx;try{return kx=a,l()}finally{kx=u}},t.shouldError=function(){return null},t[e(2293)]=function(){return!1},t[e(1701)]=function(a,l,u,b){const y=e;var W=l[y(1895)],K=dt(),P=en(W);return u=Zm(u),l[y(3246)]===null?l[y(3246)]=u:l[y(3032)]=u,l=bi(K,P),l.payload={element:a},b=b===void 0?null:b,b!==null&&(l.callback=b),$i(W,l),a=lg(W,P,K),a!==null&&gl(a,W,P),P},t};X3.exports=N4;var F4=X3[I(2129)];const z4=iZ(F4),Qf={},M4=i=>void Object[I(1859)](Qf,i);function L4(i,x){const e=I;function t(A,{args:d=[],attach:h,...f},B){const Z=i0;let G=""+A[0][Z(3773)]()+A[Z(1226)](1),m;if(A===Z(1231)){if(f[Z(1011)]===void 0)throw new Error(Z(2459));const v=f[Z(1011)];m=Xs(v,{type:A,root:B,attach:h,primitive:!0})}else{const v=Qf[G];if(!v)throw new Error("R3F: "+G+Z(683));if(!Array[Z(1987)](d))throw new Error(Z(2150));m=Xs(new v(...d),{type:A,root:B,attach:h,memoizedProps:{args:d}})}return m[Z(3730)][Z(3754)]===void 0&&(m[Z(956)]?m.__r3f[Z(3754)]="geometry":m[Z(730)]&&(m[Z(3730)][Z(3754)]="material")),G!==Z(1722)&&fu(m,f),m}function g(A,d){const h=i0;let f=!1;if(d){var B,Z;(B=d[h(3730)])!=null&&B.attach?hu(A,d,d.__r3f[h(3754)]):d[h(3985)]&&A[h(3985)]&&(A.add(d),f=!0),f||(Z=A[h(3730)])==null||Z.objects.push(d),d[h(3730)]||Xs(d,{}),d[h(3730)].parent=A,Ah(d),Ys(d)}}function n(A,d,h){const f=i0;let B=!1;if(d){var Z,G;if((Z=d[f(3730)])!=null&&Z.attach)hu(A,d,d[f(3730)][f(3754)]);else if(d[f(3985)]&&A.isObject3D){d[f(1064)]=A,d[f(1457)]({type:f(118)}),A.dispatchEvent({type:"childadded",child:d});const m=A[f(1352)][f(1095)](p=>p!==d),v=m[f(2377)](h);A[f(1352)]=[...m[f(1226)](0,v),d,...m.slice(v)],B=!0}B||(G=A[f(3730)])==null||G[f(1143)][f(3330)](d),d[f(3730)]||Xs(d,{}),d[f(3730)][f(1064)]=A,Ah(d),Ys(d)}}function s(A,d,h=!1){const f=i0;A&&[...A][f(1599)](B=>o(d,B,h))}function o(A,d,h){const f=i0;if(d){var B,Z,G;if(d[f(3730)]&&(d[f(3730)].parent=null),(B=A[f(3730)])!=null&&B[f(1143)]&&(A[f(3730)][f(1143)]=A.__r3f[f(1143)][f(1095)](V=>V!==d)),(Z=d[f(3730)])!=null&&Z[f(3754)])pB(A,d,d[f(3730)][f(3754)]);else if(d[f(3985)]&&A.isObject3D){var m;A[f(2208)](d),(m=d[f(3730)])!=null&&m.root&&D4(vr(d),d)}const p=(G=d[f(3730)])==null?void 0:G[f(1231)],w=!p&&(h===void 0?d[f(1439)]!==null:h);if(!p){var v;s((v=d[f(3730)])==null?void 0:v[f(1143)],d,w),s(d[f(1352)],d,w)}if(delete d[f(3730)],w&&d[f(1439)]&&d[f(3505)]!==f(3199)){const V=()=>{const N=f;try{d[N(1439)]()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?rh[f(3790)](rh.unstable_IdlePriority,V):V()}Ys(A)}}function c(A,d,h,f){const B=i0;var Z;const G=(Z=A[B(3730)])==null?void 0:Z.parent;if(!G)return;const m=t(d,h,A[B(3730)][B(1871)]);if(A[B(1352)]){for(const v of A[B(1352)])v[B(3730)]&&g(m,v);A[B(1352)]=A[B(1352)][B(1095)](v=>!v[B(3730)])}A.__r3f[B(1143)].forEach(v=>g(m,v)),A.__r3f.objects=[],!A[B(3730)][B(1647)]&&o(G,A),m[B(1064)]&&(m[B(3730)].autoRemovedBeforeAppend=!0),g(G,m),m[B(785)]&&m[B(3730)].eventCount&&vr(m)[B(312)]()[B(494)][B(415)][B(3330)](m),[f,f[B(641)]][B(1599)](v=>{const p=B;v!==null&&(v[p(1133)]=m,v[p(3786)]&&(typeof v[p(3786)]===p(1126)?v[p(3786)](m):v.ref[p(1895)]=m))})}const C=()=>{};return{reconciler:z4({createInstance:t,removeChild:o,appendChild:g,appendInitialChild:g,insertBefore:n,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(A,d)=>{const h=i0;if(!d)return;const f=A.getState().scene;f[h(3730)]&&(f[h(3730)][h(1871)]=A,g(f,d))},removeChildFromContainer:(A,d)=>{const h=i0;d&&o(A.getState()[h(1419)],d)},insertInContainerBefore:(A,d,h)=>{const f=i0;if(!d||!h)return;const B=A[f(312)]()[f(1419)];B.__r3f&&n(B,d,h)},getRootHostContext:()=>null,getChildHostContext:A=>A,finalizeInitialChildren(A){const d=i0;var h;return!!((h=A==null?void 0:A[d(3730)])!=null?h:{})[d(3680)]},prepareUpdate(A,d,h,f){const B=i0;var Z;if(((Z=A==null?void 0:A[B(3730)])!=null?Z:{})[B(1231)]&&f[B(1011)]&&f[B(1011)]!==A)return[!0];{const{args:m=[],children:v,...p}=f,{args:w=[],children:V,...N}=h;if(!Array.isArray(m))throw new Error(B(784));if(m[B(2995)]((M,Y)=>M!==w[Y]))return[!0];const X=k3(A,p,N,!0);return X[B(1020)].length?[!1,X]:null}},commitUpdate(A,[d,h],f,B,Z,G){d?c(A,f,Z,G):fu(A,h)},commitMount(A,d,h,f){const B=i0;var Z;const G=(Z=A[B(3730)])!=null?Z:{};A[B(785)]&&G[B(3680)]&&G[B(607)]&&vr(A)[B(312)]().internal.interaction[B(3330)](A)},getPublicInstance:A=>A,prepareForCommit:()=>null,preparePortalMount:A=>Xs(A[e(312)]().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(A){const d=e;var h;const{attach:f,parent:B}=(h=A[d(3730)])!=null?h:{};f&&B&&pB(B,A,f),A[d(3985)]&&(A.visible=!1),Ys(A)},unhideInstance(A,d){const h=e;var f;const{attach:B,parent:Z}=(f=A[h(3730)])!=null?f:{};B&&Z&&hu(Z,A,B),(A[h(3985)]&&d.visible==null||d[h(2548)])&&(A[h(2548)]=!0),Ys(A)},createTextInstance:C,hideTextInstance:C,unhideTextInstance:C,getCurrentEventPriority:()=>x?x():$s[e(3686)],beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance!==e(1797)&&ee[e(2835)](performance.now)?performance.now:ee[e(2835)](Date.now)?Date.now:()=>0,scheduleTimeout:ee[e(2835)](setTimeout)?setTimeout:void 0,cancelTimeout:ee[e(2835)](clearTimeout)?clearTimeout:void 0}),applyProps:fu}}var hB,fB;const bu=i=>"colorSpace"in i||"outputColorSpace"in i,H3=()=>{const i=I;var x;return(x=Qf[i(3086)])!=null?x:null},N3=i=>i&&i.isOrthographicCamera,k4=i=>i&&i.hasOwnProperty(I(1895)),EC=typeof window!==I(1797)&&((hB=window[I(2597)])!=null&&hB[I(2171)]||((fB=window[I(285)])==null?void 0:fB.product)===I(2570))?_0[I(3612)]:_0.useEffect;function F3(i){const x=I,e=_0[x(1576)](i);return EC(()=>void(e[x(1895)]=i),[i]),e}function T4({set:i}){return EC(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}class z3 extends _0[I(1789)]{constructor(...x){const e=I;super(...x),this[e(704)]={error:!1}}[I(384)](x){const e=I;this[e(3105)][e(298)](x)}[I(948)](){const x=I;return this.state[x(2963)]?null:this[x(3105)].children}}z3.getDerivedStateFromError=()=>({error:!0});const M3=I(770),mB=new Map,J4=i=>i&&!!i[I(2679)]&&!!i[I(1020)];function L3(i){const x=I;var e;const t=typeof window!==x(1797)?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math[x(1410)](Math[x(1971)](i[0],t),i[1]):i}const bc=i=>{const x=I;var e;return(e=i[x(3730)])==null?void 0:e[x(1871)][x(312)]()};function vr(i){const x=I;let e=i[x(3730)].root;for(;e[x(312)]()[x(2738)];)e=e[x(312)]()[x(2738)];return e}const ee={obj:i=>i===Object(i)&&!ee.arr(i)&&typeof i!="function",fun:i=>typeof i===I(1126),str:i=>typeof i===I(3674),num:i=>typeof i=="number",boo:i=>typeof i===I(3889),und:i=>i===void 0,arr:i=>Array[I(1987)](i),equ(i,x,{arrays:e="shallow",objects:t=I(3139),strict:g=!0}={}){const n=I;if(typeof i!=typeof x||!!i!=!!x)return!1;if(ee[n(2909)](i)||ee[n(3839)](i)||ee.boo(i))return i===x;const s=ee.obj(i);if(s&&t===n(3139))return i===x;const o=ee[n(838)](i);if(o&&e===n(3139))return i===x;if((o||s)&&i===x)return!0;let c;for(c in i)if(!(c in x))return!1;if(s&&e===n(2270)&&t==="shallow"){for(c in g?x:i)if(!ee[n(1839)](i[c],x[c],{strict:g,objects:n(3139)}))return!1}else for(c in g?x:i)if(i[c]!==x[c])return!1;if(ee.und(c)){if(o&&i[n(2989)]===0&&x.length===0||s&&Object.keys(i)[n(2989)]===0&&Object[n(958)](x)[n(2989)]===0)return!0;if(i!==x)return!1}return!0}};function E4(i){const x=I;i.dispose&&i[x(3505)]!=="Scene"&&i[x(1439)]();for(const e in i)e.dispose==null||e[x(1439)](),delete i[e]}function Xs(i,x){const e=i;return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...x},i}function dh(i,x){const e=I;let t=i;if(x[e(3532)]("-")){const g=x.split("-"),n=g[e(3604)]();return t=g[e(1089)]((s,o)=>s[o],i),{target:t,key:n}}else return{target:t,key:x}}const GB=/-\d+$/;function hu(i,x,e){const t=I;if(ee[t(2909)](e)){if(GB.test(e)){const s=e[t(333)](GB,""),{target:o,key:c}=dh(i,s);Array[t(1987)](o[c])||(o[c]=[])}const{target:g,key:n}=dh(i,e);x[t(3730)][t(450)]=g[n],g[n]=x}else x[t(3730)][t(450)]=e(i,x)}function pB(i,x,e){const t=I;var g,n;if(ee.str(e)){const{target:s,key:o}=dh(i,e),c=x[t(3730)].previousAttach;c===void 0?delete s[o]:s[o]=c}else(g=x[t(3730)])==null||g[t(450)]==null||g[t(450)](i,x);(n=x[t(3730)])==null||delete n[t(450)]}function k3(i,{children:x,key:e,ref:t,...g},{children:n,key:s,ref:o,...c}={},C=!1){const r=I,A=i[r(3730)],d=Object[r(3537)](g),h=[];if(C){const B=Object[r(958)](c);for(let Z=0;Z<B[r(2989)];Z++)g[r(3631)](B[Z])||d[r(1907)]([B[Z],M3+r(2208)])}d[r(1599)](([B,Z])=>{const G=r;var m;if((m=i[G(3730)])!=null&&m[G(1231)]&&B==="object"||ee[G(1839)](Z,c[B]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/[G(3633)](B))return h[G(3330)]([B,Z,!0,[]]);let v=[];B[G(3532)]("-")&&(v=B[G(2874)]("-")),h[G(3330)]([B,Z,!1,v]);for(const p in g){const w=g[p];p.startsWith(B+"-")&&h[G(3330)]([p,w,!1,p[G(2874)]("-")])}});const f={...g};return A!=null&&A.memoizedProps&&A!=null&&A[r(2990)][r(3283)]&&(f[r(3283)]=A.memoizedProps.args),A!=null&&A[r(2990)]&&A!=null&&A[r(2990)][r(3754)]&&(f[r(3754)]=A[r(2990)].attach),{memoized:f,changes:h}}function fu(i,x){const e=I;var t;const g=i[e(3730)],n=g==null?void 0:g[e(1871)],s=n==null||n[e(312)]==null?void 0:n[e(312)](),{memoized:o,changes:c}=J4(x)?x:k3(i,x),C=g==null?void 0:g[e(607)];i.__r3f&&(i[e(3730)][e(2990)]=o);for(let h=0;h<c.length;h++){let[f,B,Z,G]=c[h];if(bu(i)){const w="srgb",V="srgb-linear";f===e(2335)?(f=e(1549),B=B===3001?w:V):f===e(236)&&(f=e(3930),B=B===3001?w:V)}let m=i,v=m[f];if(G.length&&(v=G[e(1089)]((p,w)=>p[w],i),!(v&&v[e(298)]))){const[p,...w]=G[e(3399)]();m=w[e(3399)]()[e(1089)]((V,N)=>V[N],i),f=p}if(B===M3+e(2208))if(m.constructor){let p=mB[e(2695)](m[e(135)]);!p&&(p=new m[e(135)],mB.set(m[e(135)],p)),B=p[f]}else B=0;if(Z&&g)B?g.handlers[f]=B:delete g[e(3680)][f],g.eventCount=Object.keys(g[e(3680)])[e(2989)];else if(v&&v[e(298)]&&(v[e(1493)]||v instanceof KI)){if(Array[e(1987)](B))v[e(2793)]?v[e(2793)](B):v[e(298)](...B);else if(v.copy&&B&&B.constructor&&v[e(135)]===B[e(135)])v[e(1493)](B);else if(B!==void 0){var r;const p=(r=v)==null?void 0:r[e(1892)];!p&&v.setScalar?v[e(3319)](B):v instanceof KI&&B instanceof KI?v[e(829)]=B[e(829)]:v[e(298)](B),!H3()&&s&&!s[e(1953)]&&p&&v[e(2068)]()}}else{var A;if(m[f]=B,(A=m[f])!=null&&A[e(3984)]&&m[f][e(3207)]===zt&&m[f].type===di&&s){const p=m[f];bu(p)&&bu(s.gl)?p[e(1549)]=s.gl[e(3930)]:p[e(2335)]=s.gl.outputEncoding}}Ys(i)}if(g&&g[e(1064)]&&i[e(785)]&&C!==g.eventCount){const h=vr(i)[e(312)]().internal,f=h[e(415)][e(2377)](i);f>-1&&h[e(415)][e(2960)](f,1),g[e(607)]&&h[e(415)][e(3330)](i)}return!(c[e(2989)]===1&&c[0][0]===e(1581))&&c.length&&(t=i[e(3730)])!=null&&t[e(1064)]&&Ah(i),i}function Ys(i){const x=I;var e,t;const g=(e=i[x(3730)])==null||(t=e[x(1871)])==null||t[x(312)]==null?void 0:t.getState();g&&g[x(494)][x(1162)]===0&&g[x(3971)]()}function Ah(i){const x=I;i[x(1581)]==null||i[x(1581)](i)}function U4(i,x){const e=I;!i[e(1841)]&&(N3(i)?(i[e(2881)]=x.width/-2,i[e(1913)]=x[e(2315)]/2,i[e(2058)]=x.height/2,i.bottom=x[e(2741)]/-2):i[e(3455)]=x[e(2315)]/x[e(2741)],i[e(3947)](),i[e(3554)]())}function ja(i){const x=I;return(i.eventObject||i[x(1011)])[x(296)]+"/"+i[x(587)]+i[x(1280)]}function _4(){const i=I;var x;const e=typeof self!==i(1797)&&self||typeof window!==i(1797)&&window;if(!e)return $s[i(3686)];switch((x=e[i(1751)])==null?void 0:x[i(3505)]){case i(1115):case i(2810):case i(2263):case i(1783):case"pointerdown":case i(269):return $s[i(2707)];case i(1693):case i(2696):case i(3441):case"pointerenter":case i(3535):case i(1785):return $s[i(1806)];default:return $s[i(3686)]}}function T3(i,x,e,t){const g=I,n=e[g(2695)](x);n&&(e[g(1432)](x),e[g(1019)]===0&&(i[g(1432)](t),n[g(2930)].releasePointerCapture(t)))}function D4(i,x){const e=I,{internal:t}=i[e(312)]();t.interaction=t[e(415)].filter(g=>g!==x),t[e(2312)]=t[e(2312)].filter(g=>g!==x),t[e(1349)][e(1599)]((g,n)=>{const s=e;(g.eventObject===x||g.object===x)&&t[s(1349)][s(1432)](n)}),t[e(3668)][e(1599)]((g,n)=>{T3(t[e(3668)],x,g,n)})}function Q4(i){function x(c){const C=i0,{internal:r}=i[C(312)](),A=c[C(2119)]-r[C(3662)][0],d=c[C(3450)]-r[C(3662)][1];return Math.round(Math[C(3641)](A*A+d*d))}function e(c){const C=i0;return c[C(1095)](r=>["Move",C(848),"Enter",C(1782),C(2005)][C(2995)](A=>{const d=C;var h;return(h=r[d(3730)])==null?void 0:h[d(3680)][d(3470)+A]}))}function t(c,C){const r=i0,A=i.getState(),d=new Set,h=[],f=C?C(A[r(494)][r(415)]):A[r(494)][r(415)];for(let m=0;m<f[r(2989)];m++){const v=bc(f[m]);v&&(v.raycaster[r(240)]=void 0)}!A[r(2738)]&&(A.events[r(3975)]==null||A[r(1827)][r(3975)](c,A));function B(m){const v=r,p=bc(m);if(!p||!p.events[v(2648)]||p[v(816)].camera===null)return[];if(p[v(816)][v(240)]===void 0){var w;p[v(1827)][v(3975)]==null||p[v(1827)].compute(c,p,(w=p[v(2738)])==null?void 0:w.getState()),p[v(816)].camera===void 0&&(p.raycaster.camera=null)}return p[v(816)].camera?p[v(816)][v(1921)](m,!0):[]}let Z=f[r(1204)](B)[r(3609)]((m,v)=>{const p=r,w=bc(m[p(1011)]),V=bc(v[p(1011)]);return!w||!V?m[p(3035)]-v[p(3035)]:V[p(1827)][p(668)]-w[p(1827)].priority||m[p(3035)]-v[p(3035)]})[r(1095)](m=>{const v=r,p=ja(m);return d[v(2489)](p)?!1:(d.add(p),!0)});A.events[r(1095)]&&(Z=A[r(1827)].filter(Z,A));for(const m of Z){let v=m.object;for(;v;){var G;(G=v[r(3730)])!=null&&G.eventCount&&h[r(3330)]({...m,eventObject:v}),v=v.parent}}if("pointerId"in c&&A[r(494)].capturedMap[r(2489)](c.pointerId))for(let m of A[r(494)].capturedMap[r(2695)](c[r(220)])[r(2326)]())d[r(2489)](ja(m.intersection))||h[r(3330)](m[r(2151)]);return h}function g(c,C,r,A){const d=i0,h=i[d(312)]();if(c.length){const f={stopped:!1};for(const B of c){const Z=bc(B[d(1011)])||h,{raycaster:G,pointer:m,camera:v,internal:p}=Z,w=new E(m.x,m.y,0)[d(1230)](v),V=S=>{const H=d;var O,I0;return(O=(I0=p[H(3668)].get(S))==null?void 0:I0.has(B[H(3960)]))!=null?O:!1},N=S=>{const H=d,O={intersection:B,target:C[H(2930)]};p[H(3668)][H(2489)](S)?p[H(3668)][H(2695)](S)[H(298)](B[H(3960)],O):p[H(3668)][H(298)](S,new Map([[B[H(3960)],O]])),C[H(2930)][H(2806)](S)},X=S=>{const H=d,O=p[H(3668)][H(2695)](S);O&&T3(p[H(3668)],B.eventObject,O,S)};let M={};for(let S in C){let H=C[S];typeof H!==d(1126)&&(M[S]=H)}let Y={...B,...M,pointer:m,intersections:c,stopped:f[d(1610)],delta:r,unprojectedPoint:w,ray:G[d(1253)],camera:v,stopPropagation(){const S=d,H=S(220)in C&&p.capturedMap.get(C[S(220)]);if((!H||H[S(2489)](B[S(3960)]))&&(Y[S(1610)]=f.stopped=!0,p.hovered.size&&Array[S(3803)](p[S(1349)].values())[S(3553)](O=>O.eventObject===B[S(3960)]))){const O=c[S(1226)](0,c[S(2377)](B));n([...O,B])}},target:{hasPointerCapture:V,setPointerCapture:N,releasePointerCapture:X},currentTarget:{hasPointerCapture:V,setPointerCapture:N,releasePointerCapture:X},nativeEvent:C};if(A(Y),f[d(1610)]===!0)break}}return c}function n(c){const C=i0,{internal:r}=i[C(312)]();for(const A of r[C(1349)].values())if(!c[C(2989)]||!c[C(3553)](d=>d[C(1011)]===A.object&&d.index===A[C(587)]&&d[C(1280)]===A[C(1280)])){const d=A[C(3960)],h=d[C(3730)],f=h==null?void 0:h[C(3680)];if(r[C(1349)][C(1432)](ja(A)),h!=null&&h.eventCount){const B={...A,intersections:c};f.onPointerOut==null||f[C(1048)](B),f[C(2356)]==null||f.onPointerLeave(B)}}}function s(c,C){const r=i0;for(let A=0;A<C[r(2989)];A++){const d=C[A][r(3730)];d==null||d[r(3680)][r(544)]==null||d[r(3680)].onPointerMissed(c)}}function o(c){const C=i0;switch(c){case"onPointerLeave":case C(3287):return()=>n([]);case C(1447):return r=>{const A=C,{internal:d}=i[A(312)]();"pointerId"in r&&d[A(3668)][A(2489)](r[A(220)])&&requestAnimationFrame(()=>{const h=A;d[h(3668)][h(2489)](r[h(220)])&&(d[h(3668)][h(1432)](r.pointerId),n([]))})}}return function(A){const d=C,{onPointerMissed:h,internal:f}=i[d(312)]();f[d(1140)].current=A;const B=c===d(1702),Z=c===d(2834)||c==="onContextMenu"||c===d(3576),G=B?e:void 0,m=t(A,G),v=Z?x(A):0;c==="onPointerDown"&&(f[d(3662)]=[A[d(2119)],A[d(3450)]],f[d(2312)]=m[d(3879)](w=>w[d(3960)])),Z&&!m[d(2989)]&&v<=2&&(s(A,f.interaction),h&&h(A)),B&&n(m);function p(w){const V=d,N=w[V(3960)],X=N.__r3f,M=X==null?void 0:X[V(3680)];if(X!=null&&X[V(607)])if(B){if(M[V(1960)]||M[V(3111)]||M[V(1048)]||M[V(2356)]){const Y=ja(w),S=f[V(1349)][V(2695)](Y);S?S[V(1610)]&&w.stopPropagation():(f.hovered[V(298)](Y,w),M.onPointerOver==null||M.onPointerOver(w),M[V(3111)]==null||M[V(3111)](w))}M[V(1702)]==null||M.onPointerMove(w)}else{const Y=M[c];Y?(!Z||f[V(2312)][V(3532)](N))&&(s(A,f[V(415)][V(1095)](S=>!f[V(2312)][V(3532)](S))),Y(w)):Z&&f[V(2312)].includes(N)&&s(A,f[V(415)][V(1095)](S=>!f[V(2312)][V(3532)](S)))}}g(m,A,v,p)}}return{handlePointer:o}}const J3=i=>!!(i!=null&&i[I(948)]),E3=_0.createContext(null),P4=(i,x)=>{const e=I,t=X4((c,C)=>{const r=i0,A=new E,d=new E,h=new E;function f(v=C().camera,p=d,w=C()[r(1019)]){const V=r,{width:N,height:X,top:M,left:Y}=w,S=N/X;p[V(2752)]?h.copy(p):h[V(298)](...p);const H=v[V(3713)](A).distanceTo(h);if(N3(v))return{width:N/v[V(3981)],height:X/v.zoom,top:M,left:Y,factor:1,distance:H,aspect:S};{const O=v[V(1302)]*Math.PI/180,I0=2*Math[V(1597)](O/2)*H,z=I0*(N/X);return{width:z,height:I0,top:M,left:Y,factor:N/z,distance:H,aspect:S}}}let B;const Z=v=>c(p=>({performance:{...p[r(932)],current:v}})),G=new S0;return{set:c,get:C,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>i(C(),v),advance:(v,p)=>x(v,p,C()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Ef,pointer:G,mouse:G,frameloop:r(836),onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=r,p=C();B&&clearTimeout(B),p[v(932)][v(1895)]!==p[v(932)][v(1410)]&&Z(p[v(932)][v(1410)]),B=setTimeout(()=>Z(C()[v(932)][v(1971)]),p.performance[v(1369)])}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:f},setEvents:v=>c(p=>({...p,events:{...p[r(1827)],...v}})),setSize:(v,p,w,V,N)=>{const X=r,M=C()[X(240)],Y={width:v,height:p,top:V||0,left:N||0,updateStyle:w};c(S=>({size:Y,viewport:{...S.viewport,...f(M,d,Y)}}))},setDpr:v=>c(p=>{const w=r,V=L3(v);return{viewport:{...p.viewport,dpr:V,initialDpr:p.viewport[w(3164)]||V}}}),setFrameloop:(v=r(836))=>{const p=r,w=C()[p(174)];w.stop(),w[p(1828)]=0,v!=="never"&&(w[p(3988)](),w[p(1828)]=0),c(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:_0.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,p,w)=>{const V=r,N=C().internal;return N[V(668)]=N[V(668)]+(p>0?1:0),N.subscribers[V(3330)]({ref:v,priority:p,store:w}),N[V(556)]=N.subscribers[V(3609)]((X,M)=>X[V(668)]-M[V(668)]),()=>{const X=V,M=C()[X(494)];M!=null&&M[X(556)]&&(M[X(668)]=M[X(668)]-(p>0?1:0),M.subscribers=M[X(556)][X(1095)](Y=>Y.ref!==v))}}}}}),g=t[e(312)]();let n=g.size,s=g[e(1310)][e(3715)],o=g[e(240)];return t[e(2914)](()=>{const c=e,{camera:C,size:r,viewport:A,gl:d,set:h}=t[c(312)]();if(r[c(2315)]!==n[c(2315)]||r[c(2741)]!==n[c(2741)]||A[c(3715)]!==s){var f;n=r,s=A[c(3715)],U4(C,r),d[c(3261)](A[c(3715)]);const B=(f=r.updateStyle)!=null?f:typeof HTMLCanvasElement!==c(1797)&&d.domElement instanceof HTMLCanvasElement;d[c(2614)](r[c(2315)],r[c(2741)],B)}C!==o&&(o=C,h(B=>({viewport:{...B[c(1310)],...B[c(1310)][c(2631)](C)}})))}),t.subscribe(c=>i(c)),t};let xr,O4=new Set,q4=new Set,$4=new Set;function mu(i,x){const e=I;if(i.size)for(const{callback:t}of i[e(2326)]())t(x)}function hc(i,x){const e=I;switch(i){case e(3053):return mu(O4,x);case"after":return mu(q4,x);case e(470):return mu($4,x)}}let Gu,pu;function Bu(i,x,e){const t=I;let g=x[t(174)][t(3534)]();for(x[t(3610)]===t(1700)&&typeof i===t(1025)&&(g=i-x[t(174)][t(1828)],x[t(174)][t(2116)]=x[t(174)].elapsedTime,x[t(174)][t(1828)]=i),Gu=x[t(494)][t(556)],xr=0;xr<Gu.length;xr++)pu=Gu[xr],pu[t(3786)][t(1895)](pu.store.getState(),g,e);return!x[t(494)][t(668)]&&x.gl[t(948)]&&x.gl.render(x[t(1419)],x.camera),x.internal[t(1162)]=Math.max(0,x[t(494)][t(1162)]-1),x[t(3610)]===t(836)?1:x[t(494)][t(1162)]}function j4(i){let x=!1,e=!1,t,g,n;function s(C){const r=i0;g=requestAnimationFrame(s),x=!0,t=0,hc(r(3053),C),e=!0;for(const d of i[r(2326)]()){var A;n=d[r(1728)][r(312)](),n.internal[r(2706)]&&(n.frameloop===r(836)||n[r(494)][r(1162)]>0)&&!((A=n.gl.xr)!=null&&A.isPresenting)&&(t+=Bu(C,n))}if(e=!1,hc("after",C),t===0)return hc("tail",C),x=!1,cancelAnimationFrame(g)}function o(C,r=1){const A=i0;var d;if(!C)return i.forEach(h=>o(h[A(1728)][A(312)](),r));(d=C.gl.xr)!=null&&d[A(1509)]||!C[A(494)][A(2706)]||C[A(3610)]===A(1700)||(r>1?C[A(494)][A(1162)]=Math[A(1410)](60,C[A(494)].frames+r):e?C[A(494)][A(1162)]=2:C[A(494)][A(1162)]=1,!x&&(x=!0,requestAnimationFrame(s)))}function c(C,r=!0,A,d){const h=i0;if(r&&hc(h(3053),C),A)Bu(C,A,d);else for(const f of i[h(2326)]())Bu(C,f[h(1728)][h(312)]());r&&hc(h(1093),C)}return{loop:s,invalidate:o,advance:c}}function U3(){const i=I,x=_0[i(2423)](E3);if(!x)throw new Error(i(2207));return x}function xz(i=e=>e,x){return U3()(i,x)}function ez(i,x=0){const e=I,t=U3(),g=t[e(312)]()[e(494)][e(2914)],n=F3(i);return EC(()=>g(n,x,t),[x,g,t]),null}const Go=new Map,{invalidate:BB,advance:ZB}=j4(Go),{reconciler:s2,applyProps:Vs}=L4(Go,_4),Ss={objects:I(2270),strict:!1},tz=(i,x)=>{const e=I,t=typeof i===e(1126)?i(x):i;return J3(t)?t:new Fv({powerPreference:e(1484),canvas:x,antialias:!0,alpha:!0,...i})};function gz(i,x){const e=I,t=typeof HTMLCanvasElement!==e(1797)&&i instanceof HTMLCanvasElement;if(x){const{width:g,height:n,top:s,left:o,updateStyle:c=t}=x;return{width:g,height:n,top:s,left:o,updateStyle:c}}else if(typeof HTMLCanvasElement!==e(1797)&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:g,height:n,top:s,left:o}=i[e(3150)][e(2419)]();return{width:g,height:n,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i[e(2315)],height:i[e(2741)],top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function iz(i){const x=I,e=Go[x(2695)](i),t=e==null?void 0:e[x(3312)],g=e==null?void 0:e[x(1728)];e&&console.warn("R3F.createRoot should only be called once!");const n=typeof reportError===x(1126)?reportError:console[x(2963)],s=g||P4(BB,ZB),o=t||s2[x(2069)](s,$s[x(170)],null,!1,null,"",n,null);e||Go[x(298)](i,{fiber:o,store:s});let c,C=!1,r;return{configure(A={}){const d=x;let{gl:h,size:f,scene:B,events:Z,onCreated:G,shadows:m=!1,linear:v=!1,flat:p=!1,legacy:w=!1,orthographic:V=!1,frameloop:N=d(836),dpr:X=[1,2],performance:M,raycaster:Y,camera:S,onPointerMissed:H}=A,O=s[d(312)](),I0=O.gl;O.gl||O[d(298)]({gl:I0=tz(h,i)});let z=O[d(816)];z||O[d(298)]({raycaster:z=new R3});const{params:b0,...f0}=Y||{};if(ee[d(1839)](f0,z,Ss)||Vs(z,{...f0}),ee.equ(b0,z[d(3598)],Ss)||Vs(z,{params:{...z[d(3598)],...b0}}),!O.camera||O[d(240)]===r&&!ee.equ(r,S,Ss)){r=S;const c0=S instanceof NC,h0=c0?S:V?new MC(0,0,0,0,.1,1e3):new ze(75,0,.1,1e3);c0||(h0.position.z=5,S&&(Vs(h0,S),(d(3455)in S||"left"in S||"right"in S||d(801)in S||"top"in S)&&(h0.manual=!0,h0[d(3947)]())),!O[d(240)]&&!(S!=null&&S[d(1488)])&&h0[d(2765)](0,0,0)),O.set({camera:h0}),z.camera=h0}if(!O[d(1419)]){let c0;B!=null&&B.isScene?c0=B:(c0=new Wf,B&&Vs(c0,B)),O[d(298)]({scene:Xs(c0)})}if(!O.xr){var G0;const c0=(n0,g0)=>{const l0=d,m0=s[l0(312)]();m0[l0(3610)]!==l0(1700)&&ZB(n0,!0,m0,g0)},h0=()=>{const n0=d,g0=s[n0(312)]();g0.gl.xr[n0(2648)]=g0.gl.xr[n0(1509)],g0.gl.xr[n0(2073)](g0.gl.xr.isPresenting?c0:null),g0.gl.xr[n0(1509)]||BB(g0)},X0={connect(){const n0=d,g0=s[n0(312)]().gl;g0.xr[n0(2134)](n0(2517),h0),g0.xr.addEventListener(n0(2704),h0)},disconnect(){const n0=d,g0=s[n0(312)]().gl;g0.xr.removeEventListener(n0(2517),h0),g0.xr[n0(1216)]("sessionend",h0)}};typeof((G0=I0.xr)==null?void 0:G0[d(2134)])===d(1126)&&X0[d(1222)](),O[d(298)]({xr:X0})}if(I0.shadowMap){const c0=I0[d(2001)].enabled,h0=I0.shadowMap[d(3505)];if(I0[d(2001)][d(2648)]=!!m,ee[d(3125)](m))I0[d(2001)].type=zc;else if(ee[d(2909)](m)){var $;const X0={basic:Ay,percentage:m2,soft:zc,variance:Hg};I0[d(2001)][d(3505)]=($=X0[m])!=null?$:zc}else ee[d(3746)](m)&&Object.assign(I0[d(2001)],m);(c0!==I0.shadowMap[d(2648)]||h0!==I0[d(2001)][d(3505)])&&(I0[d(2001)][d(2170)]=!0)}const j=H3();j&&(d(2648)in j?j[d(2648)]=!w:d(3832)in j&&(j.legacyMode=w)),C||Vs(I0,{outputEncoding:v?3e3:3001,toneMapping:p?ai:sf}),O[d(2104)]!==w&&O[d(298)](()=>({legacy:w})),O[d(1953)]!==v&&O.set(()=>({linear:v})),O.flat!==p&&O[d(298)](()=>({flat:p})),h&&!ee[d(2835)](h)&&!J3(h)&&!ee[d(1839)](h,I0,Ss)&&Vs(I0,h),Z&&!O[d(1827)][d(3680)]&&O[d(298)]({events:Z(s)});const x0=gz(i,f);return!ee[d(1839)](x0,O.size,Ss)&&O.setSize(x0[d(2315)],x0.height,x0.updateStyle,x0[d(2058)],x0.left),X&&O.viewport[d(3715)]!==L3(X)&&O.setDpr(X),O[d(3610)]!==N&&O[d(3332)](N),O[d(544)]||O[d(298)]({onPointerMissed:H}),M&&!ee.equ(M,O[d(932)],Ss)&&O.set(c0=>({performance:{...c0[d(932)],...M}})),c=G,C=!0,this},render(A){const d=x;return C||this[d(3575)](),s2[d(1701)](dg[d(657)](nz,{store:s,children:A,onCreated:c,rootElement:i}),o,null,()=>{}),s},unmount(){_3(i)}}}function nz({store:i,children:x,onCreated:e,rootElement:t}){const g=I;return EC(()=>{const n=i0,s=i[n(312)]();s[n(298)](o=>({internal:{...o[n(494)],active:!0}})),e&&e(s),i[n(312)]()[n(1827)].connected||s[n(1827)][n(1222)]==null||s.events[n(1222)](t)},[]),dg[g(657)](E3[g(2773)],{value:i,children:x})}function _3(i,x){const e=I,t=Go[e(2695)](i),g=t==null?void 0:t[e(3312)];if(g){const n=t==null?void 0:t[e(1728)][e(312)]();n&&(n[e(494)][e(2706)]=!1),s2.updateContainer(null,g,null,()=>{n&&setTimeout(()=>{const s=i0;try{var o,c,C,r;n[s(1827)][s(3573)]==null||n[s(1827)][s(3573)](),(o=n.gl)==null||(c=o.renderLists)==null||c[s(1439)]==null||c[s(1439)](),(C=n.gl)==null||C[s(2769)]==null||C[s(2769)](),(r=n.gl)!=null&&r.xr&&n.xr.disconnect(),E4(n),Go.delete(i)}catch{}},500)})}}s2[I(2232)]({bundleType:0,rendererPackageName:I(3280),version:_0[I(1450)]});const Zu={onClick:[I(1115),!1],onContextMenu:[I(2810),!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:[I(3178),!0],onPointerUp:[I(269),!0],onPointerLeave:[I(3535),!0],onPointerMove:[I(1693),!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:[I(1201),!0]};function Iz(i){const x=I,{handlePointer:e}=Q4(i);return{priority:1,enabled:!0,compute(t,g,n){const s=i0;g[s(902)][s(298)](t.offsetX/g[s(1019)][s(2315)]*2-1,-(t[s(3450)]/g.size[s(2741)])*2+1),g.raycaster[s(3661)](g[s(902)],g[s(240)])},connected:void 0,handlers:Object.keys(Zu)[x(1089)]((t,g)=>({...t,[g]:e(g)}),{}),update:()=>{const t=x;var g;const{events:n,internal:s}=i[t(312)]();(g=s.lastEvent)!=null&&g[t(1895)]&&n[t(3680)]&&n[t(3680)][t(1702)](s.lastEvent.current)},connect:t=>{const g=x;var n;const{set:s,events:o}=i.getState();o[g(3573)]==null||o[g(3573)](),s(c=>({events:{...c.events,connected:t}})),Object.entries((n=o[g(3680)])!=null?n:[]).forEach(([c,C])=>{const r=g,[A,d]=Zu[c];t[r(2134)](A,C,{passive:d})})},disconnect:()=>{const t=x,{set:g,events:n}=i[t(312)]();if(n.connected){var s;Object[t(3537)]((s=n[t(3680)])!=null?s:[])[t(1599)](([o,c])=>{const C=t;if(n&&n.connected instanceof HTMLElement){const[r]=Zu[o];n[C(1984)][C(1216)](r,c)}}),g(o=>({events:{...o[t(1827)],connected:void 0}}))}}}}function yB(i,x){let e;return(...t)=>{const g=i0;window[g(2873)](e),e=window[g(1267)](()=>i(...t),x)}}function sz({debounce:i,scroll:x,polyfill:e,offsetSize:t}={debounce:0,scroll:!1,offsetSize:!1}){const g=I,n=e||(typeof window==g(1797)?class{}:window[g(2994)]);if(!n)throw new Error(g(2663));const[s,o]=_0.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=_0[g(1576)]({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),C=i?typeof i=="number"?i:i[g(3234)]:null,r=i?typeof i=="number"?i:i[g(3115)]:null,A=_0[g(1576)](!1);_0[g(263)](()=>(A[g(1895)]=!0,()=>void(A.current=!1)));const[d,h,f]=_0[g(2072)](()=>{const m=()=>{const v=i0;if(!c[v(1895)][v(545)])return;const{left:p,top:w,width:V,height:N,bottom:X,right:M,x:Y,y:S}=c[v(1895)][v(545)][v(2419)](),H={left:p,top:w,width:V,height:N,bottom:X,right:M,x:Y,y:S};c[v(1895)][v(545)]instanceof HTMLElement&&t&&(H.height=c[v(1895)].element[v(1409)],H[v(2315)]=c[v(1895)][v(545)].offsetWidth),Object[v(776)](H),A[v(1895)]&&!lz(c[v(1895)][v(2122)],H)&&o(c[v(1895)].lastBounds=H)};return[m,r?yB(m,r):m,C?yB(m,C):m]},[o,t,C,r]);function B(){const m=g;c[m(1895)][m(119)]&&(c.current.scrollContainers[m(1599)](v=>v[m(1216)](m(3234),f,!0)),c[m(1895)][m(119)]=null),c.current[m(1018)]&&(c[m(1895)][m(1018)][m(3573)](),c.current[m(1018)]=null),c.current[m(1734)]&&(m(806)in screen&&m(1216)in screen[m(806)]?screen[m(806)][m(1216)](m(3848),c[m(1895)][m(1734)]):m(2397)in window&&window[m(1216)]("orientationchange",c[m(1895)][m(1734)]))}function Z(){const m=g;c[m(1895)].element&&(c[m(1895)][m(1018)]=new n(f),c[m(1895)].resizeObserver[m(2324)](c[m(1895)][m(545)]),x&&c.current.scrollContainers&&c[m(1895)][m(119)].forEach(v=>v.addEventListener(m(3234),f,{capture:!0,passive:!0})),c[m(1895)].orientationHandler=()=>{f()},"orientation"in screen&&m(2134)in screen[m(806)]?screen[m(806)][m(2134)](m(3848),c[m(1895)][m(1734)]):m(2397)in window&&window.addEventListener(m(2932),c[m(1895)].orientationHandler))}const G=m=>{const v=g;!m||m===c[v(1895)][v(545)]||(B(),c.current.element=m,c.current[v(119)]=D3(m),Z())};return cz(f,!!x),oz(h),_0[g(263)](()=>{B(),Z()},[x,f,h]),_0.useEffect(()=>B,[]),[G,s,d]}function oz(i){_0.useEffect(()=>{const x=i0,e=i;return window.addEventListener(x(3115),e),()=>void window[x(1216)]("resize",e)},[i])}function cz(i,x){const e=I;_0[e(263)](()=>{const t=e;if(x){const g=i;return window[t(2134)](t(3234),g,{capture:!0,passive:!0}),()=>void window[t(1216)](t(3234),g,!0)}},[i,x])}function D3(i){const x=I,e=[];if(!i||i===document[x(1153)])return e;const{overflow:t,overflowX:g,overflowY:n}=window.getComputedStyle(i);return[t,g,n][x(2995)](s=>s===x(261)||s===x(3234))&&e[x(3330)](i),[...e,...D3(i[x(3150)])]}const Cz=["x","y",I(2058),I(801),I(2881),I(1913),"width",I(2741)],lz=(i,x)=>Cz.every(e=>i[e]===x[e]);var az=Object[I(2899)],rz=Object.defineProperties,dz=Object[I(433)],vB=Object.getOwnPropertySymbols,Az=Object[I(1566)].hasOwnProperty,uz=Object[I(1566)][I(1129)],WB=(i,x,e)=>x in i?az(i,x,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[x]=e,wB=(i,x)=>{const e=I;for(var t in x||(x={}))Az[e(2627)](x,t)&&WB(i,t,x[t]);if(vB)for(var t of vB(x))uz[e(2627)](x,t)&&WB(i,t,x[t]);return i},bz=(i,x)=>rz(i,dz(x)),RB,VB;typeof window!==I(1797)&&((RB=window[I(2597)])!=null&&RB.createElement||((VB=window[I(285)])==null?void 0:VB[I(1496)])===I(2570))?_0.useLayoutEffect:_0[I(263)];function Q3(i,x,e){const t=I;if(!i)return;if(e(i)===!0)return i;let g=i[t(1367)];for(;g;){const n=Q3(g,x,e);if(n)return n;g=g.sibling}}function P3(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const SB=console[I(2963)];console[I(2963)]=function(){const i=I,x=[...arguments].join("");if(x!=null&&x[i(3907)](i(1571))&&x[i(3532)](i(2423))){console.error=SB;return}return SB[i(1307)](this,arguments)};const Pf=P3(_0[I(680)](null));class O3 extends _0[I(1789)]{[I(948)](){const x=I;return _0[x(2171)](Pf[x(2773)],{value:this[x(1525)]},this.props.children)}}function hz(){const i=I,x=_0[i(2423)](Pf);if(x===null)throw new Error(i(2936));const e=_0[i(850)]();return _0[i(2072)](()=>{for(const g of[x,x==null?void 0:x.alternate]){if(!g)continue;const n=Q3(g,!1,s=>{const o=i0;let c=s[o(485)];for(;c;){if(c[o(485)]===e)return!0;c=c.next}});if(n)return n}},[x,e])}function fz(){const i=I,x=hz(),[e]=_0[i(3533)](()=>new Map);e[i(3223)]();let t=x;for(;t;){if(t[i(3505)]&&typeof t[i(3505)]=="object"){const g=t[i(3505)]._context===void 0&&t[i(3505)][i(2773)]===t[i(3505)],n=g?t.type:t.type._context;n&&n!==Pf&&!e[i(2489)](n)&&e[i(298)](n,_0[i(2423)](P3(n)))}t=t.return}return e}function mz(){const i=I,x=fz();return _0.useMemo(()=>Array[i(3803)](x[i(958)]())[i(1089)]((e,t)=>g=>_0.createElement(e,null,_0[i(2171)](t.Provider,bz(wB({},g),{value:x[i(2695)](t)}))),e=>_0.createElement(O3,wB({},e))),[x])}const Gz=_0[I(2475)](function({children:x,fallback:e,resize:t,style:g,gl:n,events:s=Iz,eventSource:o,eventPrefix:c,shadows:C,linear:r,flat:A,legacy:d,orthographic:h,frameloop:f,dpr:B,performance:Z,raycaster:G,camera:m,scene:v,onPointerMissed:p,onCreated:w,...V},N){const X=I;_0[X(2072)](()=>M4(R4),[]);const M=mz(),[Y,S]=sz({scroll:!0,debounce:{scroll:50,resize:0},...t}),H=_0.useRef(null),O=_0[X(1576)](null);_0[X(3695)](N,()=>H[X(1895)]);const I0=F3(p),[z,b0]=_0.useState(!1),[f0,G0]=_0[X(3533)](!1);if(z)throw z;if(f0)throw f0;const $=_0.useRef(null);EC(()=>{const x0=X,c0=H[x0(1895)];S.width>0&&S.height>0&&c0&&($.current||($[x0(1895)]=iz(c0)),$.current.configure({gl:n,events:s,shadows:C,linear:r,flat:A,legacy:d,orthographic:h,frameloop:f,dpr:B,performance:Z,raycaster:G,camera:m,scene:v,size:S,onPointerMissed:(...h0)=>I0.current==null?void 0:I0.current(...h0),onCreated:h0=>{const X0=x0;h0[X0(1827)].connect==null||h0[X0(1827)][X0(1222)](o?k4(o)?o.current:o:O[X0(1895)]),c&&h0[X0(3899)]({compute:(n0,g0)=>{const l0=X0,m0=n0[c+"X"],M0=n0[c+"Y"];g0[l0(902)][l0(298)](m0/g0[l0(1019)][l0(2315)]*2-1,-(M0/g0[l0(1019)][l0(2741)])*2+1),g0[l0(816)][l0(3661)](g0.pointer,g0[l0(240)])}}),w==null||w(h0)}}),$[x0(1895)][x0(948)](dg[x0(657)](M,{children:dg[x0(657)](z3,{set:G0,children:dg[x0(657)](_0[x0(2066)],{fallback:dg[x0(657)](T4,{set:b0}),children:x??null})})})))}),_0[X(263)](()=>{const x0=X,c0=H[x0(1895)];if(c0)return()=>_3(c0)},[]);const j=X(o?2608:261);return dg[X(657)](X(778),{ref:O,style:{position:X(2694),width:X(2524),height:X(2524),overflow:X(2578),pointerEvents:j,...g},...V,children:dg[X(657)](X(778),{ref:Y,style:{width:X(2524),height:"100%"},children:dg[X(657)](X(2359),{ref:H,style:{display:X(3265)},children:e})})})}),TM=_0[I(2475)](function(x,e){const t=I;return dg[t(657)](O3,{children:dg[t(657)](Gz,{...x,ref:e})})});var uh={exports:{}},co=typeof Reflect===I(1011)?Reflect:null,XB=co&&typeof co[I(1307)]=="function"?co.apply:function(x,e,t){const g=I;return Function[g(1566)][g(1307)].call(x,e,t)},Wr;co&&typeof co[I(1930)]===I(1126)?Wr=co[I(1930)]:Object[I(1941)]?Wr=function(x){const e=I;return Object.getOwnPropertyNames(x)[e(534)](Object[e(1941)](x))}:Wr=function(x){return Object.getOwnPropertyNames(x)};function pz(i){const x=I;console&&console[x(3748)]&&console[x(3748)](i)}var YB=Number[I(688)]||function(x){return x!==x};function Ox(){const i=I;Ox[i(2032)][i(2627)](this)}uh[I(2129)]=Ox,uh[I(2129)][I(597)]=vz,Ox[I(3420)]=Ox,Ox[I(1566)]._events=void 0,Ox[I(1566)][I(3397)]=0,Ox[I(1566)]._maxListeners=void 0;var KB=10;function wr(i){const x=I;if(typeof i!="function")throw new TypeError(x(1350)+typeof i)}Object[I(2899)](Ox,"defaultMaxListeners",{enumerable:!0,get:function(){return KB},set:function(i){const x=I;if(typeof i!==x(1025)||i<0||YB(i))throw new RangeError(x(458)+i+".");KB=i}}),Ox[I(2032)]=function(){const i=I;(this[i(2846)]===void 0||this[i(2846)]===Object[i(1537)](this)[i(2846)])&&(this[i(2846)]=Object.create(null),this._eventsCount=0),this[i(1823)]=this[i(1823)]||void 0},Ox[I(1566)][I(798)]=function(x){const e=I;if(typeof x!="number"||x<0||YB(x))throw new RangeError(e(1243)+x+".");return this[e(1823)]=x,this};function q3(i){return i._maxListeners===void 0?Ox.defaultMaxListeners:i._maxListeners}Ox.prototype[I(2662)]=function(){return q3(this)},Ox[I(1566)][I(1412)]=function(x){const e=I;for(var t=[],g=1;g<arguments.length;g++)t[e(3330)](arguments[g]);var n=x===e(2963),s=this[e(2846)];if(s!==void 0)n=n&&s[e(2963)]===void 0;else if(!n)return!1;if(n){var o;if(t[e(2989)]>0&&(o=t[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o[e(268)]+")":""));throw c[e(3246)]=o,c}var C=s[x];if(C===void 0)return!1;if(typeof C===e(1126))XB(C,this,t);else for(var r=C.length,A=$3(C,r),g=0;g<r;++g)XB(A[g],this,t);return!0};function HB(i,x,e,t){const g=I;var n,s,o;if(wr(e),s=i[g(2846)],s===void 0?(s=i[g(2846)]=Object[g(968)](null),i[g(3397)]=0):(s[g(2776)]!==void 0&&(i[g(1412)](g(2776),x,e[g(976)]?e.listener:e),s=i._events),o=s[x]),o===void 0)o=s[x]=e,++i._eventsCount;else if(typeof o===g(1126)?o=s[x]=t?[e,o]:[o,e]:t?o[g(1907)](e):o[g(3330)](e),n=q3(i),n>0&&o[g(2989)]>n&&!o[g(1955)]){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o[g(2989)]+" "+String(x)+g(578)+g(2703)+g(1033));c[g(1474)]=g(1641),c.emitter=i,c[g(3505)]=x,c[g(3411)]=o[g(2989)],pz(c)}return i}Ox[I(1566)].addListener=function(x,e){return HB(this,x,e,!1)},Ox[I(1566)].on=Ox[I(1566)][I(2488)],Ox[I(1566)][I(3002)]=function(x,e){return HB(this,x,e,!0)};function Bz(){const i=I;if(!this[i(3030)])return this[i(2930)][i(202)](this.type,this[i(3689)]),this[i(3030)]=!0,arguments.length===0?this[i(976)][i(2627)](this[i(2930)]):this.listener[i(1307)](this.target,arguments)}function NB(i,x,e){const t=I;var g={fired:!1,wrapFn:void 0,target:i,type:x,listener:e},n=Bz[t(1600)](g);return n[t(976)]=e,g[t(3689)]=n,n}Ox[I(1566)][I(597)]=function(x,e){return wr(e),this.on(x,NB(this,x,e)),this},Ox[I(1566)][I(3690)]=function(x,e){return wr(e),this.prependListener(x,NB(this,x,e)),this},Ox[I(1566)][I(202)]=function(x,e){const t=I;var g,n,s,o,c;if(wr(e),n=this._events,n===void 0)return this;if(g=n[x],g===void 0)return this;if(g===e||g[t(976)]===e)--this[t(3397)]===0?this[t(2846)]=Object[t(968)](null):(delete n[x],n.removeListener&&this[t(1412)](t(202),x,g[t(976)]||e));else if(typeof g!==t(1126)){for(s=-1,o=g.length-1;o>=0;o--)if(g[o]===e||g[o].listener===e){c=g[o][t(976)],s=o;break}if(s<0)return this;s===0?g[t(214)]():Zz(g,s),g[t(2989)]===1&&(n[x]=g[0]),n[t(202)]!==void 0&&this[t(1412)](t(202),x,c||e)}return this},Ox[I(1566)][I(3311)]=Ox.prototype[I(202)],Ox[I(1566)][I(1200)]=function(x){const e=I;var t,g,n;if(g=this._events,g===void 0)return this;if(g[e(202)]===void 0)return arguments[e(2989)]===0?(this[e(2846)]=Object[e(968)](null),this[e(3397)]=0):g[x]!==void 0&&(--this[e(3397)]===0?this[e(2846)]=Object.create(null):delete g[x]),this;if(arguments[e(2989)]===0){var s=Object[e(958)](g),o;for(n=0;n<s[e(2989)];++n)o=s[n],o!==e(202)&&this[e(1200)](o);return this[e(1200)]("removeListener"),this[e(2846)]=Object[e(968)](null),this._eventsCount=0,this}if(t=g[x],typeof t===e(1126))this[e(202)](x,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this[e(202)](x,t[n]);return this};function FB(i,x,e){const t=I;var g=i[t(2846)];if(g===void 0)return[];var n=g[x];return n===void 0?[]:typeof n===t(1126)?e?[n[t(976)]||n]:[n]:e?yz(n):$3(n,n[t(2989)])}Ox[I(1566)][I(3566)]=function(x){return FB(this,x,!0)},Ox[I(1566)][I(157)]=function(x){return FB(this,x,!1)},Ox[I(1564)]=function(i,x){const e=I;return typeof i.listenerCount===e(1126)?i[e(1564)](x):zB[e(2627)](i,x)},Ox[I(1566)][I(1564)]=zB;function zB(i){const x=I;var e=this[x(2846)];if(e!==void 0){var t=e[i];if(typeof t===x(1126))return 1;if(t!==void 0)return t[x(2989)]}return 0}Ox[I(1566)][I(1820)]=function(){const x=I;return this._eventsCount>0?Wr(this[x(2846)]):[]};function $3(i,x){for(var e=new Array(x),t=0;t<x;++t)e[t]=i[t];return e}function Zz(i,x){const e=I;for(;x+1<i[e(2989)];x++)i[x]=i[x+1];i.pop()}function yz(i){const x=I;for(var e=new Array(i[x(2989)]),t=0;t<e[x(2989)];++t)e[t]=i[t][x(976)]||i[t];return e}function vz(i,x){return new Promise(function(e,t){const g=i0;function n(o){i.removeListener(x,s),t(o)}function s(){const o=i0;typeof i[o(202)]=="function"&&i[o(202)]("error",n),e([].slice[o(2627)](arguments))}j3(i,x,s,{once:!0}),x!==g(2963)&&Wz(i,n,{once:!0})})}function Wz(i,x,e){const t=I;typeof i.on===t(1126)&&j3(i,t(2963),x,e)}function j3(i,x,e,t){const g=I;if(typeof i.on===g(1126))t[g(597)]?i[g(597)](x,e):i.on(x,e);else if(typeof i[g(2134)]===g(1126))i[g(2134)](x,function n(s){const o=g;t[o(597)]&&i[o(1216)](x,n),e(s)});else throw new TypeError(g(646)+typeof i)}var wz=uh[I(2129)];function Rz(i,x){var e=atob(i);return e}function Vz(i,x,e){const t=I;var g=Rz(i),n=g.indexOf(`
`,10)+1,s=g[t(981)](n)+"",o=new Blob([s],{type:t(1127)});return URL[t(606)](o)}function Sz(i,x,e){var t;return function(n){return t=t||Vz(i),new Worker(t,n)}}var Xz=Sz("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KCiAgLyoqCiAgICogQSAzeDMgbWF0cml4LgogICAqIEF1dGhvcmVkIGJ5IHtAbGluayBodHRwOi8vZ2l0aHViLmNvbS9zY2h0ZXBwZS8gc2NodGVwcGV9CiAgICovCiAgY2xhc3MgTWF0MyB7CiAgICAvKioKICAgICAqIEEgdmVjdG9yIG9mIGxlbmd0aCA5LCBjb250YWluaW5nIGFsbCBtYXRyaXggZWxlbWVudHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBlbGVtZW50cyBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihlbGVtZW50cykgewogICAgICBpZiAoZWxlbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIGVsZW1lbnRzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgdGhlIG1hdHJpeCB0byBpZGVudGl0eQogICAgICogQHRvZG8gU2hvdWxkIHBlcmhhcHMgYmUgcmVuYW1lZCB0byBgc2V0SWRlbnRpdHkoKWAgdG8gYmUgbW9yZSBjbGVhci4KICAgICAqIEB0b2RvIENyZWF0ZSBhbm90aGVyIGZ1bmN0aW9uIHRoYXQgaW1tZWRpYXRlbHkgY3JlYXRlcyBhbiBpZGVudGl0eSBtYXRyaXggZWcuIGBleWUoKWAKICAgICAqLwoKCiAgICBpZGVudGl0eSgpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSAxOwogICAgICBlWzFdID0gMDsKICAgICAgZVsyXSA9IDA7CiAgICAgIGVbM10gPSAwOwogICAgICBlWzRdID0gMTsKICAgICAgZVs1XSA9IDA7CiAgICAgIGVbNl0gPSAwOwogICAgICBlWzddID0gMDsKICAgICAgZVs4XSA9IDE7CiAgICB9CiAgICAvKioKICAgICAqIFNldCBhbGwgZWxlbWVudHMgdG8gemVybwogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMDsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDA7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMgZnJvbSBhIFZlYzMKICAgICAqLwoKCiAgICBzZXRUcmFjZSh2ZWN0b3IpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSB2ZWN0b3IueDsKICAgICAgZVs0XSA9IHZlY3Rvci55OwogICAgICBlWzhdID0gdmVjdG9yLno7CiAgICB9CiAgICAvKioKICAgICAqIEdldHMgdGhlIG1hdHJpeCBkaWFnb25hbCBlbGVtZW50cwogICAgICovCgoKICAgIGdldFRyYWNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgdGFyZ2V0LnggPSBlWzBdOwogICAgICB0YXJnZXQueSA9IGVbNF07CiAgICAgIHRhcmdldC56ID0gZVs4XTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LVZlY3RvciBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIHYgVGhlIHZlY3RvciB0byBtdWx0aXBseSB3aXRoCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLCB0YXJnZXQgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgTWF0MygpOwogICAgICB9CgogICAgICBjb25zdCBBID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgQiA9IG1hdHJpeC5lbGVtZW50czsKICAgICAgY29uc3QgVCA9IHRhcmdldC5lbGVtZW50czsKICAgICAgY29uc3QgYTExID0gQVswXSwKICAgICAgICAgICAgYTEyID0gQVsxXSwKICAgICAgICAgICAgYTEzID0gQVsyXSwKICAgICAgICAgICAgYTIxID0gQVszXSwKICAgICAgICAgICAgYTIyID0gQVs0XSwKICAgICAgICAgICAgYTIzID0gQVs1XSwKICAgICAgICAgICAgYTMxID0gQVs2XSwKICAgICAgICAgICAgYTMyID0gQVs3XSwKICAgICAgICAgICAgYTMzID0gQVs4XTsKICAgICAgY29uc3QgYjExID0gQlswXSwKICAgICAgICAgICAgYjEyID0gQlsxXSwKICAgICAgICAgICAgYjEzID0gQlsyXSwKICAgICAgICAgICAgYjIxID0gQlszXSwKICAgICAgICAgICAgYjIyID0gQls0XSwKICAgICAgICAgICAgYjIzID0gQls1XSwKICAgICAgICAgICAgYjMxID0gQls2XSwKICAgICAgICAgICAgYjMyID0gQls3XSwKICAgICAgICAgICAgYjMzID0gQls4XTsKICAgICAgVFswXSA9IGExMSAqIGIxMSArIGExMiAqIGIyMSArIGExMyAqIGIzMTsKICAgICAgVFsxXSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMjsKICAgICAgVFsyXSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMzsKICAgICAgVFszXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMTsKICAgICAgVFs0XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMjsKICAgICAgVFs1XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMzsKICAgICAgVFs2XSA9IGEzMSAqIGIxMSArIGEzMiAqIGIyMSArIGEzMyAqIGIzMTsKICAgICAgVFs3XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMjsKICAgICAgVFs4XSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2NhbGUgZWFjaCBjb2x1bW4gb2YgdGhlIG1hdHJpeAogICAgICovCgoKICAgIHNjYWxlKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCB0ID0gdGFyZ2V0LmVsZW1lbnRzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDM7IGkrKykgewogICAgICAgIHRbMyAqIGkgKyAwXSA9IHZlY3Rvci54ICogZVszICogaSArIDBdOwogICAgICAgIHRbMyAqIGkgKyAxXSA9IHZlY3Rvci55ICogZVszICogaSArIDFdOwogICAgICAgIHRbMyAqIGkgKyAyXSA9IHZlY3Rvci56ICogZVszICogaSArIDJdOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZSBBeD1iCiAgICAgKiBAcGFyYW0gYiBUaGUgcmlnaHQgaGFuZCBzaWRlCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBUYXJnZXQgdmVjdG9yIHRvIHNhdmUgaW4uCiAgICAgKiBAcmV0dXJuIFRoZSBzb2x1dGlvbiB4CiAgICAgKiBAdG9kbyBzaG91bGQgcmV1c2UgYXJyYXlzCiAgICAgKi8KCgogICAgc29sdmUoYiwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgYENvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyR7dGFyZ2V0LnRvU3RyaW5nKCl9XSwgYj1bJHtiLnRvU3RyaW5nKCl9XSwgQT1bJHt0aGlzLnRvU3RyaW5nKCl9XWA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA2OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IHJldmVyc2VfZXFuczsKICAgICAgbGV0IGk7CiAgICAgIGxldCBqOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIGVxbnNbaSArIG5jICogal0gPSB0aGlzLmVsZW1lbnRzW2kgKyAzICogal07CiAgICAgICAgfQogICAgICB9CgogICAgICBlcW5zWzMgKyA2ICogMF0gPSAxOwogICAgICBlcW5zWzMgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzMgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMV0gPSAxOwogICAgICBlcW5zWzQgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMl0gPSAxOyAvLyBDb21wdXRlIHJpZ2h0IHVwcGVyIHRyaWFuZ3VsYXIgdmVyc2lvbiBvZiB0aGUgbWF0cml4IC0gR2F1c3MgZWxpbWluYXRpb24KCiAgICAgIGxldCBuID0gMzsKICAgICAgY29uc3QgayA9IG47CiAgICAgIGxldCBucDsKICAgICAgY29uc3Qga3AgPSBuYzsgLy8gbnVtIHJvd3MKCiAgICAgIGxldCBwOwoKICAgICAgZG8gewogICAgICAgIGkgPSBrIC0gbjsKCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gPT09IDApIHsKICAgICAgICAgIC8vIHRoZSBwaXZvdCBpcyBudWxsLCBzd2FwIGxpbmVzCiAgICAgICAgICBmb3IgKGogPSBpICsgMTsgaiA8IGs7IGorKykgewogICAgICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBqXSAhPT0gMCkgewogICAgICAgICAgICAgIG5wID0ga3A7CgogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGkgKSA9IGxpbmUoIGkgKSArIGxpbmUoIGsgKQogICAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldICs9IGVxbnNbcCArIG5jICogal07CiAgICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBpXSAhPT0gMCkgewogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGsgKSA9IGxpbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaW5lKCBpICkKICAgICAgICAgICAgICBwID0ga3AgLSBucDsKICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gcCA8PSBpID8gMCA6IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IHdoaWxlICgtLW4pOyAvLyBlbGltaW5hdGUgdGhlIHVwcGVyIGxlZnQgdHJpYW5nbGUgb2YgdGhlIG1hdHJpeAoKCiAgICAgIGkgPSAyOwoKICAgICAgZG8gewogICAgICAgIGogPSBpIC0gMTsKCiAgICAgICAgZG8gewogICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgICBkbyB7CiAgICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gZXFuc1twICsgbmMgKiBqXSAtIGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgfSB3aGlsZSAoai0tKTsKICAgICAgfSB3aGlsZSAoLS1pKTsgLy8gb3BlcmF0aW9ucyBvbiB0aGUgZGlhZ29uYWwKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gMSAvIGVxbnNbaSArIG5jICogaV07CiAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IG5jIC0gbnA7CiAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldID0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgIH0gd2hpbGUgKGktLSk7CgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gMjsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IGVxbnNbbnIgKyBqICsgbmMgKiBpXTsKCiAgICAgICAgICBpZiAoaXNOYU4ocCkgfHwgcCA9PT0gSW5maW5pdHkpIHsKICAgICAgICAgICAgdGhyb3cgYENvdWxkIG5vdCByZXZlcnNlISBBPVske3RoaXMudG9TdHJpbmcoKX1dYDsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IE1hdDMoKTsKICAgICAgfQoKICAgICAgY29uc3QgTSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGxldCB0bXA7IC8vU2V0IGRpYWdvbmFscwoKICAgICAgVFswXSA9IE1bMF07CiAgICAgIFRbNF0gPSBNWzRdOwogICAgICBUWzhdID0gTVs4XTsKICAgICAgdG1wID0gTVsxXTsKICAgICAgVFsxXSA9IE1bM107CiAgICAgIFRbM10gPSB0bXA7CiAgICAgIHRtcCA9IE1bMl07CiAgICAgIFRbMl0gPSBNWzZdOwogICAgICBUWzZdID0gdG1wOwogICAgICB0bXAgPSBNWzVdOwogICAgICBUWzVdID0gTVs3XTsKICAgICAgVFs3XSA9IHRtcDsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgfQogIGNvbnN0IHJldmVyc2VfZXFucyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCiAgLyoqCiAgICogMy1kaW1lbnNpb25hbCB2ZWN0b3IKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCB2ID0gbmV3IFZlYzMoMSwgMiwgMykKICAgKiAgICAgY29uc29sZS5sb2coJ3g9JyArIHYueCkgLy8geD0xCiAgICovCgogIGNsYXNzIFZlYzMgewogICAgY29uc3RydWN0b3IoeCwgeSwgeikgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDAuMDsKICAgICAgfQoKICAgICAgaWYgKHkgPT09IHZvaWQgMCkgewogICAgICAgIHkgPSAwLjA7CiAgICAgIH0KCiAgICAgIGlmICh6ID09PSB2b2lkIDApIHsKICAgICAgICB6ID0gMC4wOwogICAgICB9CgogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgY3Jvc3MgcHJvZHVjdAogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbi4KICAgICAqLwoKCiAgICBjcm9zcyh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB2eCA9IHZlY3Rvci54OwogICAgICBjb25zdCB2eSA9IHZlY3Rvci55OwogICAgICBjb25zdCB2eiA9IHZlY3Rvci56OwogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHkgKiB2eiAtIHogKiB2eTsKICAgICAgdGFyZ2V0LnkgPSB6ICogdnggLSB4ICogdno7CiAgICAgIHRhcmdldC56ID0geCAqIHZ5IC0geSAqIHZ4OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZlY3RvcnMnIDMgZWxlbWVudHMKICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeikgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogU2V0IGFsbCBjb21wb25lbnRzIG9mIHRoZSB2ZWN0b3IgdG8gemVyby4KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgYWRkaXRpb24KICAgICAqLwoKCiAgICB2YWRkKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICsgdGhpcy54OwogICAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKyB0aGlzLnk7CiAgICAgICAgdGFyZ2V0LnogPSB2ZWN0b3IueiArIHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54ICsgdmVjdG9yLngsIHRoaXMueSArIHZlY3Rvci55LCB0aGlzLnogKyB2ZWN0b3Iueik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIHN1YnRyYWN0aW9uCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluLgogICAgICovCgoKICAgIHZzdWIodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdGhpcy54IC0gdmVjdG9yLng7CiAgICAgICAgdGFyZ2V0LnkgPSB0aGlzLnkgLSB2ZWN0b3IueTsKICAgICAgICB0YXJnZXQueiA9IHRoaXMueiAtIHZlY3Rvci56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggLSB2ZWN0b3IueCwgdGhpcy55IC0gdmVjdG9yLnksIHRoaXMueiAtIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNyb3NzIHByb2R1Y3QgbWF0cml4IGFfY3Jvc3MgZnJvbSBhIHZlY3Rvciwgc3VjaCB0aGF0IGEgeCBiID0gYV9jcm9zcyAqIGIgPSBjCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dzguY3MudW11LnNlL2t1cnNlci9UREJEMjQvVlQwNi9sZWN0dXJlcy9MZWN0dXJlNi5wZGYgVW1lw6UgVW5pdmVyc2l0eSBMZWN0dXJlfQogICAgICovCgoKICAgIGNyb3NzbWF0KCkgewogICAgICByZXR1cm4gbmV3IE1hdDMoWzAsIC10aGlzLnosIHRoaXMueSwgdGhpcy56LCAwLCAtdGhpcy54LCAtdGhpcy55LCB0aGlzLngsIDBdKTsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSB2ZWN0b3IuIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBpbiB0aGUgdmVjdG9yLgogICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgbm9ybSBvZiB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBuID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7CgogICAgICBpZiAobiA+IDAuMCkgewogICAgICAgIGNvbnN0IGludk4gPSAxIC8gbjsKICAgICAgICB0aGlzLnggKj0gaW52TjsKICAgICAgICB0aGlzLnkgKj0gaW52TjsKICAgICAgICB0aGlzLnogKj0gaW52TjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBNYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB2ZXJzaW9uIG9mIHRoaXMgdmVjdG9yIHRoYXQgaXMgb2YgbGVuZ3RoIDEuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgdGhlIHVuaXQgdmVjdG9yCiAgICAgKi8KCgogICAgdW5pdCh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHNjYWxhciAqIHg7CiAgICAgIHRhcmdldC55ID0gc2NhbGFyICogeTsKICAgICAgdGFyZ2V0LnogPSBzY2FsYXIgKiB6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgdmVjdG9yIHdpdGggYW4gb3RoZXIgdmVjdG9yLCBjb21wb25lbnQtd2lzZS4KICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHZlY3RvciB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bCh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICogdGhpcy54OwogICAgICB0YXJnZXQueSA9IHZlY3Rvci55ICogdGhpcy55OwogICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICogdGhpcy56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTY2FsZSBhIHZlY3RvciBhbmQgYWRkIGl0IHRvIHRoaXMgdmVjdG9yLiBTYXZlIHRoZSByZXN1bHQgaW4gInRhcmdldCIuICh0YXJnZXQgPSB0aGlzICsgdmVjdG9yICogc2NhbGFyKQogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBhZGRTY2FsZWRWZWN0b3Ioc2NhbGFyLCB2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnggPSAtdGhpcy54OwogICAgICB0YXJnZXQueSA9IC10aGlzLnk7CiAgICAgIHRhcmdldC56ID0gLXRoaXMuejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0d28gYXJ0aWZpY2lhbCB0YW5nZW50cyB0byB0aGUgdmVjdG9yCiAgICAgKiBAcGFyYW0gdDEgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBmaXJzdCB0YW5nZW50IGluCiAgICAgKiBAcGFyYW0gdDIgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBzZWNvbmQgdGFuZ2VudCBpbgogICAgICovCgoKICAgIHRhbmdlbnRzKHQxLCB0MikgewogICAgICBjb25zdCBub3JtID0gdGhpcy5sZW5ndGgoKTsKCiAgICAgIGlmIChub3JtID4gMC4wKSB7CiAgICAgICAgY29uc3QgbiA9IFZlYzNfdGFuZ2VudHNfbjsKICAgICAgICBjb25zdCBpbm9ybSA9IDEgLyBub3JtOwogICAgICAgIG4uc2V0KHRoaXMueCAqIGlub3JtLCB0aGlzLnkgKiBpbm9ybSwgdGhpcy56ICogaW5vcm0pOwogICAgICAgIGNvbnN0IHJhbmRWZWMgPSBWZWMzX3RhbmdlbnRzX3JhbmRWZWM7CgogICAgICAgIGlmIChNYXRoLmFicyhuLngpIDwgMC45KSB7CiAgICAgICAgICByYW5kVmVjLnNldCgxLCAwLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByYW5kVmVjLnNldCgwLCAxLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0KCiAgICAgICAgbi5jcm9zcyh0MSwgdDIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSBub3JtYWwgbGVuZ3RoIGlzIHplcm8sIG1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdDEuc2V0KDEsIDAsIDApOwogICAgICAgIHQyLnNldCgwLCAxLCAwKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhIG1vcmUgcmVhZGFibGUgZm9ybWF0CiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen1gOwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIGlmIChwcmVjaXNpb24gPT09IHZvaWQgMCkgewogICAgICAgIHByZWNpc2lvbiA9IDFlLTY7CiAgICAgIH0KCiAgICAgIGlmIChNYXRoLmFicyh0aGlzLnggLSB2ZWN0b3IueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55IC0gdmVjdG9yLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueiAtIHZlY3Rvci56KSA+IHByZWNpc2lvbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGlzIGFsbW9zdCB6ZXJvCiAgICAgKi8KCgogICAgYWxtb3N0WmVybyhwcmVjaXNpb24pIHsKICAgICAgaWYgKHByZWNpc2lvbiA9PT0gdm9pZCAwKSB7CiAgICAgICAgcHJlY2lzaW9uID0gMWUtNjsKICAgICAgfQoKICAgICAgaWYgKE1hdGguYWJzKHRoaXMueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnopID4gcHJlY2lzaW9uKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIHZlY3RvciBpcyBhbnRpLXBhcmFsbGVsIHRvIGFub3RoZXIgdmVjdG9yLgogICAgICogQHBhcmFtIHByZWNpc2lvbiBTZXQgdG8gemVybyBmb3IgZXhhY3QgY29tcGFyaXNvbnMKICAgICAqLwoKCiAgICBpc0FudGlwYXJhbGxlbFRvKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIHRoaXMubmVnYXRlKGFudGlwX25lZyk7CiAgICAgIHJldHVybiBhbnRpcF9uZWcuYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgdGhlIHZlY3RvcgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54LCB0aGlzLnksIHRoaXMueik7CiAgICB9CgogIH0KICBWZWMzLlpFUk8gPSBuZXcgVmVjMygwLCAwLCAwKTsKICBWZWMzLlVOSVRfWCA9IG5ldyBWZWMzKDEsIDAsIDApOwogIFZlYzMuVU5JVF9ZID0gbmV3IFZlYzMoMCwgMSwgMCk7CiAgVmVjMy5VTklUX1ogPSBuZXcgVmVjMygwLCAwLCAxKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IFZlYzNfdGFuZ2VudHNfcmFuZFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYW50aXBfbmVnID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KICBjbGFzcyBBQUJCIHsKICAgIC8qKgogICAgICogVGhlIGxvd2VyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHVwcGVyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLmxvd2VyQm91bmQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwcGVyQm91bmQgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG93ZXJCb3VuZCkgewogICAgICAgIHRoaXMubG93ZXJCb3VuZC5jb3B5KG9wdGlvbnMubG93ZXJCb3VuZCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnVwcGVyQm91bmQpIHsKICAgICAgICB0aGlzLnVwcGVyQm91bmQuY29weShvcHRpb25zLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgQUFCQiBib3VuZHMgZnJvbSBhIHNldCBvZiBwb2ludHMuCiAgICAgKiBAcGFyYW0gcG9pbnRzIEFuIGFycmF5IG9mIFZlYzMncy4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0CiAgICAgKi8KCgogICAgc2V0RnJvbVBvaW50cyhwb2ludHMsIHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBza2luU2l6ZSkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBxID0gcXVhdGVybmlvbjsgLy8gU2V0IHRvIHRoZSBmaXJzdCBwb2ludAoKICAgICAgbC5jb3B5KHBvaW50c1swXSk7CgogICAgICBpZiAocSkgewogICAgICAgIHEudm11bHQobCwgbCk7CiAgICAgIH0KCiAgICAgIHUuY29weShsKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IHAgPSBwb2ludHNbaV07CgogICAgICAgIGlmIChxKSB7CiAgICAgICAgICBxLnZtdWx0KHAsIHRtcCQxKTsKICAgICAgICAgIHAgPSB0bXAkMTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPiB1LngpIHsKICAgICAgICAgIHUueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPCBsLngpIHsKICAgICAgICAgIGwueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPCBsLnkpIHsKICAgICAgICAgIGwueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPiB1LnopIHsKICAgICAgICAgIHUueiA9IHAuejsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHAuejsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIG9mZnNldAoKCiAgICAgIGlmIChwb3NpdGlvbikgewogICAgICAgIHBvc2l0aW9uLnZhZGQobCwgbCk7CiAgICAgICAgcG9zaXRpb24udmFkZCh1LCB1KTsKICAgICAgfQoKICAgICAgaWYgKHNraW5TaXplKSB7CiAgICAgICAgbC54IC09IHNraW5TaXplOwogICAgICAgIGwueSAtPSBza2luU2l6ZTsKICAgICAgICBsLnogLT0gc2tpblNpemU7CiAgICAgICAgdS54ICs9IHNraW5TaXplOwogICAgICAgIHUueSArPSBza2luU2l6ZTsKICAgICAgICB1LnogKz0gc2tpblNpemU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGJvdW5kcyBmcm9tIGFuIEFBQkIgdG8gdGhpcyBBQUJCCiAgICAgKiBAcGFyYW0gYWFiYiBTb3VyY2UgdG8gY29weSBmcm9tCiAgICAgKiBAcmV0dXJuIFRoZSB0aGlzIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eQogICAgICovCgoKICAgIGNvcHkoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQuY29weShhYWJiLmxvd2VyQm91bmQpOwogICAgICB0aGlzLnVwcGVyQm91bmQuY29weShhYWJiLnVwcGVyQm91bmQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgYW4gQUFCQgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEFBQkIoKS5jb3B5KHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBFeHRlbmQgdGhpcyBBQUJCIHNvIHRoYXQgaXQgY292ZXJzIHRoZSBnaXZlbiBBQUJCIHRvby4KICAgICAqLwoKCiAgICBleHRlbmQoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueCk7CiAgICAgIHRoaXMudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC54KTsKICAgICAgdGhpcy5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueSwgYWFiYi5sb3dlckJvdW5kLnkpOwogICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC55LCBhYWJiLnVwcGVyQm91bmQueSk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC56ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnosIGFhYmIubG93ZXJCb3VuZC56KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnogPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueiwgYWFiYi51cHBlckJvdW5kLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgb3ZlcmxhcHMgdGhpcyBBQUJCLgogICAgICovCgoKICAgIG92ZXJsYXBzKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tfAogICAgICAvLyBsMSAgICAgICB1MQoKICAgICAgY29uc3Qgb3ZlcmxhcHNYID0gbDIueCA8PSB1MS54ICYmIHUxLnggPD0gdTIueCB8fCBsMS54IDw9IHUyLnggJiYgdTIueCA8PSB1MS54OwogICAgICBjb25zdCBvdmVybGFwc1kgPSBsMi55IDw9IHUxLnkgJiYgdTEueSA8PSB1Mi55IHx8IGwxLnkgPD0gdTIueSAmJiB1Mi55IDw9IHUxLnk7CiAgICAgIGNvbnN0IG92ZXJsYXBzWiA9IGwyLnogPD0gdTEueiAmJiB1MS56IDw9IHUyLnogfHwgbDEueiA8PSB1Mi56ICYmIHUyLnogPD0gdTEuejsKICAgICAgcmV0dXJuIG92ZXJsYXBzWCAmJiBvdmVybGFwc1kgJiYgb3ZlcmxhcHNaOwogICAgfSAvLyBNb3N0bHkgZm9yIGRlYnVnZ2luZwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIHJldHVybiAodS54IC0gbC54KSAqICh1LnkgLSBsLnkpICogKHUueiAtIGwueik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gQUFCQiBpcyBmdWxseSBjb250YWluZWQgaW4gdGhpcyBBQUJCLgogICAgICovCgoKICAgIGNvbnRhaW5zKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgICAgICAgIHUxCgogICAgICByZXR1cm4gbDEueCA8PSBsMi54ICYmIHUxLnggPj0gdTIueCAmJiBsMS55IDw9IGwyLnkgJiYgdTEueSA+PSB1Mi55ICYmIGwxLnogPD0gbDIueiAmJiB1MS56ID49IHUyLno7CiAgICB9CgogICAgZ2V0Q29ybmVycyhhLCBiLCBjLCBkLCBlLCBmLCBnLCBoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIGEuY29weShsKTsKICAgICAgYi5zZXQodS54LCBsLnksIGwueik7CiAgICAgIGMuc2V0KHUueCwgdS55LCBsLnopOwogICAgICBkLnNldChsLngsIHUueSwgdS56KTsKICAgICAgZS5zZXQodS54LCBsLnksIHUueik7CiAgICAgIGYuc2V0KGwueCwgdS55LCBsLnopOwogICAgICBnLnNldChsLngsIGwueSwgdS56KTsKICAgICAgaC5jb3B5KHUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gYW5vdGhlciBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvTG9jYWxGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb0xvY2FsKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gdGhlIGdsb2JhbCBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvV29ybGRGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb1dvcmxkKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgQUFCQiBpcyBoaXQgYnkgYSByYXkuCiAgICAgKi8KCgogICAgb3ZlcmxhcHNSYXkocmF5KSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkaXJlY3Rpb24sCiAgICAgICAgZnJvbQogICAgICB9ID0gcmF5OyAvLyBjb25zdCB0ID0gMAogICAgICAvLyByYXkuZGlyZWN0aW9uIGlzIHVuaXQgZGlyZWN0aW9uIHZlY3RvciBvZiByYXkKCiAgICAgIGNvbnN0IGRpckZyYWNYID0gMSAvIGRpcmVjdGlvbi54OwogICAgICBjb25zdCBkaXJGcmFjWSA9IDEgLyBkaXJlY3Rpb24ueTsKICAgICAgY29uc3QgZGlyRnJhY1ogPSAxIC8gZGlyZWN0aW9uLno7IC8vIHRoaXMubG93ZXJCb3VuZCBpcyB0aGUgY29ybmVyIG9mIEFBQkIgd2l0aCBtaW5pbWFsIGNvb3JkaW5hdGVzIC0gbGVmdCBib3R0b20sIHJ0IGlzIG1heGltYWwgY29ybmVyCgogICAgICBjb25zdCB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIGZyb20ueCkgKiBkaXJGcmFjWDsKICAgICAgY29uc3QgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQzID0gKHRoaXMubG93ZXJCb3VuZC55IC0gZnJvbS55KSAqIGRpckZyYWNZOwogICAgICBjb25zdCB0NCA9ICh0aGlzLnVwcGVyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDUgPSAodGhpcy5sb3dlckJvdW5kLnogLSBmcm9tLnopICogZGlyRnJhY1o7CiAgICAgIGNvbnN0IHQ2ID0gKHRoaXMudXBwZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOyAvLyBjb25zdCB0bWluID0gTWF0aC5tYXgoTWF0aC5tYXgoTWF0aC5taW4odDEsIHQyKSwgTWF0aC5taW4odDMsIHQ0KSkpOwogICAgICAvLyBjb25zdCB0bWF4ID0gTWF0aC5taW4oTWF0aC5taW4oTWF0aC5tYXgodDEsIHQyKSwgTWF0aC5tYXgodDMsIHQ0KSkpOwoKICAgICAgY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpLCBNYXRoLm1pbih0NSwgdDYpKTsKICAgICAgY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpLCBNYXRoLm1heCh0NSwgdDYpKTsgLy8gaWYgdG1heCA8IDAsIHJheSAobGluZSkgaXMgaW50ZXJzZWN0aW5nIEFBQkIsIGJ1dCB3aG9sZSBBQUJCIGlzIGJlaGluZyB1cwoKICAgICAgaWYgKHRtYXggPCAwKSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gaWYgdG1pbiA+IHRtYXgsIHJheSBkb2Vzbid0IGludGVyc2VjdCBBQUJCCgoKICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB9CiAgY29uc3QgdG1wJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRyYW5zZm9ybUludG9GcmFtZV9jb3JuZXJzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBDb2xsaXNpb24gIm1hdHJpeCIuCiAgICogSXQncyBhY3R1YWxseSBhIHRyaWFuZ3VsYXItc2hhcGVkIGFycmF5IG9mIHdoZXRoZXIgdHdvIGJvZGllcyBhcmUgdG91Y2hpbmcgdGhpcyBzdGVwLCBmb3IgcmVmZXJlbmNlIG5leHQgc3RlcAogICAqLwogIGNsYXNzIEFycmF5Q29sbGlzaW9uTWF0cml4IHsKICAgIC8qKgogICAgICogVGhlIG1hdHJpeCBzdG9yYWdlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3Igb2JqZWN0cyB0aGF0IGRpc3BhdGNoZXMgZXZlbnRzLgogICAqLwogIGNsYXNzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwogICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICAgIH0KCiAgICAgIGlmICghbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gIT09IHVuZGVmaW5lZCAmJiBsaXN0ZW5lcnNbdHlwZV0uaW5jbHVkZXMobGlzdGVuZXIpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgYW55IGV2ZW50IGxpc3RlbmVyIG9mIHRoZSBnaXZlbiB0eXBlIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzQW55RXZlbnRMaXN0ZW5lcih0eXBlKSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgICByZXR1cm4gbGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgogICAgICogQHJldHVybiBUaGUgc2VsZiBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4ID0gbGlzdGVuZXJzW3R5cGVdLmluZGV4T2YobGlzdGVuZXIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogRW1pdCBhbiBldmVudC4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKCiAgICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpc3RlbmVyQXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBsaXN0ZW5lckFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgogIGNsYXNzIFF1YXRlcm5pb24gewogICAgY29uc3RydWN0b3IoeCwgeSwgeiwgdykgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh5ID09PSB2b2lkIDApIHsKICAgICAgICB5ID0gMDsKICAgICAgfQoKICAgICAgaWYgKHogPT09IHZvaWQgMCkgewogICAgICAgIHogPSAwOwogICAgICB9CgogICAgICBpZiAodyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHRoaXMudyA9IHc7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgc2V0KHgsIHksIHosIHcpIHsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdG8gYSByZWFkYWJsZSBmb3JtYXQKICAgICAqIEByZXR1cm4gIngseSx6LHciCiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen0sJHt0aGlzLnd9YDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcykgewogICAgICBpZiAodGFyZ2V0QXhpcyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMubm9ybWFsaXplKCk7IC8vIGlmIHc+MSBhY29zIGFuZCBzcXJ0IHdpbGwgcHJvZHVjZSBlcnJvcnMsIHRoaXMgY2FudCBoYXBwZW4gaWYgcXVhdGVybmlvbiBpcyBub3JtYWxpc2VkCgogICAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLmFjb3ModGhpcy53KTsKICAgICAgY29uc3QgcyA9IE1hdGguc3FydCgxIC0gdGhpcy53ICogdGhpcy53KTsgLy8gYXNzdW1pbmcgcXVhdGVybmlvbiBub3JtYWxpc2VkIHRoZW4gdyBpcyBsZXNzIHRoYW4gMSwgc28gdGVybSBhbHdheXMgcG9zaXRpdmUuCgogICAgICBpZiAocyA8IDAuMDAxKSB7CiAgICAgICAgLy8gdGVzdCB0byBhdm9pZCBkaXZpZGUgYnkgemVybywgcyBpcyBhbHdheXMgcG9zaXRpdmUgZHVlIHRvIHNxcnQKICAgICAgICAvLyBpZiBzIGNsb3NlIHRvIHplcm8gdGhlbiBkaXJlY3Rpb24gb2YgYXhpcyBub3QgaW1wb3J0YW50CiAgICAgICAgdGFyZ2V0QXhpcy54ID0gdGhpcy54OyAvLyBpZiBpdCBpcyBpbXBvcnRhbnQgdGhhdCBheGlzIGlzIG5vcm1hbGlzZWQgdGhlbiByZXBsYWNlIHdpdGggeD0xOyB5PXo9MDsKCiAgICAgICAgdGFyZ2V0QXhpcy55ID0gdGhpcy55OwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLnggLyBzOyAvLyBub3JtYWxpc2UgYXhpcwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnkgLyBzOwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMueiAvIHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGFyZ2V0QXhpcywgYW5nbGVdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHF1YXRlcm5pb24gdmFsdWUgZ2l2ZW4gdHdvIHZlY3RvcnMuIFRoZSByZXN1bHRpbmcgcm90YXRpb24gd2lsbCBiZSB0aGUgbmVlZGVkIHJvdGF0aW9uIHRvIHJvdGF0ZSB1IHRvIHYuCiAgICAgKi8KCgogICAgc2V0RnJvbVZlY3RvcnModSwgdikgewogICAgICBpZiAodS5pc0FudGlwYXJhbGxlbFRvKHYpKSB7CiAgICAgICAgY29uc3QgdDEgPSBzZnZfdDE7CiAgICAgICAgY29uc3QgdDIgPSBzZnZfdDI7CiAgICAgICAgdS50YW5nZW50cyh0MSwgdDIpOwogICAgICAgIHRoaXMuc2V0RnJvbUF4aXNBbmdsZSh0MSwgTWF0aC5QSSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYSA9IHUuY3Jvc3Modik7CiAgICAgICAgdGhpcy54ID0gYS54OwogICAgICAgIHRoaXMueSA9IGEueTsKICAgICAgICB0aGlzLnogPSBhLno7CiAgICAgICAgdGhpcy53ID0gTWF0aC5zcXJ0KHUubGVuZ3RoKCkgKiogMiAqIHYubGVuZ3RoKCkgKiogMikgKyB1LmRvdCh2KTsKICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHF1YXRlcm5pb24gd2l0aCBhbiBvdGhlciBxdWF0ZXJuaW9uLgogICAgICovCgoKICAgIG11bHQocXVhdCwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCB3ID0gdGhpcy53OwogICAgICB0aGlzLmNvbmp1Z2F0ZSh0YXJnZXQpOwogICAgICBjb25zdCBpbm9ybTIgPSAxIC8gKHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3KTsKICAgICAgdGFyZ2V0LnggKj0gaW5vcm0yOwogICAgICB0YXJnZXQueSAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC56ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LncgKj0gaW5vcm0yOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHF1YXRlcm5pb24gY29uanVnYXRlCiAgICAgKi8KCgogICAgY29uanVnYXRlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IC10aGlzLng7CiAgICAgIHRhcmdldC55ID0gLXRoaXMueTsKICAgICAgdGFyZ2V0LnogPSAtdGhpcy56OwogICAgICB0YXJnZXQudyA9IHRoaXMudzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSBxdWF0ZXJuaW9uLiBOb3RlIHRoYXQgdGhpcyBjaGFuZ2VzIHRoZSB2YWx1ZXMgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBsZXQgbCA9IE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwoKICAgICAgaWYgKGwgPT09IDApIHsKICAgICAgICB0aGlzLnggPSAwOwogICAgICAgIHRoaXMueSA9IDA7CiAgICAgICAgdGhpcy56ID0gMDsKICAgICAgICB0aGlzLncgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwgPSAxIC8gbDsKICAgICAgICB0aGlzLnggKj0gbDsKICAgICAgICB0aGlzLnkgKj0gbDsKICAgICAgICB0aGlzLnogKj0gbDsKICAgICAgICB0aGlzLncgKj0gbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEFwcHJveGltYXRpb24gb2YgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uLiBXb3JrcyBiZXN0IHdoZW4gcXVhdCBpcyBhbHJlYWR5IGFsbW9zdC1ub3JtYWxpemVkLgogICAgICogQGF1dGhvciB1bnBoYXNlZCwgaHR0cHM6Ly9naXRodWIuY29tL3VucGhhc2VkCiAgICAgKi8KCgogICAgbm9ybWFsaXplRmFzdCgpIHsKICAgICAgY29uc3QgZiA9ICgzLjAgLSAodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53KSkgLyAyLjA7CgogICAgICBpZiAoZiA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy54ICo9IGY7CiAgICAgICAgdGhpcy55ICo9IGY7CiAgICAgICAgdGhpcy56ICo9IGY7CiAgICAgICAgdGhpcy53ICo9IGY7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiBieSBhIHZlY3RvcgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIpIHsKICAgICAgaWYgKG9yZGVyID09PSB2b2lkIDApIHsKICAgICAgICBvcmRlciA9ICdZWlgnOwogICAgICB9CgogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFdWxlciBvcmRlciAke29yZGVyfSBub3Qgc3VwcG9ydGVkIHlldC5gKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnkgPSBoZWFkaW5nOwogICAgICB0YXJnZXQueiA9IGF0dGl0dWRlOwogICAgICB0YXJnZXQueCA9IGJhbms7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIEV1bGVyIGFuZ2xlIHJlcHJlc2VudGF0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSBvcmRlciBUaGUgb3JkZXIgdG8gYXBwbHkgYW5nbGVzOiAnWFlaJyBvciAnWVhaJyBvciBhbnkgb3RoZXIgY29tYmluYXRpb24uCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dy5tYXRod29ya3MuY29tL21hdGxhYmNlbnRyYWwvZmlsZWV4Y2hhbmdlLzIwNjk2LWZ1bmN0aW9uLXRvLWNvbnZlcnQtYmV0d2Vlbi1kY20tZXVsZXItYW5nbGVzLXF1YXRlcm5pb25zLWFuZC1ldWxlci12ZWN0b3JzIE1hdGhXb3Jrc30gcmVmZXJlbmNlCiAgICAgKi8KCgogICAgc2V0RnJvbUV1bGVyKHgsIHksIHosIG9yZGVyKSB7CiAgICAgIGlmIChvcmRlciA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3JkZXIgPSAnWFlaJzsKICAgICAgfQoKICAgICAgY29uc3QgYzEgPSBNYXRoLmNvcyh4IC8gMik7CiAgICAgIGNvbnN0IGMyID0gTWF0aC5jb3MoeSAvIDIpOwogICAgICBjb25zdCBjMyA9IE1hdGguY29zKHogLyAyKTsKICAgICAgY29uc3QgczEgPSBNYXRoLnNpbih4IC8gMik7CiAgICAgIGNvbnN0IHMyID0gTWF0aC5zaW4oeSAvIDIpOwogICAgICBjb25zdCBzMyA9IE1hdGguc2luKHogLyAyKTsKCiAgICAgIGlmIChvcmRlciA9PT0gJ1hZWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWFonKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWlhZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1pZWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWlgnKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWFpZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgUXVhdGVybmlvbih0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpOwogICAgfQogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhIHNwaGVyaWNhbCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHR3byBxdWF0CiAgICAgKgogICAgICogQHBhcmFtIHRvUXVhdCBzZWNvbmQgb3BlcmFuZAogICAgICogQHBhcmFtIHQgaW50ZXJwb2xhdGlvbiBhbW91bnQgYmV0d2VlbiB0aGUgc2VsZiBxdWF0ZXJuaW9uIGFuZCB0b1F1YXQKICAgICAqIEBwYXJhbSB0YXJnZXQgQSBxdWF0ZXJuaW9uIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uIElmIG5vdCBwcm92aWRlZCwgYSBuZXcgb25lIHdpbGwgYmUgY3JlYXRlZC4KICAgICAqIEByZXR1cm5zIHtRdWF0ZXJuaW9ufSBUaGUgInRhcmdldCIgb2JqZWN0CiAgICAgKi8KCgogICAgc2xlcnAodG9RdWF0LCB0LCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gYW5ndWxhclZlbG9jaXR5LnggKiBhbmd1bGFyRmFjdG9yLngsCiAgICAgICAgICAgIGF5ID0gYW5ndWxhclZlbG9jaXR5LnkgKiBhbmd1bGFyRmFjdG9yLnksCiAgICAgICAgICAgIGF6ID0gYW5ndWxhclZlbG9jaXR5LnogKiBhbmd1bGFyRmFjdG9yLnosCiAgICAgICAgICAgIGJ4ID0gdGhpcy54LAogICAgICAgICAgICBieSA9IHRoaXMueSwKICAgICAgICAgICAgYnogPSB0aGlzLnosCiAgICAgICAgICAgIGJ3ID0gdGhpcy53OwogICAgICBjb25zdCBoYWxmX2R0ID0gZHQgKiAwLjU7CiAgICAgIHRhcmdldC54ICs9IGhhbGZfZHQgKiAoYXggKiBidyArIGF5ICogYnogLSBheiAqIGJ5KTsKICAgICAgdGFyZ2V0LnkgKz0gaGFsZl9kdCAqIChheSAqIGJ3ICsgYXogKiBieCAtIGF4ICogYnopOwogICAgICB0YXJnZXQueiArPSBoYWxmX2R0ICogKGF6ICogYncgKyBheCAqIGJ5IC0gYXkgKiBieCk7CiAgICAgIHRhcmdldC53ICs9IGhhbGZfZHQgKiAoLWF4ICogYnggLSBheSAqIGJ5IC0gYXogKiBieik7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KICBjb25zdCBzZnZfdDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNmdl90MiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIFRoZSBhdmFpbGFibGUgc2hhcGUgdHlwZXMuCiAgICovCiAgY29uc3QgU0hBUEVfVFlQRVMgPSB7CiAgICAvKiogU1BIRVJFICovCiAgICBTUEhFUkU6IDEsCgogICAgLyoqIFBMQU5FICovCiAgICBQTEFORTogMiwKCiAgICAvKiogQk9YICovCiAgICBCT1g6IDQsCgogICAgLyoqIENPTVBPVU5EICovCiAgICBDT01QT1VORDogOCwKCiAgICAvKiogQ09OVkVYUE9MWUhFRFJPTiAqLwogICAgQ09OVkVYUE9MWUhFRFJPTjogMTYsCgogICAgLyoqIEhFSUdIVEZJRUxEICovCiAgICBIRUlHSFRGSUVMRDogMzIsCgogICAgLyoqIFBBUlRJQ0xFICovCiAgICBQQVJUSUNMRTogNjQsCgogICAgLyoqIENZTElOREVSICovCiAgICBDWUxJTkRFUjogMTI4LAoKICAgIC8qKiBUUklNRVNIICovCiAgICBUUklNRVNIOiAyNTYKICB9OwogIC8qKgogICAqIFNoYXBlVHlwZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBzaGFwZXMKICAgKi8KICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgdGhpcy5pZCA9IFNoYXBlLmlkQ291bnRlcisrOwogICAgICB0aGlzLnR5cGUgPSBvcHRpb25zLnR5cGUgfHwgMDsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID8gb3B0aW9ucy5jb2xsaXNpb25SZXNwb25zZSA6IHRydWU7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgPyBvcHRpb25zLm1hdGVyaWFsIDogbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgdGhlIGJvdW5kaW5nIHNwaGVyZSByYWRpdXMuCiAgICAgKiBUaGUgcmVzdWx0IGlzIHN0b3JlZCBpbiB0aGUgcHJvcGVydHkgYC5ib3VuZGluZ1NwaGVyZVJhZGl1c2AKICAgICAqLwoKCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhyb3cgYGNvbXB1dGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZvbHVtZSBvZiB0aGlzIHNoYXBlCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICB0aHJvdyBgdm9sdW1lKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZXMgdGhlIGluZXJ0aWEgaW4gdGhlIGxvY2FsIGZyYW1lIGZvciB0aGlzIHNoYXBlLgogICAgICogQHNlZSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Rfb2ZfbW9tZW50c19vZl9pbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICB0aHJvdyBgY2FsY3VsYXRlTG9jYWxJbmVydGlhKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdCBmb3IgdGhlc2Uga2luZCBvZiBtZXRob2RzCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgdGhyb3cgYGNhbGN1bGF0ZVdvcmxkQUFCQigpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQoKICB9CiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwoKICAvKioKICAgKiBUcmFuc2Zvcm1hdGlvbiB1dGlsaXRpZXMuCiAgICovCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHsKICAgICAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGdsb2JhbCBwb2ludCBpbiBsb2NhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb0xvY2FsKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgd29ybGRQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgbG9jYWwgcG9pbnQgaW4gZ2xvYmFsIHRyYW5zZm9ybSBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGQobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIHJldHVybiBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5wb3NpdGlvbiwgdGhpcy5xdWF0ZXJuaW9uLCBsb2NhbFBvaW50LCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHBvaW50VG9Mb2NhbEZyYW1lCiAgICAgKi8KCgogICAgc3RhdGljIHBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxQb2ludCwgcmVzdWx0KTsKICAgICAgcmVzdWx0LnZhZGQocG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb1dvcmxkRnJhbWUocXVhdGVybmlvbiwgbG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CiAgY29uc3QgdG1wUXVhdCQxID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwogIGNsYXNzIENvbnZleFBvbHloZWRyb24gZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogdmVydGljZXMgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggZmFjZSBjb25zaXN0cyBvZgogICAgICovCgogICAgLyoqIGZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkVmVydGljZXMgKi8KCiAgICAvKiogd29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHMgKi8KCiAgICAvKiogd29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlICovCgogICAgLyoqCiAgICAgKiBJZiBnaXZlbiwgdGhlc2UgbG9jYWxseSBkZWZpbmVkLCBub3JtYWxpemVkIGF4ZXMgYXJlIHRoZSBvbmx5IG9uZXMgYmVpbmcgY2hlY2tlZCB3aGVuIGRvaW5nIHNlcGFyYXRpbmcgYXhpcyBjaGVjay4KICAgICAqLwoKICAgIC8qKiB1bmlxdWVFZGdlcyAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIHZlcnRpY2VzIEFuIGFycmF5IG9mIFZlYzMncwogICAgICogQHBhcmFtIGZhY2VzIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBkZXNjcmliaW5nIHdoaWNoIHZlcnRpY2VzIHRoYXQgaXMgaW5jbHVkZWQgaW4gZWFjaCBmYWNlLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihwcm9wcykgewogICAgICBpZiAocHJvcHMgPT09IHZvaWQgMCkgewogICAgICAgIHByb3BzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IHsKICAgICAgICB2ZXJ0aWNlcyA9IFtdLAogICAgICAgIGZhY2VzID0gW10sCiAgICAgICAgbm9ybWFscyA9IFtdLAogICAgICAgIGF4ZXMsCiAgICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICAgICAgfSA9IHByb3BzOwogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTgogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZlcnRleCAke3RoaXMuZmFjZXNbaV1bal19IG5vdCBmb3VuZCFgKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ldIHx8IG5ldyBWZWMzKCk7CiAgICAgICAgdGhpcy5nZXRGYWNlTm9ybWFsKGksIG4pOwogICAgICAgIG4ubmVnYXRlKG4pOwogICAgICAgIHRoaXMuZmFjZU5vcm1hbHNbaV0gPSBuOwogICAgICAgIGNvbnN0IHZlcnRleCA9IHRoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVswXV07CgogICAgICAgIGlmIChuLmRvdCh2ZXJ0ZXgpIDwgMCkgewogICAgICAgICAgY29uc29sZS5lcnJvcihgLmZhY2VOb3JtYWxzWyR7aX1dID0gVmVjMygke24udG9TdHJpbmcoKX0pIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuYCk7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybihgLnZlcnRpY2VzWyR7dGhpcy5mYWNlc1tpXVtqXX1dID0gVmVjMygke3RoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVtqXV0udG9TdHJpbmcoKX0pYCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIG5vcm1hbCBvZiBhIGZhY2UgZnJvbSBpdHMgdmVydGljZXMKICAgICAqLwoKCiAgICBnZXRGYWNlTm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tpXTsKICAgICAgY29uc3QgdmEgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCB2YiA9IHRoaXMudmVydGljZXNbZlsxXV07CiAgICAgIGNvbnN0IHZjID0gdGhpcy52ZXJ0aWNlc1tmWzJdXTsKICAgICAgQ29udmV4UG9seWhlZHJvbi5jb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNiID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWIgPSBuZXcgVmVjMygpOwogICAgICB2Yi52c3ViKHZhLCBhYik7CiAgICAgIHZjLnZzdWIodmIsIGNiKTsKICAgICAgY2IuY3Jvc3MoYWIsIHRhcmdldCk7CgogICAgICBpZiAoIXRhcmdldC5pc1plcm8oKSkgewogICAgICAgIHRhcmdldC5ub3JtYWxpemUoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBAcGFyYW0gbWluRGlzdCBDbGFtcCBkaXN0YW5jZQogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgYW4gYXJyYXkgb2YgY29udGFjdCBwb2ludCBvYmplY3RzLCBzZWUgY2xpcEZhY2VBZ2FpbnN0SHVsbAogICAgICovCgoKICAgIGNsaXBBZ2FpbnN0SHVsbChwb3NBLCBxdWF0QSwgaHVsbEIsIHBvc0IsIHF1YXRCLCBzZXBhcmF0aW5nTm9ybWFsLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgV29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBsZXQgY2xvc2VzdEZhY2VCID0gLTE7CiAgICAgIGxldCBkbWF4ID0gLU51bWJlci5NQVhfVkFMVUU7CgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxCLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgV29ybGROb3JtYWwuY29weShodWxsQi5mYWNlTm9ybWFsc1tmYWNlXSk7CiAgICAgICAgcXVhdEIudm11bHQoV29ybGROb3JtYWwsIFdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCBkID0gV29ybGROb3JtYWwuZG90KHNlcGFyYXRpbmdOb3JtYWwpOwoKICAgICAgICBpZiAoZCA+IGRtYXgpIHsKICAgICAgICAgIGRtYXggPSBkOwogICAgICAgICAgY2xvc2VzdEZhY2VCID0gZmFjZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkVmVydHNCMSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGh1bGxCLnZlcnRpY2VzW2h1bGxCLmZhY2VzW2Nsb3Nlc3RGYWNlQl1baV1dOwogICAgICAgIGNvbnN0IHdvcmxkYiA9IG5ldyBWZWMzKCk7CiAgICAgICAgd29ybGRiLmNvcHkoYik7CiAgICAgICAgcXVhdEIudm11bHQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHBvc0IudmFkZCh3b3JsZGIsIHdvcmxkYik7CiAgICAgICAgd29ybGRWZXJ0c0IxLnB1c2god29ybGRiKTsKICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQiA+PSAwKSB7CiAgICAgICAgdGhpcy5jbGlwRmFjZUFnYWluc3RIdWxsKHNlcGFyYXRpbmdOb3JtYWwsIHBvc0EsIHF1YXRBLCB3b3JsZFZlcnRzQjEsIG1pbkRpc3QsIG1heERpc3QsIHJlc3VsdCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogRmluZCB0aGUgc2VwYXJhdGluZyBheGlzIGJldHdlZW4gdGhpcyBodWxsIGFuZCBhbm90aGVyCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgdmVjdG9yIHRvIHNhdmUgdGhlIGF4aXMgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyBmYWxzZSBpZiBhIHNlcGFyYXRpb24gaXMgZm91bmQsIGVsc2UgdHJ1ZQogICAgICovCgoKICAgIGZpbmRTZXBhcmF0aW5nQXhpcyhodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCLCB0YXJnZXQsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MzID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRub3JtYWwxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGVsdGFDID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBDcm9zcyA9IG5ldyBWZWMzKCk7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwoKICAgICAgaWYgKCFodWxsQS51bmlxdWVBeGVzKSB7CiAgICAgICAgY29uc3QgbnVtRmFjZXNBID0gZmFjZUxpc3RBID8gZmFjZUxpc3RBLmxlbmd0aCA6IGh1bGxBLmZhY2VzLmxlbmd0aDsgLy8gVGVzdCBmYWNlIG5vcm1hbHMgZnJvbSBodWxsQQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQTsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QVtpXSA6IGk7IC8vIEdldCB3b3JsZCBmYWNlIG5vcm1hbAoKICAgICAgICAgIGZhY2VBTm9ybWFsV1MzLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MzLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEEudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGF4aXMKICAgICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUF4ZXNbaV0sIGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhmYWNlQU5vcm1hbFdTMywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaHVsbEIudW5pcXVlQXhlcykgewogICAgICAgIC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEIKICAgICAgICBjb25zdCBudW1GYWNlc0IgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEIubGVuZ3RoIDogaHVsbEIuZmFjZXMubGVuZ3RoOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QiA/IGZhY2VMaXN0QltpXSA6IGk7CiAgICAgICAgICBXb3JsZG5vcm1hbDEuY29weShodWxsQi5mYWNlTm9ybWFsc1tmaV0pOwogICAgICAgICAgcXVhdEIudm11bHQoV29ybGRub3JtYWwxLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMgaW4gQgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBodWxsQi51bmlxdWVBeGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBxdWF0Qi52bXVsdChodWxsQi51bmlxdWVBeGVzW2ldLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRlc3QgZWRnZXMKCgogICAgICBmb3IgKGxldCBlMCA9IDA7IGUwICE9PSBodWxsQS51bmlxdWVFZGdlcy5sZW5ndGg7IGUwKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgZWRnZQogICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUVkZ2VzW2UwXSwgd29ybGRFZGdlMCk7CgogICAgICAgIGZvciAobGV0IGUxID0gMDsgZTEgIT09IGh1bGxCLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgZTErKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UgMgogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlRWRnZXNbZTFdLCB3b3JsZEVkZ2UxKTsKICAgICAgICAgIHdvcmxkRWRnZTAuY3Jvc3Mod29ybGRFZGdlMSwgQ3Jvc3MpOwoKICAgICAgICAgIGlmICghQ3Jvc3MuYWxtb3N0WmVybygpKSB7CiAgICAgICAgICAgIENyb3NzLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBjb25zdCBkaXN0ID0gaHVsbEEudGVzdFNlcEF4aXMoQ3Jvc3MsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgICAgaWYgKGRpc3QgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGlzdCA8IGRtaW4pIHsKICAgICAgICAgICAgICBkbWluID0gZGlzdDsKICAgICAgICAgICAgICB0YXJnZXQuY29weShDcm9zcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHBvc0IudnN1Yihwb3NBLCBkZWx0YUMpOwoKICAgICAgaWYgKGRlbHRhQy5kb3QodGFyZ2V0KSA+IDAuMCkgewogICAgICAgIHRhcmdldC5uZWdhdGUodGFyZ2V0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFRlc3Qgc2VwYXJhdGluZyBheGlzIGFnYWluc3QgdHdvIGh1bGxzLiBCb3RoIGh1bGxzIGFyZSBwcm9qZWN0ZWQgb250byB0aGUgYXhpcyBhbmQgdGhlIG92ZXJsYXAgc2l6ZSBpcyByZXR1cm5lZCBpZiB0aGVyZSBpcyBvbmUuCiAgICAgKiBAcmV0dXJuIFRoZSBvdmVybGFwIGRlcHRoLCBvciBGQUxTRSBpZiBubyBwZW5ldHJhdGlvbi4KICAgICAqLwoKCiAgICB0ZXN0U2VwQXhpcyhheGlzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKSB7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgQ29udmV4UG9seWhlZHJvbi5wcm9qZWN0KGh1bGxBLCBheGlzLCBwb3NBLCBxdWF0QSwgbWF4bWluQSk7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQiwgYXhpcywgcG9zQiwgcXVhdEIsIG1heG1pbkIpOwogICAgICBjb25zdCBtYXhBID0gbWF4bWluQVswXTsKICAgICAgY29uc3QgbWluQSA9IG1heG1pbkFbMV07CiAgICAgIGNvbnN0IG1heEIgPSBtYXhtaW5CWzBdOwogICAgICBjb25zdCBtaW5CID0gbWF4bWluQlsxXTsKCiAgICAgIGlmIChtYXhBIDwgbWluQiB8fCBtYXhCIDwgbWluQSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gU2VwYXJhdGVkCiAgICAgIH0KCiAgICAgIGNvbnN0IGQwID0gbWF4QSAtIG1pbkI7CiAgICAgIGNvbnN0IGQxID0gbWF4QiAtIG1pbkE7CiAgICAgIGNvbnN0IGRlcHRoID0gZDAgPCBkMSA/IGQwIDogZDE7CiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICBjb25zdCBhYWJibWF4ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWFiYm1pbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29tcHV0ZUxvY2FsQUFCQihhYWJibWluLCBhYWJibWF4KTsKICAgICAgY29uc3QgeCA9IGFhYmJtYXgueCAtIGFhYmJtaW4ueDsKICAgICAgY29uc3QgeSA9IGFhYmJtYXgueSAtIGFhYmJtaW4ueTsKICAgICAgY29uc3QgeiA9IGFhYmJtYXgueiAtIGFhYmJtaW4uejsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeik7CiAgICAgIHRhcmdldC55ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHggKiAyICogeCArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueiA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB5ICogMiAqIHkgKyAyICogeCAqIDIgKiB4KTsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIGZhY2VfaSBJbmRleCBvZiB0aGUgZmFjZQogICAgICovCgoKICAgIGdldFBsYW5lQ29uc3RhbnRPZkZhY2UoZmFjZV9pKSB7CiAgICAgIGNvbnN0IGYgPSB0aGlzLmZhY2VzW2ZhY2VfaV07CiAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ZhY2VfaV07CiAgICAgIGNvbnN0IHYgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCBjID0gLW4uZG90KHYpOwogICAgICByZXR1cm4gYzsKICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgYWdhaW5zdCBhIGh1bGwuCiAgICAgKiBAcGFyYW0gd29ybGRWZXJ0c0IxIEFuIGFycmF5IG9mIFZlYzMgd2l0aCB2ZXJ0aWNlcyBpbiB0aGUgd29ybGQgZnJhbWUuCiAgICAgKiBAcGFyYW0gbWluRGlzdCBEaXN0YW5jZSBjbGFtcGluZwogICAgICogQHBhcmFtIEFycmF5IHJlc3VsdCBBcnJheSB0byBzdG9yZSByZXN1bHRpbmcgY29udGFjdCBwb2ludHMgaW4uIFdpbGwgYmUgb2JqZWN0cyB3aXRoIHByb3BlcnRpZXM6IHBvaW50LCBkZXB0aCwgbm9ybWFsLiBUaGVzZSBhcmUgcmVwcmVzZW50ZWQgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgZmFjZUFOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGVkZ2UwID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkUGxhbmVBbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHBsYW5lTm9ybWFsV1MxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRBMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVOb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwogICAgICBjb25zdCB3b3JsZFZlcnRzQjIgPSBbXTsKICAgICAgY29uc3QgcFZ0eEluID0gd29ybGRWZXJ0c0IxOwogICAgICBjb25zdCBwVnR4T3V0ID0gd29ybGRWZXJ0c0IyOwogICAgICBsZXQgY2xvc2VzdEZhY2VBID0gLTE7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsgLy8gRmluZCB0aGUgZmFjZSB3aXRoIG5vcm1hbCBjbG9zZXN0IHRvIHRoZSBzZXBhcmF0aW5nIGF4aXMKCiAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgaHVsbEEuZmFjZXMubGVuZ3RoOyBmYWNlKyspIHsKICAgICAgICBmYWNlQU5vcm1hbFdTLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MsIGZhY2VBTm9ybWFsV1MpOwogICAgICAgIGNvbnN0IGQgPSBmYWNlQU5vcm1hbFdTLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQSA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY2xvc2VzdEZhY2VBIDwgMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBHZXQgdGhlIGZhY2UgYW5kIGNvbnN0cnVjdCBjb25uZWN0ZWQgZmFjZXMKCgogICAgICBjb25zdCBwb2x5QSA9IGh1bGxBLmZhY2VzW2Nsb3Nlc3RGYWNlQV07CiAgICAgIHBvbHlBLmNvbm5lY3RlZEZhY2VzID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBodWxsQS5mYWNlc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgLyogU2hhcmluZyBhIHZlcnRleCovCiAgICAgICAgICBwb2x5QS5pbmRleE9mKGh1bGxBLmZhY2VzW2ldW2pdKSAhPT0gLTEgJiYKICAgICAgICAgIC8qIE5vdCB0aGUgb25lIHdlIGFyZSBsb29raW5nIGZvciBjb25uZWN0aW9ucyBmcm9tICovCiAgICAgICAgICBpICE9PSBjbG9zZXN0RmFjZUEgJiYKICAgICAgICAgIC8qIE5vdCBhbHJlYWR5IGFkZGVkICovCiAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5pbmRleE9mKGkpID09PSAtMSkgewogICAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5wdXNoKGkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBDbGlwIHRoZSBwb2x5Z29uIHRvIHRoZSBiYWNrIG9mIHRoZSBwbGFuZXMgb2YgYWxsIGZhY2VzIG9mIGh1bGwgQSwKICAgICAgLy8gdGhhdCBhcmUgYWRqYWNlbnQgdG8gdGhlIHdpdG5lc3MgZmFjZQoKCiAgICAgIGNvbnN0IG51bVZlcnRpY2VzQSA9IHBvbHlBLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVmVydGljZXNBOyBpKyspIHsKICAgICAgICBjb25zdCBhID0gaHVsbEEudmVydGljZXNbcG9seUFbaV1dOwogICAgICAgIGNvbnN0IGIgPSBodWxsQS52ZXJ0aWNlc1twb2x5QVsoaSArIDEpICUgbnVtVmVydGljZXNBXV07CiAgICAgICAgYS52c3ViKGIsIGVkZ2UwKTsKICAgICAgICBXb3JsZEVkZ2UwLmNvcHkoZWRnZTApOwogICAgICAgIHF1YXRBLnZtdWx0KFdvcmxkRWRnZTAsIFdvcmxkRWRnZTApOwogICAgICAgIHBvc0EudmFkZChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICB3b3JsZFBsYW5lQW5vcm1hbDEuY29weSh0aGlzLmZhY2VOb3JtYWxzW2Nsb3Nlc3RGYWNlQV0pOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBwb3NBLnZhZGQod29ybGRQbGFuZUFub3JtYWwxLCB3b3JsZFBsYW5lQW5vcm1hbDEpOwogICAgICAgIFdvcmxkRWRnZTAuY3Jvc3Mod29ybGRQbGFuZUFub3JtYWwxLCBwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgcGxhbmVOb3JtYWxXUzEubmVnYXRlKHBsYW5lTm9ybWFsV1MxKTsKICAgICAgICB3b3JsZEExLmNvcHkoYSk7CiAgICAgICAgcXVhdEEudm11bHQod29ybGRBMSwgd29ybGRBMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIGNvbnN0IG90aGVyRmFjZSA9IHBvbHlBLmNvbm5lY3RlZEZhY2VzW2ldOwogICAgICAgIGxvY2FsUGxhbmVOb3JtYWwuY29weSh0aGlzLmZhY2VOb3JtYWxzW290aGVyRmFjZV0pOwogICAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShvdGhlckZhY2UpOwogICAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgICBxdWF0QS52bXVsdChwbGFuZU5vcm1hbFdTLCBwbGFuZU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsgLy8gQ2xpcCBmYWNlIGFnYWluc3Qgb3VyIGNvbnN0cnVjdGVkIHBsYW5lCgogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0UGxhbmUocFZ0eEluLCBwVnR4T3V0LCBwbGFuZU5vcm1hbFdTLCBwbGFuZUVxV1MpOyAvLyBUaHJvdyBhd2F5IGFsbCBjbGlwcGVkIHBvaW50cywgYnV0IHNhdmUgdGhlIHJlbWFpbmluZyB1bnRpbCBuZXh0IGNsaXAKCiAgICAgICAgd2hpbGUgKHBWdHhJbi5sZW5ndGgpIHsKICAgICAgICAgIHBWdHhJbi5zaGlmdCgpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHBWdHhPdXQubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4ucHVzaChwVnR4T3V0LnNoaWZ0KCkpOwogICAgICAgIH0KICAgICAgfSAvLyBvbmx5IGtlZXAgY29udGFjdCBwb2ludHMgdGhhdCBhcmUgYmVoaW5kIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgY29uc3QgbG9jYWxQbGFuZUVxID0gdGhpcy5nZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGNsb3Nlc3RGYWNlQSk7CiAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgIGNvbnN0IHBsYW5lRXFXUyA9IGxvY2FsUGxhbmVFcSAtIHBsYW5lTm9ybWFsV1MuZG90KHBvc0EpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwVnR4SW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgZGVwdGggPSBwbGFuZU5vcm1hbFdTLmRvdChwVnR4SW5baV0pICsgcGxhbmVFcVdTOyAvLyA/Pz8KCiAgICAgICAgaWYgKGRlcHRoIDw9IG1pbkRpc3QpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBjbGFtcGVkOiBkZXB0aD0ke2RlcHRofSB0byBtaW5EaXN0PSR7bWluRGlzdH1gKTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0YXJnZXQudmFkZCh2ZXJ0c1tpXSwgdGFyZ2V0KTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnNjYWxlKDEgLyB2ZXJ0cy5sZW5ndGgsIHRhcmdldCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zZm9ybSBhbGwgbG9jYWwgcG9pbnRzLiBXaWxsIGNoYW5nZSB0aGUgLnZlcnRpY2VzCiAgICAgKi8KCgogICAgdHJhbnNmb3JtQWxsUG9pbnRzKG9mZnNldCwgcXVhdCkgewogICAgICBjb25zdCBuID0gdGhpcy52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsgLy8gQXBwbHkgcm90YXRpb24KCiAgICAgIGlmIChxdWF0KSB7CiAgICAgICAgLy8gUm90YXRlIHZlcnRpY2VzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfSAvLyBSb3RhdGUgZmFjZSBub3JtYWxzCgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLmZhY2VOb3JtYWxzW2ldOwogICAgICAgICAgcXVhdC52bXVsdCh2LCB2KTsKICAgICAgICB9CiAgICAgICAgLyoKICAgICAgICAgICAgICAvLyBSb3RhdGUgZWRnZXMKICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHRoaXMudW5pcXVlRWRnZXNbaV07CiAgICAgICAgICAgICAgICAgIHF1YXQudm11bHQodix2KTsKICAgICAgICAgICAgICB9Ki8KCiAgICAgIH0gLy8gQXBwbHkgb2Zmc2V0CgoKICAgICAgaWYgKG9mZnNldCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICB2LnZhZGQob2Zmc2V0LCB2KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIgcCBpcyBpbnNpZGUgdGhlIHBvbHloZWRyYS4gTXVzdCBiZSBpbiBsb2NhbCBjb29yZHMuCiAgICAgKiBUaGUgcG9pbnQgbGllcyBvdXRzaWRlIG9mIHRoZSBjb252ZXggaHVsbCBvZiB0aGUgb3RoZXIgcG9pbnRzIGlmIGFuZCBvbmx5IGlmIHRoZSBkaXJlY3Rpb24KICAgICAqIG9mIGFsbCB0aGUgdmVjdG9ycyBmcm9tIGl0IHRvIHRob3NlIG90aGVyIHBvaW50cyBhcmUgb24gbGVzcyB0aGFuIG9uZSBoYWxmIG9mIGEgc3BoZXJlIGFyb3VuZCBpdC4KICAgICAqIEBwYXJhbSBwIEEgcG9pbnQgZ2l2ZW4gaW4gbG9jYWwgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBwb2ludElzSW5zaWRlKHApIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCBmYWNlcyA9IHRoaXMuZmFjZXM7CiAgICAgIGNvbnN0IG5vcm1hbHMgPSB0aGlzLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBwb3NpdGl2ZVJlc3VsdCA9IG51bGw7CiAgICAgIGNvbnN0IHBvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5nZXRBdmVyYWdlUG9pbnRMb2NhbChwb2ludEluc2lkZSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgbiA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ZhY2VzW2ldWzBdXTsgLy8gV2Ugb25seSBuZWVkIG9uZSBwb2ludCBpbiB0aGUgZmFjZQogICAgICAgIC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgICBjb25zdCB2VG9QID0gbmV3IFZlYzMoKTsKICAgICAgICBwLnZzdWIodiwgdlRvUCk7CiAgICAgICAgY29uc3QgcjEgPSBuLmRvdCh2VG9QKTsKICAgICAgICBjb25zdCB2VG9Qb2ludEluc2lkZSA9IG5ldyBWZWMzKCk7CiAgICAgICAgcG9pbnRJbnNpZGUudnN1Yih2LCB2VG9Qb2ludEluc2lkZSk7CiAgICAgICAgY29uc3QgcjIgPSBuLmRvdCh2VG9Qb2ludEluc2lkZSk7CgogICAgICAgIGlmIChyMSA8IDAgJiYgcjIgPiAwIHx8IHIxID4gMCAmJiByMiA8IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gRW5jb3VudGVyZWQgc29tZSBvdGhlciBzaWduLiBFeGl0LgogICAgICAgIH0KICAgICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgICAgcmV0dXJuIHBvc2l0aXZlUmVzdWx0ID8gMSA6IC0xOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbWF4IGFuZCBtaW4gZG90IHByb2R1Y3Qgb2YgYSBjb252ZXggaHVsbCBhdCBwb3NpdGlvbiAocG9zLHF1YXQpIHByb2plY3RlZCBvbnRvIGFuIGF4aXMuCiAgICAgKiBSZXN1bHRzIGFyZSBzYXZlZCBpbiB0aGUgYXJyYXkgbWF4bWluLgogICAgICogQHBhcmFtIHJlc3VsdCByZXN1bHRbMF0gYW5kIHJlc3VsdFsxXSB3aWxsIGJlIHNldCB0byBtYXhpbXVtIGFuZCBtaW5pbXVtLCByZXNwZWN0aXZlbHkuCiAgICAgKi8KCgogICAgc3RhdGljIHByb2plY3Qoc2hhcGUsIGF4aXMsIHBvcywgcXVhdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IG4gPSBzaGFwZS52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IGxvY2FsQXhpcyA9IHByb2plY3RfbG9jYWxBeGlzOwogICAgICBsZXQgbWF4ID0gMDsKICAgICAgbGV0IG1pbiA9IDA7CiAgICAgIGNvbnN0IGxvY2FsT3JpZ2luID0gcHJvamVjdF9sb2NhbE9yaWdpbjsKICAgICAgY29uc3QgdnMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgbG9jYWxPcmlnaW4uc2V0WmVybygpOyAvLyBUcmFuc2Zvcm0gdGhlIGF4aXMgdG8gbG9jYWwKCiAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBheGlzLCBsb2NhbEF4aXMpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBsb2NhbE9yaWdpbiwgbG9jYWxPcmlnaW4pOwogICAgICBjb25zdCBhZGQgPSBsb2NhbE9yaWdpbi5kb3QobG9jYWxBeGlzKTsKICAgICAgbWluID0gbWF4ID0gdnNbMF0uZG90KGxvY2FsQXhpcyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IG47IGkrKykgewogICAgICAgIGNvbnN0IHZhbCA9IHZzW2ldLmRvdChsb2NhbEF4aXMpOwoKICAgICAgICBpZiAodmFsID4gbWF4KSB7CiAgICAgICAgICBtYXggPSB2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsIDwgbWluKSB7CiAgICAgICAgICBtaW4gPSB2YWw7CiAgICAgICAgfQogICAgICB9CgogICAgICBtaW4gLT0gYWRkOwogICAgICBtYXggLT0gYWRkOwoKICAgICAgaWYgKG1pbiA+IG1heCkgewogICAgICAgIC8vIEluY29uc2lzdGVudCAtIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gbWluOwogICAgICAgIG1pbiA9IG1heDsKICAgICAgICBtYXggPSB0ZW1wOwogICAgICB9IC8vIE91dHB1dAoKCiAgICAgIHJlc3VsdFswXSA9IG1heDsKICAgICAgcmVzdWx0WzFdID0gbWluOwogICAgfQoKICB9CiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHByb2plY3RfbG9jYWxBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBwcm9qZWN0X2xvY2FsT3JpZ2luID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCiAgY2xhc3MgQm94IGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBUaGUgaGFsZiBleHRlbnRzIG9mIHRoZSBib3guCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgYnkgdGhlIGNvbnRhY3QgZ2VuZXJhdG9yIHRvIG1ha2UgY29udGFjdHMgd2l0aCBvdGhlciBjb252ZXggcG9seWhlZHJhIGZvciBleGFtcGxlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihoYWxmRXh0ZW50cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQk9YCiAgICAgIH0pOwogICAgICB0aGlzLmhhbGZFeHRlbnRzID0gaGFsZkV4dGVudHM7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gbnVsbDsKICAgICAgdGhpcy51cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBsb2NhbCBjb252ZXggcG9seWhlZHJvbiByZXByZXNlbnRhdGlvbiB1c2VkIGZvciBzb21lIGNvbGxpc2lvbnMuCiAgICAgKi8KCgogICAgdXBkYXRlQ29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uKCkgewogICAgICBjb25zdCBzeCA9IHRoaXMuaGFsZkV4dGVudHMueDsKICAgICAgY29uc3Qgc3kgPSB0aGlzLmhhbGZFeHRlbnRzLnk7CiAgICAgIGNvbnN0IHN6ID0gdGhpcy5oYWxmRXh0ZW50cy56OwogICAgICBjb25zdCBWID0gVmVjMzsKICAgICAgY29uc3QgdmVydGljZXMgPSBbbmV3IFYoLXN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCAtc3ksIHN6KSwgbmV3IFYoc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgc3ksIHN6KSwgbmV3IFYoLXN4LCBzeSwgc3opXTsKICAgICAgY29uc3QgZmFjZXMgPSBbWzMsIDIsIDEsIDBdLCAvLyAtegogICAgICBbNCwgNSwgNiwgN10sIC8vICt6CiAgICAgIFs1LCA0LCAwLCAxXSwgLy8gLXkKICAgICAgWzIsIDMsIDcsIDZdLCAvLyAreQogICAgICBbMCwgNCwgNywgM10sIC8vIC14CiAgICAgIFsxLCAyLCA2LCA1XSAvLyAreAogICAgICBdOwogICAgICBjb25zdCBheGVzID0gW25ldyBWKDAsIDAsIDEpLCBuZXcgVigwLCAxLCAwKSwgbmV3IFYoMSwgMCwgMCldOwogICAgICBjb25zdCBoID0gbmV3IENvbnZleFBvbHloZWRyb24oewogICAgICAgIHZlcnRpY2VzLAogICAgICAgIGZhY2VzLAogICAgICAgIGF4ZXMKICAgICAgfSk7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gaDsKICAgICAgaC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0aGUgaW5lcnRpYSBvZiB0aGUgYm94LgogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CiAgY29uc3Qgd29ybGRDb3JuZXJUZW1wUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCB3b3JsZENvcm5lcnNUZW1wID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCiAgY29uc3QgQk9EWV9UWVBFUyA9IHsKICAgIC8qKiBEWU5BTUlDICovCiAgICBEWU5BTUlDOiAxLAoKICAgIC8qKiBTVEFUSUMgKi8KICAgIFNUQVRJQzogMiwKCiAgICAvKiogS0lORU1BVElDICovCiAgICBLSU5FTUFUSUM6IDQKICB9OwogIC8qKgogICAqIEJvZHlUeXBlCiAgICovCgogIC8qKgogICAqIEJPRFlfU0xFRVBfU1RBVEVTCiAgICovCiAgY29uc3QgQk9EWV9TTEVFUF9TVEFURVMgPSB7CiAgICAvKiogQVdBS0UgKi8KICAgIEFXQUtFOiAwLAoKICAgIC8qKiBTTEVFUFkgKi8KICAgIFNMRUVQWTogMSwKCiAgICAvKiogU0xFRVBJTkcgKi8KICAgIFNMRUVQSU5HOiAyCiAgfTsKICAvKioKICAgKiBCb2R5U2xlZXBTdGF0ZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBhbGwgYm9keSB0eXBlcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBzaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKDEpCiAgICogICAgIGNvbnN0IGJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoewogICAqICAgICAgIG1hc3M6IDEsCiAgICogICAgICAgc2hhcGUsCiAgICogICAgIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keSkKICAgKi8KICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pZCA9IEJvZHkuaWRDb3VudGVyKys7CiAgICAgIHRoaXMuaW5kZXggPSAtMTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcmVzdWx0KTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIHdvcmxkIHZlY3RvciB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHZlY3RvclRvTG9jYWxGcmFtZSh3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIGxvY2FsIGJvZHkgcG9pbnQgdG8gd29ybGQgZnJhbWUuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBib2R5IHdpdGggYSBsb2NhbCBvZmZzZXQgYW5kIG9yaWVudGF0aW9uLgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgYWRkU2hhcGUoc2hhcGUsIF9vZmZzZXQsIF9vcmllbnRhdGlvbikgewogICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CgogICAgICBpZiAoX29mZnNldCkgewogICAgICAgIG9mZnNldC5jb3B5KF9vZmZzZXQpOwogICAgICB9CgogICAgICBpZiAoX29yaWVudGF0aW9uKSB7CiAgICAgICAgb3JpZW50YXRpb24uY29weShfb3JpZW50YXRpb24pOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5wdXNoKHNoYXBlKTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMucHVzaChvZmZzZXQpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnB1c2gob3JpZW50YXRpb24pOwogICAgICB0aGlzLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdSYWRpdXMoKTsKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBzaGFwZS5ib2R5ID0gdGhpczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhIHNoYXBlIGZyb20gdGhlIGJvZHkuCiAgICAgKiBAcmV0dXJuIFRoZSBib2R5IG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICByZW1vdmVTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2hhcGVzLmluZGV4T2Yoc2hhcGUpOwoKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIGNvbnNvbGUud2FybignU2hhcGUgZG9lcyBub3QgYmVsb25nIHRvIHRoZSBib2R5Jyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hhcGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPcmllbnRhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IG51bGw7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGJvdW5kaW5nIHJhZGl1cyBvZiB0aGUgYm9keS4gU2hvdWxkIGJlIGRvbmUgaWYgYW55IG9mIHRoZSBzaGFwZXMgYXJlIGNoYW5nZWQuCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdSYWRpdXMoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGxldCByYWRpdXMgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldOwogICAgICAgIHNoYXBlLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2hhcGVPZmZzZXRzW2ldLmxlbmd0aCgpOwogICAgICAgIGNvbnN0IHIgPSBzaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1czsKCiAgICAgICAgaWYgKG9mZnNldCArIHIgPiByYWRpdXMpIHsKICAgICAgICAgIHJhZGl1cyA9IG9mZnNldCArIHI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gcmFkaXVzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSAuYWFiYgogICAgICovCgoKICAgIHVwZGF0ZUFBQkIoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3Qgc2hhcGVPcmllbnRhdGlvbnMgPSB0aGlzLnNoYXBlT3JpZW50YXRpb25zOwogICAgICBjb25zdCBOID0gc2hhcGVzLmxlbmd0aDsKICAgICAgY29uc3Qgb2Zmc2V0ID0gdG1wVmVjOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IHRtcFF1YXQ7CiAgICAgIGNvbnN0IGJvZHlRdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBhYWJiID0gdGhpcy5hYWJiOwogICAgICBjb25zdCBzaGFwZUFBQkIgPSB1cGRhdGVBQUJCX3NoYXBlQUFCQjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsgLy8gR2V0IHNoYXBlIHdvcmxkIHBvc2l0aW9uCgogICAgICAgIGJvZHlRdWF0LnZtdWx0KHNoYXBlT2Zmc2V0c1tpXSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQudmFkZCh0aGlzLnBvc2l0aW9uLCBvZmZzZXQpOyAvLyBHZXQgc2hhcGUgd29ybGQgcXVhdGVybmlvbgoKICAgICAgICBib2R5UXVhdC5tdWx0KHNoYXBlT3JpZW50YXRpb25zW2ldLCBvcmllbnRhdGlvbik7IC8vIEdldCBzaGFwZSBBQUJCCgogICAgICAgIHNoYXBlLmNhbGN1bGF0ZVdvcmxkQUFCQihvZmZzZXQsIG9yaWVudGF0aW9uLCBzaGFwZUFBQkIubG93ZXJCb3VuZCwgc2hhcGVBQUJCLnVwcGVyQm91bmQpOwoKICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgYWFiYi5jb3B5KHNoYXBlQUFCQik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFhYmIuZXh0ZW5kKHNoYXBlQUFCQik7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgYC5pbmVydGlhV29ybGRgIGFuZCBgLmludkluZXJ0aWFXb3JsZGAKICAgICAqLwoKCiAgICB1cGRhdGVJbmVydGlhV29ybGQoZm9yY2UpIHsKICAgICAgY29uc3QgSSA9IHRoaXMuaW52SW5lcnRpYTsKCiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDsgZWxzZSB7CiAgICAgICAgY29uc3QgbTEgPSB1aXdfbTE7CiAgICAgICAgY29uc3QgbTIgPSB1aXdfbTI7CiAgICAgICAgbTEuc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbih0aGlzLnF1YXRlcm5pb24pOwogICAgICAgIG0xLnRyYW5zcG9zZShtMik7CiAgICAgICAgbTEuc2NhbGUoSSwgbTEpOwogICAgICAgIG0xLm1tdWx0KG0yLCB0aGlzLmludkluZXJ0aWFXb3JsZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgZm9yY2UgdG8gYSBwb2ludCBvZiB0aGUgYm9keS4gVGhpcyBjb3VsZCBmb3IgZXhhbXBsZSBiZSBhIHBvaW50IG9uIHRoZSBCb2R5IHN1cmZhY2UuCiAgICAgKiBBcHBseWluZyBmb3JjZSB0aGlzIHdheSB3aWxsIGFkZCB0byBCb2R5LmZvcmNlIGFuZCBCb2R5LnRvcnF1ZS4KICAgICAqIEBwYXJhbSBmb3JjZSBUaGUgYW1vdW50IG9mIGZvcmNlIHRvIGFkZC4KICAgICAqIEBwYXJhbSByZWxhdGl2ZVBvaW50IEEgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIHRvIGFwcGx5IHRoZSBmb3JjZSBvbi4KICAgICAqLwoKCiAgICBhcHBseUZvcmNlKGZvcmNlLCByZWxhdGl2ZVBvaW50KSB7CiAgICAgIGlmIChyZWxhdGl2ZVBvaW50ID09PSB2b2lkIDApIHsKICAgICAgICByZWxhdGl2ZVBvaW50ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgLy8gTmVlZGVkPwogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBmb3JjZQoKCiAgICAgIGNvbnN0IHJvdEZvcmNlID0gQm9keV9hcHBseUZvcmNlX3JvdEZvcmNlOwogICAgICByZWxhdGl2ZVBvaW50LmNyb3NzKGZvcmNlLCByb3RGb3JjZSk7IC8vIEFkZCBsaW5lYXIgZm9yY2UKCiAgICAgIHRoaXMuZm9yY2UudmFkZChmb3JjZSwgdGhpcy5mb3JjZSk7IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgogICAgICB0aGlzLnRvcnF1ZS52YWRkKHJvdEZvcmNlLCB0aGlzLnRvcnF1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGZvcmNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEZvcmNlKGxvY2FsRm9yY2UsIGxvY2FsUG9pbnQpIHsKICAgICAgaWYgKGxvY2FsUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIGxvY2FsUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQpIHsKICAgICAgaWYgKHJlbGF0aXZlUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcG9pbnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGJvZHkgY2VudGVyCgoKICAgICAgY29uc3QgciA9IHJlbGF0aXZlUG9pbnQ7IC8vIENvbXB1dGUgcHJvZHVjZWQgY2VudHJhbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCB2ZWxvID0gQm9keV9hcHBseUltcHVsc2VfdmVsbzsKICAgICAgdmVsby5jb3B5KGltcHVsc2UpOwogICAgICB2ZWxvLnNjYWxlKHRoaXMuaW52TWFzcywgdmVsbyk7IC8vIEFkZCBsaW5lYXIgaW1wdWxzZQoKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHZlbG8sIHRoaXMudmVsb2NpdHkpOyAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgaW1wdWxzZSB2ZWxvY2l0eQoKICAgICAgY29uc3Qgcm90VmVsbyA9IEJvZHlfYXBwbHlJbXB1bHNlX3JvdFZlbG87CiAgICAgIHIuY3Jvc3MoaW1wdWxzZSwgcm90VmVsbyk7CiAgICAgIC8qCiAgICAgICByb3RWZWxvLnggKj0gdGhpcy5pbnZJbmVydGlhLng7CiAgICAgICByb3RWZWxvLnkgKj0gdGhpcy5pbnZJbmVydGlhLnk7CiAgICAgICByb3RWZWxvLnogKj0gdGhpcy5pbnZJbmVydGlhLno7CiAgICAgICAqLwoKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQudm11bHQocm90VmVsbywgcm90VmVsbyk7IC8vIEFkZCByb3RhdGlvbmFsIEltcHVsc2UKCiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnZhZGQocm90VmVsbywgdGhpcy5hbmd1bGFyVmVsb2NpdHkpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBsb2NhbGx5LWRlZmluZWQgaW1wdWxzZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxJbXB1bHNlKGxvY2FsSW1wdWxzZSwgbG9jYWxQb2ludCkgewogICAgICBpZiAobG9jYWxQb2ludCA9PT0gdm9pZCAwKSB7CiAgICAgICAgbG9jYWxQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgd29ybGRJbXB1bHNlID0gQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2U7CiAgICAgIGNvbnN0IHJlbGF0aXZlUG9pbnRXb3JsZCA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludDsgLy8gVHJhbnNmb3JtIHRoZSBmb3JjZSB2ZWN0b3IgdG8gd29ybGQgc3BhY2UKCiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsSW1wdWxzZSwgd29ybGRJbXB1bHNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUltcHVsc2Uod29ybGRJbXB1bHNlLCByZWxhdGl2ZVBvaW50V29ybGQpOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgY2FsbGVkIHdoZW5ldmVyIHlvdSBjaGFuZ2UgdGhlIGJvZHkgc2hhcGUgb3IgbWFzcy4KICAgICAqLwoKCiAgICB1cGRhdGVNYXNzUHJvcGVydGllcygpIHsKICAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBCb2R5X3VwZGF0ZU1hc3NQcm9wZXJ0aWVzX2hhbGZFeHRlbnRzOwogICAgICB0aGlzLmludk1hc3MgPSB0aGlzLm1hc3MgPiAwID8gMS4wIC8gdGhpcy5tYXNzIDogMDsKICAgICAgY29uc3QgSSA9IHRoaXMuaW5lcnRpYTsKICAgICAgY29uc3QgZml4ZWQgPSB0aGlzLmZpeGVkUm90YXRpb247IC8vIEFwcHJveGltYXRlIHdpdGggQUFCQiBib3gKCiAgICAgIHRoaXMudXBkYXRlQUFCQigpOwogICAgICBoYWxmRXh0ZW50cy5zZXQoKHRoaXMuYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLmFhYmIubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLmFhYmIudXBwZXJCb3VuZC55IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueSkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueiAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnopIC8gMik7CiAgICAgIEJveC5jYWxjdWxhdGVJbmVydGlhKGhhbGZFeHRlbnRzLCB0aGlzLm1hc3MsIEkpOwogICAgICB0aGlzLmludkluZXJ0aWEuc2V0KEkueCA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS54IDogMCwgSS55ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnkgOiAwLCBJLnogPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueiA6IDApOwogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCh0cnVlKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHdvcmxkIHZlbG9jaXR5IG9mIGEgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gd29ybGRQb2ludAogICAgICogQHBhcmFtIHJlc3VsdAogICAgICogQHJldHVybiBUaGUgcmVzdWx0IHZlY3Rvci4KICAgICAqLwoKCiAgICBnZXRWZWxvY2l0eUF0V29ybGRQb2ludCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgY29uc3QgciA9IG5ldyBWZWMzKCk7CiAgICAgIHdvcmxkUG9pbnQudnN1Yih0aGlzLnBvc2l0aW9uLCByKTsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MociwgcmVzdWx0KTsKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogTW92ZSB0aGUgYm9keSBmb3J3YXJkIGluIHRpbWUuCiAgICAgKiBAcGFyYW0gZHQgVGltZSBzdGVwCiAgICAgKiBAcGFyYW0gcXVhdE5vcm1hbGl6ZSBTZXQgdG8gdHJ1ZSB0byBub3JtYWxpemUgdGhlIGJvZHkgcXVhdGVybmlvbgogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemVGYXN0IElmIHRoZSBxdWF0ZXJuaW9uIHNob3VsZCBiZSBub3JtYWxpemVkIHVzaW5nICJmYXN0IiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgIC8vIFNhdmUgcHJldmlvdXMgcG9zaXRpb24KICAgICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uLmNvcHkodGhpcy5wb3NpdGlvbik7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uKTsKCiAgICAgIGlmICghKHRoaXMudHlwZSA9PT0gQm9keS5EWU5BTUlDIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHx8IHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIC8vIE9ubHkgZm9yIGR5bmFtaWMKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlbG8gPSB0aGlzLnZlbG9jaXR5OwogICAgICBjb25zdCBhbmd1bGFyVmVsbyA9IHRoaXMuYW5ndWxhclZlbG9jaXR5OwogICAgICBjb25zdCBwb3MgPSB0aGlzLnBvc2l0aW9uOwogICAgICBjb25zdCBmb3JjZSA9IHRoaXMuZm9yY2U7CiAgICAgIGNvbnN0IHRvcnF1ZSA9IHRoaXMudG9ycXVlOwogICAgICBjb25zdCBxdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBpbnZNYXNzID0gdGhpcy5pbnZNYXNzOwogICAgICBjb25zdCBpbnZJbmVydGlhID0gdGhpcy5pbnZJbmVydGlhV29ybGQ7CiAgICAgIGNvbnN0IGxpbmVhckZhY3RvciA9IHRoaXMubGluZWFyRmFjdG9yOwogICAgICBjb25zdCBpTWR0ID0gaW52TWFzcyAqIGR0OwogICAgICB2ZWxvLnggKz0gZm9yY2UueCAqIGlNZHQgKiBsaW5lYXJGYWN0b3IueDsKICAgICAgdmVsby55ICs9IGZvcmNlLnkgKiBpTWR0ICogbGluZWFyRmFjdG9yLnk7CiAgICAgIHZlbG8ueiArPSBmb3JjZS56ICogaU1kdCAqIGxpbmVhckZhY3Rvci56OwogICAgICBjb25zdCBlID0gaW52SW5lcnRpYS5lbGVtZW50czsKICAgICAgY29uc3QgYW5ndWxhckZhY3RvciA9IHRoaXMuYW5ndWxhckZhY3RvcjsKICAgICAgY29uc3QgdHggPSB0b3JxdWUueCAqIGFuZ3VsYXJGYWN0b3IueDsKICAgICAgY29uc3QgdHkgPSB0b3JxdWUueSAqIGFuZ3VsYXJGYWN0b3IueTsKICAgICAgY29uc3QgdHogPSB0b3JxdWUueiAqIGFuZ3VsYXJGYWN0b3IuejsKICAgICAgYW5ndWxhclZlbG8ueCArPSBkdCAqIChlWzBdICogdHggKyBlWzFdICogdHkgKyBlWzJdICogdHopOwogICAgICBhbmd1bGFyVmVsby55ICs9IGR0ICogKGVbM10gKiB0eCArIGVbNF0gKiB0eSArIGVbNV0gKiB0eik7CiAgICAgIGFuZ3VsYXJWZWxvLnogKz0gZHQgKiAoZVs2XSAqIHR4ICsgZVs3XSAqIHR5ICsgZVs4XSAqIHR6KTsgLy8gVXNlIG5ldyB2ZWxvY2l0eSAgLSBsZWFwIGZyb2cKCiAgICAgIHBvcy54ICs9IHZlbG8ueCAqIGR0OwogICAgICBwb3MueSArPSB2ZWxvLnkgKiBkdDsKICAgICAgcG9zLnogKz0gdmVsby56ICogZHQ7CiAgICAgIHF1YXQuaW50ZWdyYXRlKHRoaXMuYW5ndWxhclZlbG9jaXR5LCBkdCwgdGhpcy5hbmd1bGFyRmFjdG9yLCBxdWF0KTsKCiAgICAgIGlmIChxdWF0Tm9ybWFsaXplKSB7CiAgICAgICAgaWYgKHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgICAgICBxdWF0Lm5vcm1hbGl6ZUZhc3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcXVhdC5ub3JtYWxpemUoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsgLy8gVXBkYXRlIHdvcmxkIGluZXJ0aWEKCiAgICAgIHRoaXMudXBkYXRlSW5lcnRpYVdvcmxkKCk7CiAgICB9CgogIH0KICBCb2R5LmlkQ291bnRlciA9IDA7CiAgQm9keS5DT0xMSURFX0VWRU5UX05BTUUgPSAnY29sbGlkZSc7CiAgQm9keS5EWU5BTUlDID0gQk9EWV9UWVBFUy5EWU5BTUlDOwogIEJvZHkuU1RBVElDID0gQk9EWV9UWVBFUy5TVEFUSUM7CiAgQm9keS5LSU5FTUFUSUMgPSBCT0RZX1RZUEVTLktJTkVNQVRJQzsKICBCb2R5LkFXQUtFID0gQk9EWV9TTEVFUF9TVEFURVMuQVdBS0U7CiAgQm9keS5TTEVFUFkgPSBCT0RZX1NMRUVQX1NUQVRFUy5TTEVFUFk7CiAgQm9keS5TTEVFUElORyA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQSU5HOwogIEJvZHkud2FrZXVwRXZlbnQgPSB7CiAgICB0eXBlOiAnd2FrZXVwJwogIH07CiAgQm9keS5zbGVlcHlFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcHknCiAgfTsKICBCb2R5LnNsZWVwRXZlbnQgPSB7CiAgICB0eXBlOiAnc2xlZXAnCiAgfTsKICBjb25zdCB0bXBWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHVwZGF0ZUFBQkJfc2hhcGVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCB1aXdfbTEgPSBuZXcgTWF0MygpOwogIGNvbnN0IHVpd19tMiA9IG5ldyBNYXQzKCk7CiAgbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGJyb2FkcGhhc2UgaW1wbGVtZW50YXRpb25zCiAgICogQGF1dGhvciBzY2h0ZXBwZQogICAqLwogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudXNlQm91bmRpbmdCb3hlcyA9IGZhbHNlOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb2xsaXNpb24gcGFpcnMgZnJvbSB0aGUgd29ybGQKICAgICAqIEBwYXJhbSB3b3JsZCBUaGUgd29ybGQgdG8gc2VhcmNoIGluCiAgICAgKiBAcGFyYW0gcDEgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKiBAcGFyYW0gcDIgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbGxpc2lvblBhaXJzIG5vdCBpbXBsZW1lbnRlZCBmb3IgdGhpcyBCcm9hZFBoYXNlIGNsYXNzIScpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIGJvZHkgcGFpciBuZWVkcyB0byBiZSBpbnRlcnNlY3Rpb24gdGVzdGVkIGF0IGFsbC4KICAgICAqLwoKCiAgICBuZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihib2R5QSwgYm9keUIpIHsKICAgICAgLy8gQ2hlY2sgY29sbGlzaW9uIGZpbHRlciBtYXNrcwogICAgICBpZiAoKGJvZHlBLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUIuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDAgfHwgKGJvZHlCLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUEuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgdHlwZXMKCgogICAgICBpZiAoKChib2R5QS50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlBLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpICYmICgoYm9keUIudHlwZSAmIEJvZHkuU1RBVElDKSAhPT0gMCB8fCBib2R5Qi5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSkgewogICAgICAgIC8vIEJvdGggYm9kaWVzIGFyZSBzdGF0aWMgb3Igc2xlZXBpbmcuIFNraXAuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHZvbHVtZXMgb2YgdHdvIGJvZGllcyBpbnRlcnNlY3QuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0aW9uVGVzdChib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGlmICh0aGlzLnVzZUJvdW5kaW5nQm94ZXMpIHsKICAgICAgICB0aGlzLmRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICogQHBhcmFtIHBhaXJzMSBib2R5QSBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICogQHBhcmFtIHBhaXJzMiBib2R5QiBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICovCgoKICAgIGRvQm91bmRpbmdTcGhlcmVCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgciA9IEJyb2FkcGhhc2VfY29sbGlzaW9uUGFpcnNfcjsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgcik7CiAgICAgIGNvbnN0IGJvdW5kaW5nUmFkaXVzU3VtMiA9IChib2R5QS5ib3VuZGluZ1JhZGl1cyArIGJvZHlCLmJvdW5kaW5nUmFkaXVzKSAqKiAyOwogICAgICBjb25zdCBub3JtMiA9IHIubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgaWYgKG5vcm0yIDwgYm91bmRpbmdSYWRpdXNTdW0yKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgYm94ZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICovCgoKICAgIGRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKGJvZHlBLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlBLnVwZGF0ZUFBQkIoKTsKICAgICAgfQoKICAgICAgaWYgKGJvZHlCLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlCLnVwZGF0ZUFBQkIoKTsKICAgICAgfSAvLyBDaGVjayBBQUJCIC8gQUFCQgoKCiAgICAgIGlmIChib2R5QS5hYWJiLm92ZXJsYXBzKGJvZHlCLmFhYmIpKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBwYWlycyBmcm9tIHRoZSBwYWlyIGFycmF5cy4KICAgICAqLwoKCiAgICBtYWtlUGFpcnNVbmlxdWUocGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgdCA9IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3RlbXA7CiAgICAgIGNvbnN0IHAxID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDE7CiAgICAgIGNvbnN0IHAyID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDI7CiAgICAgIGNvbnN0IE4gPSBwYWlyczEubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIHAxW2ldID0gcGFpcnMxW2ldOwogICAgICAgIHAyW2ldID0gcGFpcnMyW2ldOwogICAgICB9CgogICAgICBwYWlyczEubGVuZ3RoID0gMDsKICAgICAgcGFpcnMyLmxlbmd0aCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgaWQxID0gcDFbaV0uaWQ7CiAgICAgICAgY29uc3QgaWQyID0gcDJbaV0uaWQ7CiAgICAgICAgY29uc3Qga2V5ID0gaWQxIDwgaWQyID8gYCR7aWQxfSwke2lkMn1gIDogYCR7aWQyfSwke2lkMX1gOwogICAgICAgIHRba2V5XSA9IGk7CiAgICAgICAgdC5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHQua2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IHQua2V5cy5wb3AoKTsKICAgICAgICBjb25zdCBwYWlySW5kZXggPSB0W2tleV07CiAgICAgICAgcGFpcnMxLnB1c2gocDFbcGFpckluZGV4XSk7CiAgICAgICAgcGFpcnMyLnB1c2gocDJbcGFpckluZGV4XSk7CiAgICAgICAgZGVsZXRlIHRba2V5XTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBUbyBiZSBpbXBsZW1lbnRlZCBieSBzdWJjYXNzZXMKICAgICAqLwoKCiAgICBzZXRXb3JsZCh3b3JsZCkge30KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBvdmVybGFwLgogICAgICovCgoKICAgIHN0YXRpYyBib3VuZGluZ1NwaGVyZUNoZWNrKGJvZHlBLCBib2R5QikgewogICAgICBjb25zdCBkaXN0ID0gbmV3IFZlYzMoKTsgLy8gYnNjX2Rpc3Q7CgogICAgICBib2R5QS5wb3NpdGlvbi52c3ViKGJvZHlCLnBvc2l0aW9uLCBkaXN0KTsKICAgICAgY29uc3Qgc2EgPSBib2R5QS5zaGFwZXNbMF07CiAgICAgIGNvbnN0IHNiID0gYm9keUIuc2hhcGVzWzBdOwogICAgICByZXR1cm4gTWF0aC5wb3coc2EuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzYi5ib3VuZGluZ1NwaGVyZVJhZGl1cywgMikgPiBkaXN0Lmxlbmd0aFNxdWFyZWQoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbGwgdGhlIGJvZGllcyB3aXRoaW4gdGhlIEFBQkIuCiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KHdvcmxkLCBhYWJiLCByZXN1bHQpIHsKICAgICAgY29uc29sZS53YXJuKCcuYWFiYlF1ZXJ5IGlzIG5vdCBpbXBsZW1lbnRlZCBpbiB0aGlzIEJyb2FkcGhhc2Ugc3ViY2xhc3MuJyk7CiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgfSAvLyBUZW1wIG9iamVjdHMKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBRdWF0ZXJuaW9uKCk7CiAgbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogTmFpdmUgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbiwgdXNlZCBpbiBsYWNrIG9mIGJldHRlciBvbmVzLgogICAqCiAgICogVGhlIG5haXZlIGJyb2FkcGhhc2UgbG9va3MgYXQgYWxsIHBvc3NpYmxlIHBhaXJzIHdpdGhvdXQgcmVzdHJpY3Rpb24sIHRoZXJlZm9yZSBpdCBoYXMgY29tcGxleGl0eSBOXjIgXyh3aGljaCBpcyBiYWQpXwogICAqLwogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSB3b3JsZC5ib2RpZXNbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfSAvLyBVZ2x5IGhhY2sgdW50aWwgQm9keSBnZXRzIGFhYmIKCgogICAgICAgIGlmIChiLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgfQoKICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCiAgY2xhc3MgUmF5Y2FzdFJlc3VsdCB7CiAgICAvKioKICAgICAqIHJheUZyb21Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiByYXlUb1dvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdE5vcm1hbFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdFBvaW50V29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGFzSGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIHNoYXBlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJvZHkKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGluZGV4IG9mIHRoZSBoaXQgdHJpYW5nbGUsIGlmIHRoZSBoaXQgc2hhcGUgd2FzIGEgdHJpbWVzaAogICAgICovCgogICAgLyoqCiAgICAgKiBEaXN0YW5jZSB0byB0aGUgaGl0LiBXaWxsIGJlIHNldCB0byAtMSBpZiB0aGVyZSB3YXMgbm8gaGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSByYXkgc2hvdWxkIHN0b3AgdHJhdmVyc2luZyB0aGUgYm9kaWVzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzZXQgYWxsIHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogYWJvcnQKICAgICAqLwoKCiAgICBhYm9ydCgpIHsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHNldChyYXlGcm9tV29ybGQsIHJheVRvV29ybGQsIGhpdE5vcm1hbFdvcmxkLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuY29weShyYXlGcm9tV29ybGQpOwogICAgICB0aGlzLnJheVRvV29ybGQuY29weShyYXlUb1dvcmxkKTsKICAgICAgdGhpcy5oaXROb3JtYWxXb3JsZC5jb3B5KGhpdE5vcm1hbFdvcmxkKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLmNvcHkoaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZTsKICAgICAgdGhpcy5ib2R5ID0gYm9keTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IGRpc3RhbmNlOwogICAgfQoKICB9CgogIGxldCBfU2hhcGUkdHlwZXMkU1BIRVJFLCBfU2hhcGUkdHlwZXMkUExBTkUsIF9TaGFwZSR0eXBlcyRCT1gsIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiwgX1NoYXBlJHR5cGVzJENPTlZFWFBPLCBfU2hhcGUkdHlwZXMkSEVJR0hURkksIF9TaGFwZSR0eXBlcyRUUklNRVNIOwoKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KICBjb25zdCBSQVlfTU9ERVMgPSB7CiAgICAvKiogQ0xPU0VTVCAqLwogICAgQ0xPU0VTVDogMSwKCiAgICAvKiogQU5ZICovCiAgICBBTlk6IDIsCgogICAgLyoqIEFMTCAqLwogICAgQUxMOiA0CiAgfTsKICAvKioKICAgKiBSYXlNb2RlCiAgICovCgogIF9TaGFwZSR0eXBlcyRTUEhFUkUgPSBTaGFwZS50eXBlcy5TUEhFUkU7CiAgX1NoYXBlJHR5cGVzJFBMQU5FID0gU2hhcGUudHlwZXMuUExBTkU7CiAgX1NoYXBlJHR5cGVzJEJPWCA9IFNoYXBlLnR5cGVzLkJPWDsKICBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIgPSBTaGFwZS50eXBlcy5DWUxJTkRFUjsKICBfU2hhcGUkdHlwZXMkQ09OVkVYUE8gPSBTaGFwZS50eXBlcy5DT05WRVhQT0xZSEVEUk9OOwogIF9TaGFwZSR0eXBlcyRIRUlHSFRGSSA9IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxEOwogIF9TaGFwZSR0eXBlcyRUUklNRVNIID0gU2hhcGUudHlwZXMuVFJJTUVTSDsKCiAgLyoqCiAgICogQSBsaW5lIGluIDNEIHNwYWNlIHRoYXQgaW50ZXJzZWN0cyBib2RpZXMgYW5kIHJldHVybiBwb2ludHMuCiAgICovCiAgY2xhc3MgUmF5IHsKICAgIC8qKgogICAgICogZnJvbQogICAgICovCgogICAgLyoqCiAgICAgKiB0bwogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb24KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHByZWNpc2lvbiBvZiB0aGUgcmF5LiBVc2VkIHdoZW4gY2hlY2tpbmcgcGFyYWxsZWxpdHkgZXRjLgogICAgICogQGRlZmF1bHQgMC4wMDAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBgZmFsc2VgIGlmIHlvdSBkb24ndCB3YW50IHRoZSBSYXkgdG8gdGFrZSBgY29sbGlzaW9uUmVzcG9uc2VgIGZsYWdzIGludG8gYWNjb3VudCBvbiBib2RpZXMgYW5kIHNoYXBlcy4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHJheSBza2lwcyBhbnkgaGl0cyB3aXRoIG5vcm1hbC5kb3QocmF5RGlyZWN0aW9uKSA8IDAuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJNYXNrCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJHcm91cAogICAgICogQGRlZmF1bHQgLTEKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGludGVyc2VjdGlvbiBtb2RlLiBTaG91bGQgYmUgUmF5LkFOWSwgUmF5LkFMTCBvciBSYXkuQ0xPU0VTVC4KICAgICAqIEBkZWZhdWx0IFJBWS5BTlkKICAgICAqLwoKICAgIC8qKgogICAgICogQ3VycmVudCByZXN1bHQgb2JqZWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBXaWxsIGJlIHNldCB0byBgdHJ1ZWAgZHVyaW5nIGludGVyc2VjdFdvcmxkKCkgaWYgdGhlIHJheSBoaXQgYW55dGhpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZXItcHJvdmlkZWQgcmVzdWx0IGNhbGxiYWNrLiBXaWxsIGJlIHVzZWQgaWYgbW9kZSBpcyBSYXkuQUxMLgogICAgICovCgogICAgLyoqCiAgICAgKiBDTE9TRVNUCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBBTEwKICAgICAqLwogICAgZ2V0IFtfU2hhcGUkdHlwZXMkU1BIRVJFXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFNwaGVyZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRQTEFORV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RQbGFuZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRCT1hdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Qm94OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENZTElOREVSXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRDT05WRVhQT10oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkSEVJR0hURkldKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkVFJJTUVTSF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RUcmltZXNoOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKGZyb20sIHRvKSB7CiAgICAgIGlmIChmcm9tID09PSB2b2lkIDApIHsKICAgICAgICBmcm9tID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgaWYgKHRvID09PSB2b2lkIDApIHsKICAgICAgICB0byA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CiAgUmF5LkNMT1NFU1QgPSBSQVlfTU9ERVMuQ0xPU0VTVDsKICBSYXkuQU5ZID0gUkFZX01PREVTLkFOWTsKICBSYXkuQUxMID0gUkFZX01PREVTLkFMTDsKICBjb25zdCB0bXBBQUJCJDEgPSBuZXcgQUFCQigpOwogIGNvbnN0IHRtcEFycmF5ID0gW107CiAgY29uc3QgdjEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3hpID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3FpID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCBpbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYyA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgUmF5Y2FzdFJlc3VsdCgpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleF92ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9sb2NhbFRvID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkSW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIG5ldyBBQUJCKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF90cmlhbmdsZXMgPSBbXTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyZWVUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7CiAgY29uc3QgdjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCBkaXJlY3Rpb24sIHBvc2l0aW9uKSB7CiAgICAvLyB2MCBpcyB2ZWN0b3IgZnJvbSBmcm9tIHRvIHBvc2l0aW9uCiAgICBwb3NpdGlvbi52c3ViKGZyb20sIHYwKTsKICAgIGNvbnN0IGRvdCA9IHYwLmRvdChkaXJlY3Rpb24pOyAvLyBpbnRlcnNlY3QgPSBkaXJlY3Rpb24qZG90ICsgZnJvbQoKICAgIGRpcmVjdGlvbi5zY2FsZShkb3QsIGludGVyc2VjdCk7CiAgICBpbnRlcnNlY3QudmFkZChmcm9tLCBpbnRlcnNlY3QpOwogICAgY29uc3QgZGlzdGFuY2UgPSBwb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyc2VjdCk7CiAgICByZXR1cm4gZGlzdGFuY2U7CiAgfQoKICAvKioKICAgKiBTd2VlcCBhbmQgcHJ1bmUgYnJvYWRwaGFzZSBhbG9uZyBvbmUgYXhpcy4KICAgKi8KICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5kaXJ0eSkgewogICAgICAgIHRoaXMuc29ydExpc3QoKTsKICAgICAgICB0aGlzLmRpcnR5ID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNJbmRleCA9IHRoaXMuYXhpc0luZGV4OwogICAgICBsZXQgYXhpcyA9ICd4JzsKCiAgICAgIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBheGlzID0gJ3knOwogICAgICB9CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAyKSB7CiAgICAgICAgYXhpcyA9ICd6JzsKICAgICAgfQoKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBhYWJiLmxvd2VyQm91bmRbYXhpc107CiAgICAgIGFhYmIudXBwZXJCb3VuZFtheGlzXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXhpc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gYXhpc0xpc3RbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KCiAgY2xhc3MgVXRpbHMgewogICAgLyoqCiAgICAgKiBFeHRlbmQgYW4gb3B0aW9ucyBvYmplY3Qgd2l0aCBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEBwYXJhbSBvcHRpb25zIFRoZSBvcHRpb25zIG9iamVjdC4gTWF5IGJlIGZhbHN5OiBpbiB0aGlzIGNhc2UsIGEgbmV3IG9iamVjdCBpcyBjcmVhdGVkIGFuZCByZXR1cm5lZC4KICAgICAqIEBwYXJhbSBkZWZhdWx0cyBBbiBvYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEByZXR1cm4gVGhlIG1vZGlmaWVkIG9wdGlvbnMgb2JqZWN0LgogICAgICovCiAgICBzdGF0aWMgZGVmYXVsdHMob3B0aW9ucywgZGVmYXVsdHMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBiYXNlIGNsYXNzCiAgICovCiAgY2xhc3MgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIEVxdWF0aW9ucyB0byBiZSBzb2x2ZWQgaW4gdGhpcyBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50IHRoZSBib2RpZXMgdG8gY29sbGlkZSB3aGVuIHRoZXkgYXJlIGNvbm5lY3RlZC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KICBDb25zdHJhaW50LmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJvdGF0aW9uYWwgPSBuZXcgVmVjMygpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIG90aGVyIEphY29iaWFuRWxlbWVudAogICAgICovCgoKICAgIG11bHRpcGx5RWxlbWVudChlbGVtZW50KSB7CiAgICAgIHJldHVybiBlbGVtZW50LnNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyBlbGVtZW50LnJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHdpdGggdHdvIHZlY3RvcnMKICAgICAqLwoKCiAgICBtdWx0aXBseVZlY3RvcnMoc3BhdGlhbCwgcm90YXRpb25hbCkgewogICAgICByZXR1cm4gc3BhdGlhbC5kb3QodGhpcy5zcGF0aWFsKSArIHJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCiAgY2xhc3MgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBNaW5pbXVtIChyZWFkOiBuZWdhdGl2ZSBtYXgpIGZvcmNlIHRvIGJlIGFwcGxpZWQgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heGltdW0gKHJlYWQ6IHBvc2l0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogQSBudW1iZXIsIHByb3BvcnRpb25hbCB0byB0aGUgZm9yY2UgYWRkZWQgdG8gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYmksIGJqLCBtaW5Gb3JjZSwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1pbkZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtaW5Gb3JjZSA9IC0xZTY7CiAgICAgIH0KCiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQogIEVxdWF0aW9uLmlkQ291bnRlciA9IDA7CiAgY29uc3QgaU1maSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaU1maiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWlfdm11bHRfdGF1aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWpfdm11bHRfdGF1aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wID0gbmV3IFZlYzMoKTsKICBjb25zdCBhZGRUb1dsYW1iZGFfdGVtcCA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KICBjbGFzcyBDb250YWN0RXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqICJib3VuY2luZXNzIjogdTEgPSAtZSp1MAogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZC1vcmllbnRlZCB2ZWN0b3IgdGhhdCBnb2VzIGZyb20gdGhlIGNlbnRlciBvZiBiaSB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgc3RhcnRzIGluIGJvZHkgaiBwb3NpdGlvbiBhbmQgZ29lcyB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQ29udGFjdCBub3JtYWwsIHBvaW50aW5nIG91dCBvZiBib2R5IGkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAwLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSAwLjA7CiAgICAgIHRoaXMucmkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJqID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5uaSA9IG5ldyBWZWMzKCk7CiAgICB9CgogICAgY29tcHV0ZUIoaCkgewogICAgICBjb25zdCBhID0gdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgcmkgPSB0aGlzLnJpOwogICAgICBjb25zdCByaiA9IHRoaXMucmo7CiAgICAgIGNvbnN0IHJpeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDI7CiAgICAgIGNvbnN0IHZpID0gYmkudmVsb2NpdHk7CiAgICAgIGNvbnN0IHdpID0gYmkuYW5ndWxhclZlbG9jaXR5OwogICAgICBiaS5mb3JjZTsKICAgICAgYmkudG9ycXVlOwogICAgICBjb25zdCB2aiA9IGJqLnZlbG9jaXR5OwogICAgICBjb25zdCB3aiA9IGJqLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmouZm9yY2U7CiAgICAgIGJqLnRvcnF1ZTsKICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDM7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgbiA9IHRoaXMubmk7IC8vIENhbHVjbGF0ZSBjcm9zcyBwcm9kdWN0cwoKICAgICAgcmkuY3Jvc3Mobiwgcml4bik7CiAgICAgIHJqLmNyb3NzKG4sIHJqeG4pOyAvLyBnID0geGorcmogLSh4aStyaSkKICAgICAgLy8gRyA9IFsgLW5pICAtcml4biAgbmkgIHJqeG4gXQoKICAgICAgbi5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeG4ubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkobik7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanhuKTsgLy8gQ2FsY3VsYXRlIHRoZSBwZW5ldHJhdGlvbiB2ZWN0b3IKCiAgICAgIHBlbmV0cmF0aW9uVmVjLmNvcHkoYmoucG9zaXRpb24pOwogICAgICBwZW5ldHJhdGlvblZlYy52YWRkKHJqLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIoYmkucG9zaXRpb24sIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgcGVuZXRyYXRpb25WZWMudnN1YihyaSwgcGVuZXRyYXRpb25WZWMpOwogICAgICBjb25zdCBnID0gbi5kb3QocGVuZXRyYXRpb25WZWMpOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgY29uc3QgZVBsdXNPbmUgPSB0aGlzLnJlc3RpdHV0aW9uICsgMTsKICAgICAgY29uc3QgR1cgPSBlUGx1c09uZSAqIHZqLmRvdChuKSAtIGVQbHVzT25lICogdmkuZG90KG4pICsgd2ouZG90KHJqeG4pIC0gd2kuZG90KHJpeG4pOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmVsYXRpdmUgdmVsb2NpdHkgaW4gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCgogICAgZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbCgpIHsKICAgICAgY29uc3QgdmkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aTsKICAgICAgY29uc3QgdmogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92ajsKICAgICAgY29uc3QgeGkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aTsKICAgICAgY29uc3QgeGogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94ajsKICAgICAgY29uc3QgcmVsVmVsID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfcmVsVmVsOwogICAgICB0aGlzLmJpLnBvc2l0aW9uLnZhZGQodGhpcy5yaSwgeGkpOwogICAgICB0aGlzLmJqLnBvc2l0aW9uLnZhZGQodGhpcy5yaiwgeGopOwogICAgICB0aGlzLmJpLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhpLCB2aSk7CiAgICAgIHRoaXMuYmouZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoeGosIHZqKTsKICAgICAgdmkudnN1Yih2aiwgcmVsVmVsKTsKICAgICAgcmV0dXJuIHRoaXMubmkuZG90KHJlbFZlbCk7CiAgICB9CgogIH0KICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMKCiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDMgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZpID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3hqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF9yZWxWZWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBDb25uZWN0cyB0d28gYm9kaWVzIGF0IGdpdmVuIG9mZnNldCBwb2ludHMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgYm9keUEgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgY29uc3QgYm9keUIgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgYm9keUEucG9zaXRpb24uc2V0KC0xLCAwLCAwKQogICAqICAgICBib2R5Qi5wb3NpdGlvbi5zZXQoMSwgMCwgMCkKICAgKiAgICAgYm9keUEuYWRkU2hhcGUoc2hhcGVBKQogICAqICAgICBib2R5Qi5hZGRTaGFwZShzaGFwZUIpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUEpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUIpCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RBID0gbmV3IFZlYzMoMSwgMCwgMCkKICAgKiAgICAgY29uc3QgbG9jYWxQaXZvdEIgPSBuZXcgVmVjMygtMSwgMCwgMCkKICAgKiAgICAgY29uc3QgY29uc3RyYWludCA9IG5ldyBQb2ludFRvUG9pbnRDb25zdHJhaW50KGJvZHlBLCBsb2NhbFBpdm90QSwgYm9keUIsIGxvY2FsUGl2b3RCKQogICAqICAgICB3b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpCiAgICovCiAgY2xhc3MgUG9pbnRUb1BvaW50Q29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlCLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcGl2b3RBIFRoZSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3Mgb2YgYm9keUEgd2hpY2ggYm9keUEgaXMgY29uc3RyYWluZWQgdG8uCiAgICAgKiBAcGFyYW0gYm9keUIgQm9keSB0aGF0IHdpbGwgYmUgY29uc3RyYWluZWQgaW4gYSBzaW1pbGFyIHdheSB0byB0aGUgc2FtZSBwb2ludCBhcyBib2R5QS4gV2Ugd2lsbCB0aGVyZWZvcmUgZ2V0IGEgbGluayBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5Qi4gSWYgbm90IHNwZWNpZmllZCwgYm9keUEgd2lsbCBiZSBjb25zdHJhaW5lZCB0byBhIHN0YXRpYyBwb2ludC4KICAgICAqIEBwYXJhbSBwaXZvdEIgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QiB3aGljaCBib2R5QiBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBtYXhGb3JjZSBUaGUgbWF4aW11bSBmb3JjZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIGNvbnN0cmFpbiB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgcGl2b3RBLCBib2R5QiwgcGl2b3RCLCBtYXhGb3JjZSkgewogICAgICBpZiAocGl2b3RBID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAocGl2b3RCID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAobWF4Rm9yY2UgPT09IHZvaWQgMCkgewogICAgICAgIG1heEZvcmNlID0gMWU2OwogICAgICB9CgogICAgICBzdXBlcihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQoKICAvKioKICAgKiBDb25lIGVxdWF0aW9uLiBXb3JrcyB0byBrZWVwIHRoZSBnaXZlbiBib2R5IHdvcmxkIHZlY3RvcnMgYWxpZ25lZCwgb3IgdGlsdGVkIHdpdGhpbiBhIGdpdmVuIGFuZ2xlIGZyb20gZWFjaCBvdGhlci4KICAgKi8KICBjbGFzcyBDb25lRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIExvY2FsIGF4aXMgaW4gQQogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEIKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlICJjb25lIGFuZ2xlIiB0byBrZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CiAgY29uc3QgdG1wVmVjMSQyID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWMyJDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxFcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIG1heEFuZ2xlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IHRtcFZlYzEkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQxID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCiAgY2xhc3MgQ29uZVR3aXN0Q29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBheGlzIGRpcmVjdGlvbiBmb3IgdGhlIGNvbnN0cmFpbnQgb2YgdGhlIGJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGFwZXJ0dXJlIGFuZ2xlIG9mIHRoZSBjb25lLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHdpc3QgYW5nbGUgb2YgdGhlIGpvaW50LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gb3B0aW9ucy5heGlzQSA/IG9wdGlvbnMuYXhpc0EuY2xvbmUoKSA6IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gISFvcHRpb25zLmNvbGxpZGVDb25uZWN0ZWQ7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgICAgY29uc3QgYyA9IHRoaXMuY29uZUVxdWF0aW9uID0gbmV3IENvbmVFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCB0ID0gdGhpcy50d2lzdEVxdWF0aW9uID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy50d2lzdEFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMudHdpc3RBbmdsZSA6IDA7IC8vIE1ha2UgdGhlIGNvbmUgZXF1YXRpb24gcHVzaCB0aGUgYm9kaWVzIHRvd2FyZCB0aGUgY29uZSBheGlzLCBub3Qgb3V0d2FyZAoKICAgICAgYy5tYXhGb3JjZSA9IDA7CiAgICAgIGMubWluRm9yY2UgPSAtbWF4Rm9yY2U7IC8vIE1ha2UgdGhlIHR3aXN0IGVxdWF0aW9uIGFkZCB0b3JxdWUgdG93YXJkIHRoZSBpbml0aWFsIHBvc2l0aW9uCgogICAgICB0Lm1heEZvcmNlID0gMDsKICAgICAgdC5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChjLCB0KTsKICAgIH0KCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBjb25lID0gdGhpcy5jb25lRXF1YXRpb247CiAgICAgIGNvbnN0IHR3aXN0ID0gdGhpcy50d2lzdEVxdWF0aW9uOwogICAgICBzdXBlci51cGRhdGUoKTsgLy8gVXBkYXRlIHRoZSBheGVzIHRvIHRoZSBjb25lIGNvbnN0cmFpbnQKCiAgICAgIGJvZHlBLnZlY3RvclRvV29ybGRGcmFtZSh0aGlzLmF4aXNBLCBjb25lLmF4aXNBKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0IsIGNvbmUuYXhpc0IpOyAvLyBVcGRhdGUgdGhlIHdvcmxkIGF4ZXMgaW4gdGhlIHR3aXN0IGNvbnN0cmFpbnQKCiAgICAgIHRoaXMuYXhpc0EudGFuZ2VudHModHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNBLCB0d2lzdC5heGlzQSk7CiAgICAgIHRoaXMuYXhpc0IudGFuZ2VudHModHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNCLCB0d2lzdC5heGlzQik7CiAgICAgIGNvbmUuYW5nbGUgPSB0aGlzLmFuZ2xlOwogICAgICB0d2lzdC5tYXhBbmdsZSA9IHRoaXMudHdpc3RBbmdsZTsKICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KICBjbGFzcyBEaXN0YW5jZUNvbnN0cmFpbnQgZXh0ZW5kcyBDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRpc3RhbmNlIFRoZSBkaXN0YW5jZSB0byBrZWVwLiBJZiB1bmRlZmluZWQsIGl0IHdpbGwgYmUgc2V0IHRvIHRoZSBjdXJyZW50IGRpc3RhbmNlIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgZGlzdGFuY2UsIG1heEZvcmNlKSB7CiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHN1cGVyKGJvZHlBLCBib2R5Qik7CgogICAgICBpZiAodHlwZW9mIGRpc3RhbmNlID09PSAndW5kZWZpbmVkJykgewogICAgICAgIGRpc3RhbmNlID0gYm9keUEucG9zaXRpb24uZGlzdGFuY2VUbyhib2R5Qi5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb24gPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goZXEpOyAvLyBNYWtlIGl0IGJpZGlyZWN0aW9uYWwKCiAgICAgIGVxLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICBlcS5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBlcSA9IHRoaXMuZGlzdGFuY2VFcXVhdGlvbjsKICAgICAgY29uc3QgaGFsZkRpc3QgPSB0aGlzLmRpc3RhbmNlICogMC41OwogICAgICBjb25zdCBub3JtYWwgPSBlcS5uaTsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBub3JtYWwuc2NhbGUoaGFsZkRpc3QsIGVxLnJpKTsKICAgICAgbm9ybWFsLnNjYWxlKC1oYWxmRGlzdCwgZXEucmopOwogICAgfQoKICB9CgogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCiAgY2xhc3MgTG9ja0NvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7IC8vIFNldCBwaXZvdCBwb2ludCBpbiBiZXR3ZWVuCgogICAgICBjb25zdCBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoYWxmV2F5ID0gbmV3IFZlYzMoKTsKICAgICAgYm9keUEucG9zaXRpb24udmFkZChib2R5Qi5wb3NpdGlvbiwgaGFsZldheSk7CiAgICAgIGhhbGZXYXkuc2NhbGUoMC41LCBoYWxmV2F5KTsKICAgICAgYm9keUIucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RCKTsKICAgICAgYm9keUEucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RBKTsgLy8gVGhlIHBvaW50LXRvLXBvaW50IGNvbnN0cmFpbnQgd2lsbCBrZWVwIGEgcG9pbnQgc2hhcmVkIGJldHdlZW4gdGhlIGJvZGllcwoKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOyAvLyBTdG9yZSBpbml0aWFsIHJvdGF0aW9uIG9mIHRoZSBib2RpZXMgYXMgdW5pdCB2ZWN0b3JzIGluIHRoZSBsb2NhbCBib2R5IHNwYWNlcwoKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIG1vdG9yIGNvbnN0cmFpbnQuIFRyaWVzIHRvIGtlZXAgdGhlIHJlbGF0aXZlIGFuZ3VsYXIgdmVsb2NpdHkgb2YgdGhlIGJvZGllcyB0byBhIGdpdmVuIHZhbHVlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KCiAgLyoqCiAgICogSGluZ2UgY29uc3RyYWludC4gVGhpbmsgb2YgaXQgYXMgYSBkb29yIGhpbmdlLiBJdCB0cmllcyB0byBrZWVwIHRoZSBkb29yIGluIHRoZSBjb3JyZWN0IHBsYWNlIGFuZCB3aXRoIHRoZSBjb3JyZWN0IG9yaWVudGF0aW9uLgogICAqLwogIGNsYXNzIEhpbmdlQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIGF4aXMsIGRlZmluZWQgbG9jYWxseSBpbiBib2R5Qi4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEhpbmdlQ29uc3RyYWludF91cGRhdGVfdG1wVmVjMiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KICBjbGFzcyBGcmljdGlvbkVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLy8gVGFuZ2VudAoKICAgIC8qKgogICAgICogQHBhcmFtIHNsaXBGb3JjZSBzaG91bGQgYmUgKy1GX2ZyaWN0aW9uID0gKy1tdSAqIEZfbm9ybWFsID0gKy1tdSAqIG0gKiBnCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgc2xpcEZvcmNlKSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLXNsaXBGb3JjZSwgc2xpcEZvcmNlKTsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KICBjbGFzcyBDb250YWN0TWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBJZGVudGlmaWVyIG9mIHRoaXMgbWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBhcnRpY2lwYXRpbmcgbWF0ZXJpYWxzLgogICAgICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgY29udGFjdCBlcXVhdGlvbnMuCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG0xLCBtMiwgb3B0aW9ucykgewogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMywKICAgICAgICBjb250YWN0RXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBjb250YWN0RXF1YXRpb25SZWxheGF0aW9uOiAzLAogICAgICAgIGZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbjogMwogICAgICB9KTsKICAgICAgdGhpcy5pZCA9IENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSBbbTEsIG0yXTsKICAgICAgdGhpcy5mcmljdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb247CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSBvcHRpb25zLnJlc3RpdHV0aW9uOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb247CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb247CiAgICB9CgogIH0KICBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyID0gMDsKCiAgLyoqCiAgICogRGVmaW5lcyBhIHBoeXNpY3MgbWF0ZXJpYWwuCiAgICovCiAgY2xhc3MgTWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBNYXRlcmlhbCBuYW1lLgogICAgICogSWYgb3B0aW9ucyBpcyBhIHN0cmluZywgbmFtZSB3aWxsIGJlIHNldCB0byB0aGF0IHN0cmluZy4KICAgICAqIEB0b2RvIERlcHJlY2F0ZSB0aGlzCiAgICAgKi8KCiAgICAvKiogTWF0ZXJpYWwgaWQuICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGZyaWN0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gZm9yIHRoaXMgbWF0ZXJpYWwuCiAgICAgKiBJZiBub24tbmVnYXRpdmUsIGl0IHdpbGwgYmUgdXNlZCBpbnN0ZWFkIG9mIHRoZSByZXN0aXR1dGlvbiBnaXZlbiBieSBDb250YWN0TWF0ZXJpYWxzLiBJZiB0aGVyZSdzIG5vIG1hdGNoaW5nIENvbnRhY3RNYXRlcmlhbCwgdGhlIHZhbHVlIGZyb20gYGRlZmF1bHRDb250YWN0TWF0ZXJpYWxgIGluIHRoZSBXb3JsZCB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQogIE1hdGVyaWFsLmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwogIGNsYXNzIFNwcmluZyB7CiAgICAvKioKICAgICAqIFJlc3QgbGVuZ3RoIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID4gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID49IDAuCiAgICAgKiBAZGVmYXVsdCAxMDAKICAgICAqLwoKICAgIC8qKgogICAgICogRGFtcGluZyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBGaXJzdCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogU2Vjb25kIGNvbm5lY3RlZCBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBBbmNob3IgZm9yIGJvZHlBIGluIGxvY2FsIGJvZHlBIGNvb3JkaW5hdGVzLgogICAgICogV2hlcmUgdG8gaG9vayB0aGUgc3ByaW5nIHRvIGJvZHkgQSwgaW4gbG9jYWwgYm9keSBjb29yZGluYXRlcy4KICAgICAqIEBkZWZhdWx0IG5ldyBWZWMzKCkKICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QiBpbiBsb2NhbCBib2R5QiBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEIsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJlc3RMZW5ndGggPSB0eXBlb2Ygb3B0aW9ucy5yZXN0TGVuZ3RoID09PSAnbnVtYmVyJyA/IG9wdGlvbnMucmVzdExlbmd0aCA6IDE7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gb3B0aW9ucy5zdGlmZm5lc3MgfHwgMTAwOwogICAgICB0aGlzLmRhbXBpbmcgPSBvcHRpb25zLmRhbXBpbmcgfHwgMTsKICAgICAgdGhpcy5ib2R5QSA9IGJvZHlBOwogICAgICB0aGlzLmJvZHlCID0gYm9keUI7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG9jYWxBbmNob3JBKSB7CiAgICAgICAgdGhpcy5sb2NhbEFuY2hvckEuY29weShvcHRpb25zLmxvY2FsQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQikgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JCLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckIpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckEpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQShvcHRpb25zLndvcmxkQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLndvcmxkQW5jaG9yQikgewogICAgICAgIHRoaXMuc2V0V29ybGRBbmNob3JCKG9wdGlvbnMud29ybGRBbmNob3JCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIHVzaW5nIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHNldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpIHsKICAgICAgdGhpcy5ib2R5QS5wb2ludFRvTG9jYWxGcmFtZSh3b3JsZEFuY2hvckEsIHRoaXMubG9jYWxBbmNob3JBKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBCLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JCLCB0aGlzLmxvY2FsQW5jaG9yQik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQSwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckEocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckEsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckIocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRoZSBzcHJpbmcgZm9yY2UgdG8gdGhlIGNvbm5lY3RlZCBib2RpZXMuCiAgICAgKi8KCgogICAgYXBwbHlGb3JjZSgpIHsKICAgICAgY29uc3QgayA9IHRoaXMuc3RpZmZuZXNzOwogICAgICBjb25zdCBkID0gdGhpcy5kYW1waW5nOwogICAgICBjb25zdCBsID0gdGhpcy5yZXN0TGVuZ3RoOwogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgciA9IGFwcGx5Rm9yY2VfcjsKICAgICAgY29uc3Qgcl91bml0ID0gYXBwbHlGb3JjZV9yX3VuaXQ7CiAgICAgIGNvbnN0IHUgPSBhcHBseUZvcmNlX3U7CiAgICAgIGNvbnN0IGYgPSBhcHBseUZvcmNlX2Y7CiAgICAgIGNvbnN0IHRtcCA9IGFwcGx5Rm9yY2VfdG1wOwogICAgICBjb25zdCB3b3JsZEFuY2hvckEgPSBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQTsKICAgICAgY29uc3Qgd29ybGRBbmNob3JCID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckI7CiAgICAgIGNvbnN0IHJpID0gYXBwbHlGb3JjZV9yaTsKICAgICAgY29uc3QgcmogPSBhcHBseUZvcmNlX3JqOwogICAgICBjb25zdCByaV94X2YgPSBhcHBseUZvcmNlX3JpX3hfZjsKICAgICAgY29uc3QgcmpfeF9mID0gYXBwbHlGb3JjZV9yal94X2Y7IC8vIEdldCB3b3JsZCBhbmNob3JzCgogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpOwogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQih3b3JsZEFuY2hvckIpOyAvLyBHZXQgb2Zmc2V0IHBvaW50cwoKICAgICAgd29ybGRBbmNob3JBLnZzdWIoYm9keUEucG9zaXRpb24sIHJpKTsKICAgICAgd29ybGRBbmNob3JCLnZzdWIoYm9keUIucG9zaXRpb24sIHJqKTsgLy8gQ29tcHV0ZSBkaXN0YW5jZSB2ZWN0b3IgYmV0d2VlbiB3b3JsZCBhbmNob3IgcG9pbnRzCgogICAgICB3b3JsZEFuY2hvckIudnN1Yih3b3JsZEFuY2hvckEsIHIpOwogICAgICBjb25zdCBybGVuID0gci5sZW5ndGgoKTsKICAgICAgcl91bml0LmNvcHkocik7CiAgICAgIHJfdW5pdC5ub3JtYWxpemUoKTsgLy8gQ29tcHV0ZSByZWxhdGl2ZSB2ZWxvY2l0eSBvZiB0aGUgYW5jaG9yIHBvaW50cywgdQoKICAgICAgYm9keUIudmVsb2NpdHkudnN1Yihib2R5QS52ZWxvY2l0eSwgdSk7IC8vIEFkZCByb3RhdGlvbmFsIHZlbG9jaXR5CgogICAgICBib2R5Qi5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmosIHRtcCk7CiAgICAgIHUudmFkZCh0bXAsIHUpOwogICAgICBib2R5QS5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmksIHRtcCk7CiAgICAgIHUudnN1Yih0bXAsIHUpOyAvLyBGID0gLSBrICogKCB4IC0gTCApIC0gRCAqICggdSApCgogICAgICByX3VuaXQuc2NhbGUoLWsgKiAocmxlbiAtIGwpIC0gZCAqIHUuZG90KHJfdW5pdCksIGYpOyAvLyBBZGQgZm9yY2VzIHRvIGJvZGllcwoKICAgICAgYm9keUEuZm9yY2UudnN1YihmLCBib2R5QS5mb3JjZSk7CiAgICAgIGJvZHlCLmZvcmNlLnZhZGQoZiwgYm9keUIuZm9yY2UpOyAvLyBBbmd1bGFyIGZvcmNlCgogICAgICByaS5jcm9zcyhmLCByaV94X2YpOwogICAgICByai5jcm9zcyhmLCByal94X2YpOwogICAgICBib2R5QS50b3JxdWUudnN1YihyaV94X2YsIGJvZHlBLnRvcnF1ZSk7CiAgICAgIGJvZHlCLnRvcnF1ZS52YWRkKHJqX3hfZiwgYm9keUIudG9ycXVlKTsKICAgIH0KCiAgfQogIGNvbnN0IGFwcGx5Rm9yY2VfciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yX3VuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfdSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV93b3JsZEFuY2hvckIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmlfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JqX3hfZiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV90bXAgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBXaGVlbEluZm8KICAgKi8KICBjbGFzcyBXaGVlbEluZm8gewogICAgLyoqCiAgICAgKiBNYXggdHJhdmVsIGRpc3RhbmNlIG9mIHRoZSBzdXNwZW5zaW9uLCBpbiBtZXRlcnMuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNwZWVkIHRvIGFwcGx5IHRvIHRoZSB3aGVlbCByb3RhdGlvbiB3aGVuIHRoZSB3aGVlbCBpcyBzbGlkaW5nLgogICAgICogQGRlZmF1bHQgLTAuMQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCBzaG91bGQgYmUgdXNlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaWRpbmcKICAgICAqLwoKICAgIC8qKgogICAgICogQ29ubmVjdGlvbiBwb2ludCwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBjaGFzc2lzIGJvZHkgZnJhbWUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Mb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlTG9jYWwKICAgICAqLwoKICAgIC8qKgogICAgICogYXhsZVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25SZXN0TGVuZ3RoCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25NYXhMZW5ndGgKICAgICAqIEBkZWZhdWx0IDIKICAgICAqLwoKICAgIC8qKgogICAgICogcmFkaXVzCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25TdGlmZm5lc3MKICAgICAqIEBkZWZhdWx0IDEwMAogICAgICovCgogICAgLyoqCiAgICAgKiBkYW1waW5nQ29tcHJlc3Npb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdSZWxheGF0aW9uCiAgICAgKiBAZGVmYXVsdCAxMAogICAgICovCgogICAgLyoqCiAgICAgKiBmcmljdGlvblNsaXAKICAgICAqIEBkZWZhdWx0IDEwLjUKICAgICAqLwoKICAgIC8qKiBmb3J3YXJkQWNjZWxlcmF0aW9uICovCgogICAgLyoqIHNpZGVBY2NlbGVyYXRpb24gKi8KCiAgICAvKioKICAgICAqIHN0ZWVyaW5nCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIHZhbHVlLCBpbiByYWRpYW5zLgogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBkZWx0YVJvdGF0aW9uCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJvbGxJbmZsdWVuY2UKICAgICAqIEBkZWZhdWx0IDAuMDEKICAgICAqLwoKICAgIC8qKgogICAgICogbWF4U3VzcGVuc2lvbkZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGVuZ2luZUZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJyYWtlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGlzRnJvbnRXaGVlbAogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkZvcmNlCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaXBJbmZvCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNraWRJbmZvCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25MZW5ndGgKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2lkZUltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogZm9yd2FyZEltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHJlc3VsdCBmcm9tIHJheWNhc3RpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZWVsIHdvcmxkIHRyYW5zZm9ybS4KICAgICAqLwoKICAgIC8qKgogICAgICogaXNJbkNvbnRhY3QKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQogIGNvbnN0IGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCByZWxwb3MgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCiAgY2xhc3MgUmF5Y2FzdFZlaGljbGUgewogICAgLyoqIFRoZSBjYXIgY2hhc3NpcyBib2R5LiAqLwoKICAgIC8qKiBUaGUgd2hlZWxzLiAqLwoKICAgIC8qKiBXaWxsIGJlIHNldCB0byB0cnVlIGlmIHRoZSBjYXIgaXMgc2xpZGluZy4gKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHJpZ2h0IGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIGZvcndhcmQgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBJbmRleCBvZiB0aGUgdXAgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBUaGUgY29uc3RyYWludHMuICovCgogICAgLyoqIE9wdGlvbmFsIHByZS1zdGVwIGNhbGxiYWNrLiAqLwoKICAgIC8qKiBOdW1iZXIgb2Ygd2hlZWxzIG9uIHRoZSBncm91bmQuICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIHRoaXMuY2hhc3Npc0JvZHkgPSBvcHRpb25zLmNoYXNzaXNCb2R5OwogICAgICB0aGlzLndoZWVsSW5mb3MgPSBbXTsKICAgICAgdGhpcy5zbGlkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMud29ybGQgPSBudWxsOwogICAgICB0aGlzLmluZGV4UmlnaHRBeGlzID0gdHlwZW9mIG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleFJpZ2h0QXhpcyA6IDI7CiAgICAgIHRoaXMuaW5kZXhGb3J3YXJkQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4Rm9yd2FyZEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzIDogMDsKICAgICAgdGhpcy5pbmRleFVwQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4VXBBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhVcEF4aXMgOiAxOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gW107CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHt9OwoKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gMDsKICAgICAgdGhpcy5udW1XaGVlbHNPbkdyb3VuZCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHdoZWVsLiBGb3IgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9wdGlvbnMsIHNlZSBgV2hlZWxJbmZvYC4KICAgICAqLwoKCiAgICBhZGRXaGVlbChvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzYgPSBuZXcgVmVjMygpOwogIG5ldyBSYXkoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfcmF5dmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYXN0UmF5X3RhcmdldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZGlyZWN0aW9ucyA9IFtuZXcgVmVjMygxLCAwLCAwKSwgbmV3IFZlYzMoMCwgMSwgMCksIG5ldyBWZWMzKDAsIDAsIDEpXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSBuZXcgVmVjMygpOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2F4bGUgPSBbXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9mb3J3YXJkV1MgPSBbXTsKICBjb25zdCBzaWRlRnJpY3Rpb25TdGlmZm5lc3MyID0gMTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjYWxjUm9sbGluZ0ZyaWN0aW9uKGJvZHkwLCBib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCwgbWF4SW1wdWxzZSkgewogICAgbGV0IGoxID0gMDsKICAgIGNvbnN0IGNvbnRhY3RQb3NXb3JsZCA9IGZyaWN0aW9uUG9zV29ybGQ7IC8vIGNvbnN0IHJlbF9wb3MxID0gbmV3IFZlYzMoKTsKICAgIC8vIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKCiAgICBjb25zdCB2ZWwxID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwxOwogICAgY29uc3QgdmVsMiA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMjsKICAgIGNvbnN0IHZlbCA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsOyAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MC5wb3NpdGlvbiwgcmVsX3BvczEpOwogICAgLy8gY29udGFjdFBvc1dvcmxkLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MyKTsKCiAgICBib2R5MC5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDEpOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoY29udGFjdFBvc1dvcmxkLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgdnJlbCA9IGZyaWN0aW9uRGlyZWN0aW9uV29ybGQuZG90KHZlbCk7CiAgICBjb25zdCBkZW5vbTAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHkwLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkKTsKICAgIGNvbnN0IGRlbm9tMSA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTEsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgcmVsYXhhdGlvbiA9IDE7CiAgICBjb25zdCBqYWNEaWFnQUJJbnYgPSByZWxheGF0aW9uIC8gKGRlbm9tMCArIGRlbm9tMSk7IC8vIGNhbGN1bGF0ZSBqIHRoYXQgbW92ZXMgdXMgdG8gemVybyByZWxhdGl2ZSB2ZWxvY2l0eQoKICAgIGoxID0gLXZyZWwgKiBqYWNEaWFnQUJJbnY7CgogICAgaWYgKG1heEltcHVsc2UgPCBqMSkgewogICAgICBqMSA9IG1heEltcHVsc2U7CiAgICB9CgogICAgaWYgKGoxIDwgLW1heEltcHVsc2UpIHsKICAgICAgajEgPSAtbWF4SW1wdWxzZTsKICAgIH0KCiAgICByZXR1cm4gajE7CiAgfQoKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5LCBwb3MsIG5vcm1hbCkgewogICAgY29uc3QgcjAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwOwogICAgY29uc3QgYzAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwOwogICAgY29uc3QgdmVjID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl92ZWM7CiAgICBjb25zdCBtID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tOwogICAgcG9zLnZzdWIoYm9keS5wb3NpdGlvbiwgcjApOwogICAgcjAuY3Jvc3Mobm9ybWFsLCBjMCk7CiAgICBib2R5LmludkluZXJ0aWFXb3JsZC52bXVsdChjMCwgbSk7CiAgICBtLmNyb3NzKHIwLCB2ZWMpOwogICAgcmV0dXJuIGJvZHkuaW52TWFzcyArIG5vcm1hbC5kb3QodmVjKTsKICB9CgogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbCA9IG5ldyBWZWMzKCk7IC8vIGJpbGF0ZXJhbCBjb25zdHJhaW50IGJldHdlZW4gdHdvIGR5bmFtaWMgb2JqZWN0cwoKICBmdW5jdGlvbiByZXNvbHZlU2luZ2xlQmlsYXRlcmFsKGJvZHkxLCBwb3MxLCBib2R5MiwgcG9zMiwgbm9ybWFsKSB7CiAgICBjb25zdCBub3JtYWxMZW5TcXIgPSBub3JtYWwubGVuZ3RoU3F1YXJlZCgpOwoKICAgIGlmIChub3JtYWxMZW5TcXIgPiAxLjEpIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vIGltcHVsc2UKICAgIH0gLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwogICAgLy8gcG9zMS52c3ViKGJvZHkxLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBwb3MyLnZzdWIoYm9keTIucG9zaXRpb24sIHJlbF9wb3MyKTsKCgogICAgY29uc3QgdmVsMSA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMTsKICAgIGNvbnN0IHZlbDIgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDI7CiAgICBjb25zdCB2ZWwgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDsKICAgIGJvZHkxLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHBvczEsIHZlbDEpOwogICAgYm9keTIuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMiwgdmVsMik7CiAgICB2ZWwxLnZzdWIodmVsMiwgdmVsKTsKICAgIGNvbnN0IHJlbF92ZWwgPSBub3JtYWwuZG90KHZlbCk7CiAgICBjb25zdCBjb250YWN0RGFtcGluZyA9IDAuMjsKICAgIGNvbnN0IG1hc3NUZXJtID0gMSAvIChib2R5MS5pbnZNYXNzICsgYm9keTIuaW52TWFzcyk7CiAgICBjb25zdCBpbXB1bHNlID0gLWNvbnRhY3REYW1waW5nICogcmVsX3ZlbCAqIG1hc3NUZXJtOwogICAgcmV0dXJuIGltcHVsc2U7CiAgfQoKICAvKioKICAgKiBTcGhlcmljYWwgc2hhcGUKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCByYWRpdXMgPSAxCiAgICogICAgIGNvbnN0IHNwaGVyZVNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUocmFkaXVzKQogICAqICAgICBjb25zdCBzcGhlcmVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHNwaGVyZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoc3BoZXJlQm9keSkKICAgKi8KICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cyAhPT0gdW5kZWZpbmVkID8gcmFkaXVzIDogMS4wOwoKICAgICAgaWYgKHRoaXMucmFkaXVzIDwgMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHNwaGVyZSByYWRpdXMgY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKiogY2FsY3VsYXRlTG9jYWxJbmVydGlhICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgSSA9IDIuMCAqIG1hc3MgKiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzIC8gNS4wOwogICAgICB0YXJnZXQueCA9IEk7CiAgICAgIHRhcmdldC55ID0gSTsKICAgICAgdGFyZ2V0LnogPSBJOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqIHZvbHVtZSAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogTWF0aC5wb3codGhpcy5yYWRpdXMsIDMpIC8gMy4wOwogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gdGhpcy5yYWRpdXM7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgciA9IHRoaXMucmFkaXVzOwogICAgICBjb25zdCBheGVzID0gWyd4JywgJ3knLCAneiddOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBheGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYXggPSBheGVzW2ldOwogICAgICAgIG1pbltheF0gPSBwb3NbYXhdIC0gcjsKICAgICAgICBtYXhbYXhdID0gcG9zW2F4XSArIHI7CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMgZm9yIGNhbGN1bGF0aW9uCgogIG5ldyBWZWMzKCk7IC8vIFJlbGF0aXZlIHZlbG9jaXR5CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpIHsKICAgICAgaWYgKHJhZGl1c1RvcCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzVG9wID0gMTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzQm90dG9tID0gMTsKICAgICAgfQoKICAgICAgaWYgKGhlaWdodCA9PT0gdm9pZCAwKSB7CiAgICAgICAgaGVpZ2h0ID0gMTsKICAgICAgfQoKICAgICAgaWYgKG51bVNlZ21lbnRzID09PSB2b2lkIDApIHsKICAgICAgICBudW1TZWdtZW50cyA9IDg7CiAgICAgIH0KCiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQoKICAvKioKICAgKiBQYXJ0aWNsZSBzaGFwZS4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwYXJ0aWNsZVNoYXBlID0gbmV3IENBTk5PTi5QYXJ0aWNsZSgpCiAgICogICAgIGNvbnN0IHBhcnRpY2xlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBwYXJ0aWNsZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGFydGljbGVCb2R5KQogICAqLwogIGNsYXNzIFBhcnRpY2xlIGV4dGVuZHMgU2hhcGUgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QQVJUSUNMRQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSAwOwogICAgfQoKICAgIGNhbGN1bGF0ZVdvcmxkQUFCQihwb3MsIHF1YXQsIG1pbiwgbWF4KSB7CiAgICAgIC8vIEdldCBlYWNoIGF4aXMgbWF4CiAgICAgIG1pbi5jb3B5KHBvcyk7CiAgICAgIG1heC5jb3B5KHBvcyk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBwbGFuZSwgZmFjaW5nIGluIHRoZSBaIGRpcmVjdGlvbi4gVGhlIHBsYW5lIGhhcyBpdHMgc3VyZmFjZSBhdCB6PTAgYW5kIGV2ZXJ5dGhpbmcgYmVsb3cgej0wIGlzIGFzc3VtZWQgdG8gYmUgc29saWQgcGxhbmUuIFRvIG1ha2UgdGhlIHBsYW5lIGZhY2UgaW4gc29tZSBvdGhlciBkaXJlY3Rpb24gdGhhbiB6LCB5b3UgbXVzdCBwdXQgaXQgaW5zaWRlIGEgQm9keSBhbmQgcm90YXRlIHRoYXQgYm9keS4gU2VlIHRoZSBkZW1vcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwbGFuZVNoYXBlID0gbmV3IENBTk5PTi5QbGFuZSgpCiAgICogICAgIGNvbnN0IHBsYW5lQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDAsIHNoYXBlOiAgcGxhbmVTaGFwZSB9KQogICAqICAgICBwbGFuZUJvZHkucXVhdGVybmlvbi5zZXRGcm9tRXVsZXIoLU1hdGguUEkgLyAyLCAwLCAwKSAvLyBtYWtlIGl0IGZhY2UgdXAKICAgKiAgICAgd29ybGQuYWRkQm9keShwbGFuZUJvZHkpCiAgICovCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE51bWJlci5NQVhfVkFMVUU7CiAgICB9CiAgICAvKiogY29tcHV0ZVdvcmxkTm9ybWFsICovCgoKICAgIGNvbXB1dGVXb3JsZE5vcm1hbChxdWF0KSB7CiAgICAgIGNvbnN0IG4gPSB0aGlzLndvcmxkTm9ybWFsOwogICAgICBuLnNldCgwLCAwLCAxKTsKICAgICAgcXVhdC52bXVsdChuLCBuKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQogIGNvbnN0IHRlbXBOb3JtYWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwogIGNsYXNzIEhlaWdodGZpZWxkIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBBbiBhcnJheSBvZiBudW1iZXJzLCBvciBoZWlnaHQgdmFsdWVzLCB0aGF0IGFyZSBzcHJlYWQgb3V0IGFsb25nIHRoZSB4IGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heCB2YWx1ZSBvZiB0aGUgZGF0YSBwb2ludHMgaW4gdGhlIGRhdGEgYXJyYXkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1pbmltdW0gdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjaW5nIGJldHdlZW4gdGhlIGRhdGEgcG9pbnRzIGluIFggYW5kIFkgZGlyZWN0aW9uLgogICAgICogQHRvZG8gZWxlbWVudFNpemVYIGFuZCBZCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRhdGEgQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihkYXRhLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG9wdGlvbnMubWF4VmFsdWU7CiAgICAgIHRoaXMubWluVmFsdWUgPSBvcHRpb25zLm1pblZhbHVlOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gb3B0aW9ucy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmIChvcHRpb25zLm1pblZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNaW5WYWx1ZSgpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5tYXhWYWx1ZSA9PT0gbnVsbCkgewogICAgICAgIHRoaXMudXBkYXRlTWF4VmFsdWUoKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZUVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLnBpbGxhckNvbnZleCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOyAvLyAiaV9qX2lzVXBwZXIiID0+IHsgY29udmV4OiAuLi4sIG9mZnNldDogLi4uIH0KICAgICAgLy8gZm9yIGV4YW1wbGU6CiAgICAgIC8vIF9jYWNoZWRQaWxsYXJzWyIwXzJfMSJdCgogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0ge307CiAgICB9CiAgICAvKioKICAgICAqIENhbGwgd2hlbmV2ZXIgeW91IGNoYW5nZSB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWluVmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWluVmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtaW5WYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA8IG1pblZhbHVlKSB7CiAgICAgICAgICAgIG1pblZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWluVmFsdWUgPSBtaW5WYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWF4VmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWF4VmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtYXhWYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA+IG1heFZhbHVlKSB7CiAgICAgICAgICAgIG1heFZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWF4VmFsdWUgPSBtYXhWYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBoZWlnaHQgdmFsdWUgYXQgYW4gaW5kZXguIERvbid0IGZvcmdldCB0byB1cGRhdGUgbWF4VmFsdWUgYW5kIG1pblZhbHVlIGFmdGVyIHlvdSdyZSBkb25lLgogICAgICovCgoKICAgIHNldEhlaWdodFZhbHVlQXRJbmRleCh4aSwgeWksIHZhbHVlKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGRhdGFbeGldW3lpXSA9IHZhbHVlOyAvLyBJbnZhbGlkYXRlIGNhY2hlCgogICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBmYWxzZSk7CgogICAgICBpZiAoeGkgPiAwKSB7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIHRydWUpOwogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpLCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIGlmICh5aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSAtIDEsIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCAmJiB4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSAtIDEsIHRydWUpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXgvbWluIGluIGEgcmVjdGFuZ2xlIGluIHRoZSBtYXRyaXggZGF0YQogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSB0aGUgcmVzdWx0cyBpbi4KICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCBhcnJheSwgaWYgaXQgd2FzIHBhc3NlZCBpbi4gTWluaW11bSB3aWxsIGJlIGF0IHBvc2l0aW9uIDAgYW5kIG1heCBhdCAxLgogICAgICovCgoKICAgIGdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBbXTsKICAgICAgfQoKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIF9yZWYpIHsKICAgICAgbGV0IHsKICAgICAgICBsb3dlckJvdW5kLAogICAgICAgIHVwcGVyQm91bmQKICAgICAgfSA9IF9yZWY7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKICAgICAgbG93ZXJCb3VuZC5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgdXBwZXJCb3VuZC5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0pOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGhlaWdodCBpbiB0aGUgaGVpZ2h0ZmllbGQgYXQgYSBnaXZlbiBwb3NpdGlvbgogICAgICovCgoKICAgIGdldEhlaWdodEF0KHgsIHksIGVkZ2VDbGFtcCkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBhID0gZ2V0SGVpZ2h0QXRfYTsKICAgICAgY29uc3QgYiA9IGdldEhlaWdodEF0X2I7CiAgICAgIGNvbnN0IGMgPSBnZXRIZWlnaHRBdF9jOwogICAgICBjb25zdCBpZHggPSBnZXRIZWlnaHRBdF9pZHg7CiAgICAgIHRoaXMuZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIGlkeCwgZWRnZUNsYW1wKTsKICAgICAgbGV0IHhpID0gaWR4WzBdOwogICAgICBsZXQgeWkgPSBpZHhbMV07CgogICAgICBpZiAoZWRnZUNsYW1wKSB7CiAgICAgICAgeGkgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHhpKSk7CiAgICAgICAgeWkgPSBNYXRoLm1pbihkYXRhWzBdLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHlpKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHVwcGVyID0gdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBnZXRIZWlnaHRBdF93ZWlnaHRzKTsKICAgICAgY29uc3QgdyA9IGdldEhlaWdodEF0X3dlaWdodHM7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aSArIDFdW3lpICsgMV0gKiB3LnggKyBkYXRhW3hpXVt5aSArIDFdICogdy55ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcuejsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aV1beWldICogdy54ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcueSArIGRhdGFbeGldW3lpICsgMV0gKiB3Lno7CiAgICAgIH0KICAgIH0KCiAgICBnZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICByZXR1cm4gYCR7eGl9XyR7eWl9XyR7Z2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwfWA7CiAgICB9CgogICAgZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KCiAgICBzZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIGNvbnZleCwgb2Zmc2V0KSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldID0gewogICAgICAgIGNvbnZleCwKICAgICAgICBvZmZzZXQKICAgICAgfTsKICAgIH0KCiAgICBjbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBkZWxldGUgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV07CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGZyb20gdGhlIGhlaWdodGZpZWxkCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGUoeGksIHlpLCB1cHBlciwgYSwgYiwgYykgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWkgKyAxXSk7CiAgICAgICAgYi5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSk7CiAgICAgICAgYy5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgYS5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgICBiLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgICBjLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB0cmlhbmdsZSBpbiB0aGUgdGVycmFpbiBpbiB0aGUgZm9ybSBvZiBhIHRyaWFuZ3VsYXIgY29udmV4IHNoYXBlLgogICAgICovCgoKICAgIGdldENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5waWxsYXJDb252ZXg7CiAgICAgIGxldCBvZmZzZXRSZXN1bHQgPSB0aGlzLnBpbGxhck9mZnNldDsKCiAgICAgIGlmICh0aGlzLmNhY2hlRW5hYmxlZCkgewogICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSk7CgogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IGRhdGEuY29udmV4OwogICAgICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBkYXRhLm9mZnNldDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc3VsdCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgICAgb2Zmc2V0UmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IHJlc3VsdDsKICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IG9mZnNldFJlc3VsdDsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBmYWNlcyA9IHJlc3VsdC5mYWNlczsgLy8gUmV1c2UgdmVydHMgaWYgcG9zc2libGUKCiAgICAgIHJlc3VsdC52ZXJ0aWNlcy5sZW5ndGggPSA2OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgICBpZiAoIXJlc3VsdC52ZXJ0aWNlc1tpXSkgewogICAgICAgICAgcmVzdWx0LnZlcnRpY2VzW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gUmV1c2UgZmFjZXMgaWYgcG9zc2libGUKCgogICAgICBmYWNlcy5sZW5ndGggPSA1OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsKICAgICAgICBpZiAoIWZhY2VzW2ldKSB7CiAgICAgICAgICBmYWNlc1tpXSA9IFtdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgdmVydHMgPSByZXN1bHQudmVydGljZXM7CiAgICAgIGNvbnN0IGggPSAoTWF0aC5taW4oZGF0YVt4aV1beWldLCBkYXRhW3hpICsgMV1beWldLCBkYXRhW3hpXVt5aSArIDFdLCBkYXRhW3hpICsgMV1beWkgKyAxXSkgLSB0aGlzLm1pblZhbHVlKSAvIDIgKyB0aGlzLm1pblZhbHVlOwoKICAgICAgaWYgKCFnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgICAgLy8gQ2VudGVyIG9mIHRoZSB0cmlhbmdsZSBwaWxsYXIgLSBhbGwgcG9seWdvbnMgYXJlIGdpdmVuIHJlbGF0aXZlIHRvIHRoaXMgb25lCiAgICAgICAgb2Zmc2V0UmVzdWx0LnNldCgoeGkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCAvLyBzb3J0IG9mIGNlbnRlciBvZiBhIHRyaWFuZ2xlCiAgICAgICAgKHlpICsgMC4yNSkgKiBlbGVtZW50U2l6ZSwgaCAvLyB2ZXJ0aWNhbCBjZW50ZXIKICAgICAgICApOyAvLyBUb3AgdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbMF0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzFdLnNldCgwLjc1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsKICAgICAgICB2ZXJ0c1syXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7IC8vIGJvdHRvbSB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1szXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIDAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIHRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAteCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMl1bMV0gPSAyOwogICAgICAgIGZhY2VzWzJdWzJdID0gNTsKICAgICAgICBmYWNlc1syXVszXSA9IDM7IC8vIC15IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMTsKICAgICAgICBmYWNlc1szXVsxXSA9IDA7CiAgICAgICAgZmFjZXNbM11bMl0gPSAzOwogICAgICAgIGZhY2VzWzNdWzNdID0gNDsgLy8gK3h5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gNDsKICAgICAgICBmYWNlc1s0XVsxXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bMl0gPSAyOwogICAgICAgIGZhY2VzWzRdWzNdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuNzUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjc1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAwLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIC0wLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIFRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAreCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMV0gPSA1OwogICAgICAgIGZhY2VzWzJdWzJdID0gMzsKICAgICAgICBmYWNlc1syXVszXSA9IDA7IC8vICt5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMzsKICAgICAgICBmYWNlc1szXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbM11bMl0gPSAxOwogICAgICAgIGZhY2VzWzNdWzNdID0gMDsgLy8gLXh5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gMTsKICAgICAgICBmYWNlc1s0XVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbNF1bMl0gPSA1OwogICAgICAgIGZhY2VzWzRdWzNdID0gMjsKICAgICAgfQoKICAgICAgcmVzdWx0LmNvbXB1dGVOb3JtYWxzKCk7CiAgICAgIHJlc3VsdC5jb21wdXRlRWRnZXMoKTsKICAgICAgcmVzdWx0LnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgIHRoaXMuc2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlLCByZXN1bHQsIG9mZnNldFJlc3VsdCk7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KICBjb25zdCBnZXRIZWlnaHRBdF9pZHggPSBbXTsKICBjb25zdCBnZXRIZWlnaHRBdF93ZWlnaHRzID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9lMCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTEgPSBuZXcgVmVjMygpOyAvLyBmcm9tIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0JhcnljZW50cmljX2Nvb3JkaW5hdGVfc3lzdGVtCgogIGZ1bmN0aW9uIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBheCwgYXksIGJ4LCBieSwgY3gsIGN5LCByZXN1bHQpIHsKICAgIHJlc3VsdC54ID0gKChieSAtIGN5KSAqICh4IC0gY3gpICsgKGN4IC0gYngpICogKHkgLSBjeSkpIC8gKChieSAtIGN5KSAqIChheCAtIGN4KSArIChjeCAtIGJ4KSAqIChheSAtIGN5KSk7CiAgICByZXN1bHQueSA9ICgoY3kgLSBheSkgKiAoeCAtIGN4KSArIChheCAtIGN4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnogPSAxIC0gcmVzdWx0LnggLSByZXN1bHQueTsKICB9CgogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KICBjbGFzcyBPY3RyZWVOb2RlIHsKICAgIC8qKiBUaGUgcm9vdCBub2RlICovCgogICAgLyoqIEJvdW5kYXJ5IG9mIHRoaXMgbm9kZSAqLwoKICAgIC8qKiBDb250YWluZWQgZGF0YSBhdCB0aGUgY3VycmVudCBub2RlIGxldmVsICovCgogICAgLyoqIENoaWxkcmVuIHRvIHRoaXMgbm9kZSAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJvb3QgPSBvcHRpb25zLnJvb3QgfHwgbnVsbDsKICAgICAgdGhpcy5hYWJiID0gb3B0aW9ucy5hYWJiID8gb3B0aW9ucy5hYWJiLmNsb25lKCkgOiBuZXcgQUFCQigpOwogICAgICB0aGlzLmRhdGEgPSBbXTsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiByZXNldAogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLmNoaWxkcmVuLmxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGggPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBJbnNlcnQgZGF0YSBpbnRvIHRoaXMgbm9kZQogICAgICogQHJldHVybiBUcnVlIGlmIHN1Y2Nlc3NmdWwsIG90aGVyd2lzZSBmYWxzZQogICAgICovCgoKICAgIGluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwpIHsKICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsKICAgICAgICBsZXZlbCA9IDA7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVEYXRhID0gdGhpcy5kYXRhOyAvLyBJZ25vcmUgb2JqZWN0cyB0aGF0IGRvIG5vdCBiZWxvbmcgaW4gdGhpcyBub2RlCgogICAgICBpZiAoIXRoaXMuYWFiYi5jb250YWlucyhhYWJiKSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gb2JqZWN0IGNhbm5vdCBiZSBhZGRlZAogICAgICB9CgogICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICAgIGNvbnN0IG1heERlcHRoID0gdGhpcy5tYXhEZXB0aCB8fCB0aGlzLnJvb3QubWF4RGVwdGg7CgogICAgICBpZiAobGV2ZWwgPCBtYXhEZXB0aCkgewogICAgICAgIC8vIFN1YmRpdmlkZSBpZiB0aGVyZSBhcmUgbm8gY2hpbGRyZW4geWV0CiAgICAgICAgbGV0IHN1YmRpdmlkZWQgPSBmYWxzZTsKCiAgICAgICAgaWYgKCFjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuc3ViZGl2aWRlKCk7CiAgICAgICAgICBzdWJkaXZpZGVkID0gdHJ1ZTsKICAgICAgICB9IC8vIGFkZCB0byB3aGljaGV2ZXIgbm9kZSB3aWxsIGFjY2VwdCBpdAoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgICAgaWYgKGNoaWxkcmVuW2ldLmluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwgKyAxKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzdWJkaXZpZGVkKSB7CiAgICAgICAgICAvLyBObyBjaGlsZHJlbiBhY2NlcHRlZCEgTWlnaHQgYXMgd2VsbCBqdXN0IHJlbW92ZSBlbSBzaW5jZSB0aGV5IGNvbnRhaW4gbm9uZQogICAgICAgICAgY2hpbGRyZW4ubGVuZ3RoID0gMDsKICAgICAgICB9CiAgICAgIH0gLy8gVG9vIGRlZXAsIG9yIGNoaWxkcmVuIGRpZG50IHdhbnQgaXQuIGFkZCBpdCBpbiBjdXJyZW50IG5vZGUKCgogICAgICBub2RlRGF0YS5wdXNoKGVsZW1lbnREYXRhKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZSA4IGVxdWFsbHkgc2l6ZWQgY2hpbGRyZW4gbm9kZXMgYW5kIHB1dCB0aGVtIGluIHRoZSBgY2hpbGRyZW5gIGFycmF5LgogICAgICovCgoKICAgIHN1YmRpdmlkZSgpIHsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjaGlsZHJlbi5wdXNoKG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDAsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMCkKICAgICAgICB9KQogICAgICB9KSk7CiAgICAgIHUudnN1YihsLCBoYWxmRGlhZ29uYWwpOwogICAgICBoYWxmRGlhZ29uYWwuc2NhbGUoMC41LCBoYWxmRGlhZ29uYWwpOwogICAgICBjb25zdCByb290ID0gdGhpcy5yb290IHx8IHRoaXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gODsgaSsrKSB7CiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTsgLy8gU2V0IGN1cnJlbnQgbm9kZSBhcyByb290CgogICAgICAgIGNoaWxkLnJvb3QgPSByb290OyAvLyBDb21wdXRlIGJvdW5kcwoKICAgICAgICBjb25zdCBsb3dlckJvdW5kID0gY2hpbGQuYWFiYi5sb3dlckJvdW5kOwogICAgICAgIGxvd2VyQm91bmQueCAqPSBoYWxmRGlhZ29uYWwueDsKICAgICAgICBsb3dlckJvdW5kLnkgKj0gaGFsZkRpYWdvbmFsLnk7CiAgICAgICAgbG93ZXJCb3VuZC56ICo9IGhhbGZEaWFnb25hbC56OwogICAgICAgIGxvd2VyQm91bmQudmFkZChsLCBsb3dlckJvdW5kKTsgLy8gVXBwZXIgYm91bmQgaXMgYWx3YXlzIGxvd2VyIGJvdW5kICsgaGFsZkRpYWdvbmFsCgogICAgICAgIGxvd2VyQm91bmQudmFkZChoYWxmRGlhZ29uYWwsIGNoaWxkLmFhYmIudXBwZXJCb3VuZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSB3aXRoaW4gYW4gQUFCQgogICAgICogQHJldHVybiBUaGUgInJlc3VsdCIgb2JqZWN0CiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KGFhYmIsIHJlc3VsdCkgewogICAgICB0aGlzLmRhdGE7IC8vIGFib3J0IGlmIHRoZSByYW5nZSBkb2VzIG5vdCBpbnRlcnNlY3QgdGhpcyBub2RlCiAgICAgIC8vIGlmICghdGhpcy5hYWJiLm92ZXJsYXBzKGFhYmIpKXsKICAgICAgLy8gICAgIHJldHVybiByZXN1bHQ7CiAgICAgIC8vIH0KICAgICAgLy8gQWRkIG9iamVjdHMgYXQgdGhpcyBsZXZlbAogICAgICAvLyBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGVEYXRhKTsKICAgICAgLy8gQWRkIGNoaWxkIGRhdGEKICAgICAgLy8gQHRvZG8gdW53cmFwIHJlY3Vyc2lvbiBpbnRvIGEgcXVldWUgLyBsb29wLCB0aGF0J3MgZmFzdGVyIGluIEpTCgogICAgICB0aGlzLmNoaWxkcmVuOyAvLyBmb3IgKGxldCBpID0gMCwgTiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpICE9PSBOOyBpKyspIHsKICAgICAgLy8gICAgIGNoaWxkcmVuW2ldLmFhYmJRdWVyeShhYWJiLCByZXN1bHQpOwogICAgICAvLyB9CgogICAgICBjb25zdCBxdWV1ZSA9IFt0aGlzXTsKCiAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7CgogICAgICAgIGlmIChub2RlLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHJlc3VsdCwgbm9kZS5kYXRhKTsKICAgICAgICB9CgogICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHF1ZXVlLCBub2RlLmNoaWxkcmVuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSBpbnRlcnNlY3RlZCBieSBhIHJheS4KICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIHJheVF1ZXJ5KHJheSwgdHJlZVRyYW5zZm9ybSwgcmVzdWx0KSB7CiAgICAgIC8vIFVzZSBhYWJiIHF1ZXJ5IGZvciBub3cuCgogICAgICAvKiogQHRvZG8gaW1wbGVtZW50IHJlYWwgcmF5IHF1ZXJ5IHdoaWNoIG5lZWRzIGxlc3MgbG9va3VwcyAqLwogICAgICByYXkuZ2V0QUFCQih0bXBBQUJCKTsKICAgICAgdG1wQUFCQi50b0xvY2FsRnJhbWUodHJlZVRyYW5zZm9ybSwgdG1wQUFCQik7CiAgICAgIHRoaXMuYWFiYlF1ZXJ5KHRtcEFBQkIsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHJlbW92ZUVtcHR5Tm9kZXMKICAgICAqLwoKCiAgICByZW1vdmVFbXB0eU5vZGVzKCkgewogICAgICBmb3IgKGxldCBpID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHRoaXMuY2hpbGRyZW5baV0ucmVtb3ZlRW1wdHlOb2RlcygpOwoKICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uY2hpbGRyZW4ubGVuZ3RoICYmICF0aGlzLmNoaWxkcmVuW2ldLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIE9jdHJlZQogICAqLwoKCiAgY2xhc3MgT2N0cmVlIGV4dGVuZHMgT2N0cmVlTm9kZSB7CiAgICAvKioKICAgICAqIE1heGltdW0gc3ViZGl2aXNpb24gZGVwdGgKICAgICAqIEBkZWZhdWx0IDgKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGFhYmIgVGhlIHRvdGFsIEFBQkIgb2YgdGhlIHRyZWUKICAgICAqLwogICAgY29uc3RydWN0b3IoYWFiYiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KICBjb25zdCBoYWxmRGlhZ29uYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcEFBQkIgPSBuZXcgQUFCQigpOwoKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwogIGNsYXNzIFRyaW1lc2ggZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIHZlcnRpY2VzCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXJzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggdHJpYW5nbGUgY29uc2lzdHMgb2YuIFRoZSBsZW5ndGggb2YgdGhpcyBhcnJheSBpcyB0aHVzIDMgdGltZXMgdGhlIG51bWJlciBvZiB0cmlhbmdsZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBub3JtYWxzIGRhdGEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBBQUJCIG9mIHRoZSBtZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2VzIHRvIHZlcnRleCBwYWlycywgbWFraW5nIHVwIGFsbCB1bmlxdWUgZWRnZXMgaW4gdGhlIHRyaW1lc2guCiAgICAgKi8KCiAgICAvKioKICAgICAqIExvY2FsIHNjYWxpbmcgb2YgdGhlIG1lc2guIFVzZSAuc2V0U2NhbGUoKSB0byBzZXQgaXQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmRleGVkIHRyaWFuZ2xlcy4gVXNlIC51cGRhdGVUcmVlKCkgdG8gdXBkYXRlIGl0LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcih2ZXJ0aWNlcywgaW5kaWNlcykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuVFJJTUVTSAogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBgJHthfV8ke2J9YCA6IGAke2J9XyR7YX1gOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cywgdHViZSwgcmFkaWFsU2VnbWVudHMsIHR1YnVsYXJTZWdtZW50cywgYXJjKSB7CiAgICAgIGlmIChyYWRpdXMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGl1cyA9IDE7CiAgICAgIH0KCiAgICAgIGlmICh0dWJlID09PSB2b2lkIDApIHsKICAgICAgICB0dWJlID0gMC41OwogICAgICB9CgogICAgICBpZiAocmFkaWFsU2VnbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGlhbFNlZ21lbnRzID0gODsKICAgICAgfQoKICAgICAgaWYgKHR1YnVsYXJTZWdtZW50cyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdHVidWxhclNlZ21lbnRzID0gNjsKICAgICAgfQoKICAgICAgaWYgKGFyYyA9PT0gdm9pZCAwKSB7CiAgICAgICAgYXJjID0gTWF0aC5QSSAqIDI7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGluZGljZXMgPSBbXTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgdSA9IGkgLyB0dWJ1bGFyU2VnbWVudHMgKiBhcmM7CiAgICAgICAgICBjb25zdCB2ID0gaiAvIHJhZGlhbFNlZ21lbnRzICogTWF0aC5QSSAqIDI7CiAgICAgICAgICBjb25zdCB4ID0gKHJhZGl1cyArIHR1YmUgKiBNYXRoLmNvcyh2KSkgKiBNYXRoLmNvcyh1KTsKICAgICAgICAgIGNvbnN0IHkgPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguc2luKHUpOwogICAgICAgICAgY29uc3QgeiA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICAgIHZlcnRpY2VzLnB1c2goeCwgeSwgeik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMTsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGEgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiBqICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBiID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGkgLSAxOwogICAgICAgICAgY29uc3QgYyA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyBpOwogICAgICAgICAgY29uc3QgZCA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKTsKICAgIH0KCiAgfQogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnQgZXF1YXRpb24gc29sdmVyIGJhc2UgY2xhc3MuCiAgICovCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICB9CiAgICAvKioKICAgICAqIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzc2VzIQogICAgICogQHRvZG8gdXNlIGFic3RyYWN0CiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICByZXR1cm4gKC8vIFNob3VsZCByZXR1cm4gdGhlIG51bWJlciBvZiBpdGVyYXRpb25zIGRvbmUhCiAgICAgICAgMAogICAgICApOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICBhZGRFcXVhdGlvbihlcSkgewogICAgICBpZiAoZXEuZW5hYmxlZCAmJiAhZXEuYmkuaXNUcmlnZ2VyICYmICFlcS5iai5pc1RyaWdnZXIpIHsKICAgICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICByZW1vdmVFcXVhdGlvbihlcSkgewogICAgICBjb25zdCBlcXMgPSB0aGlzLmVxdWF0aW9uczsKICAgICAgY29uc3QgaSA9IGVxcy5pbmRleE9mKGVxKTsKCiAgICAgIGlmIChpICE9PSAtMSkgewogICAgICAgIGVxcy5zcGxpY2UoaSwgMSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQWRkIGFsbCBlcXVhdGlvbnMKICAgICAqLwoKCiAgICByZW1vdmVBbGxFcXVhdGlvbnMoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KICBjbGFzcyBHU1NvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuCiAgICAgKiBUaGUgbW9yZSBpdGVyYXRpb25zLCB0aGUgbW9yZSBjb3JyZWN0IHNpbXVsYXRpb24uIE1vcmUgaXRlcmF0aW9ucyBuZWVkIG1vcmUgY29tcHV0YXRpb25zIHRob3VnaC4gSWYgeW91IGhhdmUgYSBsYXJnZSBncmF2aXR5IGZvcmNlIGluIHlvdXIgd29ybGQsIHlvdSB3aWxsIG5lZWQgbW9yZSBpdGVyYXRpb25zLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRvbGVyYW5jZSBpcyByZWFjaGVkLCB0aGUgc3lzdGVtIGlzIGFzc3VtZWQgdG8gYmUgY29udmVyZ2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBAdG9kbyByZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgIH0KICAgIC8qKgogICAgICogU29sdmUKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgcGVyZm9ybWVkCiAgICAgKi8KCgogICAgc29sdmUoZHQsIHdvcmxkKSB7CiAgICAgIGxldCBpdGVyID0gMDsKICAgICAgY29uc3QgbWF4SXRlciA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgdG9sU3F1YXJlZCA9IHRoaXMudG9sZXJhbmNlICogdGhpcy50b2xlcmFuY2U7CiAgICAgIGNvbnN0IGVxdWF0aW9ucyA9IHRoaXMuZXF1YXRpb25zOwogICAgICBjb25zdCBOZXEgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB3b3JsZC5ib2RpZXM7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBoID0gZHQ7CiAgICAgIGxldCBCOwogICAgICBsZXQgaW52QzsKICAgICAgbGV0IGRlbHRhbGFtYmRhOwogICAgICBsZXQgZGVsdGFsYW1iZGFUb3Q7CiAgICAgIGxldCBHV2xhbWJkYTsKICAgICAgbGV0IGxhbWJkYWo7IC8vIFVwZGF0ZSBzb2x2ZSBtYXNzCgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5ib2RpZXM7IGkrKykgewogICAgICAgICAgYm9kaWVzW2ldLnVwZGF0ZVNvbHZlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gVGhpbmdzIHRoYXQgZG8gbm90IGNoYW5nZSBkdXJpbmcgaXRlcmF0aW9uIGNhbiBiZSBjb21wdXRlZCBvbmNlCgoKICAgICAgY29uc3QgaW52Q3MgPSBHU1NvbHZlcl9zb2x2ZV9pbnZDczsKICAgICAgY29uc3QgQnMgPSBHU1NvbHZlcl9zb2x2ZV9CczsKICAgICAgY29uc3QgbGFtYmRhID0gR1NTb2x2ZXJfc29sdmVfbGFtYmRhOwogICAgICBpbnZDcy5sZW5ndGggPSBOZXE7CiAgICAgIEJzLmxlbmd0aCA9IE5lcTsKICAgICAgbGFtYmRhLmxlbmd0aCA9IE5lcTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXE7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBlcXVhdGlvbnNbaV07CiAgICAgICAgbGFtYmRhW2ldID0gMC4wOwogICAgICAgIEJzW2ldID0gYy5jb21wdXRlQihoKTsKICAgICAgICBpbnZDc1tpXSA9IDEuMCAvIGMuY29tcHV0ZUMoKTsKICAgICAgfQoKICAgICAgaWYgKE5lcSAhPT0gMCkgewogICAgICAgIC8vIFJlc2V0IHZsYW1iZGEKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdmxhbWJkYSA9IGIudmxhbWJkYTsKICAgICAgICAgIGNvbnN0IHdsYW1iZGEgPSBiLndsYW1iZGE7CiAgICAgICAgICB2bGFtYmRhLnNldCgwLCAwLCAwKTsKICAgICAgICAgIHdsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgIH0gLy8gSXRlcmF0ZSBvdmVyIGVxdWF0aW9ucwoKCiAgICAgICAgZm9yIChpdGVyID0gMDsgaXRlciAhPT0gbWF4SXRlcjsgaXRlcisrKSB7CiAgICAgICAgICAvLyBBY2N1bXVsYXRlIHRoZSB0b3RhbCBlcnJvciBmb3IgZWFjaCBpdGVyYXRpb24uCiAgICAgICAgICBkZWx0YWxhbWJkYVRvdCA9IDAuMDsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tqXTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgICAgICAgIEIgPSBCc1tqXTsKICAgICAgICAgICAgaW52QyA9IGludkNzW2pdOwogICAgICAgICAgICBsYW1iZGFqID0gbGFtYmRhW2pdOwogICAgICAgICAgICBHV2xhbWJkYSA9IGMuY29tcHV0ZUdXbGFtYmRhKCk7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gaW52QyAqIChCIC0gR1dsYW1iZGEgLSBjLmVwcyAqIGxhbWJkYWopOyAvLyBDbGFtcCBpZiB3ZSBhcmUgbm90IHdpdGhpbiB0aGUgbWluL21heCBpbnRlcnZhbAoKICAgICAgICAgICAgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA8IGMubWluRm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWluRm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA+IGMubWF4Rm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWF4Rm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYW1iZGFbal0gKz0gZGVsdGFsYW1iZGE7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhVG90ICs9IGRlbHRhbGFtYmRhID4gMC4wID8gZGVsdGFsYW1iZGEgOiAtZGVsdGFsYW1iZGE7IC8vIGFicyhkZWx0YWxhbWJkYSkKCiAgICAgICAgICAgIGMuYWRkVG9XbGFtYmRhKGRlbHRhbGFtYmRhKTsKICAgICAgICAgIH0gLy8gSWYgdGhlIHRvdGFsIGVycm9yIGlzIHNtYWxsIGVub3VnaCAtIHN0b3AgaXRlcmF0ZQoKCiAgICAgICAgICBpZiAoZGVsdGFsYW1iZGFUb3QgKiBkZWx0YWxhbWJkYVRvdCA8IHRvbFNxdWFyZWQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgcmVzdWx0IHRvIHZlbG9jaXR5CgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdiA9IGIudmVsb2NpdHk7CiAgICAgICAgICBjb25zdCB3ID0gYi5hbmd1bGFyVmVsb2NpdHk7CiAgICAgICAgICBiLnZsYW1iZGEudm11bChiLmxpbmVhckZhY3RvciwgYi52bGFtYmRhKTsKICAgICAgICAgIHYudmFkZChiLnZsYW1iZGEsIHYpOwogICAgICAgICAgYi53bGFtYmRhLnZtdWwoYi5hbmd1bGFyRmFjdG9yLCBiLndsYW1iZGEpOwogICAgICAgICAgdy52YWRkKGIud2xhbWJkYSwgdyk7CiAgICAgICAgfSAvLyBTZXQgdGhlIGAubXVsdGlwbGllcmAgcHJvcGVydHkgb2YgZWFjaCBlcXVhdGlvbgoKCiAgICAgICAgbGV0IGwgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICAgIGNvbnN0IGludkR0ID0gMSAvIGg7CgogICAgICAgIHdoaWxlIChsLS0pIHsKICAgICAgICAgIGVxdWF0aW9uc1tsXS5tdWx0aXBsaWVyID0gbGFtYmRhW2xdICogaW52RHQ7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gaXRlcjsKICAgIH0KCiAgfSAvLyBKdXN0IHRlbXBvcmFyeSBudW1iZXIgaG9sZGVycyB0aGF0IHdlIHdhbnQgdG8gcmV1c2UgZWFjaCBpdGVyYXRpb24uCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKCiAgLyoqCiAgICogU3BsaXRzIHRoZSBlcXVhdGlvbnMgaW50byBpc2xhbmRzIGFuZCBzb2x2ZXMgdGhlbSBpbmRlcGVuZGVudGx5LiBDYW4gaW1wcm92ZSBwZXJmb3JtYW5jZS4KICAgKi8KICBjbGFzcyBTcGxpdFNvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKiogc3Vic29sdmVyICovCiAgICBjb25zdHJ1Y3RvcihzdWJzb2x2ZXIpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgICAgdGhpcy5zdWJzb2x2ZXIgPSBzdWJzb2x2ZXI7CiAgICAgIHRoaXMubm9kZXMgPSBbXTsKICAgICAgdGhpcy5ub2RlUG9vbCA9IFtdOyAvLyBDcmVhdGUgbmVlZGVkIG5vZGVzLCByZXVzZSBpZiBwb3NzaWJsZQoKICAgICAgd2hpbGUgKHRoaXMubm9kZVBvb2wubGVuZ3RoIDwgMTI4KSB7CiAgICAgICAgdGhpcy5ub2RlUG9vbC5wdXNoKHRoaXMuY3JlYXRlTm9kZSgpKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjcmVhdGVOb2RlCiAgICAgKi8KCgogICAgY3JlYXRlTm9kZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBib2R5OiBudWxsLAogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBlcXM6IFtdLAogICAgICAgIHZpc2l0ZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIHRoZSBzdWJzeXN0ZW1zCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICBjb25zdCBub2RlcyA9IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzOwogICAgICBjb25zdCBub2RlUG9vbCA9IHRoaXMubm9kZVBvb2w7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBzdWJzb2x2ZXIgPSB0aGlzLnN1YnNvbHZlcjsgLy8gQ3JlYXRlIG5lZWRlZCBub2RlcywgcmV1c2UgaWYgcG9zc2libGUKCiAgICAgIHdoaWxlIChub2RlUG9vbC5sZW5ndGggPCBOYm9kaWVzKSB7CiAgICAgICAgbm9kZVBvb2wucHVzaCh0aGlzLmNyZWF0ZU5vZGUoKSk7CiAgICAgIH0KCiAgICAgIG5vZGVzLmxlbmd0aCA9IE5ib2RpZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5ib2RpZXM7IGkrKykgewogICAgICAgIG5vZGVzW2ldID0gbm9kZVBvb2xbaV07CiAgICAgIH0gLy8gUmVzZXQgbm9kZSB2YWx1ZXMKCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwogICAgICAgIG5vZGUuYm9keSA9IGJvZGllc1tpXTsKICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgbm9kZS5lcXMubGVuZ3RoID0gMDsKICAgICAgICBub2RlLnZpc2l0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5lcTsgaysrKSB7CiAgICAgICAgY29uc3QgZXEgPSBlcXVhdGlvbnNba107CiAgICAgICAgY29uc3QgaSA9IGJvZGllcy5pbmRleE9mKGVxLmJpKTsKICAgICAgICBjb25zdCBqID0gYm9kaWVzLmluZGV4T2YoZXEuYmopOwogICAgICAgIGNvbnN0IG5pID0gbm9kZXNbaV07CiAgICAgICAgY29uc3QgbmogPSBub2Rlc1tqXTsKICAgICAgICBuaS5jaGlsZHJlbi5wdXNoKG5qKTsKICAgICAgICBuaS5lcXMucHVzaChlcSk7CiAgICAgICAgbmouY2hpbGRyZW4ucHVzaChuaSk7CiAgICAgICAgbmouZXFzLnB1c2goZXEpOwogICAgICB9CgogICAgICBsZXQgY2hpbGQ7CiAgICAgIGxldCBuID0gMDsKICAgICAgbGV0IGVxcyA9IFNwbGl0U29sdmVyX3NvbHZlX2VxczsKICAgICAgc3Vic29sdmVyLnRvbGVyYW5jZSA9IHRoaXMudG9sZXJhbmNlOwogICAgICBzdWJzb2x2ZXIuaXRlcmF0aW9ucyA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgZHVtbXlXb3JsZCA9IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQ7CgogICAgICB3aGlsZSAoY2hpbGQgPSBnZXRVbnZpc2l0ZWROb2RlKG5vZGVzKSkgewogICAgICAgIGVxcy5sZW5ndGggPSAwOwogICAgICAgIGR1bW15V29ybGQuYm9kaWVzLmxlbmd0aCA9IDA7CiAgICAgICAgYmZzKGNoaWxkLCB2aXNpdEZ1bmMsIGR1bW15V29ybGQuYm9kaWVzLCBlcXMpOwogICAgICAgIGNvbnN0IE5lcXMgPSBlcXMubGVuZ3RoOwogICAgICAgIGVxcyA9IGVxcy5zb3J0KHNvcnRCeUlkKTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcXM7IGkrKykgewogICAgICAgICAgc3Vic29sdmVyLmFkZEVxdWF0aW9uKGVxc1tpXSk7CiAgICAgICAgfQoKICAgICAgICBzdWJzb2x2ZXIuc29sdmUoZHQsIGR1bW15V29ybGQpOwogICAgICAgIHN1YnNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsKICAgICAgICBuKys7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICB9IC8vIFJldHVybnMgdGhlIG51bWJlciBvZiBzdWJzeXN0ZW1zCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzID0gW107IC8vIEFsbCBhbGxvY2F0ZWQgbm9kZSBvYmplY3RzCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2VxcyA9IFtdOyAvLyBUZW1wIGFycmF5CgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQgPSB7CiAgICBib2RpZXM6IFtdCiAgfTsgLy8gVGVtcCBvYmplY3QKCiAgY29uc3QgU1RBVElDID0gQm9keS5TVEFUSUM7CgogIGZ1bmN0aW9uIGdldFVudmlzaXRlZE5vZGUobm9kZXMpIHsKICAgIGNvbnN0IE5ub2RlcyA9IG5vZGVzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTm5vZGVzOyBpKyspIHsKICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgaWYgKCFub2RlLnZpc2l0ZWQgJiYgIShub2RlLmJvZHkudHlwZSAmIFNUQVRJQykpIHsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGNvbnN0IHF1ZXVlID0gW107CgogIGZ1bmN0aW9uIGJmcyhyb290LCB2aXNpdEZ1bmMsIGJkcywgZXFzKSB7CiAgICBxdWV1ZS5wdXNoKHJvb3QpOwogICAgcm9vdC52aXNpdGVkID0gdHJ1ZTsKICAgIHZpc2l0RnVuYyhyb290LCBiZHMsIGVxcyk7CgogICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkgewogICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7IC8vIExvb3Agb3ZlciB1bnZpc2l0ZWQgY2hpbGQgbm9kZXMKCiAgICAgIGxldCBjaGlsZDsKCiAgICAgIHdoaWxlIChjaGlsZCA9IGdldFVudmlzaXRlZE5vZGUobm9kZS5jaGlsZHJlbikpIHsKICAgICAgICBjaGlsZC52aXNpdGVkID0gdHJ1ZTsKICAgICAgICB2aXNpdEZ1bmMoY2hpbGQsIGJkcywgZXFzKTsKICAgICAgICBxdWV1ZS5wdXNoKGNoaWxkKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdmlzaXRGdW5jKG5vZGUsIGJkcywgZXFzKSB7CiAgICBiZHMucHVzaChub2RlLmJvZHkpOwogICAgY29uc3QgTmVxcyA9IG5vZGUuZXFzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmVxczsgaSsrKSB7CiAgICAgIGNvbnN0IGVxID0gbm9kZS5lcXNbaV07CgogICAgICBpZiAoIWVxcy5pbmNsdWRlcyhlcSkpIHsKICAgICAgICBlcXMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNvcnRCeUlkKGEsIGIpIHsKICAgIHJldHVybiBiLmlkIC0gYS5pZDsKICB9CgogIC8qKgogICAqIEZvciBwb29saW5nIG9iamVjdHMgdGhhdCBjYW4gYmUgcmV1c2VkLgogICAqLwogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuIG9iamVjdCBhZnRlciB1c2UKICAgICAqLwogICAgcmVsZWFzZSgpIHsKICAgICAgY29uc3QgTmFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChpIDwgMCB8fCBhcmd1bWVudHMubGVuZ3RoIDw9IGkgPyB1bmRlZmluZWQgOiBhcmd1bWVudHNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIG9iamVjdAogICAgICovCgoKICAgIGdldCgpIHsKICAgICAgaWYgKHRoaXMub2JqZWN0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RPYmplY3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RzLnBvcCgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhbiBvYmplY3QuIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBlYWNoIHN1YmNsYXNzLgogICAgICovCgoKICAgIGNvbnN0cnVjdE9iamVjdCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25zdHJ1Y3RPYmplY3QoKSBub3QgaW1wbGVtZW50ZWQgaW4gdGhpcyBQb29sIHN1YmNsYXNzIHlldCEnKTsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBTZWxmLCBmb3IgY2hhaW5pbmcKICAgICAqLwoKCiAgICByZXNpemUoc2l6ZSkgewogICAgICBjb25zdCBvYmplY3RzID0gdGhpcy5vYmplY3RzOwoKICAgICAgd2hpbGUgKG9iamVjdHMubGVuZ3RoID4gc2l6ZSkgewogICAgICAgIG9iamVjdHMucG9wKCk7CiAgICAgIH0KCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA8IHNpemUpIHsKICAgICAgICBvYmplY3RzLnB1c2godGhpcy5jb25zdHJ1Y3RPYmplY3QoKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CgogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgogIGNsYXNzIFZlYzNQb29sIGV4dGVuZHMgUG9vbCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhIHZlY3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMygpOwogICAgfQoKICB9CgogIC8vIE5hbWluZyBydWxlOiBiYXNlZCBvZiB0aGUgb3JkZXIgaW4gU0hBUEVfVFlQRVMsCiAgLy8gdGhlIGZpcnN0IHBhcnQgb2YgdGhlIG1ldGhvZCBpcyBmb3JtZWQgYnkgdGhlCiAgLy8gc2hhcGUgdHlwZSB0aGF0IGNvbWVzIGJlZm9yZSwgaW4gdGhlIHNlY29uZCBwYXJ0CiAgLy8gdGhlcmUgaXMgdGhlIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBhZnRlciBpbiB0aGUgU0hBUEVfVFlQRVMgbGlzdAogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwoKICAvKioKICAgKiBIZWxwZXIgY2xhc3MgZm9yIHRoZSBXb3JsZC4gR2VuZXJhdGVzIENvbnRhY3RFcXVhdGlvbnMuCiAgICogQHRvZG8gU3BoZXJlLUNvbnZleFBvbHloZWRyb24gY29udGFjdHMKICAgKiBAdG9kbyBDb250YWN0IHJlZHVjdGlvbgogICAqIEB0b2RvIHNob3VsZCBtb3ZlIG1ldGhvZHMgdG8gcHJvdG90eXBlCiAgICovCiAgY2xhc3MgTmFycm93cGhhc2UgewogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBzdG9yYWdlIG9mIHBvb2xlZCBjb250YWN0IHBvaW50cy4KICAgICAqLwoKICAgIC8qKgogICAgICogUG9vbGVkIHZlY3RvcnMuCiAgICAgKi8KICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVNwaGVyZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVNwaGVyZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVBsYW5lOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEJveF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveEJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVCb3g7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhDb252ZXhdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94Q29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlSGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94SGVpZ2h0ZmllbGRdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhIZWlnaHRmaWVsZF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleEhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVBhcnRpY2xlXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94UGFydGljbGVdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmN5bGluZGVyQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVDeWxpbmRlcl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmhlaWdodGZpZWxkQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5oZWlnaHRmaWVsZEN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBhcnRpY2xlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5wYXJ0aWNsZUN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVUcmltZXNoOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lVHJpbWVzaF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lVHJpbWVzaDsKICAgIH0gLy8gZ2V0IFtDT0xMSVNJT05fVFlQRVMuY29udmV4VHJpbWVzaF0oKSB7CiAgICAvLyAgIHJldHVybiB0aGlzLmNvbnZleFRyaW1lc2gKICAgIC8vIH0KCgogICAgY29uc3RydWN0b3Iod29ybGQpIHsKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsKICAgICAgdGhpcy5yZXN1bHQgPSBbXTsKICAgICAgdGhpcy5mcmljdGlvblJlc3VsdCA9IFtdOwogICAgICB0aGlzLnYzcG9vbCA9IG5ldyBWZWMzUG9vbCgpOwogICAgICB0aGlzLndvcmxkID0gd29ybGQ7CiAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogTWFrZSBhIGNvbnRhY3Qgb2JqZWN0LCBieSB1c2luZyB0aGUgaW50ZXJuYWwgcG9vbCBvciBjcmVhdGluZyBhIG5ldyBvbmUuCiAgICAgKi8KCgogICAgY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCBvdmVycmlkZVNoYXBlQSwgb3ZlcnJpZGVTaGFwZUIpIHsKICAgICAgbGV0IGM7CgogICAgICBpZiAodGhpcy5jb250YWN0UG9pbnRQb29sLmxlbmd0aCkgewogICAgICAgIGMgPSB0aGlzLmNvbnRhY3RQb2ludFBvb2wucG9wKCk7CiAgICAgICAgYy5iaSA9IGJpOwogICAgICAgIGMuYmogPSBiajsKICAgICAgfSBlbHNlIHsKICAgICAgICBjID0gbmV3IENvbnRhY3RFcXVhdGlvbihiaSwgYmopOwogICAgICB9CgogICAgICBjLmVuYWJsZWQgPSBiaS5jb2xsaXNpb25SZXNwb25zZSAmJiBiai5jb2xsaXNpb25SZXNwb25zZSAmJiBzaS5jb2xsaXNpb25SZXNwb25zZSAmJiBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgY29uc3QgY20gPSB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWw7CiAgICAgIGMucmVzdGl0dXRpb24gPSBjbS5yZXN0aXR1dGlvbjsKICAgICAgYy5zZXRTcG9va1BhcmFtcyhjbS5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MsIGNtLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24sIHRoaXMud29ybGQuZHQpOwogICAgICBjb25zdCBtYXRBID0gc2kubWF0ZXJpYWwgfHwgYmkubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzai5tYXRlcmlhbCB8fCBiai5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5yZXN0aXR1dGlvbiA+PSAwICYmIG1hdEIucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgIGMucmVzdGl0dXRpb24gPSBtYXRBLnJlc3RpdHV0aW9uICogbWF0Qi5yZXN0aXR1dGlvbjsKICAgICAgfQoKICAgICAgYy5zaSA9IG92ZXJyaWRlU2hhcGVBIHx8IHNpOwogICAgICBjLnNqID0gb3ZlcnJpZGVTaGFwZUIgfHwgc2o7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoY29udGFjdEVxdWF0aW9uLCBvdXRBcnJheSkgewogICAgICBjb25zdCBib2R5QSA9IGNvbnRhY3RFcXVhdGlvbi5iaTsKICAgICAgY29uc3QgYm9keUIgPSBjb250YWN0RXF1YXRpb24uYmo7CiAgICAgIGNvbnN0IHNoYXBlQSA9IGNvbnRhY3RFcXVhdGlvbi5zaTsKICAgICAgY29uc3Qgc2hhcGVCID0gY29udGFjdEVxdWF0aW9uLnNqOwogICAgICBjb25zdCB3b3JsZCA9IHRoaXMud29ybGQ7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOyAvLyBJZiBmcmljdGlvbiBvciByZXN0aXR1dGlvbiB3ZXJlIHNwZWNpZmllZCBpbiB0aGUgbWF0ZXJpYWwsIHVzZSB0aGVtCgogICAgICBsZXQgZnJpY3Rpb24gPSBjbS5mcmljdGlvbjsKICAgICAgY29uc3QgbWF0QSA9IHNoYXBlQS5tYXRlcmlhbCB8fCBib2R5QS5tYXRlcmlhbDsKICAgICAgY29uc3QgbWF0QiA9IHNoYXBlQi5tYXRlcmlhbCB8fCBib2R5Qi5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5mcmljdGlvbiA+PSAwICYmIG1hdEIuZnJpY3Rpb24gPj0gMCkgewogICAgICAgIGZyaWN0aW9uID0gbWF0QS5mcmljdGlvbiAqIG1hdEIuZnJpY3Rpb247CiAgICAgIH0KCiAgICAgIGlmIChmcmljdGlvbiA+IDApIHsKICAgICAgICAvLyBDcmVhdGUgMiB0YW5nZW50IGVxdWF0aW9ucwogICAgICAgIC8vIFVzZXJzIG1heSBwcm92aWRlIGEgZm9yY2UgZGlmZmVyZW50IGZyb20gZ2xvYmFsIGdyYXZpdHkgdG8gdXNlIHdoZW4gY29tcHV0aW5nIGNvbnRhY3QgZnJpY3Rpb24uCiAgICAgICAgY29uc3QgbXVnID0gZnJpY3Rpb24gKiAod29ybGQuZnJpY3Rpb25HcmF2aXR5IHx8IHdvcmxkLmdyYXZpdHkpLmxlbmd0aCgpOwogICAgICAgIGxldCByZWR1Y2VkTWFzcyA9IGJvZHlBLmludk1hc3MgKyBib2R5Qi5pbnZNYXNzOwoKICAgICAgICBpZiAocmVkdWNlZE1hc3MgPiAwKSB7CiAgICAgICAgICByZWR1Y2VkTWFzcyA9IDEgLyByZWR1Y2VkTWFzczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBvb2wgPSB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sOwogICAgICAgIGNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYm9keUEsIGJvZHlCLCBtdWcgKiByZWR1Y2VkTWFzcyk7CiAgICAgICAgY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjMS5iaSA9IGMyLmJpID0gYm9keUE7CiAgICAgICAgYzEuYmogPSBjMi5iaiA9IGJvZHlCOwogICAgICAgIGMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnICogcmVkdWNlZE1hc3M7CiAgICAgICAgYzEubWF4Rm9yY2UgPSBjMi5tYXhGb3JjZSA9IG11ZyAqIHJlZHVjZWRNYXNzOyAvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKCiAgICAgICAgYzEucmkuY29weShjb250YWN0RXF1YXRpb24ucmkpOwogICAgICAgIGMxLnJqLmNvcHkoY29udGFjdEVxdWF0aW9uLnJqKTsKICAgICAgICBjMi5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzIucmouY29weShjb250YWN0RXF1YXRpb24ucmopOyAvLyBDb25zdHJ1Y3QgdGFuZ2VudHMKCiAgICAgICAgY29udGFjdEVxdWF0aW9uLm5pLnRhbmdlbnRzKGMxLnQsIGMyLnQpOyAvLyBTZXQgc3Bvb2sgcGFyYW1zCgogICAgICAgIGMxLnNldFNwb29rUGFyYW1zKGNtLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MsIGNtLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uLCB3b3JsZC5kdCk7CiAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMS5lbmFibGVkID0gYzIuZW5hYmxlZCA9IGNvbnRhY3RFcXVhdGlvbi5lbmFibGVkOwogICAgICAgIG91dEFycmF5LnB1c2goYzEsIGMyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBUYWtlIHRoZSBhdmVyYWdlIE4gbGF0ZXN0IGNvbnRhY3QgcG9pbnQgb24gdGhlIHBsYW5lLgogICAgICovCgoKICAgIGNyZWF0ZUZyaWN0aW9uRnJvbUF2ZXJhZ2UobnVtQ29udGFjdHMpIHsKICAgICAgLy8gVGhlIGxhc3QgY29udGFjdEVxdWF0aW9uCiAgICAgIGxldCBjID0gdGhpcy5yZXN1bHRbdGhpcy5yZXN1bHQubGVuZ3RoIC0gMV07IC8vIENyZWF0ZSB0aGUgcmVzdWx0OiB0d28gImF2ZXJhZ2UiIGZyaWN0aW9uIGVxdWF0aW9ucwoKICAgICAgaWYgKCF0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoYywgdGhpcy5mcmljdGlvblJlc3VsdCkgfHwgbnVtQ29udGFjdHMgPT09IDEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGYxID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDJdOwogICAgICBjb25zdCBmMiA9IHRoaXMuZnJpY3Rpb25SZXN1bHRbdGhpcy5mcmljdGlvblJlc3VsdC5sZW5ndGggLSAxXTsKICAgICAgYXZlcmFnZU5vcm1hbC5zZXRaZXJvKCk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEIuc2V0WmVybygpOwogICAgICBjb25zdCBib2R5QSA9IGMuYmk7CiAgICAgIGMuYmo7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbnVtQ29udGFjdHM7IGkrKykgewogICAgICAgIGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxIC0gaV07CgogICAgICAgIGlmIChjLmJpICE9PSBib2R5QSkgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52YWRkKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJpLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52c3ViKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJqLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGludk51bUNvbnRhY3RzID0gMSAvIG51bUNvbnRhY3RzOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmkpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmopOwogICAgICBmMi5yaS5jb3B5KGYxLnJpKTsgLy8gU2hvdWxkIGJlIHRoZSBzYW1lCgogICAgICBmMi5yai5jb3B5KGYxLnJqKTsKICAgICAgYXZlcmFnZU5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgYXZlcmFnZU5vcm1hbC50YW5nZW50cyhmMS50LCBmMi50KTsgLy8gcmV0dXJuIGVxOwogICAgfQogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBhbGwgY29udGFjdHMgYmV0d2VlbiBhIGxpc3Qgb2YgYm9keSBwYWlycwogICAgICogQHBhcmFtIHAxIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHAyIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHJlc3VsdCBBcnJheSB0byBzdG9yZSBnZW5lcmF0ZWQgY29udGFjdHMKICAgICAqIEBwYXJhbSBvbGRjb250YWN0cyBPcHRpb25hbC4gQXJyYXkgb2YgcmV1c2FibGUgY29udGFjdCBvYmplY3RzCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdHMocDEsIHAyLCB3b3JsZCwgcmVzdWx0LCBvbGRjb250YWN0cywgZnJpY3Rpb25SZXN1bHQsIGZyaWN0aW9uUG9vbCkgewogICAgICAvLyBTYXZlIG9sZCBjb250YWN0IG9iamVjdHMKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gb2xkY29udGFjdHM7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBmcmljdGlvblBvb2w7CiAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0OwogICAgICB0aGlzLmZyaWN0aW9uUmVzdWx0ID0gZnJpY3Rpb25SZXN1bHQ7CiAgICAgIGNvbnN0IHFpID0gdG1wUXVhdDE7CiAgICAgIGNvbnN0IHFqID0gdG1wUXVhdDI7CiAgICAgIGNvbnN0IHhpID0gdG1wVmVjMTsKICAgICAgY29uc3QgeGogPSB0bXBWZWMyOwoKICAgICAgZm9yIChsZXQgayA9IDAsIE4gPSBwMS5sZW5ndGg7IGsgIT09IE47IGsrKykgewogICAgICAgIC8vIEdldCBjdXJyZW50IGNvbGxpc2lvbiBib2RpZXMKICAgICAgICBjb25zdCBiaSA9IHAxW2tdOwogICAgICAgIGNvbnN0IGJqID0gcDJba107IC8vIEdldCBjb250YWN0IG1hdGVyaWFsCgogICAgICAgIGxldCBib2R5Q29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBib2R5Q29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKGJpLm1hdGVyaWFsLCBiai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGp1c3RUZXN0ID0gYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LlNUQVRJQyB8fCBiaS50eXBlICYgQm9keS5TVEFUSUMgJiYgYmoudHlwZSAmIEJvZHkuS0lORU1BVElDIHx8IGJpLnR5cGUgJiBCb2R5LktJTkVNQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmkuc2hhcGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBiaS5xdWF0ZXJuaW9uLm11bHQoYmkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICAgIGJpLnF1YXRlcm5pb24udm11bHQoYmkuc2hhcGVPZmZzZXRzW2ldLCB4aSk7CiAgICAgICAgICB4aS52YWRkKGJpLnBvc2l0aW9uLCB4aSk7CiAgICAgICAgICBjb25zdCBzaSA9IGJpLnNoYXBlc1tpXTsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJqLnNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAvLyBDb21wdXRlIHdvcmxkIHRyYW5zZm9ybSBvZiBzaGFwZXMKICAgICAgICAgICAgYmoucXVhdGVybmlvbi5tdWx0KGJqLnNoYXBlT3JpZW50YXRpb25zW2pdLCBxaik7CiAgICAgICAgICAgIGJqLnF1YXRlcm5pb24udm11bHQoYmouc2hhcGVPZmZzZXRzW2pdLCB4aik7CiAgICAgICAgICAgIHhqLnZhZGQoYmoucG9zaXRpb24sIHhqKTsKICAgICAgICAgICAgY29uc3Qgc2ogPSBiai5zaGFwZXNbal07CgogICAgICAgICAgICBpZiAoIShzaS5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2ouY29sbGlzaW9uRmlsdGVyR3JvdXAgJiYgc2ouY29sbGlzaW9uRmlsdGVyTWFzayAmIHNpLmNvbGxpc2lvbkZpbHRlckdyb3VwKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0gLy8gR2V0IGNvbGxpc2lvbiBtYXRlcmlhbAoKCiAgICAgICAgICAgIGxldCBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IG51bGw7CgogICAgICAgICAgICBpZiAoc2kubWF0ZXJpYWwgJiYgc2oubWF0ZXJpYWwpIHsKICAgICAgICAgICAgICBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmdldENvbnRhY3RNYXRlcmlhbChzaS5tYXRlcmlhbCwgc2oubWF0ZXJpYWwpIHx8IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHNoYXBlQ29udGFjdE1hdGVyaWFsIHx8IGJvZHlDb250YWN0TWF0ZXJpYWwgfHwgd29ybGQuZGVmYXVsdENvbnRhY3RNYXRlcmlhbDsgLy8gR2V0IGNvbnRhY3RzCgogICAgICAgICAgICBjb25zdCByZXNvbHZlckluZGV4ID0gc2kudHlwZSB8IHNqLnR5cGU7CiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gdGhpc1tyZXNvbHZlckluZGV4XTsKCiAgICAgICAgICAgIGlmIChyZXNvbHZlcikgewogICAgICAgICAgICAgIGxldCByZXR2YWwgPSBmYWxzZTsgLy8gVE8gRE86IGludmVzdGlnYXRlIHdoeSBzcGhlcmVQYXJ0aWNsZSBhbmQgY29udmV4UGFydGljbGUKICAgICAgICAgICAgICAvLyByZXNvbHZlcnMgZXhwZWN0IHNpIGFuZCBzaiBzaGFwZXMgdG8gYmUgaW4gcmV2ZXJzZSBvcmRlcgogICAgICAgICAgICAgIC8vIChpLmUuIGxhcmdlciBpbnRlZ2VyIHZhbHVlIHR5cGUgZmlyc3QgaW5zdGVhZCBvZiBzbWFsbGVyIGZpcnN0KQoKICAgICAgICAgICAgICBpZiAoc2kudHlwZSA8IHNqLnR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHZhbCA9IHJlc29sdmVyLmNhbGwodGhpcywgc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHJldHZhbCAmJiBqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgb3ZlcmxhcAogICAgICAgICAgICAgICAgd29ybGQuc2hhcGVPdmVybGFwS2VlcGVyLnNldChzaS5pZCwgc2ouaWQpOwogICAgICAgICAgICAgICAgd29ybGQuYm9keU92ZXJsYXBLZWVwZXIuc2V0KGJpLmlkLCBiai5pZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlU3BoZXJlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgIHJldHVybiB4aS5kaXN0YW5jZVNxdWFyZWQoeGopIDwgKHNpLnJhZGl1cyArIHNqLnJhZGl1cykgKiogMjsKICAgICAgfSAvLyBXZSB3aWxsIGhhdmUgb25seSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKCgogICAgICBjb25zdCBjb250YWN0RXEgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgeGoudnN1Yih4aSwgY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLm5pLm5vcm1hbGl6ZSgpOyAvLyBDb250YWN0IHBvaW50IGxvY2F0aW9ucwoKICAgICAgY29udGFjdEVxLnJpLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJqLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJpLnNjYWxlKHNpLnJhZGl1cywgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnNjYWxlKC1zai5yYWRpdXMsIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yaS52YWRkKHhpLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmkudnN1YihiaS5wb3NpdGlvbiwgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnZhZGQoeGosIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yai52c3ViKGJqLnBvc2l0aW9uLCBjb250YWN0RXEucmopOwogICAgICB0aGlzLnJlc3VsdC5wdXNoKGNvbnRhY3RFcSk7CiAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjb250YWN0RXEsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgfQoKICAgIHNwaGVyZVBsYW5lKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFdlIHdpbGwgaGF2ZSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICByLm5pLnNldCgwLCAwLCAxKTsKICAgICAgcWoudm11bHQoci5uaSwgci5uaSk7CiAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBib2R5IGkgaXMgdGhlIHNwaGVyZSwgZmxpcCBub3JtYWwKCiAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIE5lZWRlZD8KICAgICAgLy8gVmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0IHBvaW50CgogICAgICByLm5pLnNjYWxlKHNpLnJhZGl1cywgci5yaSk7IC8vIFByb2plY3QgZG93biBzcGhlcmUgb24gcGxhbmUKCiAgICAgIHhpLnZzdWIoeGosIHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSk7CiAgICAgIHIubmkuc2NhbGUoci5uaS5kb3QocG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKSwgcGxhbmVfdG9fc3BoZXJlX29ydGhvKTsKICAgICAgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLnZzdWIocGxhbmVfdG9fc3BoZXJlX29ydGhvLCByLnJqKTsgLy8gVGhlIHNwaGVyZSBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gcGxhbmUKCiAgICAgIGlmICgtcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLmRvdChyLm5pKSA8PSBzaS5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKCiAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgIGNvbnN0IHJqID0gci5yajsKICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgIH0KICAgIH0KCiAgICBib3hCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOyAvLyB3ZSByZWZlciB0byB0aGUgYm94IGFzIGJvZHkgagoKICAgICAgY29uc3Qgc2lkZXMgPSBzcGhlcmVCb3hfc2lkZXM7CiAgICAgIHhpLnZzdWIoeGosIGJveF90b19zcGhlcmUpOwogICAgICBzai5nZXRTaWRlTm9ybWFscyhzaWRlcywgcWopOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOwoKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7IC8vIFN0b3JlIHRoZSByZXN1bHRpbmcgc2lkZSBwZW5ldHJhdGlvbiBpbmZvCgogICAgICBjb25zdCBzaWRlX25zID0gc3BoZXJlQm94X3NpZGVfbnM7CiAgICAgIGNvbnN0IHNpZGVfbnMxID0gc3BoZXJlQm94X3NpZGVfbnMxOwogICAgICBjb25zdCBzaWRlX25zMiA9IHNwaGVyZUJveF9zaWRlX25zMjsKICAgICAgbGV0IHNpZGVfaCA9IG51bGw7CiAgICAgIGxldCBzaWRlX3BlbmV0cmF0aW9ucyA9IDA7CiAgICAgIGxldCBzaWRlX2RvdDEgPSAwOwogICAgICBsZXQgc2lkZV9kb3QyID0gMDsKICAgICAgbGV0IHNpZGVfZGlzdGFuY2UgPSBudWxsOwoKICAgICAgZm9yIChsZXQgaWR4ID0gMCwgbnNpZGVzID0gc2lkZXMubGVuZ3RoOyBpZHggIT09IG5zaWRlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGlkeCsrKSB7CiAgICAgICAgLy8gR2V0IHRoZSBwbGFuZSBzaWRlIG5vcm1hbCAobnMpCiAgICAgICAgY29uc3QgbnMgPSBzcGhlcmVCb3hfbnM7CiAgICAgICAgbnMuY29weShzaWRlc1tpZHhdKTsKICAgICAgICBjb25zdCBoID0gbnMubGVuZ3RoKCk7CiAgICAgICAgbnMubm9ybWFsaXplKCk7IC8vIFRoZSBub3JtYWwvZGlzdGFuY2UgZG90IHByb2R1Y3QgdGVsbHMgd2hpY2ggc2lkZSBvZiB0aGUgcGxhbmUgd2UgYXJlCgogICAgICAgIGNvbnN0IGRvdCA9IGJveF90b19zcGhlcmUuZG90KG5zKTsKCiAgICAgICAgaWYgKGRvdCA8IGggKyBSICYmIGRvdCA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayB0aGUgb3RoZXIgdHdvIGRpbWVuc2lvbnMKICAgICAgICAgIGNvbnN0IG5zMSA9IHNwaGVyZUJveF9uczE7CiAgICAgICAgICBjb25zdCBuczIgPSBzcGhlcmVCb3hfbnMyOwogICAgICAgICAgbnMxLmNvcHkoc2lkZXNbKGlkeCArIDEpICUgM10pOwogICAgICAgICAgbnMyLmNvcHkoc2lkZXNbKGlkeCArIDIpICUgM10pOwogICAgICAgICAgY29uc3QgaDEgPSBuczEubGVuZ3RoKCk7CiAgICAgICAgICBjb25zdCBoMiA9IG5zMi5sZW5ndGgoKTsKICAgICAgICAgIG5zMS5ub3JtYWxpemUoKTsKICAgICAgICAgIG5zMi5ub3JtYWxpemUoKTsKICAgICAgICAgIGNvbnN0IGRvdDEgPSBib3hfdG9fc3BoZXJlLmRvdChuczEpOwogICAgICAgICAgY29uc3QgZG90MiA9IGJveF90b19zcGhlcmUuZG90KG5zMik7CgogICAgICAgICAgaWYgKGRvdDEgPCBoMSAmJiBkb3QxID4gLWgxICYmIGRvdDIgPCBoMiAmJiBkb3QyID4gLWgyKSB7CiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmFicyhkb3QgLSBoIC0gUik7CgogICAgICAgICAgICBpZiAoc2lkZV9kaXN0YW5jZSA9PT0gbnVsbCB8fCBkaXN0IDwgc2lkZV9kaXN0YW5jZSkgewogICAgICAgICAgICAgIHNpZGVfZGlzdGFuY2UgPSBkaXN0OwogICAgICAgICAgICAgIHNpZGVfZG90MSA9IGRvdDE7CiAgICAgICAgICAgICAgc2lkZV9kb3QyID0gZG90MjsKICAgICAgICAgICAgICBzaWRlX2ggPSBoOwogICAgICAgICAgICAgIHNpZGVfbnMuY29weShucyk7CiAgICAgICAgICAgICAgc2lkZV9uczEuY29weShuczEpOwogICAgICAgICAgICAgIHNpZGVfbnMyLmNvcHkobnMyKTsKICAgICAgICAgICAgICBzaWRlX3BlbmV0cmF0aW9ucysrOwoKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNpZGVfcGVuZXRyYXRpb25zKSB7CiAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHNpZGVfbnMuc2NhbGUoLVIsIHIucmkpOyAvLyBTcGhlcmUgcgoKICAgICAgICByLm5pLmNvcHkoc2lkZV9ucyk7CiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBzaG91bGQgYmUgb3V0IG9mIHNwaGVyZQoKICAgICAgICBzaWRlX25zLnNjYWxlKHNpZGVfaCwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczEuc2NhbGUoc2lkZV9kb3QxLCBzaWRlX25zMSk7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMxLCBzaWRlX25zKTsKICAgICAgICBzaWRlX25zMi5zY2FsZShzaWRlX2RvdDIsIHNpZGVfbnMyKTsKICAgICAgICBzaWRlX25zLnZhZGQoc2lkZV9uczIsIHIucmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9IC8vIENoZWNrIGNvcm5lcnMKCgogICAgICBsZXQgcmogPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVCb3hfc3BoZXJlX3RvX2Nvcm5lcjsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSAyICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IDIgJiYgIWZvdW5kOyBrKyspIHsKICAgICAgICAgIGZvciAobGV0IGwgPSAwOyBsICE9PSAyICYmICFmb3VuZDsgbCsrKSB7CiAgICAgICAgICAgIHJqLnNldCgwLCAwLCAwKTsKCiAgICAgICAgICAgIGlmIChqKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1swXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGspIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzFdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobCkgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMl0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gLy8gV29ybGQgcG9zaXRpb24gb2YgY29ybmVyCgoKICAgICAgICAgICAgeGoudmFkZChyaiwgc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICAgIHNwaGVyZV90b19jb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICAgIHIucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICAgICAgci5yai5jb3B5KHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UocmopOwogICAgICByaiA9IG51bGw7IC8vIENoZWNrIGVkZ2VzCgogICAgICBjb25zdCBlZGdlVGFuZ2VudCA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgZWRnZUNlbnRlciA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgciA9IHYzcG9vbC5nZXQoKTsgLy8gciA9IGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIKCiAgICAgIGNvbnN0IG9ydGhvZ29uYWwgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGRpc3QgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IE5zaWRlcyA9IHNpZGVzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOc2lkZXMgJiYgIWZvdW5kOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayAhPT0gTnNpZGVzICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBpZiAoaiAlIDMgIT09IGsgJSAzKSB7CiAgICAgICAgICAgIC8vIEdldCBlZGdlIHRhbmdlbnQKICAgICAgICAgICAgc2lkZXNba10uY3Jvc3Moc2lkZXNbal0sIGVkZ2VUYW5nZW50KTsKICAgICAgICAgICAgZWRnZVRhbmdlbnQubm9ybWFsaXplKCk7CiAgICAgICAgICAgIHNpZGVzW2pdLnZhZGQoc2lkZXNba10sIGVkZ2VDZW50ZXIpOwogICAgICAgICAgICByLmNvcHkoeGkpOwogICAgICAgICAgICByLnZzdWIoZWRnZUNlbnRlciwgcik7CiAgICAgICAgICAgIHIudnN1Yih4aiwgcik7CiAgICAgICAgICAgIGNvbnN0IG9ydGhvbm9ybSA9IHIuZG90KGVkZ2VUYW5nZW50KTsgLy8gZGlzdGFuY2UgZnJvbSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyIGluIHRoZSB0YW5nZW50IGRpcmVjdGlvbgoKICAgICAgICAgICAgZWRnZVRhbmdlbnQuc2NhbGUob3J0aG9ub3JtLCBvcnRob2dvbmFsKTsgLy8gVmVjdG9yIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KICAgICAgICAgICAgLy8gRmluZCB0aGUgdGhpcmQgc2lkZSBvcnRob2dvbmFsIHRvIHRoaXMgb25lCgogICAgICAgICAgICBsZXQgbCA9IDA7CgogICAgICAgICAgICB3aGlsZSAobCA9PT0gaiAlIDMgfHwgbCA9PT0gayAlIDMpIHsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgIH0gLy8gdmVjIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIHByb2plY3RlZCB0byB0aGUgcGxhbmUgb3J0aG9nb25hbCB0byB0aGUgZWRnZSB0YW5nZW50CgoKICAgICAgICAgICAgZGlzdC5jb3B5KHhpKTsKICAgICAgICAgICAgZGlzdC52c3ViKG9ydGhvZ29uYWwsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoZWRnZUNlbnRlciwgZGlzdCk7CiAgICAgICAgICAgIGRpc3QudnN1Yih4aiwgZGlzdCk7IC8vIERpc3RhbmNlcyBpbiB0YW5nZW50IGRpcmVjdGlvbiBhbmQgZGlzdGFuY2UgaW4gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gaXQKCiAgICAgICAgICAgIGNvbnN0IHRkaXN0ID0gTWF0aC5hYnMob3J0aG9ub3JtKTsKICAgICAgICAgICAgY29uc3QgbmRpc3QgPSBkaXN0Lmxlbmd0aCgpOwoKICAgICAgICAgICAgaWYgKHRkaXN0IDwgc2lkZXNbbF0ubGVuZ3RoKCkgJiYgbmRpc3QgPCBSKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBjb25zdCByZXMgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIGVkZ2VDZW50ZXIudmFkZChvcnRob2dvbmFsLCByZXMucmopOyAvLyBib3ggcmoKCiAgICAgICAgICAgICAgcmVzLnJqLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICBkaXN0Lm5lZ2F0ZShyZXMubmkpOwogICAgICAgICAgICAgIHJlcy5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuY29weShyZXMucmopOwogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhqLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuc2NhbGUoUiwgcmVzLnJpKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgcmVzLnJpLnZhZGQoeGksIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJpLnZzdWIoYmkucG9zaXRpb24sIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJqLnZhZGQoeGosIHJlcy5yaik7CiAgICAgICAgICAgICAgcmVzLnJqLnZzdWIoYmoucG9zaXRpb24sIHJlcy5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyZXMpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyZXMsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2M3Bvb2wucmVsZWFzZShlZGdlVGFuZ2VudCwgZWRnZUNlbnRlciwgciwgb3J0aG9nb25hbCwgZGlzdCk7CiAgICB9CgogICAgcGxhbmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNqLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uaWQgPSBzai5pZDsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXgoc2ksIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4Q29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBzZXBBeGlzID0gY29udmV4Q29udmV4X3NlcEF4aXM7CgogICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoc2kuZmluZFNlcGFyYXRpbmdBeGlzKHNqLCB4aSwgcWksIHhqLCBxaiwgc2VwQXhpcywgZmFjZUxpc3RBLCBmYWNlTGlzdEIpKSB7CiAgICAgICAgY29uc3QgcmVzID0gW107CiAgICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgICAgIHNpLmNsaXBBZ2FpbnN0SHVsbCh4aSwgcWksIHNqLCB4aiwgcWosIHNlcEF4aXMsIC0xMDAsIDEwMCwgcmVzKTsKICAgICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gcmVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7CiAgICAgICAgICBzZXBBeGlzLm5lZ2F0ZShyLm5pKTsKICAgICAgICAgIHJlc1tqXS5ub3JtYWwubmVnYXRlKHEpOwogICAgICAgICAgcS5zY2FsZShyZXNbal0uZGVwdGgsIHEpOwogICAgICAgICAgcmVzW2pdLnBvaW50LnZhZGQocSwgcmkpOwogICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOyAvLyBDb250YWN0IHBvaW50cyBhcmUgaW4gd29ybGQgY29vcmRpbmF0ZXMuIFRyYW5zZm9ybSBiYWNrIHRvIHJlbGF0aXZlCgogICAgICAgICAgcmkudnN1Yih4aSwgcmkpOwogICAgICAgICAgcmoudnN1Yih4aiwgcmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICAgIHJpLnZzdWIoYmkucG9zaXRpb24sIHJpKTsKICAgICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7CiAgICAgIHhpLnZzdWIoeGosIGNvbnZleF90b19zcGhlcmUpOwogICAgICBjb25zdCBub3JtYWxzID0gc2ouZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IGZhY2VzID0gc2ouZmFjZXM7CiAgICAgIGNvbnN0IHZlcnRzID0gc2oudmVydGljZXM7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIC8vICAgICByZXR1cm47CiAgICAgIC8vIH0KCiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBDaGVjayBjb3JuZXJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKICAgICAgICBjb25zdCB3b3JsZENvcm5lciA9IHNwaGVyZUNvbnZleF93b3JsZENvcm5lcjsKICAgICAgICBxai52bXVsdCh2LCB3b3JsZENvcm5lcik7CiAgICAgICAgeGoudmFkZCh3b3JsZENvcm5lciwgd29ybGRDb3JuZXIpOwogICAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Db3JuZXI7CiAgICAgICAgd29ybGRDb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgIGlmIChzcGhlcmVfdG9fY29ybmVyLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICByLnJpLmNvcHkoc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgci5yaS5zY2FsZShSLCByLnJpKTsKICAgICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGosIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIHNpZGUgKHBsYW5lKSBpbnRlcnNlY3Rpb25zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIG5mYWNlcyA9IGZhY2VzLmxlbmd0aDsgaSAhPT0gbmZhY2VzICYmIGZvdW5kID09PSBmYWxzZTsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9ybWFsID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07IC8vIEdldCB3b3JsZC10cmFuc2Zvcm1lZCBub3JtYWwgb2YgdGhlIGZhY2UKCiAgICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBzcGhlcmVDb252ZXhfd29ybGROb3JtYWw7CiAgICAgICAgcWoudm11bHQobm9ybWFsLCB3b3JsZE5vcm1hbCk7IC8vIEdldCBhIHdvcmxkIHZlcnRleCBmcm9tIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkUG9pbnQgPSBzcGhlcmVDb252ZXhfd29ybGRQb2ludDsKICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWzBdXSwgd29ybGRQb2ludCk7CiAgICAgICAgd29ybGRQb2ludC52YWRkKHhqLCB3b3JsZFBvaW50KTsgLy8gR2V0IGEgcG9pbnQgb24gdGhlIHNwaGVyZSwgY2xvc2VzdCB0byB0aGUgZmFjZSBub3JtYWwKCiAgICAgICAgY29uc3Qgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gc3BoZXJlQ29udmV4X3dvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZTsKICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsKICAgICAgICB4aS52YWRkKHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsgLy8gVmVjdG9yIGZyb20gYSBmYWNlIHBvaW50IHRvIHRoZSBjbG9zZXN0IHBvaW50IG9uIHRoZSBzcGhlcmUKCiAgICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWM7CiAgICAgICAgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lLnZzdWIod29ybGRQb2ludCwgcGVuZXRyYXRpb25WZWMpOyAvLyBUaGUgcGVuZXRyYXRpb24uIE5lZ2F0aXZlIHZhbHVlIG1lYW5zIG92ZXJsYXAuCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb25WZWMuZG90KHdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCB3b3JsZFBvaW50VG9TcGhlcmUgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Xb3JsZFBvaW50OwogICAgICAgIHhpLnZzdWIod29ybGRQb2ludCwgd29ybGRQb2ludFRvU3BoZXJlKTsKCiAgICAgICAgaWYgKHBlbmV0cmF0aW9uIDwgMCAmJiB3b3JsZFBvaW50VG9TcGhlcmUuZG90KHdvcmxkTm9ybWFsKSA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayBpZiB0aGUgc3BoZXJlIGlzIGluc2lkZSB0aGUgZmFjZSBwb2x5Z29uCiAgICAgICAgICBjb25zdCBmYWNlVmVydHMgPSBbXTsgLy8gRmFjZSB2ZXJ0aWNlcywgaW4gd29ybGQgY29vcmRzCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE52ZXJ0cyA9IGZhY2UubGVuZ3RoOyBqICE9PSBOdmVydHM7IGorKykgewogICAgICAgICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVtqXV0sIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgeGoudmFkZCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgICAgICBmYWNlVmVydHMucHVzaCh3b3JsZFZlcnRleCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHBvaW50SW5Qb2x5Z29uKGZhY2VWZXJ0cywgd29ybGROb3JtYWwsIHhpKSkgewogICAgICAgICAgICAvLyBJcyB0aGUgc3BoZXJlIGNlbnRlciBpbiB0aGUgZmFjZSBwb2x5Z29uPwogICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHIucmkpOyAvLyBDb250YWN0IG9mZnNldCwgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QKCiAgICAgICAgICAgIHdvcmxkTm9ybWFsLm5lZ2F0ZShyLm5pKTsgLy8gTm9ybWFsIHBvaW50aW5nIG91dCBvZiBzcGhlcmUKCiAgICAgICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjMiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLXBlbmV0cmF0aW9uLCBwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblNwaGVyZVBvaW50ID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgcGVuZXRyYXRpb25TcGhlcmVQb2ludCk7IC8veGkudnN1Yih4aikudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50KS52YWRkKHBlbmV0cmF0aW9uVmVjMiAsIHIucmopOwoKICAgICAgICAgICAgeGkudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50LCByLnJqKTsKICAgICAgICAgICAgci5yai52YWRkKHBlbmV0cmF0aW9uVmVjMiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uVmVjMik7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOwogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOyAvLyBXZSBvbmx5IGV4cGVjdCAqb25lKiBmYWNlIGNvbnRhY3QKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEVkZ2U/CiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBmYWNlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgLy8gR2V0IHR3byB3b3JsZCB0cmFuc2Zvcm1lZCB2ZXJ0aWNlcwogICAgICAgICAgICAgIGNvbnN0IHYxID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYyID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2VbKGogKyAxKSAlIGZhY2UubGVuZ3RoXV0sIHYxKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMikgJSBmYWNlLmxlbmd0aF1dLCB2Mik7CiAgICAgICAgICAgICAgeGoudmFkZCh2MSwgdjEpOwogICAgICAgICAgICAgIHhqLnZhZGQodjIsIHYyKTsgLy8gQ29uc3RydWN0IGVkZ2UgdmVjdG9yCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2UgPSBzcGhlcmVDb252ZXhfZWRnZTsKICAgICAgICAgICAgICB2Mi52c3ViKHYxLCBlZGdlKTsgLy8gQ29uc3RydWN0IHRoZSBzYW1lIHZlY3RvciwgYnV0IG5vcm1hbGl6ZWQKCiAgICAgICAgICAgICAgY29uc3QgZWRnZVVuaXQgPSBzcGhlcmVDb252ZXhfZWRnZVVuaXQ7CiAgICAgICAgICAgICAgZWRnZS51bml0KGVkZ2VVbml0KTsgLy8gcCBpcyB4aSBwcm9qZWN0ZWQgb250byB0aGUgZWRnZQoKICAgICAgICAgICAgICBjb25zdCBwID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYxX3RvX3hpID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHhpLnZzdWIodjEsIHYxX3RvX3hpKTsKICAgICAgICAgICAgICBjb25zdCBkb3QgPSB2MV90b194aS5kb3QoZWRnZVVuaXQpOwogICAgICAgICAgICAgIGVkZ2VVbml0LnNjYWxlKGRvdCwgcCk7CiAgICAgICAgICAgICAgcC52YWRkKHYxLCBwKTsgLy8gQ29tcHV0ZSBhIHZlY3RvciBmcm9tIHAgdG8gdGhlIGNlbnRlciBvZiB0aGUgc3BoZXJlCgogICAgICAgICAgICAgIGNvbnN0IHhpX3RvX3AgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgICAgcC52c3ViKHhpLCB4aV90b19wKTsgLy8gQ29sbGlzaW9uIGlmIHRoZSBlZGdlLXNwaGVyZSBkaXN0YW5jZSBpcyBsZXNzIHRoYW4gdGhlIHJhZGl1cwogICAgICAgICAgICAgIC8vIEFORCBpZiBwIGlzIGluIGJldHdlZW4gdjEgYW5kIHYyCgogICAgICAgICAgICAgIGlmIChkb3QgPiAwICYmIGRvdCAqIGRvdCA8IGVkZ2UubGVuZ3RoU3F1YXJlZCgpICYmIHhpX3RvX3AubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICAgIC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAgIC8vIEVkZ2UgY29udGFjdCEKICAgICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICAgIHAudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGksIHIubmkpOwogICAgICAgICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICAgIHIubmkuc2NhbGUoUiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsgLy8gUmVsZWFzZSB3b3JsZCB2ZXJ0aWNlcwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjEpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh4aV90b19wKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2Mik7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjFfdG9feGkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5mYWNldmVydHMgPSBmYWNlVmVydHMubGVuZ3RoOyBqICE9PSBOZmFjZXZlcnRzOyBqKyspIHsKICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwbGFuZUNvbnZleChwbGFuZVNoYXBlLCBjb252ZXhTaGFwZSwgcGxhbmVQb3NpdGlvbiwgY29udmV4UG9zaXRpb24sIHBsYW5lUXVhdCwgY29udmV4UXVhdCwgcGxhbmVCb2R5LCBjb252ZXhCb2R5LCBzaSwgc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFNpbXBseSByZXR1cm4gdGhlIHBvaW50cyBiZWhpbmQgdGhlIHBsYW5lLgogICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHBsYW5lQ29udmV4X3Y7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gcGxhbmVDb252ZXhfbm9ybWFsOwogICAgICB3b3JsZE5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdCh3b3JsZE5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGxldCBudW1Db250YWN0cyA9IDA7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lQ29udmV4X3JlbHBvczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBjb252ZXhTaGFwZS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIEdldCB3b3JsZCBjb252ZXggdmVydGV4CiAgICAgICAgd29ybGRWZXJ0ZXguY29weShjb252ZXhTaGFwZS52ZXJ0aWNlc1tpXSk7CiAgICAgICAgY29udmV4UXVhdC52bXVsdCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnZleFBvc2l0aW9uLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICB3b3JsZFZlcnRleC52c3ViKHBsYW5lUG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY29uc3QgZG90ID0gd29ybGROb3JtYWwuZG90KHJlbHBvcyk7CgogICAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKHBsYW5lQm9keSwgY29udmV4Qm9keSwgcGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHNpLCBzaik7IC8vIEdldCB2ZXJ0ZXggcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgY29uc3QgcHJvamVjdGVkID0gcGxhbmVDb252ZXhfcHJvamVjdGVkOwogICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUod29ybGROb3JtYWwuZG90KHJlbHBvcyksIHByb2plY3RlZCk7CiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsKICAgICAgICAgIHByb2plY3RlZC52c3ViKHBsYW5lUG9zaXRpb24sIHIucmkpOyAvLyBGcm9tIHBsYW5lIHRvIHZlcnRleCBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICByLm5pLmNvcHkod29ybGROb3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsIG91dCBmcm9tIHBsYW5lCiAgICAgICAgICAvLyByaiBpcyBub3cganVzdCB0aGUgdmVjdG9yIGZyb20gdGhlIGNvbnZleCBjZW50ZXIgdG8gdGhlIHZlcnRleAoKICAgICAgICAgIHdvcmxkVmVydGV4LnZzdWIoY29udmV4UG9zaXRpb24sIHIucmopOyAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgogICAgICAgICAgci5yaS52YWRkKHBsYW5lUG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHBsYW5lQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICByLnJqLnZhZGQoY29udmV4UG9zaXRpb24sIHIucmopOwogICAgICAgICAgci5yai52c3ViKGNvbnZleEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIG51bUNvbnRhY3RzKys7CgogICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uICYmIG51bUNvbnRhY3RzKSB7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgfQogICAgfQoKICAgIGJveENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2kuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVIZWlnaHRmaWVsZChzcGhlcmVTaGFwZSwgaGZTaGFwZSwgc3BoZXJlUG9zLCBoZlBvcywgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCByYWRpdXMgPSBzcGhlcmVTaGFwZS5yYWRpdXM7CiAgICAgIGNvbnN0IHcgPSBoZlNoYXBlLmVsZW1lbnRTaXplOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDI7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbFNwaGVyZVBvcyA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBzcGhlcmVQb3MsIGxvY2FsU3BoZXJlUG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbFNwaGVyZVBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbFNwaGVyZVBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UgY2FuJ3QgdG91Y2ggdGhlIGJvdW5kaW5nIGhlaWdodCBib3gKCiAgICAgIGlmIChsb2NhbFNwaGVyZVBvcy56IC0gcmFkaXVzID4gbWF4IHx8IGxvY2FsU3BoZXJlUG9zLnogKyByYWRpdXMgPCBtaW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzdWx0OwoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGNvbnN0IG51bUNvbnRhY3RzQmVmb3JlID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBudW1Db250YWN0cyA9IHJlc3VsdC5sZW5ndGggLSBudW1Db250YWN0c0JlZm9yZTsKCiAgICAgICAgICBpZiAobnVtQ29udGFjdHMgPiAyKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8qCiAgICAgICAgICAgIC8vIFNraXAgYWxsIGJ1dCAxCiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbnVtQ29udGFjdHMgLSAxOyBrKyspIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5wb3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgKi8KCiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYm94SGVpZ2h0ZmllbGQoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3QgcmFkaXVzID0gY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CiAgICAgIGNvbnN0IHdvcmxkUGlsbGFyT2Zmc2V0ID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMjsKICAgICAgY29uc3QgZmFjZUxpc3QgPSBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdDsgLy8gR2V0IHNwaGVyZSBwb3NpdGlvbiB0byBoZWlnaHRmaWVsZCBsb2NhbCEKCiAgICAgIGNvbnN0IGxvY2FsQ29udmV4UG9zID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKGhmUG9zLCBoZlF1YXQsIGNvbnZleFBvcywgbG9jYWxDb252ZXhQb3MpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGxldCBpTWluWCA9IE1hdGguZmxvb3IoKGxvY2FsQ29udmV4UG9zLnggLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFggPSBNYXRoLmNlaWwoKGxvY2FsQ29udmV4UG9zLnggKyByYWRpdXMpIC8gdykgKyAxOwogICAgICBsZXQgaU1pblkgPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy55IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhZID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy55ICsgcmFkaXVzKSAvIHcpICsgMTsgLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKICAgICAgaWYgKGlNYXhYIDwgMCB8fCBpTWF4WSA8IDAgfHwgaU1pblggPiBkYXRhLmxlbmd0aCB8fCBpTWluWSA+IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCgoKICAgICAgaWYgKGlNaW5YIDwgMCkgewogICAgICAgIGlNaW5YID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYIDwgMCkgewogICAgICAgIGlNYXhYID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZIDwgMCkgewogICAgICAgIGlNaW5ZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZIDwgMCkgewogICAgICAgIGlNYXhZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5YID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1pblggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNYXhYID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWF4WSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1pblkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1pbk1heCA9IFtdOwogICAgICBoZlNoYXBlLmdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIG1pbk1heCk7CiAgICAgIGNvbnN0IG1pbiA9IG1pbk1heFswXTsKICAgICAgY29uc3QgbWF4ID0gbWluTWF4WzFdOyAvLyBCYWlsIG91dCBpZiB3ZSdyZSBjYW50IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxDb252ZXhQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbENvbnZleFBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgbGV0IGludGVyc2VjdGluZyA9IGZhbHNlOyAvLyBMb3dlciB0cmlhbmdsZQoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgZmFsc2UpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSAvLyBVcHBlciB0cmlhbmdsZQoKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIHRydWUpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNwaGVyZVBhcnRpY2xlKHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFRoZSBub3JtYWwgaXMgdGhlIHVuaXQgdmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBwYXJ0aWNsZSBjZW50ZXIKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVTcGhlcmVfbm9ybWFsOwogICAgICBub3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICB4aS52c3ViKHhqLCBub3JtYWwpOwogICAgICBjb25zdCBsZW5ndGhTcXVhcmVkID0gbm9ybWFsLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgIGlmIChsZW5ndGhTcXVhcmVkIDw9IHNqLnJhZGl1cyAqIHNqLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgci5yai5jb3B5KG5vcm1hbCk7CiAgICAgICAgci5yai5zY2FsZShzai5yYWRpdXMsIHIucmopOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCgogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgcGxhbmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBub3JtYWwgPSBwYXJ0aWNsZVBsYW5lX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgYmoucXVhdGVybmlvbi52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZSBvcmllbnRhdGlvbgoKICAgICAgY29uc3QgcmVscG9zID0gcGFydGljbGVQbGFuZV9yZWxwb3M7CiAgICAgIHhpLnZzdWIoYmoucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsCgogICAgICAgIHIubmkubmVnYXRlKHIubmkpOwogICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKICAgICAgICAvLyBHZXQgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBhcnRpY2xlUGxhbmVfcHJvamVjdGVkOwogICAgICAgIG5vcm1hbC5zY2FsZShub3JtYWwuZG90KHhpKSwgcHJvamVjdGVkKTsKICAgICAgICB4aS52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsgLy9wcm9qZWN0ZWQudmFkZChiai5wb3NpdGlvbixwcm9qZWN0ZWQpOwogICAgICAgIC8vIHJqIGlzIG5vdyB0aGUgcHJvamVjdGVkIHdvcmxkIHBvc2l0aW9uIG1pbnVzIHBsYW5lIHBvc2l0aW9uCgogICAgICAgIHIucmouY29weShwcm9qZWN0ZWQpOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgYm94UGFydGljbGUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBsZXQgcGVuZXRyYXRlZEZhY2VJbmRleCA9IC0xOwogICAgICBjb25zdCBwZW5ldHJhdGVkRmFjZU5vcm1hbCA9IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsOwogICAgICBjb25zdCB3b3JsZFBlbmV0cmF0aW9uVmVjID0gY29udmV4UGFydGljbGVfd29ybGRQZW5ldHJhdGlvblZlYzsKICAgICAgbGV0IG1pblBlbmV0cmF0aW9uID0gbnVsbDsKCiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQogIGNvbnN0IGF2ZXJhZ2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGF2ZXJhZ2VDb250YWN0UG9pbnRBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdDEgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHRtcFF1YXQyID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92MiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2VkZ2VWZWN0b3JVbml0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2xvY2FsU3BoZXJlUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdHJpYW5nbGVzID0gW107CiAgY29uc3QgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZV90b19zcGhlcmVfb3J0aG8gPSBuZXcgVmVjMygpOyAvLyBTZWUgaHR0cDovL2J1bGxldHBoeXNpY3MuY29tL0J1bGxldC9CdWxsZXRGdWxsL1NwaGVyZVRyaWFuZ2xlRGV0ZWN0b3JfOGNwcF9zb3VyY2UuaHRtbAoKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl92dHAgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBwb2ludEluUG9seWdvbih2ZXJ0cywgbm9ybWFsLCBwKSB7CiAgICBsZXQgcG9zaXRpdmVSZXN1bHQgPSBudWxsOwogICAgY29uc3QgTiA9IHZlcnRzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsgLy8gR2V0IGVkZ2UgdG8gdGhlIG5leHQgdmVydGV4CgogICAgICBjb25zdCBlZGdlID0gcG9pbnRJblBvbHlnb25fZWRnZTsKICAgICAgdmVydHNbKGkgKyAxKSAlIE5dLnZzdWIodiwgZWRnZSk7IC8vIEdldCBjcm9zcyBwcm9kdWN0IGJldHdlZW4gcG9seWdvbiBub3JtYWwgYW5kIHRoZSBlZGdlCgogICAgICBjb25zdCBlZGdlX3hfbm9ybWFsID0gcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbDsgLy9jb25zdCBlZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKCiAgICAgIGVkZ2UuY3Jvc3Mobm9ybWFsLCBlZGdlX3hfbm9ybWFsKTsgLy8gR2V0IHZlY3RvciBiZXR3ZWVuIHBvaW50IGFuZCBjdXJyZW50IHZlcnRleAoKICAgICAgY29uc3QgdmVydGV4X3RvX3AgPSBwb2ludEluUG9seWdvbl92dHA7CiAgICAgIHAudnN1Yih2LCB2ZXJ0ZXhfdG9fcCk7IC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgY29uc3QgciA9IGVkZ2VfeF9ub3JtYWwuZG90KHZlcnRleF90b19wKTsgLy8gSWYgYWxsIHN1Y2ggZG90IHByb2R1Y3RzIGhhdmUgc2FtZSBzaWduLCB3ZSBhcmUgaW5zaWRlIHRoZSBwb2x5Z29uLgoKICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsIHx8IHIgPiAwICYmIHBvc2l0aXZlUmVzdWx0ID09PSB0cnVlIHx8IHIgPD0gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgICBpZiAocG9zaXRpdmVSZXN1bHQgPT09IG51bGwpIHsKICAgICAgICAgIHBvc2l0aXZlUmVzdWx0ID0gciA+IDA7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEVuY291bnRlcmVkIHNvbWUgb3RoZXIgc2lnbi4gRXhpdC4KICAgICAgfQogICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgY29uc3QgYm94X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZXMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgY29uc3Qgc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X2VkZ2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZE5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9wZW5ldHJhdGlvblZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX2ZhY2VMaXN0ID0gWzBdOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwoKICBjbGFzcyBPdmVybGFwS2VlcGVyIHsKICAgIC8qKgogICAgICogQHRvZG8gUmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KCiAgY29uc3QgZ2V0S2V5ID0gKGksIGopID0+IGkgPCBqID8gYCR7aX0tJHtqfWAgOiBgJHtqfS0ke2l9YDsKICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CgogICAgLyoqIGdldCAqLwogICAgZ2V0KGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICByZXR1cm4gdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBjb25zdCBrZXkgPSBnZXRLZXkoaSwgaik7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiBkZWxldGUgKi8KCgogICAgZGVsZXRlKGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YS5rZXlzLmluZGV4T2Yoa2V5KTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmRhdGEua2V5cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogcmVzZXQgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGtleXMgPSBkYXRhLmtleXM7CgogICAgICB3aGlsZSAoa2V5cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5wb3AoKTsKICAgICAgICBkZWxldGUgZGF0YVtrZXldOwogICAgICB9CiAgICB9CgogIH0KCiAgLyoqCiAgICogVGhlIHBoeXNpY3Mgd29ybGQKICAgKi8KICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBHcmF2aXR5IHRvIHVzZSB3aGVuIGFwcHJveGltYXRpbmcgdGhlIGZyaWN0aW9uIG1heCBmb3JjZSAobXUqbWFzcypncmF2aXR5KS4KICAgICAqIElmIHVuZGVmaW5lZCwgZ2xvYmFsIGdyYXZpdHkgd2lsbCBiZSB1c2VkLgogICAgICogVXNlIHRvIGVuYWJsZSBmcmljdGlvbiBpbiBhIFdvcmxkIHdpdGggYSBudWxsIGdyYXZpdHkgdmVjdG9yIChubyBncmF2aXR5KS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGJyb2FkcGhhc2UgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IE5haXZlQnJvYWRwaGFzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYm9kaWVzIGluIHRoaXMgd29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogVHJ1ZSBpZiBhbnkgYm9kaWVzIGFyZSBub3Qgc2xlZXBpbmcsIGZhbHNlIGlmIGV2ZXJ5IGJvZHkgaXMgc2xlZXBpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBzb2x2ZXIgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IEdTU29sdmVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbk1hdHJpeAogICAgICovCgogICAgLyoqCiAgICAgKiBDb2xsaXNpb25NYXRyaXggZnJvbSB0aGUgcHJldmlvdXMgc3RlcC4KICAgICAqLwoKICAgIC8qKgogICAgICogQWxsIGFkZGVkIGNvbnRhY3RtYXRlcmlhbHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgdG8gbG9vayB1cCBhIENvbnRhY3RNYXRlcmlhbCBnaXZlbiB0d28gaW5zdGFuY2VzIG9mIE1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBtYXRlcmlhbCBvZiB0aGUgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGlzIGNvbnRhY3QgbWF0ZXJpYWwgaXMgdXNlZCBpZiBubyBzdWl0YWJsZSBjb250YWN0bWF0ZXJpYWwgaXMgZm91bmQgZm9yIGEgY29udGFjdC4KICAgICAqLwoKICAgIC8qKgogICAgICogVGltZSBhY2N1bXVsYXRvciBmb3IgaW50ZXJwb2xhdGlvbi4KICAgICAqIEBzZWUgaHR0cHM6Ly9nYWZmZXJvbmdhbWVzLmNvbS9nYW1lLXBoeXNpY3MvZml4LXlvdXItdGltZXN0ZXAvCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcigpOwogICAgICB0aGlzLmR0ID0gLTE7CiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9ICEhb3B0aW9ucy5hbGxvd1NsZWVwOwogICAgICB0aGlzLmNvbnRhY3RzID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMgPSBbXTsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplU2tpcCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgOiAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCA6IGZhbHNlOwogICAgICB0aGlzLnRpbWUgPSAwLjA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IDA7CiAgICAgIHRoaXMuZGVmYXVsdF9kdCA9IDEgLyA2MDsKICAgICAgdGhpcy5uZXh0SWQgPSAwOwogICAgICB0aGlzLmdyYXZpdHkgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMuZ3Jhdml0eSkgewogICAgICAgIHRoaXMuZ3Jhdml0eS5jb3B5KG9wdGlvbnMuZ3Jhdml0eSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmZyaWN0aW9uR3Jhdml0eSkgewogICAgICAgIHRoaXMuZnJpY3Rpb25HcmF2aXR5ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmZyaWN0aW9uR3Jhdml0eS5jb3B5KG9wdGlvbnMuZnJpY3Rpb25HcmF2aXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5icm9hZHBoYXNlID0gb3B0aW9ucy5icm9hZHBoYXNlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJyb2FkcGhhc2UgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICAgIHRoaXMuYm9kaWVzID0gW107CiAgICAgIHRoaXMuaGFzQWN0aXZlQm9kaWVzID0gZmFsc2U7CiAgICAgIHRoaXMuc29sdmVyID0gb3B0aW9ucy5zb2x2ZXIgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc29sdmVyIDogbmV3IEdTU29sdmVyKCk7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSBbXTsKICAgICAgdGhpcy5uYXJyb3dwaGFzZSA9IG5ldyBOYXJyb3dwaGFzZSh0aGlzKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSBuZXcgQXJyYXlDb2xsaXNpb25NYXRyaXgoKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gbmV3IE92ZXJsYXBLZWVwZXIoKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLmNvbnRhY3RtYXRlcmlhbHMgPSBbXTsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IG5ldyBUdXBsZURpY3Rpb25hcnkoKTsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWwoJ2RlZmF1bHQnKTsKICAgICAgdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbCh0aGlzLmRlZmF1bHRNYXRlcmlhbCwgdGhpcy5kZWZhdWx0TWF0ZXJpYWwsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjAKICAgICAgfSk7CiAgICAgIHRoaXMuZG9Qcm9maWxpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5wcm9maWxlID0gewogICAgICAgIHNvbHZlOiAwLAogICAgICAgIG1ha2VDb250YWN0Q29uc3RyYWludHM6IDAsCiAgICAgICAgYnJvYWRwaGFzZTogMCwKICAgICAgICBpbnRlZ3JhdGU6IDAsCiAgICAgICAgbmFycm93cGhhc2U6IDAKICAgICAgfTsKICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IDA7CiAgICAgIHRoaXMuc3Vic3lzdGVtcyA9IFtdOwogICAgICB0aGlzLmFkZEJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAnYWRkQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAncmVtb3ZlQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwID0ge307CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5zZXRXb3JsZCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb250YWN0IG1hdGVyaWFsIGJldHdlZW4gbWF0ZXJpYWxzIG0xIGFuZCBtMgogICAgICogQHJldHVybiBUaGUgY29udGFjdCBtYXRlcmlhbCBpZiBpdCB3YXMgZm91bmQuCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdE1hdGVyaWFsKG0xLCBtMikgewogICAgICByZXR1cm4gdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5nZXQobTEuaWQsIG0yLmlkKTsKICAgIH0KICAgIC8qKgogICAgICogU3RvcmUgb2xkIGNvbGxpc2lvbiBzdGF0ZSBpbmZvCiAgICAgKi8KCgogICAgY29sbGlzaW9uTWF0cml4VGljaygpIHsKICAgICAgY29uc3QgdGVtcCA9IHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXM7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXMgPSB0aGlzLmNvbGxpc2lvbk1hdHJpeDsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSB0ZW1wOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5yZXNldCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyLnRpY2soKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBjb25zdHJhaW50IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIGFkZENvbnN0cmFpbnQoYykgewogICAgICB0aGlzLmNvbnN0cmFpbnRzLnB1c2goYyk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgYSBjb25zdHJhaW50CiAgICAgKi8KCgogICAgcmVtb3ZlQ29uc3RyYWludChjKSB7CiAgICAgIGNvbnN0IGlkeCA9IHRoaXMuY29uc3RyYWludHMuaW5kZXhPZihjKTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgdGhpcy5jb25zdHJhaW50cy5zcGxpY2UoaWR4LCAxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXljYXN0IHRlc3QKICAgICAqIEBkZXByZWNhdGVkIFVzZSAucmF5Y2FzdEFsbCwgLnJheWNhc3RDbG9zZXN0IG9yIC5yYXljYXN0QW55IGluc3RlYWQuCiAgICAgKi8KCgogICAgcmF5VGVzdChmcm9tLCB0bywgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBSYXljYXN0UmVzdWx0KSB7CiAgICAgICAgLy8gRG8gcmF5Y2FzdENsb3Nlc3QKICAgICAgICB0aGlzLnJheWNhc3RDbG9zZXN0KGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBEbyByYXljYXN0QWxsCiAgICAgICAgdGhpcy5yYXljYXN0QWxsKGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCBhZ2FpbnN0IGFsbCBib2RpZXMuIFRoZSBwcm92aWRlZCBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIGhpdCB3aXRoIGEgUmF5Y2FzdFJlc3VsdCBhcyBzaW5nbGUgYXJndW1lbnQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QWxsKGZyb20sIHRvLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQUxMOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRtcFJheS5pbnRlcnNlY3RXb3JsZCh0aGlzLCBvcHRpb25zKTsKICAgIH0KICAgIC8qKgogICAgICogUmF5IGNhc3QsIGFuZCBzdG9wIGF0IHRoZSBmaXJzdCByZXN1bHQuIE5vdGUgdGhhdCB0aGUgb3JkZXIgaXMgcmFuZG9tIC0gYnV0IHRoZSBtZXRob2QgaXMgZmFzdC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbnkoZnJvbSwgdG8sIG9wdGlvbnMsIHJlc3VsdCkgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucywgcmVzdWx0KSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMubW9kZSA9IFJheS5DTE9TRVNUOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSByaWdpZCBib2R5IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICogQHRvZG8gSWYgdGhlIHNpbXVsYXRpb24gaGFzIG5vdCB5ZXQgc3RhcnRlZCwgd2h5IHJlY3JldGUgYW5kIGNvcHkgYXJyYXlzIGZvciBlYWNoIGJvZHk/IEFjY3VtdWxhdGUgaW4gZHluYW1pYyBhcnJheXMgaW4gdGhpcyBjYXNlLgogICAgICogQHRvZG8gQWRkaW5nIGFuIGFycmF5IG9mIGJvZGllcyBzaG91bGQgYmUgcG9zc2libGUuIFRoaXMgd291bGQgc2F2ZSBzb21lIGxvb3BzIHRvbwogICAgICovCgoKICAgIGFkZEJvZHkoYm9keSkgewogICAgICBpZiAodGhpcy5ib2RpZXMuaW5jbHVkZXMoYm9keSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGJvZHkuaW5kZXggPSB0aGlzLmJvZGllcy5sZW5ndGg7CiAgICAgIHRoaXMuYm9kaWVzLnB1c2goYm9keSk7CiAgICAgIGJvZHkud29ybGQgPSB0aGlzOwogICAgICBib2R5LmluaXRQb3NpdGlvbi5jb3B5KGJvZHkucG9zaXRpb24pOwogICAgICBib2R5LmluaXRWZWxvY2l0eS5jb3B5KGJvZHkudmVsb2NpdHkpOwogICAgICBib2R5LnRpbWVMYXN0U2xlZXB5ID0gdGhpcy50aW1lOwoKICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBCb2R5KSB7CiAgICAgICAgYm9keS5pbml0QW5ndWxhclZlbG9jaXR5LmNvcHkoYm9keS5hbmd1bGFyVmVsb2NpdHkpOwogICAgICAgIGJvZHkuaW5pdFF1YXRlcm5pb24uY29weShib2R5LnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKHRoaXMuYm9kaWVzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdID0gYm9keTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMuYWRkQm9keUV2ZW50KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGEgcmlnaWQgYm9keSBmcm9tIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIHJlbW92ZUJvZHkoYm9keSkgewogICAgICBib2R5LndvcmxkID0gbnVsbDsKICAgICAgY29uc3QgbiA9IHRoaXMuYm9kaWVzLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwogICAgICBjb25zdCBpZHggPSBib2RpZXMuaW5kZXhPZihib2R5KTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgYm9kaWVzLnNwbGljZShpZHgsIDEpOyAvLyBUb2RvOiBzaG91bGQgdXNlIGEgZ2FyYmFnZSBmcmVlIG1ldGhvZAogICAgICAgIC8vIFJlY29tcHV0ZSBpbmRleAoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0uaW5kZXggPSBpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXguc2V0TnVtT2JqZWN0cyhuKTsKICAgICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudC5ib2R5ID0gYm9keTsKICAgICAgICBkZWxldGUgdGhpcy5pZFRvQm9keU1hcFtib2R5LmlkXTsKICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5yZW1vdmVCb2R5RXZlbnQpOwogICAgICB9CiAgICB9CgogICAgZ2V0Qm9keUJ5SWQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuaWRUb0JvZHlNYXBbaWRdOwogICAgfQogICAgLyoqCiAgICAgKiBAdG9kbyBNYWtlIGEgZmFzdGVyIG1hcAogICAgICovCgoKICAgIGdldFNoYXBlQnlJZChpZCkgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGVzID0gYm9kaWVzW2ldLnNoYXBlczsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGFwZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2pdOwoKICAgICAgICAgIGlmIChzaGFwZS5pZCA9PT0gaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXBlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnRhY3QgbWF0ZXJpYWwgZnJvbSB0aGUgV29ybGQuCiAgICAgKi8KCgogICAgcmVtb3ZlQ29udGFjdE1hdGVyaWFsKGNtYXQpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb250YWN0bWF0ZXJpYWxzLmluZGV4T2YoY21hdCk7CgogICAgICBpZiAoaWR4ID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpZHgsIDEpOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmRlbGV0ZShjbWF0Lm1hdGVyaWFsc1swXS5pZCwgY21hdC5tYXRlcmlhbHNbMV0uaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBTdGVwIHRoZSBzaW11bGF0aW9uIGZvcndhcmQga2VlcGluZyB0cmFjayBvZiBsYXN0IGNhbGxlZCB0aW1lCiAgICAgKiB0byBiZSBhYmxlIHRvIHN0ZXAgdGhlIHdvcmxkIGF0IGEgZml4ZWQgcmF0ZSwgaW5kZXBlbmRlbnRseSBvZiBmcmFtZXJhdGUuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UgKGRlZmF1bHQ6IDEgLyA2MCkuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbCAoZGVmYXVsdDogMTApLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL3Bvc3QvZml4X3lvdXJfdGltZXN0ZXAvCiAgICAgKiBAZXhhbXBsZQogICAgICogICAgIC8vIFJ1biB0aGUgc2ltdWxhdGlvbiBpbmRlcGVuZGVudGx5IG9mIGZyYW1lcmF0ZSBldmVyeSAxIC8gNjAgbXMKICAgICAqICAgICB3b3JsZC5maXhlZFN0ZXAoKQogICAgICovCgoKICAgIGZpeGVkU3RlcChkdCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKGR0ID09PSB2b2lkIDApIHsKICAgICAgICBkdCA9IDEgLyA2MDsKICAgICAgfQoKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBjb25zdCB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwOyAvLyBzZWNvbmRzCgogICAgICBpZiAoIXRoaXMubGFzdENhbGxUaW1lKSB7CiAgICAgICAgdGhpcy5zdGVwKGR0LCB1bmRlZmluZWQsIG1heFN1YlN0ZXBzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0Q2FsbGVkID0gdGltZSAtIHRoaXMubGFzdENhbGxUaW1lOwogICAgICAgIHRoaXMuc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgICB9CgogICAgICB0aGlzLmxhc3RDYWxsVGltZSA9IHRpbWU7CiAgICB9CiAgICAvKioKICAgICAqIFN0ZXAgdGhlIHBoeXNpY3Mgd29ybGQgZm9yd2FyZCBpbiB0aW1lLgogICAgICoKICAgICAqIFRoZXJlIGFyZSB0d28gbW9kZXMuIFRoZSBzaW1wbGUgbW9kZSBpcyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uLiBJbiB0aGlzIGNhc2UgeW91IG9ubHkgdXNlIHRoZSBmaXJzdCBhcmd1bWVudC4gVGhlIHNlY29uZCBjYXNlIHVzZXMgaW50ZXJwb2xhdGlvbi4gSW4gdGhhdCB5b3UgYWxzbyBwcm92aWRlIHRoZSB0aW1lIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCB1c2VkLCBhcyB3ZWxsIGFzIHRoZSBtYXhpbXVtIGZpeGVkIHRpbWVzdGVwcyB0byB0YWtlLgogICAgICoKICAgICAqIEBwYXJhbSBkdCBUaGUgZml4ZWQgdGltZSBzdGVwIHNpemUgdG8gdXNlLgogICAgICogQHBhcmFtIHRpbWVTaW5jZUxhc3RDYWxsZWQgVGhlIHRpbWUgZWxhcHNlZCBzaW5jZSB0aGUgZnVuY3Rpb24gd2FzIGxhc3QgY2FsbGVkLgogICAgICogQHBhcmFtIG1heFN1YlN0ZXBzIE1heGltdW0gbnVtYmVyIG9mIGZpeGVkIHN0ZXBzIHRvIHRha2UgcGVyIGZ1bmN0aW9uIGNhbGwgKGRlZmF1bHQ6IDEwKS4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgIGxldCBzdWJzdGVwcyA9IDA7CgogICAgICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdG9yID49IGR0ICYmIHN1YnN0ZXBzIDwgbWF4U3ViU3RlcHMpIHsKICAgICAgICAgIC8vIERvIGZpeGVkIHN0ZXBzIHRvIGNhdGNoIHVwCiAgICAgICAgICB0aGlzLmludGVybmFsU3RlcChkdCk7CiAgICAgICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IGR0OwogICAgICAgICAgc3Vic3RlcHMrKzsKCiAgICAgICAgICBpZiAocGVyZm9ybWFuY2Uubm93KCkgLSB0MCA+IGR0ICogMTAwMCkgewogICAgICAgICAgICAvLyBUaGUgZnJhbWVyYXRlIGlzIG5vdCBpbnRlcmFjdGl2ZSBhbnltb3JlLgogICAgICAgICAgICAvLyBXZSBhcmUgYmVsb3cgdGhlIHRhcmdldCBmcmFtZXJhdGUuCiAgICAgICAgICAgIC8vIEJldHRlciBiYWlsIG91dC4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZW1vdmUgdGhlIGV4Y2VzcyBhY2N1bXVsYXRvciwgc2luY2Ugd2UgbWF5IG5vdAogICAgICAgIC8vIGhhdmUgaGFkIGVub3VnaCBzdWJzdGVwcyBhdmFpbGFibGUgdG8gY2F0Y2ggdXAKCgogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSB0aGlzLmFjY3VtdWxhdG9yICUgZHQ7CiAgICAgICAgY29uc3QgdCA9IHRoaXMuYWNjdW11bGF0b3IgLyBkdDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHRoaXMuYm9kaWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBiID0gdGhpcy5ib2RpZXNbal07CiAgICAgICAgICBiLnByZXZpb3VzUG9zaXRpb24ubGVycChiLnBvc2l0aW9uLCB0LCBiLmludGVycG9sYXRlZFBvc2l0aW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLnNsZXJwKGIucXVhdGVybmlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLm5vcm1hbGl6ZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50aW1lICs9IHRpbWVTaW5jZUxhc3RDYWxsZWQ7CiAgICAgIH0KICAgIH0KCiAgICBpbnRlcm5hbFN0ZXAoZHQpIHsKICAgICAgdGhpcy5kdCA9IGR0OwogICAgICBjb25zdCBjb250YWN0cyA9IHRoaXMuY29udGFjdHM7CiAgICAgIGNvbnN0IHAxID0gV29ybGRfc3RlcF9wMTsKICAgICAgY29uc3QgcDIgPSBXb3JsZF9zdGVwX3AyOwogICAgICBjb25zdCBOID0gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgfSAvLyBBZGQgZ3Jhdml0eSB0byBhbGwgb2JqZWN0cwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkudHlwZSA9PT0gRFlOQU1JQykgewogICAgICAgICAgLy8gT25seSBmb3IgZHluYW1pYyBib2RpZXMKICAgICAgICAgIGNvbnN0IGYgPSBiaS5mb3JjZTsKICAgICAgICAgIGNvbnN0IG0gPSBiaS5tYXNzOwogICAgICAgICAgZi54ICs9IG0gKiBneDsKICAgICAgICAgIGYueSArPSBtICogZ3k7CiAgICAgICAgICBmLnogKz0gbSAqIGd6OwogICAgICAgIH0KICAgICAgfSAvLyBVcGRhdGUgc3Vic3lzdGVtcwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBOc3Vic3lzdGVtcyA9IHRoaXMuc3Vic3lzdGVtcy5sZW5ndGg7IGkgIT09IE5zdWJzeXN0ZW1zOyBpKyspIHsKICAgICAgICB0aGlzLnN1YnN5c3RlbXNbaV0udXBkYXRlKCk7CiAgICAgIH0gLy8gQ29sbGlzaW9uIGRldGVjdGlvbgoKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIHAxLmxlbmd0aCA9IDA7IC8vIENsZWFuIHVwIHBhaXIgYXJyYXlzIGZyb20gbGFzdCBzdGVwCgogICAgICBwMi5sZW5ndGggPSAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UuY29sbGlzaW9uUGFpcnModGhpcywgcDEsIHAyKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuYnJvYWRwaGFzZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9sZGNvbnRhY3RzID0gV29ybGRfc3RlcF9vbGRDb250YWN0czsKICAgICAgY29uc3QgTm9sZENvbnRhY3RzID0gY29udGFjdHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZENvbnRhY3RzOyBpKyspIHsKICAgICAgICBvbGRjb250YWN0cy5wdXNoKGNvbnRhY3RzW2ldKTsKICAgICAgfQoKICAgICAgY29udGFjdHMubGVuZ3RoID0gMDsgLy8gVHJhbnNmZXIgRnJpY3Rpb25FcXVhdGlvbiBmcm9tIGN1cnJlbnQgbGlzdCB0byB0aGUgcG9vbCBmb3IgcmV1c2UKCiAgICAgIGNvbnN0IE5vbGRGcmljdGlvbkVxdWF0aW9ucyA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZEZyaWN0aW9uRXF1YXRpb25zOyBpKyspIHsKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUG9vbC5wdXNoKHRoaXMuZnJpY3Rpb25FcXVhdGlvbnNbaV0pOwogICAgICB9CgogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UuZ2V0Q29udGFjdHMocDEsIHAyLCB0aGlzLCBjb250YWN0cywgb2xkY29udGFjdHMsIC8vIFRvIGJlIHJldXNlZAogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLCBmcmljdGlvbkVxdWF0aW9uUG9vbCk7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLm5hcnJvd3BoYXNlID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBMb29wIG92ZXIgYWxsIGNvbGxpc2lvbnMKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIFdha2UgdXAgYm9kaWVzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlKSB7CiAgICAgICAgICBiaS53YWtlVXAoKTsKICAgICAgICAgIGJpLndha2VVcEFmdGVyTmFycm93cGhhc2UgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIHVzZXItYWRkZWQgY29uc3RyYWludHMKCgogICAgICBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKICAgICAgICBjLnVwZGF0ZSgpOwoKICAgICAgICBmb3IgKGxldCBqID0gMCwgTmVxID0gYy5lcXVhdGlvbnMubGVuZ3RoOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgY29uc3QgZXEgPSBjLmVxdWF0aW9uc1tqXTsKICAgICAgICAgIHNvbHZlci5hZGRFcXVhdGlvbihlcSk7CiAgICAgICAgfQogICAgICB9IC8vIFNvbHZlIHRoZSBjb25zdHJhaW5lZCBzeXN0ZW0KCgogICAgICBzb2x2ZXIuc29sdmUoZHQsIHRoaXMpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5zb2x2ZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIExlYXAgZnJvZwogICAgICAvLyB2bmV3ID0gdiArIGgqZi9tCiAgICAgIC8vIHhuZXcgPSB4ICsgaCp2bmV3CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9CgogICAgICBjb25zdCBzdGVwbnVtYmVyID0gdGhpcy5zdGVwbnVtYmVyOwogICAgICBjb25zdCBxdWF0Tm9ybWFsaXplID0gc3RlcG51bWJlciAlICh0aGlzLnF1YXROb3JtYWxpemVTa2lwICsgMSkgPT09IDA7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemVGYXN0ID0gdGhpcy5xdWF0Tm9ybWFsaXplRmFzdDsKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGJvZGllc1tpXS5pbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckZvcmNlcygpOwogICAgICB0aGlzLmJyb2FkcGhhc2UuZGlydHkgPSB0cnVlOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5pbnRlZ3JhdGUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICB9IC8vIFVwZGF0ZSBzdGVwIG51bWJlcgoKCiAgICAgIHRoaXMuc3RlcG51bWJlciArPSAxOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50KTsgLy8gU2xlZXBpbmcgdXBkYXRlCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgogIG5ldyBBQUJCKCk7CiAgY29uc3QgdG1wUmF5ID0gbmV3IFJheSgpOyAvLyBwZXJmb3JtYW5jZS5ub3coKSBmYWxsYmFjayBvbiBEYXRlLm5vdygpCgogIGNvbnN0IHBlcmZvcm1hbmNlID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIGxldCBub3dPZmZzZXQgPSBEYXRlLm5vdygpOwoKICAgIGlmIChwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0OwogICAgfQoKICAgIHBlcmZvcm1hbmNlLm5vdyA9ICgpID0+IERhdGUubm93KCkgLSBub3dPZmZzZXQ7CiAgfQoKICBuZXcgVmVjMygpOyAvLyBEaXNwYXRjaGVkIGFmdGVyIHRoZSB3b3JsZCBoYXMgc3RlcHBlZCBmb3J3YXJkIGluIHRpbWUuCiAgLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCiAgY29uc3QgV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3Bvc3RTdGVwJwogIH07IC8vIERpc3BhdGNoZWQgYmVmb3JlIHRoZSB3b3JsZCBzdGVwcyBmb3J3YXJkIGluIHRpbWUuCgogIGNvbnN0IFdvcmxkX3N0ZXBfcHJlU3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3ByZVN0ZXAnCiAgfTsKICBjb25zdCBXb3JsZF9zdGVwX2NvbGxpZGVFdmVudCA9IHsKICAgIHR5cGU6IEJvZHkuQ09MTElERV9FVkVOVF9OQU1FLAogICAgYm9keTogbnVsbCwKICAgIGNvbnRhY3Q6IG51bGwKICB9OyAvLyBQb29scyBmb3IgdW51c2VkIG9iamVjdHMKCiAgY29uc3QgV29ybGRfc3RlcF9vbGRDb250YWN0cyA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsgLy8gUmV1c2FibGUgYXJyYXlzIGZvciBjb2xsaXNpb24gcGFpcnMKCiAgY29uc3QgV29ybGRfc3RlcF9wMSA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfcDIgPSBbXTsgLy8gU3R1ZmYgZm9yIGVtaXRDb250YWN0RXZlbnRzCgogIGNvbnN0IGFkZGl0aW9ucyA9IFtdOwogIGNvbnN0IHJlbW92YWxzID0gW107CiAgY29uc3QgYmVnaW5Db250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5Db250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGVuZENvbnRhY3RFdmVudCA9IHsKICAgIHR5cGU6ICdlbmRDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGJlZ2luU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5TaGFwZUNvbnRhY3QnLAogICAgYm9keUE6IG51bGwsCiAgICBib2R5QjogbnVsbCwKICAgIHNoYXBlQTogbnVsbCwKICAgIHNoYXBlQjogbnVsbAogIH07CiAgY29uc3QgZW5kU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwoKICBjb25zdCBhZGRDb250YWN0TWF0ZXJpYWwgPSAod29ybGQsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmLCB1dWlkKSA9PiB7CiAgICBsZXQgW21hdGVyaWFsQSwgbWF0ZXJpYWxCLCBvcHRpb25zXSA9IF9yZWY7CiAgICBjb25zdCBtYXRBID0gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWxBKTsKICAgIGNvbnN0IG1hdEIgPSBjcmVhdGVNYXRlcmlhbChtYXRlcmlhbEIpOwogICAgY29uc3QgY29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbChtYXRBLCBtYXRCLCBvcHRpb25zKTsKICAgIGNvbnRhY3RNYXRlcmlhbC51dWlkID0gdXVpZDsKICAgIHdvcmxkLmFkZENvbnRhY3RNYXRlcmlhbChjb250YWN0TWF0ZXJpYWwpOwogIH07CiAgY29uc3QgcmVtb3ZlQ29udGFjdE1hdGVyaWFsID0gKHdvcmxkLCBjbVVVSUQpID0+IHsKICAgIGNvbnN0IGluZGV4ID0gd29ybGQuY29udGFjdG1hdGVyaWFscy5maW5kSW5kZXgoX3JlZjIgPT4gewogICAgICBsZXQgewogICAgICAgIHV1aWQKICAgICAgfSA9IF9yZWYyOwogICAgICByZXR1cm4gdXVpZCA9PT0gY21VVUlEOwogICAgfSk7CiAgICBjb25zdCBbewogICAgICBpZDogaQogICAgfSwgewogICAgICBpZDogagogICAgfV0gPSB3b3JsZC5jb250YWN0bWF0ZXJpYWxzW2luZGV4XS5tYXRlcmlhbHM7CiAgICB3b3JsZC5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpbmRleCwgMSk7CiAgICBkZWxldGUgd29ybGQuY29udGFjdE1hdGVyaWFsVGFibGUuZGF0YVtpIDwgaiA/IGAke2l9LSR7an1gIDogYCR7an0tJHtpfWBdOwogIH07CgogIGxldCBtYXRlcmlhbElkID0gMDsKICBjb25zdCBjcmVhdGVNYXRlcmlhbEZhY3RvcnkgPSBtYXRlcmlhbHMgPT4gZnVuY3Rpb24gKG5hbWVPck9wdGlvbnMpIHsKICAgIGlmIChuYW1lT3JPcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgbmFtZU9yT3B0aW9ucyA9IHt9OwogICAgfQogICAgY29uc3QgbWF0ZXJpYWxPcHRpb25zID0gdHlwZW9mIG5hbWVPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gewogICAgICBuYW1lOiBuYW1lT3JPcHRpb25zCiAgICB9IDogewogICAgICBuYW1lOiBTeW1ib2wuZm9yKGBNYXRlcmlhbCR7bWF0ZXJpYWxJZCsrfWApLAogICAgICAuLi5uYW1lT3JPcHRpb25zCiAgICB9OwogICAgY29uc3QgewogICAgICBuYW1lCiAgICB9ID0gbWF0ZXJpYWxPcHRpb25zOwogICAgbWF0ZXJpYWxzW25hbWVdID0gbWF0ZXJpYWxzW25hbWVdIHx8IG5ldyBNYXRlcmlhbChtYXRlcmlhbE9wdGlvbnMpOwogICAgcmV0dXJuIG1hdGVyaWFsc1tuYW1lXTsKICB9OwoKICAvKioKICAgKiBAdHlwZWRlZiB7IGltcG9ydCgnY2Fubm9uLWVzJykuTWF0ZXJpYWxPcHRpb25zIH0gTWF0ZXJpYWxPcHRpb25zCiAgICovCgogIGNvbnN0IG1ha2VWZWMzID0gX3JlZiA9PiB7CiAgICBsZXQgW3gsIHksIHpdID0gX3JlZjsKICAgIHJldHVybiBuZXcgVmVjMyh4LCB5LCB6KTsKICB9OwogIGNvbnN0IHByZXBhcmVTcGhlcmUgPSBhcmdzID0+IEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdOwogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gX3JlZjIgPT4gewogICAgbGV0IFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdID0gX3JlZjI7CiAgICByZXR1cm4gW3sKICAgICAgYXhlczogYSA/IGEubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZCwKICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMsCiAgICAgIGZhY2VzLAogICAgICBub3JtYWxzOiBuID8gbi5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgICB2ZXJ0aWNlczogdiA/IHYubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZAogICAgfV07CiAgfTsKICBmdW5jdGlvbiBjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSB7CiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnQm94JzoKICAgICAgICByZXR1cm4gbmV3IEJveChuZXcgVmVjMyguLi5hcmdzLm1hcCh2ID0+IHYgLyAyKSkpOwogICAgICAvLyBleHRlbnRzID0+IGhhbGZFeHRlbnRzCiAgICAgIGNhc2UgJ0NvbnZleFBvbHloZWRyb24nOgogICAgICAgIHJldHVybiBuZXcgQ29udmV4UG9seWhlZHJvbiguLi5wcmVwYXJlQ29udmV4UG9seWhlZHJvbihhcmdzKSk7CiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCiAgICAgIGNhc2UgJ0hlaWdodGZpZWxkJzoKICAgICAgICByZXR1cm4gbmV3IEhlaWdodGZpZWxkKC4uLmFyZ3MpOwogICAgICAvLyBbIEFycmF5IGRhdGEsIG9wdGlvbnM6IHttaW5WYWx1ZSwgbWF4VmFsdWUsIGVsZW1lbnRTaXplfSAgXSA9IGFyZ3MKICAgICAgY2FzZSAnUGFydGljbGUnOgogICAgICAgIHJldHVybiBuZXcgUGFydGljbGUoKTsKICAgICAgLy8gbm8gYXJncwogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CiAgICAgIGNhc2UgJ1NwaGVyZSc6CiAgICAgICAgcmV0dXJuIG5ldyBTcGhlcmUoLi4ucHJlcGFyZVNwaGVyZShhcmdzKSk7CiAgICAgIC8vIHJhZGl1cyA9IGFyZ3MKICAgICAgY2FzZSAnVHJpbWVzaCc6CiAgICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKC4uLmFyZ3MpOwogICAgICAvLyBbdmVydGljZXMsIGluZGljZXNdID0gYXJncwogICAgfQogIH0KCiAgLyoqCiAgICogQHBhcmFtIHtUSFJFRS5RdWF0ZXJuaW9ufSB0YXJnZXQKICAgKiBAcGFyYW0ge3sgcm90YXRpb24/OiBUSFJFRS5WZWN0b3IzVHVwbGUgcXVhdGVybmlvbj86IFRIUkVFLlZlY3RvcjRUdXBsZSB9fSBwcm9wcwogICAqIEByZXR1cm5zIHtUSFJFRS5RdWF0ZXJuaW9ufQogICAqLwogIGNvbnN0IHNldFF1YXRlcm5pb24gPSAodGFyZ2V0LCBfcmVmMykgPT4gewogICAgbGV0IHsKICAgICAgcXVhdGVybmlvbiwKICAgICAgcm90YXRpb24KICAgIH0gPSBfcmVmMzsKICAgIGlmIChxdWF0ZXJuaW9uKSB7CiAgICAgIHRhcmdldC5zZXQoLi4ucXVhdGVybmlvbik7CiAgICB9IGVsc2UgaWYgKHJvdGF0aW9uKSB7CiAgICAgIHRhcmdldC5zZXRGcm9tRXVsZXIoLi4ucm90YXRpb24pOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICAvKioKICAgKiBAZnVuY3Rpb24KICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucwogICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnV1aWQKICAgKiBAcGFyYW0ge0JvZHlQcm9wc30gb3B0aW9ucy5wcm9wcwogICAqIEBwYXJhbSB7Qm9keVNoYXBlVHlwZX0gb3B0aW9ucy50eXBlCiAgICogQHBhcmFtIHsobWF0ZXJpYWxPcHRpb25zOiBNYXRlcmlhbE9wdGlvbnMpID0+IE1hdGVyaWFsID19IG9wdGlvbnMuY3JlYXRlTWF0ZXJpYWwKICAgKiBAcmV0dXJucyB7Qm9keX0KICAgKi8KICBjb25zdCBwcm9wc1RvQm9keSA9IG9wdGlvbnMgPT4gewogICAgY29uc3QgewogICAgICB1dWlkLAogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgY3JlYXRlTWF0ZXJpYWwgPSBtYXRlcmlhbE9wdGlvbnMgPT4gbmV3IE1hdGVyaWFsKG1hdGVyaWFsT3B0aW9ucykKICAgIH0gPSBvcHRpb25zOwogICAgY29uc3QgewogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyVmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFyZ3MgPSBbXSwKICAgICAgY29sbGlzaW9uUmVzcG9uc2UsCiAgICAgIGxpbmVhckZhY3RvciA9IFsxLCAxLCAxXSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIG9uQ29sbGlkZSwKICAgICAgcG9zaXRpb24gPSBbMCwgMCwgMF0sCiAgICAgIHJvdGF0aW9uLAogICAgICBxdWF0ZXJuaW9uLAogICAgICBzaGFwZXMsCiAgICAgIHR5cGU6IGJvZHlUeXBlLAogICAgICB2ZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7CiAgICAgIC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgbWF0ZXJpYWw6IG1hdGVyaWFsID8gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkLAogICAgICB0eXBlOiBib2R5VHlwZSA/IEJvZHlbYm9keVR5cGUudG9VcHBlckNhc2UoKV0gOiB1bmRlZmluZWQKICAgIH0pOwogICAgYm9keS51dWlkID0gdXVpZDsKICAgIGlmIChjb2xsaXNpb25SZXNwb25zZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGJvZHkuY29sbGlzaW9uUmVzcG9uc2UgPSBjb2xsaXNpb25SZXNwb25zZTsKICAgIH0KICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKF9yZWY0ID0+IHsKICAgICAgICBsZXQgewogICAgICAgICAgdHlwZSwKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgIHJvdGF0aW9uLAogICAgICAgICAgcXVhdGVybmlvbiwKICAgICAgICAgIG1hdGVyaWFsLAogICAgICAgICAgLi4uZXh0cmEKICAgICAgICB9ID0gX3JlZjQ7CiAgICAgICAgY29uc3Qgc2hhcGVCb2R5ID0gYm9keS5hZGRTaGFwZShjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSwgcG9zaXRpb24gPyBuZXcgVmVjMyguLi5wb3NpdGlvbikgOiB1bmRlZmluZWQsIHNldFF1YXRlcm5pb24obmV3IFF1YXRlcm5pb24oMCwgMCwgMCwgMSksIHsKICAgICAgICAgIHF1YXRlcm5pb24sCiAgICAgICAgICByb3RhdGlvbgogICAgICAgIH0pKTsKICAgICAgICBpZiAobWF0ZXJpYWwpIHNoYXBlQm9keS5tYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQogICAgYm9keS5wb3NpdGlvbi5zZXQocG9zaXRpb25bMF0sIHBvc2l0aW9uWzFdLCBwb3NpdGlvblsyXSk7CiAgICBib2R5LnZlbG9jaXR5LnNldCh2ZWxvY2l0eVswXSwgdmVsb2NpdHlbMV0sIHZlbG9jaXR5WzJdKTsKICAgIGJvZHkuYW5ndWxhclZlbG9jaXR5LnNldChhbmd1bGFyVmVsb2NpdHlbMF0sIGFuZ3VsYXJWZWxvY2l0eVsxXSwgYW5ndWxhclZlbG9jaXR5WzJdKTsKICAgIGJvZHkubGluZWFyRmFjdG9yLnNldChsaW5lYXJGYWN0b3JbMF0sIGxpbmVhckZhY3RvclsxXSwgbGluZWFyRmFjdG9yWzJdKTsKICAgIGJvZHkuYW5ndWxhckZhY3Rvci5zZXQoYW5ndWxhckZhY3RvclswXSwgYW5ndWxhckZhY3RvclsxXSwgYW5ndWxhckZhY3RvclsyXSk7CiAgICBzZXRRdWF0ZXJuaW9uKGJvZHkucXVhdGVybmlvbiwgewogICAgICBxdWF0ZXJuaW9uLAogICAgICByb3RhdGlvbgogICAgfSk7CiAgICByZXR1cm4gYm9keTsKICB9OwoKICBjb25zdCBhZGRCb2RpZXMgPSAoc3RhdGUsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYm9keSA9IHByb3BzVG9Cb2R5KHsKICAgICAgICBjcmVhdGVNYXRlcmlhbCwKICAgICAgICBwcm9wczogcHJvcHNbaV0sCiAgICAgICAgdHlwZSwKICAgICAgICB1dWlkOiB1dWlkW2ldCiAgICAgIH0pOwogICAgICBzdGF0ZS53b3JsZC5hZGRCb2R5KGJvZHkpOwogICAgICBpZiAocHJvcHNbaV0ub25Db2xsaWRlKSBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbGxpZGUnLCBfcmVmMiA9PiB7CiAgICAgICAgbGV0IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBib2R5LAogICAgICAgICAgdGFyZ2V0LAogICAgICAgICAgY29udGFjdAogICAgICAgIH0gPSBfcmVmMjsKICAgICAgICBpZiAoIWJvZHkudXVpZCB8fCAhdGFyZ2V0LnV1aWQpIHJldHVybjsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBuaSwKICAgICAgICAgIHJpLAogICAgICAgICAgcmosCiAgICAgICAgICBiaSwKICAgICAgICAgIGJqLAogICAgICAgICAgaWQKICAgICAgICB9ID0gY29udGFjdDsKICAgICAgICBjb25zdCBjb250YWN0UG9pbnQgPSBiaS5wb3NpdGlvbi52YWRkKHJpKTsKICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsID0gYmkgPT09IGJvZHkgPyBuaSA6IG5pLnNjYWxlKC0xKTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGJvZHk6IGJvZHkudXVpZCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlcnM6IHsKICAgICAgICAgICAgYm9keUZpbHRlckdyb3VwOiBib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICBib2R5RmlsdGVyTWFzazogYm9keS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJHcm91cDogdGFyZ2V0LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJNYXNrOiB0YXJnZXQuY29sbGlzaW9uRmlsdGVyTWFzawogICAgICAgICAgfSwKICAgICAgICAgIGNvbnRhY3Q6IHsKICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiB1c2UgaWQgaW5zdGVhZCBvZiB1dWlkCiAgICAgICAgICAgIGJpOiBiaS51dWlkLAogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IHVzZSBpZCBpbnN0ZWFkIG9mIHV1aWQKICAgICAgICAgICAgYmo6IGJqLnV1aWQsCiAgICAgICAgICAgIC8vIE5vcm1hbCBvZiB0aGUgY29udGFjdCwgcmVsYXRpdmUgdG8gdGhlIGNvbGxpZGluZyBib2R5CiAgICAgICAgICAgIGNvbnRhY3ROb3JtYWw6IGNvbnRhY3ROb3JtYWwudG9BcnJheSgpLAogICAgICAgICAgICAvLyBXb3JsZCBwb3NpdGlvbiBvZiB0aGUgY29udGFjdAogICAgICAgICAgICBjb250YWN0UG9pbnQ6IGNvbnRhY3RQb2ludC50b0FycmF5KCksCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBpbXBhY3RWZWxvY2l0eTogY29udGFjdC5nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsKCksCiAgICAgICAgICAgIG5pOiBuaS50b0FycmF5KCksCiAgICAgICAgICAgIHJpOiByaS50b0FycmF5KCksCiAgICAgICAgICAgIHJqOiByai50b0FycmF5KCkKICAgICAgICAgIH0sCiAgICAgICAgICBvcDogJ2V2ZW50JywKICAgICAgICAgIHRhcmdldDogdGFyZ2V0LnV1aWQsCiAgICAgICAgICB0eXBlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH07CgogIGNvbnN0IHRyaXBsZXRUb1ZlYzMgPSB0ID0+IHQgPyBuZXcgVmVjMyguLi50KSA6IHVuZGVmaW5lZDsKCiAgY29uc3QgYWRkQ29uc3RyYWludCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IFtib2R5QSwgYm9keUIsIHsKICAgICAgICBhbmdsZSwKICAgICAgICBheGlzQSwKICAgICAgICBheGlzQiwKICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgIGRpc3RhbmNlLAogICAgICAgIG1heEZvcmNlLAogICAgICAgIG1heE11bHRpcGxpZXIsCiAgICAgICAgcGl2b3RBLAogICAgICAgIHBpdm90QiwKICAgICAgICB0d2lzdEFuZ2xlLAogICAgICAgIHdha2VVcEJvZGllcwogICAgICB9XSwKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBsZXQgY29uc3RyYWludDsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdQb2ludFRvUG9pbnQnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCB0cmlwbGV0VG9WZWMzKHBpdm90QSksIHN0YXRlLmJvZGllc1tib2R5Ql0sIHRyaXBsZXRUb1ZlYzMocGl2b3RCKSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdDb25lVHdpc3QnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uZVR3aXN0Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBhbmdsZSwKICAgICAgICAgIGF4aXNBOiB0cmlwbGV0VG9WZWMzKGF4aXNBKSwKICAgICAgICAgIGF4aXNCOiB0cmlwbGV0VG9WZWMzKGF4aXNCKSwKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICBtYXhGb3JjZSwKICAgICAgICAgIHBpdm90QTogdHJpcGxldFRvVmVjMyhwaXZvdEEpLAogICAgICAgICAgcGl2b3RCOiB0cmlwbGV0VG9WZWMzKHBpdm90QiksCiAgICAgICAgICB0d2lzdEFuZ2xlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0hpbmdlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IEhpbmdlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBheGlzQTogdHJpcGxldFRvVmVjMyhheGlzQSksCiAgICAgICAgICBheGlzQjogdHJpcGxldFRvVmVjMyhheGlzQiksCiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgICAgbWF4Rm9yY2UsCiAgICAgICAgICBwaXZvdEE6IHRyaXBsZXRUb1ZlYzMocGl2b3RBKSwKICAgICAgICAgIHBpdm90QjogdHJpcGxldFRvVmVjMyhwaXZvdEIpCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0Rpc3RhbmNlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IERpc3RhbmNlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBkaXN0YW5jZSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdMb2NrJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IExvY2tDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIG1heEZvcmNlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29uc3RyYWludCA9IG5ldyBDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICB3YWtlVXBCb2RpZXMKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgIH0KICAgIGNvbnN0cmFpbnQudXVpZCA9IHV1aWQ7CiAgICBzdGF0ZS53b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpOwogICAgaWYgKG1heE11bHRpcGxpZXIgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zdCBwb3N0U3RlcENvbnN0cmFpbnQgPSAoKSA9PiB7CiAgICAgICAgLy8gVGhlIG11bHRpcGxpZXIgaXMgcHJvcG9ydGlvbmFsIHRvIGhvdyBtdWNoIGZvcmNlIGlzIGFkZGVkIHRvIHRoZSBib2RpZXMgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgICAgLy8gSWYgdGhpcyBleGNlZWRzIGEgbGltaXQgdGhlIGNvbnN0cmFpbnQgaXMgZGlzYWJsZWQuCiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IE1hdGguYWJzKGNvbnN0cmFpbnQuZXF1YXRpb25zWzBdLm11bHRpcGxpZXIpOwogICAgICAgIGlmIChtdWx0aXBsaWVyID4gbWF4TXVsdGlwbGllcikgewogICAgICAgICAgY29uc3RyYWludC5kaXNhYmxlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSA9IHBvc3RTdGVwQ29uc3RyYWludDsKICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gdG9VcHBlcmNhc2Uoc3RyKSB7CiAgICByZXR1cm4gc3RyLnRvVXBwZXJDYXNlKCk7CiAgfQogIGNvbnN0IGFkZFJheSA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IHsKICAgICAgICBmcm9tLAogICAgICAgIG1vZGUsCiAgICAgICAgdG8sCiAgICAgICAgLi4ucmF5T3B0aW9ucwogICAgICB9LAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHJheSA9IG5ldyBSYXkodHJpcGxldFRvVmVjMyhmcm9tKSwgdHJpcGxldFRvVmVjMyh0bykpOwogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgbW9kZTogUkFZX01PREVTW3RvVXBwZXJjYXNlKG1vZGUpXSwKICAgICAgcmVzdWx0OiBuZXcgUmF5Y2FzdFJlc3VsdCgpLAogICAgICAuLi5yYXlPcHRpb25zCiAgICB9OwogICAgc3RhdGUucmF5c1t1dWlkXSA9ICgpID0+IHsKICAgICAgcmF5LmludGVyc2VjdFdvcmxkKHN0YXRlLndvcmxkLCBvcHRpb25zKTsKICAgICAgaWYgKCFvcHRpb25zLnJlc3VsdCB8fCAhb3B0aW9ucy5yZXN1bHQuYm9keSkgcmV0dXJuOwogICAgICBjb25zdCB7CiAgICAgICAgYm9keSwKICAgICAgICBzaGFwZSwKICAgICAgICByYXlGcm9tV29ybGQsCiAgICAgICAgcmF5VG9Xb3JsZCwKICAgICAgICBoaXROb3JtYWxXb3JsZCwKICAgICAgICBoaXRQb2ludFdvcmxkLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA9IG9wdGlvbnMucmVzdWx0OwogICAgICBjb25zdCBib2R5VVVJRCA9IGJvZHkudXVpZDsKICAgICAgaWYgKCFib2R5VVVJRCkgcmV0dXJuOwogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICBib2R5OiBib2R5VVVJRCwKICAgICAgICBoaXROb3JtYWxXb3JsZDogaGl0Tm9ybWFsV29ybGQudG9BcnJheSgpLAogICAgICAgIGhpdFBvaW50V29ybGQ6IGhpdFBvaW50V29ybGQudG9BcnJheSgpLAogICAgICAgIG9wOiAnZXZlbnQnLAogICAgICAgIHJheTogewogICAgICAgICAgY29sbGlzaW9uRmlsdGVyR3JvdXA6IHJheS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlck1hc2s6IHJheS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgZGlyZWN0aW9uOiByYXkuZGlyZWN0aW9uLnRvQXJyYXkoKSwKICAgICAgICAgIGZyb20sCiAgICAgICAgICB0bywKICAgICAgICAgIHV1aWQKICAgICAgICB9LAogICAgICAgIHJheUZyb21Xb3JsZDogcmF5RnJvbVdvcmxkLnRvQXJyYXkoKSwKICAgICAgICByYXlUb1dvcmxkOiByYXlUb1dvcmxkLnRvQXJyYXkoKSwKICAgICAgICBzaGFwZTogc2hhcGUgPyB7CiAgICAgICAgICAuLi5zaGFwZSwKICAgICAgICAgIGJvZHk6IGJvZHlVVUlECiAgICAgICAgfSA6IG51bGwsCiAgICAgICAgdHlwZTogJ3JheWhpdCcsCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH07CiAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwcmVTdGVwJywgc3RhdGUucmF5c1t1dWlkXSk7CiAgfTsKCiAgY29uc3QgYWRkUmF5Y2FzdFZlaGljbGUgPSAoc3RhdGUsIGRhdGEpID0+IHsKICAgIGNvbnN0IFtjaGFzc2lzQm9keSwgd2hlZWxzLCB3aGVlbEluZm9zLCBpbmRleEZvcndhcmRBeGlzLCBpbmRleFJpZ2h0QXhpcywgaW5kZXhVcEF4aXNdID0gZGF0YS5wcm9wczsKICAgIGNvbnN0IHZlaGljbGUgPSBuZXcgUmF5Y2FzdFZlaGljbGUoewogICAgICBjaGFzc2lzQm9keTogc3RhdGUuYm9kaWVzW2NoYXNzaXNCb2R5XSwKICAgICAgaW5kZXhGb3J3YXJkQXhpcywKICAgICAgaW5kZXhSaWdodEF4aXMsCiAgICAgIGluZGV4VXBBeGlzCiAgICB9KTsKICAgIHZlaGljbGUud29ybGQgPSBzdGF0ZS53b3JsZDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCB7CiAgICAgICAgYXhsZUxvY2FsLAogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCwKICAgICAgICBkaXJlY3Rpb25Mb2NhbCwKICAgICAgICAuLi5yZXN0CiAgICAgIH0gPSB3aGVlbEluZm9zW2ldOwogICAgICB2ZWhpY2xlLmFkZFdoZWVsKHsKICAgICAgICBheGxlTG9jYWw6IHRyaXBsZXRUb1ZlYzMoYXhsZUxvY2FsKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWw6IHRyaXBsZXRUb1ZlYzMoY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsKSwKICAgICAgICBkaXJlY3Rpb25Mb2NhbDogdHJpcGxldFRvVmVjMyhkaXJlY3Rpb25Mb2NhbCksCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHByZVN0ZXAgPSAoKSA9PiB7CiAgICAgIHZlaGljbGUudXBkYXRlVmVoaWNsZShzdGF0ZS53b3JsZC5kdCk7CiAgICB9OwogICAgY29uc3QgcG9zdFN0ZXAgPSAoKSA9PiB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVoaWNsZS53aGVlbEluZm9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmVoaWNsZS51cGRhdGVXaGVlbFRyYW5zZm9ybShpKTsKICAgICAgICBjb25zdCB0ID0gdmVoaWNsZS53aGVlbEluZm9zW2ldLndvcmxkVHJhbnNmb3JtOwogICAgICAgIGNvbnN0IHdoZWVsQm9keSA9IHN0YXRlLmJvZGllc1t3aGVlbHNbaV1dOwogICAgICAgIHdoZWVsQm9keS5wb3NpdGlvbi5jb3B5KHQucG9zaXRpb24pOwogICAgICAgIHdoZWVsQm9keS5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfTsKICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0gPSB7CiAgICAgIHBvc3RTdGVwLAogICAgICBwcmVTdGVwLAogICAgICB2ZWhpY2xlCiAgICB9OwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHByZVN0ZXApOwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBwb3N0U3RlcCk7CiAgfTsKCiAgY29uc3QgYWRkU3ByaW5nID0gKHN0YXRlLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wczogW2JvZHlBLCBib2R5QiwgewogICAgICAgIGRhbXBpbmcsCiAgICAgICAgbG9jYWxBbmNob3JBLAogICAgICAgIGxvY2FsQW5jaG9yQiwKICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgIHN0aWZmbmVzcywKICAgICAgICB3b3JsZEFuY2hvckEsCiAgICAgICAgd29ybGRBbmNob3JCCiAgICAgIH1dLAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHNwcmluZyA9IG5ldyBTcHJpbmcoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgewogICAgICBkYW1waW5nLAogICAgICBsb2NhbEFuY2hvckE6IHRyaXBsZXRUb1ZlYzMobG9jYWxBbmNob3JBKSwKICAgICAgbG9jYWxBbmNob3JCOiB0cmlwbGV0VG9WZWMzKGxvY2FsQW5jaG9yQiksCiAgICAgIHJlc3RMZW5ndGgsCiAgICAgIHN0aWZmbmVzcywKICAgICAgd29ybGRBbmNob3JBOiB0cmlwbGV0VG9WZWMzKHdvcmxkQW5jaG9yQSksCiAgICAgIHdvcmxkQW5jaG9yQjogdHJpcGxldFRvVmVjMyh3b3JsZEFuY2hvckIpCiAgICB9KTsKICAgIHNwcmluZy51dWlkID0gdXVpZDsKICAgIGNvbnN0IHBvc3RTdGVwU3ByaW5nID0gKCkgPT4gc3ByaW5nLmFwcGx5Rm9yY2UoKTsKICAgIHN0YXRlLnNwcmluZ3NbdXVpZF0gPSBwb3N0U3RlcFNwcmluZzsKICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXSA9IHNwcmluZzsKCiAgICAvLyBDb21wdXRlIHRoZSBmb3JjZSBhZnRlciBlYWNoIHN0ZXAKICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1t1dWlkXSk7CiAgfTsKCiAgZnVuY3Rpb24gZW1pdEJlZ2luQ29udGFjdChfcmVmKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmOwogICAgaWYgKCEoYm9keUEgIT0gbnVsbCAmJiBib2R5QS51dWlkKSB8fCAhKGJvZHlCICE9IG51bGwgJiYgYm9keUIudXVpZCkpIHJldHVybjsKICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQsCiAgICAgIG9wOiAnZXZlbnQnLAogICAgICB0eXBlOiAnY29sbGlkZUJlZ2luJwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGVtaXRFbmRDb250YWN0KF9yZWYyKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmMjsKICAgIGlmICghKGJvZHlBICE9IG51bGwgJiYgYm9keUEudXVpZCkgfHwgIShib2R5QiAhPSBudWxsICYmIGJvZHlCLnV1aWQpKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkLAogICAgICBvcDogJ2V2ZW50JywKICAgICAgdHlwZTogJ2NvbGxpZGVFbmQnCiAgICB9KTsKICB9CiAgY29uc3QgaW5pdCA9ICh3b3JsZCwgX3JlZjMpID0+IHsKICAgIGxldCB7CiAgICAgIGFsbG93U2xlZXAsCiAgICAgIGF4aXNJbmRleCA9IDAsCiAgICAgIGJyb2FkcGhhc2UsCiAgICAgIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwsCiAgICAgIGZyaWN0aW9uR3Jhdml0eSwKICAgICAgZ3Jhdml0eSwKICAgICAgaXRlcmF0aW9ucywKICAgICAgcXVhdE5vcm1hbGl6ZUZhc3QsCiAgICAgIHF1YXROb3JtYWxpemVTa2lwLAogICAgICBzb2x2ZXIsCiAgICAgIHRvbGVyYW5jZQogICAgfSA9IF9yZWYzOwogICAgd29ybGQuYWxsb3dTbGVlcCA9IGFsbG93U2xlZXA7CiAgICB3b3JsZC5ncmF2aXR5LnNldCguLi5ncmF2aXR5KTsKICAgIHdvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGZyaWN0aW9uR3Jhdml0eSA/IG5ldyBWZWMzKC4uLmZyaWN0aW9uR3Jhdml0eSkgOiB1bmRlZmluZWQ7CiAgICB3b3JsZC5xdWF0Tm9ybWFsaXplRmFzdCA9IHF1YXROb3JtYWxpemVGYXN0OwogICAgd29ybGQucXVhdE5vcm1hbGl6ZVNraXAgPSBxdWF0Tm9ybWFsaXplU2tpcDsKICAgIGlmIChzb2x2ZXIgPT09ICdTcGxpdCcpIHsKICAgICAgd29ybGQuc29sdmVyID0gbmV3IFNwbGl0U29sdmVyKG5ldyBHU1NvbHZlcigpKTsKICAgIH0KICAgIGlmICh3b3JsZC5zb2x2ZXIgaW5zdGFuY2VvZiBHU1NvbHZlcikgewogICAgICB3b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gdG9sZXJhbmNlOwogICAgICB3b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnM7CiAgICB9CiAgICB3b3JsZC5icm9hZHBoYXNlID0gYnJvYWRwaGFzZSA9PT0gJ1NBUCcgPyBuZXcgU0FQQnJvYWRwaGFzZSh3b3JsZCkgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICBpZiAod29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgd29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBheGlzSW5kZXg7CiAgICB9CiAgICB3b3JsZC5hZGRFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnLCBlbWl0QmVnaW5Db250YWN0KTsKICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZENvbnRhY3QnLCBlbWl0RW5kQ29udGFjdCk7CiAgICBPYmplY3QuYXNzaWduKHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwsIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwpOwogIH07CgogIGNvbnN0IGlzUW9yViA9IHYgPT4gdiBpbnN0YW5jZW9mIFF1YXRlcm5pb24gfHwgdiBpbnN0YW5jZW9mIFZlYzM7CiAgY29uc3Qgc3RlcCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcG9zaXRpb25zLAogICAgICBwcm9wczogewogICAgICAgIG1heFN1YlN0ZXBzLAogICAgICAgIHN0ZXBTaXplLAogICAgICAgIHRpbWVTaW5jZUxhc3RDYWxsZWQKICAgICAgfSwKICAgICAgcXVhdGVybmlvbnMKICAgIH0gPSBfcmVmOwogICAgc3RhdGUud29ybGQuc3RlcChzdGVwU2l6ZSwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS53b3JsZC5ib2RpZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgY29uc3QgcCA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5wb3NpdGlvbjsKICAgICAgY29uc3QgcSA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5xdWF0ZXJuaW9uOwogICAgICBwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHAueDsKICAgICAgcG9zaXRpb25zWzMgKiBpICsgMV0gPSBwLnk7CiAgICAgIHBvc2l0aW9uc1szICogaSArIDJdID0gcC56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDBdID0gcS54OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDFdID0gcS55OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDJdID0gcS56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDNdID0gcS53OwogICAgfQogICAgY29uc3Qgb2JzZXJ2YXRpb25zID0gW107CiAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7CiAgICAgIGNvbnN0IFt1dWlkLCB0eXBlLCB0YXJnZXQgPSAnYm9kaWVzJ10gPSBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXTsKICAgICAgY29uc3QgewogICAgICAgIGJvZGllcywKICAgICAgICB2ZWhpY2xlcwogICAgICB9ID0gc3RhdGU7CiAgICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0ID09PSAndmVoaWNsZXMnID8KICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdmVoaWNsZXNbdXVpZF0udmVoaWNsZVt0eXBlXSA6CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVE9ETzogRGlmZmVyZW50aWF0ZSB0aGVzZSAidHlwZXMiCiAgICAgIGJvZGllc1t1dWlkXVt0eXBlXTsKICAgICAgY29uc3Qgc2VyaWFsaXphYmxlVmFsdWUgPSBpc1FvclYodmFsdWUpID8gdmFsdWUudG9BcnJheSgpIDogdmFsdWU7CiAgICAgIG9ic2VydmF0aW9ucy5wdXNoKFtOdW1iZXIoaWQpLCBzZXJpYWxpemFibGVWYWx1ZSwKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdHlwZV0pOwogICAgfQogICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgYWN0aXZlOiBzdGF0ZS53b3JsZC5oYXNBY3RpdmVCb2RpZXMsCiAgICAgIG9ic2VydmF0aW9ucywKICAgICAgb3A6ICdmcmFtZScsCiAgICAgIHBvc2l0aW9ucywKICAgICAgcXVhdGVybmlvbnMKICAgIH07CiAgICBpZiAoc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcpIHsKICAgICAgbWVzc2FnZS5ib2RpZXMgPSBzdGF0ZS53b3JsZC5ib2RpZXMucmVkdWNlKChib2RpZXMsIGJvZHkpID0+IHsKICAgICAgICBpZiAoYm9keS51dWlkKSBib2RpZXMucHVzaChib2R5LnV1aWQpOwogICAgICAgIHJldHVybiBib2RpZXM7CiAgICAgIH0sIFtdKTsKICAgICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSBmYWxzZTsKICAgIH0KICAgIHNlbGYucG9zdE1lc3NhZ2UobWVzc2FnZSwgW3Bvc2l0aW9ucy5idWZmZXIsIHF1YXRlcm5pb25zLmJ1ZmZlcl0pOwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGNvbnN0cmFpbnRzOiB7fSwKICAgIG1hdGVyaWFsczoge30sCiAgICByYXlzOiB7fSwKICAgIHNwcmluZ0luc3RhbmNlczoge30sCiAgICBzcHJpbmdzOiB7fSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdmVoaWNsZXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpCiAgfTsKCiAgLy8vIDxyZWZlcmVuY2Ugbm8tZGVmYXVsdC1saWI9InRydWUiLz4KICBjb25zdCBpc0hpbmdlQ29uc3RyYWludCA9IGMgPT4gYyBpbnN0YW5jZW9mIEhpbmdlQ29uc3RyYWludDsKICBmdW5jdGlvbiBzeW5jQm9kaWVzKCkgewogICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSB0cnVlOwogICAgc3RhdGUuYm9kaWVzID0gc3RhdGUud29ybGQuYm9kaWVzLnJlZHVjZSgoYm9kaWVzLCBib2R5KSA9PiBib2R5LnV1aWQgPyB7CiAgICAgIC4uLmJvZGllcywKICAgICAgW2JvZHkudXVpZF06IGJvZHkKICAgIH0gOiBib2RpZXMsIHt9KTsKICB9CiAgY29uc3QgYnJvYWRwaGFzZXMgPSB7CiAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICBTQVBCcm9hZHBoYXNlCiAgfTsKICBjb25zdCBjcmVhdGVNYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsRmFjdG9yeShzdGF0ZS5tYXRlcmlhbHMpOwogIHNlbGYub25tZXNzYWdlID0gX3JlZiA9PiB7CiAgICBsZXQgewogICAgICBkYXRhCiAgICB9ID0gX3JlZjsKICAgIHN3aXRjaCAoZGF0YS5vcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBpbml0KHN0YXRlLndvcmxkLCBkYXRhLnByb3BzKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc3RlcCc6CiAgICAgICAgewogICAgICAgICAgc3RlcChzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZEJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgYWRkQm9kaWVzKHN0YXRlLCBjcmVhdGVNYXRlcmlhbCwgZGF0YSk7CiAgICAgICAgICBzeW5jQm9kaWVzKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3JlbW92ZUJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlQm9keShzdGF0ZS5ib2RpZXNbZGF0YS51dWlkW2ldXSk7CiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWRbaV0pOwogICAgICAgICAgICBpZiAoa2V5KSB7CiAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLnN1YnNjcmlwdGlvbnNba2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgdHlwZQogICAgICAgICAgfSA9IGRhdGEucHJvcHM7CiAgICAgICAgICBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXSA9IFtkYXRhLnV1aWQsIHR5cGUsIHRhcmdldF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1tkYXRhLnByb3BzXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0UG9zaXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnBvc2l0aW9uLnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0UXVhdGVybmlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ucXVhdGVybmlvbi5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSwgZGF0YS5wcm9wc1szXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFJvdGF0aW9uJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VmVsb2NpdHknOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnZlbG9jaXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhclZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hbmd1bGFyVmVsb2NpdHkuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmxpbmVhckZhY3Rvci5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEFuZ3VsYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJGYWN0b3Iuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXNzJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5tYXNzID0gZGF0YS5wcm9wczsKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXRlcmlhbCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ubWF0ZXJpYWwgPSBkYXRhLnByb3BzID8gY3JlYXRlTWF0ZXJpYWwoZGF0YS5wcm9wcykgOiBudWxsOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJEYW1waW5nJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5saW5lYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QWxsb3dTbGVlcCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uYWxsb3dTbGVlcCA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFNsZWVwU3BlZWRMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uc2xlZXBTcGVlZExpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0U2xlZXBUaW1lTGltaXQnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnNsZWVwVGltZUxpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyR3JvdXAnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmNvbGxpc2lvbkZpbHRlckdyb3VwID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyTWFzayc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uY29sbGlzaW9uRmlsdGVyTWFzayA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbGxpc2lvblJlc3BvbnNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5jb2xsaXNpb25SZXNwb25zZSA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEZpeGVkUm90YXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmZpeGVkUm90YXRpb24gPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRGcmljdGlvbkdyYXZpdHknOgogICAgICAgIHN0YXRlLndvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGRhdGEucHJvcHMgPyBuZXcgVmVjMyguLi5kYXRhLnByb3BzKSA6IHVuZGVmaW5lZDsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXNUcmlnZ2VyJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5pc1RyaWdnZXIgPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRHcmF2aXR5JzoKICAgICAgICBzdGF0ZS53b3JsZC5ncmF2aXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VG9sZXJhbmNlJzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuc29sdmVyIGluc3RhbmNlb2YgR1NTb2x2ZXIpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci50b2xlcmFuY2UgPSBkYXRhLnByb3BzOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXRlcmF0aW9ucyc6CiAgICAgICAgaWYgKHN0YXRlLndvcmxkLnNvbHZlciBpbnN0YW5jZW9mIEdTU29sdmVyKSB7CiAgICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGRhdGEucHJvcHM7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRCcm9hZHBoYXNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlID0gbmV3IChicm9hZHBoYXNlc1tgJHtkYXRhLnByb3BzfUJyb2FkcGhhc2VgXSB8fCBOYWl2ZUJyb2FkcGhhc2UpKHN0YXRlLndvcmxkKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QXhpc0luZGV4JzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UuYXhpc0luZGV4ID0gZGF0YS5wcm9wcyA9PT0gdW5kZWZpbmVkIHx8IGRhdGEucHJvcHMgPT09IG51bGwgPyAwIDogZGF0YS5wcm9wczsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5Rm9yY2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5Rm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUltcHVsc2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUxvY2FsRm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEltcHVsc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5TG9jYWxJbXB1bHNlKG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5kYXRhLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5VG9ycXVlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseVRvcnF1ZShuZXcgVmVjMyguLi5kYXRhLnByb3BzWzBdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FkZENvbnN0cmFpbnQnOgogICAgICAgIHsKICAgICAgICAgIGFkZENvbnN0cmFpbnQoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoX3JlZjIgPT4gewogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgdXVpZAogICAgICAgICAgfSA9IF9yZWYyOwogICAgICAgICAgcmV0dXJuIHV1aWQgPT09IGRhdGEudXVpZDsKICAgICAgICB9KS5tYXAoYyA9PiBzdGF0ZS53b3JsZC5yZW1vdmVDb25zdHJhaW50KGMpKTsKICAgICAgICBpZiAoc3RhdGUuY29uc3RyYWludHNbZGF0YS51dWlkXSkgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZW5hYmxlKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZGlzYWJsZSgpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmVuYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmRpc2FibGVNb3RvcigpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yU3BlZWQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcihjID0+IGMudXVpZCA9PT0gZGF0YS51dWlkKS5maWx0ZXIoaXNIaW5nZUNvbnN0cmFpbnQpLm1hcChjID0+IGMuc2V0TW90b3JTcGVlZChkYXRhLnByb3BzKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbnN0cmFpbnRNb3Rvck1heEZvcmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLnNldE1vdG9yTWF4Rm9yY2UoZGF0YS5wcm9wcykpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdhZGRTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIGFkZFNwcmluZyhzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ1N0aWZmbmVzcyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0uc3RpZmZuZXNzID0gZGF0YS5wcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0U3ByaW5nUmVzdExlbmd0aCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0ucmVzdExlbmd0aCA9IGRhdGEucHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ0RhbXBpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1tkYXRhLnV1aWRdLmRhbXBpbmcgPSBkYXRhLnByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5JzoKICAgICAgICB7CiAgICAgICAgICBhZGRSYXkoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVSYXknOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW2RhdGEudXVpZF0pOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnJheXNbZGF0YS51dWlkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIGFkZFJheWNhc3RWZWhpY2xlKHN0YXRlLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnBvc3RTdGVwKTsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS53b3JsZCA9IG51bGw7CiAgICAgICAgICBkZWxldGUgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXTsKICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWQpOwogICAgICAgICAgaWYgKGtleSkgewogICAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1trZXldOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZVN0ZWVyaW5nVmFsdWUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLnNldFN0ZWVyaW5nVmFsdWUodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdhcHBseVJheWNhc3RWZWhpY2xlRW5naW5lRm9yY2UnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLmFwcGx5RW5naW5lRm9yY2UodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZUJyYWtlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbYnJha2UsIHdoZWVsSW5kZXhdID0gZGF0YS5wcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS5zZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZENvbnRhY3RNYXRlcmlhbCc6CiAgICAgICAgewogICAgICAgICAgYWRkQ29udGFjdE1hdGVyaWFsKHN0YXRlLndvcmxkLCBjcmVhdGVNYXRlcmlhbCwgZGF0YS5wcm9wcywgZGF0YS51dWlkKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlQ29udGFjdE1hdGVyaWFsJzoKICAgICAgICB7CiAgICAgICAgICByZW1vdmVDb250YWN0TWF0ZXJpYWwoc3RhdGUud29ybGQsIGRhdGEudXVpZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3dha2VVcCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ud2FrZVVwKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NsZWVwJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5zbGVlcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK");class Yz extends wz{constructor(e){const t=I;let{allowSleep:g=!1,axisIndex:n=0,broadphase:s=t(736),defaultContactMaterial:o={contactEquationStiffness:1e6},frictionGravity:c=null,gravity:C=[0,-9.81,0],iterations:r=5,quatNormalizeFast:A=!1,quatNormalizeSkip:d=0,size:h=1e3,solver:f="GS",tolerance:B=.001}=e;super();xA(this,"messageQueue",[]);xA(this,"worker",null);this[t(2690)]={allowSleep:g,axisIndex:n,broadphase:s,defaultContactMaterial:o,frictionGravity:c,gravity:C,iterations:r,quatNormalizeFast:A,quatNormalizeSkip:d,size:h,solver:f,tolerance:B},this[t(2265)]={positions:new Float32Array(h*3),quaternions:new Float32Array(h*4)}}get[I(199)](){const e=I;return this.config[e(199)]}set[I(199)](e){const t=I;this.config[t(199)]=e,this[t(1587)]({op:t(562),props:e})}get broadphase(){return this[I(2690)].broadphase}set[I(1265)](e){const t=I;this.config[t(1265)]=e,this[t(1587)]({op:"setBroadphase",props:e})}get[I(2726)](){return this[I(2690)].frictionGravity}set frictionGravity(e){const t=I;this.config[t(2726)]=e,this[t(1587)]({op:t(1291),props:e})}get gravity(){return this[I(2690)].gravity}set[I(3149)](e){const t=I;this[t(2690)][t(3149)]=e,this[t(1587)]({op:t(3506),props:e})}get[I(707)](){const e=I;return this.config[e(707)]}set[I(707)](e){const t=I;this[t(2690)][t(707)]=e,this[t(1587)]({op:t(2178),props:e})}get[I(1342)](){return this[I(2690)].tolerance}set[I(1342)](e){const t=I;this[t(2690)][t(1342)]=e,this.postMessage({op:t(760),props:e})}addBodies(e){const t=I;let{props:g,type:n,uuid:s}=e;this.postMessage({op:t(3285),props:g,type:n,uuid:s})}[I(3421)](e){const t=I;let{props:[g,n,s],type:o,uuid:c}=e;this[t(1587)]({op:"addConstraint",props:[g,n,s],type:o,uuid:c})}[I(336)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(336),props:g,uuid:n})}[I(1510)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(1510),props:g,uuid:n})}addRaycastVehicle(e){const t=I;let{props:[g,n,s,o,c,C],uuid:r}=e;this[t(1587)]({op:t(3884),props:[g,n,s,o,c,C],uuid:r})}[I(2446)](e){const t=I;let{props:[g,n,s],uuid:o}=e;this[t(1587)]({op:t(2446),props:[g,n,s],uuid:o})}applyForce(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:"applyForce",props:g,uuid:n})}[I(2823)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(2823),props:g,uuid:n})}[I(2634)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(2634),props:g,uuid:n})}[I(1073)](e){let{props:t,uuid:g}=e;this.postMessage({op:"applyLocalImpulse",props:t,uuid:g})}applyRaycastVehicleEngineForce(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(1725),props:g,uuid:n})}[I(2862)](e){let{props:t,uuid:g}=e;this.postMessage({op:"applyTorque",props:t,uuid:g})}[I(1222)](){const e=I;this[e(213)]=new Xz,this[e(213)][e(1042)]=t=>{const g=e;if(t[g(3787)].op===g(949)){this[g(2265)][g(3485)]=t.data.positions,this[g(2265)].quaternions=t[g(3787)].quaternions,this[g(1412)](t.data.op,t[g(3787)]);return}this[g(1412)](t[g(3787)].type,t.data)};for(const t of this[e(1100)])this[e(213)][e(1587)](t);this.messageQueue[e(2989)]=0}[I(1475)](e){const t=I;let{uuid:g}=e;this[t(1587)]({op:"disableConstraint",uuid:g})}[I(1573)](e){const t=I;let{uuid:g}=e;this[t(1587)]({op:t(1573),uuid:g})}[I(3573)](){const e=I;this[e(213)]&&(this[e(213)].onmessage=null)}[I(1472)](e){const t=I;let{uuid:g}=e;this[t(1587)]({op:"enableConstraint",uuid:g})}enableConstraintMotor(e){const t=I;let{uuid:g}=e;this[t(1587)]({op:t(584),uuid:g})}[I(2032)](){const e=I,{allowSleep:t,axisIndex:g,broadphase:n,defaultContactMaterial:s,frictionGravity:o,gravity:c,iterations:C,quatNormalizeFast:r,quatNormalizeSkip:A,solver:d,tolerance:h}=this[e(2690)];this[e(1587)]({op:"init",props:{allowSleep:t,axisIndex:g,broadphase:n,defaultContactMaterial:s,frictionGravity:o,gravity:c,iterations:C,quatNormalizeFast:r,quatNormalizeSkip:A,solver:d,tolerance:h}})}removeBodies(e){const t=I;let{uuid:g}=e;this[t(1587)]({op:"removeBodies",uuid:g})}[I(1607)](e){const t=I;let{uuid:g}=e;this[t(1587)]({op:t(1607),uuid:g})}[I(1364)](e){const t=I;let{uuid:g}=e;this[t(1587)]({op:"removeContactMaterial",uuid:g})}removeRay(e){const t=I;let{uuid:g}=e;this[t(1587)]({op:t(2037),uuid:g})}removeRaycastVehicle(e){const t=I;let{uuid:g}=e;this[t(1587)]({op:t(2188),uuid:g})}[I(2494)](e){const t=I;let{uuid:g}=e;this[t(1587)]({op:"removeSpring",uuid:g})}[I(147)](e){const t=I;let{props:g,uuid:n}=e;this.postMessage({op:t(147),props:g,uuid:n})}[I(2465)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(2465),props:g,uuid:n})}[I(3122)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(3122),props:g,uuid:n})}[I(3394)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(3394),props:g,uuid:n})}[I(2736)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(2736),props:g,uuid:n})}[I(1920)](e){const t=I;let{props:g,uuid:n}=e;this.postMessage({op:t(1920),props:g,uuid:n})}setCollisionResponse(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(244),props:g,uuid:n})}setConstraintMotorMaxForce(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:"setConstraintMotorMaxForce",props:g,uuid:n})}[I(3061)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(3061),props:g,uuid:n})}[I(463)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(463),props:g,uuid:n})}[I(1601)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(1601),props:g,uuid:n})}setLinearDamping(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(645),props:g,uuid:n})}setLinearFactor(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(3556),props:g,uuid:n})}[I(3208)](e){const t=I;let{props:g,uuid:n}=e;this.postMessage({op:t(3208),props:g,uuid:n})}[I(3005)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:"setMaterial",props:g,uuid:n})}setPosition(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(2991),props:g,uuid:n})}[I(1e3)](e){const t=I;let{props:[g,n,s,o],uuid:c}=e;this[t(1587)]({op:"setQuaternion",props:[g,n,s,o],uuid:c})}[I(915)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(915),props:g,uuid:n})}[I(1726)](e){const t=I;let{props:g,uuid:n}=e;this.postMessage({op:t(1726),props:g,uuid:n})}[I(1390)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(1390),props:g,uuid:n})}setSleepSpeedLimit(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(404),props:g,uuid:n})}[I(1039)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(1039),props:g,uuid:n})}setSpringDamping(e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:"setSpringDamping",props:g,uuid:n})}[I(2968)](e){const t=I;let{props:g,uuid:n}=e;this.postMessage({op:t(2968),props:g,uuid:n})}[I(3412)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(3412),props:g,uuid:n})}[I(3436)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(3436),props:g,uuid:n})}[I(837)](e){const t=I;let{props:g,uuid:n}=e;this[t(1587)]({op:t(837),props:g,uuid:n})}[I(1118)](e){let{uuid:t}=e;this.postMessage({op:"sleep",uuid:t})}step(e){const t=I;var g;const{buffers:{positions:n,quaternions:s}}=this;!n[t(835)]&&!s[t(835)]||(g=this[t(213)])==null||g[t(1587)]({op:"step",positions:n,props:e,quaternions:s},[n[t(2360)],s[t(2360)]])}[I(2914)](e){const t=I;let{props:{id:g,target:n,type:s},uuid:o}=e;this.postMessage({op:t(2914),props:{id:g,target:n,type:s},uuid:o})}[I(1319)](){const e=I;var t;(t=this.worker)==null||t[e(1319)](),this.worker=null}[I(1148)](e){let{props:t}=e;this.postMessage({op:"unsubscribe",props:t})}[I(508)](e){const t=I;let{uuid:g}=e;this.postMessage({op:t(508),uuid:g})}[I(1587)](e){const t=I;if(this[t(213)])return this[t(213)][t(1587)](e);this[t(1100)].push(e)}}class Hi{constructor(x){const e=I;x===void 0&&(x=[0,0,0,0,0,0,0,0,0]),this[e(2574)]=x}[I(532)](){const x=I,e=this[x(2574)];e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}[I(2851)](){const x=this.elements;x[0]=0,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=0,x[6]=0,x[7]=0,x[8]=0}setTrace(x){const e=I,t=this[e(2574)];t[0]=x.x,t[4]=x.y,t[8]=x.z}getTrace(x){const e=I;x===void 0&&(x=new U);const t=this[e(2574)];return x.x=t[0],x.y=t[4],x.z=t[8],x}[I(2242)](x,e){e===void 0&&(e=new U);const t=this.elements,g=x.x,n=x.y,s=x.z;return e.x=t[0]*g+t[1]*n+t[2]*s,e.y=t[3]*g+t[4]*n+t[5]*s,e.z=t[6]*g+t[7]*n+t[8]*s,e}smult(x){const e=I;for(let t=0;t<this[e(2574)].length;t++)this.elements[t]*=x}[I(1810)](x,e){const t=I;e===void 0&&(e=new Hi);const g=this[t(2574)],n=x.elements,s=e.elements,o=g[0],c=g[1],C=g[2],r=g[3],A=g[4],d=g[5],h=g[6],f=g[7],B=g[8],Z=n[0],G=n[1],m=n[2],v=n[3],p=n[4],w=n[5],V=n[6],N=n[7],X=n[8];return s[0]=o*Z+c*v+C*V,s[1]=o*G+c*p+C*N,s[2]=o*m+c*w+C*X,s[3]=r*Z+A*v+d*V,s[4]=r*G+A*p+d*N,s[5]=r*m+A*w+d*X,s[6]=h*Z+f*v+B*V,s[7]=h*G+f*p+B*N,s[8]=h*m+f*w+B*X,e}[I(623)](x,e){const t=I;e===void 0&&(e=new Hi);const g=this[t(2574)],n=e[t(2574)];for(let s=0;s!==3;s++)n[3*s+0]=x.x*g[3*s+0],n[3*s+1]=x.y*g[3*s+1],n[3*s+2]=x.z*g[3*s+2];return e}[I(662)](x,e){const t=I;e===void 0&&(e=new U);const g=3,n=4,s=[];let o,c;for(o=0;o<g*n;o++)s.push(0);for(o=0;o<3;o++)for(c=0;c<3;c++)s[o+n*c]=this[t(2574)][o+3*c];s[3+4*0]=x.x,s[3+4*1]=x.y,s[3+4*2]=x.z;let C=3;const r=C;let A;const d=4;let h;do{if(o=r-C,s[o+n*o]===0){for(c=o+1;c<r;c++)if(s[o+n*c]!==0){A=d;do h=d-A,s[h+n*o]+=s[h+n*c];while(--A);break}}if(s[o+n*o]!==0)for(c=o+1;c<r;c++){const f=s[o+n*c]/s[o+n*o];A=d;do h=d-A,s[h+n*c]=h<=o?0:s[h+n*c]-s[h+n*o]*f;while(--A)}}while(--C);if(e.z=s[2*n+3]/s[2*n+2],e.y=(s[1*n+3]-s[1*n+2]*e.z)/s[1*n+1],e.x=(s[0*n+3]-s[0*n+2]*e.z-s[0*n+1]*e.y)/s[0*n+0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw"Could not solve equation! Got x=["+e[t(2635)]()+t(1965)+x[t(2635)]()+t(3464)+this.toString()+"]";return e}e(x,e,t){const g=I;if(t===void 0)return this[g(2574)][e+3*x];this[g(2574)][e+3*x]=t}[I(1493)](x){const e=I;for(let t=0;t<x.elements[e(2989)];t++)this[e(2574)][t]=x[e(2574)][t];return this}[I(2635)](){const x=I;let e="";const t=",";for(let g=0;g<9;g++)e+=this[x(2574)][g]+t;return e}[I(3399)](x){const e=I;x===void 0&&(x=new Hi);const t=3,g=6,n=Kz;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)n[s+g*o]=this[e(2574)][s+3*o];n[3+6*0]=1,n[3+6*1]=0,n[3+6*2]=0,n[4+6*0]=0,n[4+6*1]=1,n[4+6*2]=0,n[5+6*0]=0,n[5+6*1]=0,n[5+6*2]=1;let c=3;const C=c;let r;const A=g;let d;do{if(s=C-c,n[s+g*s]===0){for(o=s+1;o<C;o++)if(n[s+g*o]!==0){r=A;do d=A-r,n[d+g*s]+=n[d+g*o];while(--r);break}}if(n[s+g*s]!==0)for(o=s+1;o<C;o++){const h=n[s+g*o]/n[s+g*s];r=A;do d=A-r,n[d+g*o]=d<=s?0:n[d+g*o]-n[d+g*s]*h;while(--r)}}while(--c);s=2;do{o=s-1;do{const h=n[s+g*o]/n[s+g*s];r=g;do d=g-r,n[d+g*o]=n[d+g*o]-n[d+g*s]*h;while(--r)}while(o--)}while(--s);s=2;do{const h=1/n[s+g*s];r=g;do d=g-r,n[d+g*s]=n[d+g*s]*h;while(--r)}while(s--);s=2;do{o=2;do{if(d=n[t+o+g*s],isNaN(d)||d===1/0)throw e(3402)+this.toString()+"]";x.e(s,o,d)}while(o--)}while(s--);return x}[I(1106)](x){const e=x.x,t=x.y,g=x.z,n=x.w,s=e+e,o=t+t,c=g+g,C=e*s,r=e*o,A=e*c,d=t*o,h=t*c,f=g*c,B=n*s,Z=n*o,G=n*c,m=this.elements;return m[3*0+0]=1-(d+f),m[3*0+1]=r-G,m[3*0+2]=A+Z,m[3*1+0]=r+G,m[3*1+1]=1-(C+f),m[3*1+2]=h-B,m[3*2+0]=A-Z,m[3*2+1]=h+B,m[3*2+2]=1-(C+d),this}transpose(x){const e=I;x===void 0&&(x=new Hi);const t=this[e(2574)],g=x[e(2574)];let n;return g[0]=t[0],g[4]=t[4],g[8]=t[8],n=t[1],g[1]=t[3],g[3]=n,n=t[2],g[2]=t[6],g[6]=n,n=t[5],g[5]=t[7],g[7]=n,x}}const Kz=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class U{constructor(x,e,t){x===void 0&&(x=0),e===void 0&&(e=0),t===void 0&&(t=0),this.x=x,this.y=e,this.z=t}[I(1092)](x,e){e===void 0&&(e=new U);const t=x.x,g=x.y,n=x.z,s=this.x,o=this.y,c=this.z;return e.x=o*n-c*g,e.y=c*t-s*n,e.z=s*g-o*t,e}[I(298)](x,e,t){return this.x=x,this.y=e,this.z=t,this}setZero(){this.x=this.y=this.z=0}[I(3617)](x,e){if(e)e.x=x.x+this.x,e.y=x.y+this.y,e.z=x.z+this.z;else return new U(this.x+x.x,this.y+x.y,this.z+x.z)}[I(1727)](x,e){if(e)e.x=this.x-x.x,e.y=this.y-x.y,e.z=this.z-x.z;else return new U(this.x-x.x,this.y-x.y,this.z-x.z)}crossmat(){return new Hi([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const x=this.x,e=this.y,t=this.z,g=Math.sqrt(x*x+e*e+t*t);if(g>0){const n=1/g;this.x*=n,this.y*=n,this.z*=n}else this.x=0,this.y=0,this.z=0;return g}[I(840)](x){x===void 0&&(x=new U);const e=this.x,t=this.y,g=this.z;let n=Math.sqrt(e*e+t*t+g*g);return n>0?(n=1/n,x.x=e*n,x.y=t*n,x.z=g*n):(x.x=1,x.y=0,x.z=0),x}[I(2989)](){const x=I,e=this.x,t=this.y,g=this.z;return Math[x(3641)](e*e+t*t+g*g)}lengthSquared(){return this[I(1760)](this)}[I(3708)](x){const e=I,t=this.x,g=this.y,n=this.z,s=x.x,o=x.y,c=x.z;return Math[e(3641)]((s-t)*(s-t)+(o-g)*(o-g)+(c-n)*(c-n))}distanceSquared(x){const e=this.x,t=this.y,g=this.z,n=x.x,s=x.y,o=x.z;return(n-e)*(n-e)+(s-t)*(s-t)+(o-g)*(o-g)}[I(623)](x,e){e===void 0&&(e=new U);const t=this.x,g=this.y,n=this.z;return e.x=x*t,e.y=x*g,e.z=x*n,e}[I(3798)](x,e){return e===void 0&&(e=new U),e.x=x.x*this.x,e.y=x.y*this.y,e.z=x.z*this.z,e}[I(832)](x,e,t){return t===void 0&&(t=new U),t.x=this.x+x*e.x,t.y=this.y+x*e.y,t.z=this.z+x*e.z,t}[I(1760)](x){return this.x*x.x+this.y*x.y+this.z*x.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(x){return x===void 0&&(x=new U),x.x=-this.x,x.y=-this.y,x.z=-this.z,x}tangents(x,e){const t=I,g=this[t(2989)]();if(g>0){const n=Hz,s=1/g;n[t(298)](this.x*s,this.y*s,this.z*s);const o=Nz;Math[t(447)](n.x)<.9?(o.set(1,0,0),n.cross(o,x)):(o[t(298)](0,1,0),n[t(1092)](o,x)),n[t(1092)](x,e)}else x.set(1,0,0),e[t(298)](0,1,0)}[I(2635)](){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(x){return this.x=x.x,this.y=x.y,this.z=x.z,this}[I(3814)](x,e,t){const g=this.x,n=this.y,s=this.z;t.x=g+(x.x-g)*e,t.y=n+(x.y-n)*e,t.z=s+(x.z-s)*e}[I(2427)](x,e){const t=I;return e===void 0&&(e=1e-6),!(Math[t(447)](this.x-x.x)>e||Math[t(447)](this.y-x.y)>e||Math[t(447)](this.z-x.z)>e)}[I(3076)](x){const e=I;return x===void 0&&(x=1e-6),!(Math[e(447)](this.x)>x||Math.abs(this.y)>x||Math[e(447)](this.z)>x)}[I(1824)](x,e){return this[I(3217)](MB),MB.almostEquals(x,e)}[I(3123)](){return new U(this.x,this.y,this.z)}}U[I(3583)]=new U(0,0,0),U.UNIT_X=new U(1,0,0),U[I(1851)]=new U(0,1,0),U[I(2785)]=new U(0,0,1);const Hz=new U,Nz=new U,MB=new U;class hg{constructor(x){const e=I;x===void 0&&(x={}),this[e(3720)]=new U,this.upperBound=new U,x[e(3720)]&&this.lowerBound[e(1493)](x[e(3720)]),x[e(2095)]&&this.upperBound[e(1493)](x[e(2095)])}[I(1666)](x,e,t,g){const n=I,s=this.lowerBound,o=this[n(2095)],c=t;s.copy(x[0]),c&&c[n(2242)](s,s),o[n(1493)](s);for(let C=1;C<x.length;C++){let r=x[C];c&&(c[n(2242)](r,LB),r=LB),r.x>o.x&&(o.x=r.x),r.x<s.x&&(s.x=r.x),r.y>o.y&&(o.y=r.y),r.y<s.y&&(s.y=r.y),r.z>o.z&&(o.z=r.z),r.z<s.z&&(s.z=r.z)}return e&&(e[n(3617)](s,s),e[n(3617)](o,o)),g&&(s.x-=g,s.y-=g,s.z-=g,o.x+=g,o.y+=g,o.z+=g),this}[I(1493)](x){const e=I;return this[e(3720)].copy(x[e(3720)]),this[e(2095)][e(1493)](x[e(2095)]),this}[I(3123)](){const x=I;return new hg()[x(1493)](this)}[I(289)](x){const e=I;this[e(3720)].x=Math[e(1410)](this[e(3720)].x,x[e(3720)].x),this[e(2095)].x=Math.max(this.upperBound.x,x.upperBound.x),this[e(3720)].y=Math.min(this[e(3720)].y,x[e(3720)].y),this[e(2095)].y=Math.max(this[e(2095)].y,x[e(2095)].y),this[e(3720)].z=Math[e(1410)](this.lowerBound.z,x[e(3720)].z),this[e(2095)].z=Math.max(this[e(2095)].z,x[e(2095)].z)}[I(1195)](x){const e=I,t=this[e(3720)],g=this.upperBound,n=x[e(3720)],s=x[e(2095)],o=n.x<=g.x&&g.x<=s.x||t.x<=s.x&&s.x<=g.x,c=n.y<=g.y&&g.y<=s.y||t.y<=s.y&&s.y<=g.y,C=n.z<=g.z&&g.z<=s.z||t.z<=s.z&&s.z<=g.z;return o&&c&&C}[I(3549)](){const x=I,e=this.lowerBound,t=this[x(2095)];return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}[I(1685)](x){const e=I,t=this[e(3720)],g=this[e(2095)],n=x[e(3720)],s=x[e(2095)];return t.x<=n.x&&g.x>=s.x&&t.y<=n.y&&g.y>=s.y&&t.z<=n.z&&g.z>=s.z}[I(2053)](x,e,t,g,n,s,o,c){const C=I,r=this[C(3720)],A=this[C(2095)];x[C(1493)](r),e[C(298)](A.x,r.y,r.z),t[C(298)](A.x,A.y,r.z),g[C(298)](r.x,A.y,A.z),n.set(A.x,r.y,A.z),s.set(r.x,A.y,r.z),o.set(r.x,r.y,A.z),c[C(1493)](A)}[I(1006)](x,e){const t=I,g=kB,n=g[0],s=g[1],o=g[2],c=g[3],C=g[4],r=g[5],A=g[6],d=g[7];this[t(2053)](n,s,o,c,C,r,A,d);for(let h=0;h!==8;h++){const f=g[h];x[t(1529)](f,f)}return e[t(1666)](g)}[I(1156)](x,e){const t=I,g=kB,n=g[0],s=g[1],o=g[2],c=g[3],C=g[4],r=g[5],A=g[6],d=g[7];this[t(2053)](n,s,o,c,C,r,A,d);for(let h=0;h!==8;h++){const f=g[h];x.pointToWorld(f,f)}return e[t(1666)](g)}[I(3567)](x){const e=I,{direction:t,from:g}=x,n=1/t.x,s=1/t.y,o=1/t.z,c=(this.lowerBound.x-g.x)*n,C=(this.upperBound.x-g.x)*n,r=(this[e(3720)].y-g.y)*s,A=(this[e(2095)].y-g.y)*s,d=(this.lowerBound.z-g.z)*o,h=(this[e(2095)].z-g.z)*o,f=Math[e(1971)](Math[e(1971)](Math.min(c,C),Math[e(1410)](r,A)),Math[e(1410)](d,h)),B=Math[e(1410)](Math.min(Math[e(1971)](c,C),Math.max(r,A)),Math[e(1971)](d,h));return!(B<0||f>B)}}const LB=new U,kB=[new U,new U,new U,new U,new U,new U,new U,new U];class mt{constructor(x,e,t,g){x===void 0&&(x=0),e===void 0&&(e=0),t===void 0&&(t=0),g===void 0&&(g=1),this.x=x,this.y=e,this.z=t,this.w=g}[I(298)](x,e,t,g){return this.x=x,this.y=e,this.z=t,this.w=g,this}[I(2635)](){return this.x+","+this.y+","+this.z+","+this.w}[I(3904)](){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(x,e){const t=I,g=Math.sin(e*.5);return this.x=x.x*g,this.y=x.y*g,this.z=x.z*g,this.w=Math[t(1563)](e*.5),this}toAxisAngle(x){const e=I;x===void 0&&(x=new U),this[e(3762)]();const t=2*Math[e(3102)](this.w),g=Math[e(3641)](1-this.w*this.w);return g<.001?(x.x=this.x,x.y=this.y,x.z=this.z):(x.x=this.x/g,x.y=this.y/g,x.z=this.z/g),[x,t]}[I(2258)](x,e){const t=I;if(x.isAntiparallelTo(e)){const g=Fz,n=zz;x[t(3781)](g,n),this[t(3405)](g,Math.PI)}else{const g=x[t(1092)](e);this.x=g.x,this.y=g.y,this.z=g.z,this.w=Math.sqrt(x[t(2989)]()**2*e[t(2989)]()**2)+x[t(1760)](e),this.normalize()}return this}[I(186)](x,e){e===void 0&&(e=new mt);const t=this.x,g=this.y,n=this.z,s=this.w,o=x.x,c=x.y,C=x.z,r=x.w;return e.x=t*r+s*o+g*C-n*c,e.y=g*r+s*c+n*o-t*C,e.z=n*r+s*C+t*c-g*o,e.w=s*r-t*o-g*c-n*C,e}[I(2049)](x){const e=I;x===void 0&&(x=new mt);const t=this.x,g=this.y,n=this.z,s=this.w;this[e(3597)](x);const o=1/(t*t+g*g+n*n+s*s);return x.x*=o,x.y*=o,x.z*=o,x.w*=o,x}[I(3597)](x){return x===void 0&&(x=new mt),x.x=-this.x,x.y=-this.y,x.z=-this.z,x.w=this.w,x}[I(3762)](){let e=Math[I(3641)](this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}[I(1101)](){const x=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return x===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=x,this.y*=x,this.z*=x,this.w*=x),this}[I(2242)](x,e){e===void 0&&(e=new U);const t=x.x,g=x.y,n=x.z,s=this.x,o=this.y,c=this.z,C=this.w,r=C*t+o*n-c*g,A=C*g+c*t-s*n,d=C*n+s*g-o*t,h=-s*t-o*g-c*n;return e.x=r*C+h*-s+A*-c-d*-o,e.y=A*C+h*-o+d*-s-r*-c,e.z=d*C+h*-c+r*-o-A*-s,e}[I(1493)](x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=x.w,this}[I(2647)](x,e){const t=I;e===void 0&&(e=t(1800));let g,n,s;const o=this.x,c=this.y,C=this.z,r=this.w;switch(e){case"YZX":const A=o*c+C*r;if(A>.499&&(g=2*Math[t(435)](o,r),n=Math.PI/2,s=0),A<-.499&&(g=-2*Math[t(435)](o,r),n=-Math.PI/2,s=0),g===void 0){const d=o*o,h=c*c,f=C*C;g=Math.atan2(2*c*r-2*o*C,1-2*h-2*f),n=Math.asin(2*A),s=Math.atan2(2*o*r-2*c*C,1-2*d-2*f)}break;default:throw new Error(t(2514)+e+t(1282))}x.y=g,x.z=n,x.x=s}[I(2562)](x,e,t,g){const n=I;g===void 0&&(g=n(782));const s=Math.cos(x/2),o=Math.cos(e/2),c=Math[n(1563)](t/2),C=Math[n(1996)](x/2),r=Math.sin(e/2),A=Math[n(1996)](t/2);return g===n(782)?(this.x=C*o*c+s*r*A,this.y=s*r*c-C*o*A,this.z=s*o*A+C*r*c,this.w=s*o*c-C*r*A):g==="YXZ"?(this.x=C*o*c+s*r*A,this.y=s*r*c-C*o*A,this.z=s*o*A-C*r*c,this.w=s*o*c+C*r*A):g===n(270)?(this.x=C*o*c-s*r*A,this.y=s*r*c+C*o*A,this.z=s*o*A+C*r*c,this.w=s*o*c-C*r*A):g==="ZYX"?(this.x=C*o*c-s*r*A,this.y=s*r*c+C*o*A,this.z=s*o*A-C*r*c,this.w=s*o*c+C*r*A):g==="YZX"?(this.x=C*o*c+s*r*A,this.y=s*r*c+C*o*A,this.z=s*o*A-C*r*c,this.w=s*o*c-C*r*A):g===n(885)&&(this.x=C*o*c-s*r*A,this.y=s*r*c-C*o*A,this.z=s*o*A+C*r*c,this.w=s*o*c+C*r*A),this}clone(){return new mt(this.x,this.y,this.z,this.w)}slerp(x,e,t){const g=I;t===void 0&&(t=new mt);const n=this.x,s=this.y,o=this.z,c=this.w;let C=x.x,r=x.y,A=x.z,d=x.w,h,f,B,Z,G;return f=n*C+s*r+o*A+c*d,f<0&&(f=-f,C=-C,r=-r,A=-A,d=-d),1-f>1e-6?(h=Math[g(3102)](f),B=Math.sin(h),Z=Math.sin((1-e)*h)/B,G=Math.sin(e*h)/B):(Z=1-e,G=e),t.x=Z*n+G*C,t.y=Z*s+G*r,t.z=Z*o+G*A,t.w=Z*c+G*d,t}[I(2745)](x,e,t,g){g===void 0&&(g=new mt);const n=x.x*t.x,s=x.y*t.y,o=x.z*t.z,c=this.x,C=this.y,r=this.z,A=this.w,d=e*.5;return g.x+=d*(n*A+s*r-o*C),g.y+=d*(s*A+o*c-n*r),g.z+=d*(o*A+n*C-s*c),g.w+=d*(-n*c-s*C-o*r),g}}const Fz=new U,zz=new U,Mz={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class sx{constructor(x){const e=I;x===void 0&&(x={}),this.id=sx[e(138)]++,this.type=x.type||0,this[e(356)]=0,this[e(1788)]=x[e(1788)]?x[e(1788)]:!0,this[e(2276)]=x[e(2276)]!==void 0?x[e(2276)]:1,this[e(2138)]=x.collisionFilterMask!==void 0?x.collisionFilterMask:-1,this[e(3480)]=x[e(3480)]?x[e(3480)]:null,this[e(1153)]=null}[I(276)](){const x=I;throw x(393)+this[x(3505)]}volume(){throw"volume() not implemented for shape type "+this[I(3505)]}[I(860)](x,e){const t=I;throw t(3717)+this[t(3505)]}calculateWorldAABB(x,e,t,g){throw I(555)+this.type}}sx.idCounter=0,sx[I(909)]=Mz;class Kt{constructor(x){const e=I;x===void 0&&(x={}),this[e(2817)]=new U,this.quaternion=new mt,x[e(2817)]&&this[e(2817)][e(1493)](x[e(2817)]),x[e(3915)]&&this[e(3915)][e(1493)](x[e(3915)])}[I(1529)](x,e){const t=I;return Kt[t(530)](this.position,this[t(3915)],x,e)}[I(3173)](x,e){const t=I;return Kt.pointToWorldFrame(this[t(2817)],this[t(3915)],x,e)}vectorToWorldFrame(x,e){const t=I;return e===void 0&&(e=new U),this.quaternion[t(2242)](x,e),e}static[I(530)](x,e,t,g){const n=I;return g===void 0&&(g=new U),t[n(1727)](x,g),e[n(3597)](TB),TB.vmult(g,g),g}static pointToWorldFrame(x,e,t,g){const n=I;return g===void 0&&(g=new U),e.vmult(t,g),g[n(3617)](x,g),g}static[I(1336)](x,e,t){const g=I;return t===void 0&&(t=new U),x[g(2242)](e,t),t}static vectorToLocalFrame(x,e,t,g){return g===void 0&&(g=new U),e.w*=-1,e.vmult(t,g),e.w*=-1,g}}const TB=new mt;new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new mt,new hg,new Hi,new Hi,new Hi,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new mt,new U,new U,new U,new U;class bh{constructor(){const x=I;this[x(1360)]=new U,this.rayToWorld=new U,this.hitNormalWorld=new U,this[x(431)]=new U,this[x(1322)]=!1,this.shape=null,this.body=null,this[x(403)]=-1,this[x(3035)]=-1,this.shouldStop=!1}[I(1877)](){const x=I;this[x(1360)].setZero(),this.rayToWorld[x(2851)](),this[x(2499)][x(2851)](),this[x(431)][x(2851)](),this[x(1322)]=!1,this.shape=null,this[x(1153)]=null,this[x(403)]=-1,this[x(3035)]=-1,this[x(1981)]=!1}abort(){this.shouldStop=!0}[I(298)](x,e,t,g,n,s,o){const c=I;this[c(1360)].copy(x),this[c(3792)].copy(e),this[c(2499)][c(1493)](t),this.hitPointWorld.copy(g),this[c(2934)]=n,this.body=s,this.distance=o}}let xW,eW,tW,gW,iW,nW,IW;const yu={CLOSEST:1,ANY:2,ALL:4};xW=sx.types[I(3925)],eW=sx[I(909)][I(1964)],tW=sx[I(909)][I(235)],gW=sx[I(909)][I(3184)],iW=sx[I(909)][I(3995)],nW=sx[I(909)][I(2951)],IW=sx[I(909)][I(3145)];class nt{get[xW](){return this._intersectSphere}get[eW](){return this[I(3741)]}get[tW](){return this[I(1288)]}get[gW](){return this[I(898)]}get[iW](){return this[I(898)]}get[nW](){return this[I(1250)]}get[IW](){return this[I(354)]}constructor(x,e){const t=I;x===void 0&&(x=new U),e===void 0&&(e=new U),this[t(3803)]=x[t(3123)](),this.to=e.clone(),this[t(2721)]=new U,this[t(1661)]=1e-4,this[t(3486)]=!0,this[t(1258)]=!1,this[t(2138)]=-1,this[t(2276)]=-1,this[t(251)]=nt[t(3063)],this[t(2985)]=new bh,this[t(1322)]=!1,this[t(934)]=g=>{}}intersectWorld(x,e){const t=I;return this[t(251)]=e[t(251)]||nt[t(3063)],this.result=e[t(2985)]||new bh,this[t(1258)]=!!e[t(1258)],this[t(2138)]=typeof e[t(2138)]<"u"?e[t(2138)]:-1,this[t(2276)]=typeof e.collisionFilterGroup!==t(1797)?e[t(2276)]:-1,this[t(3486)]=typeof e[t(3486)]!==t(1797)?e[t(3486)]:!0,e[t(3803)]&&this[t(3803)][t(1493)](e[t(3803)]),e.to&&this.to[t(1493)](e.to),this[t(934)]=e[t(934)]||(()=>{}),this[t(1322)]=!1,this.result[t(1877)](),this[t(2318)](),this[t(347)](JB),vu[t(2989)]=0,x[t(1265)][t(3946)](x,JB,vu),this[t(881)](vu),this[t(1322)]}intersectBody(x,e){const t=I;e&&(this.result=e,this[t(2318)]());const g=this[t(3486)];if(g&&!x.collisionResponse||!(this[t(2276)]&x.collisionFilterMask)||!(x[t(2276)]&this[t(2138)]))return;const n=Lz,s=kz;for(let o=0,c=x[t(2386)][t(2989)];o<c;o++){const C=x.shapes[o];if(!(g&&!C.collisionResponse)&&(x[t(3915)][t(186)](x[t(1049)][o],s),x[t(3915)].vmult(x[t(3114)][o],n),n[t(3617)](x[t(2817)],n),this[t(3006)](C,s,n,x),this[t(2985)].shouldStop))break}}[I(881)](x,e){const t=I;e&&(this[t(2985)]=e,this[t(2318)]());for(let g=0,n=x[t(2989)];!this.result[t(1981)]&&g<n;g++)this[t(2021)](x[g])}updateDirection(){const x=I;this.to[x(1727)](this.from,this[x(2721)]),this[x(2721)][x(3762)]()}[I(3006)](x,e,t,g){const n=I,s=this.from;if(eM(s,this[n(2721)],t)>x[n(356)])return;const c=this[x[n(3505)]];c&&c[n(2627)](this,x,e,t,g,x)}[I(1288)](x,e,t,g,n){const s=I;return this[s(898)](x[s(3335)],e,t,g,n)}[I(3741)](x,e,t,g,n){const s=I,o=this[s(3803)],c=this.to,C=this.direction,r=new U(0,0,1);e[s(2242)](r,r);const A=new U;o[s(1727)](t,A);const d=A.dot(r);c[s(1727)](t,A);const h=A[s(1760)](r);if(d*h>0||o.distanceTo(c)<d)return;const f=r.dot(C);if(Math.abs(f)<this[s(1661)])return;const B=new U,Z=new U,G=new U;o.vsub(t,B);const m=-r[s(1760)](B)/f;C[s(623)](m,Z),o[s(3617)](Z,G),this.reportIntersection(r,G,n,g,-1)}[I(347)](x){const e=I,{lowerBound:t,upperBound:g}=x,n=this.to,s=this[e(3803)];t.x=Math[e(1410)](n.x,s.x),t.y=Math[e(1410)](n.y,s.y),t.z=Math.min(n.z,s.z),g.x=Math[e(1971)](n.x,s.x),g.y=Math[e(1971)](n.y,s.y),g.z=Math.max(n.z,s.z)}[I(1250)](x,e,t,g,n){const s=I;x.data,x.elementSize;const o=Tz;o.from[s(1493)](this[s(3803)]),o.to.copy(this.to),Kt[s(530)](t,e,o.from,o[s(3803)]),Kt[s(530)](t,e,o.to,o.to),o[s(2318)]();const c=Jz;let C,r,A,d;C=r=0,A=d=x[s(3787)][s(2989)]-1;const h=new hg;o[s(347)](h),x[s(1708)](h[s(3720)].x,h[s(3720)].y,c,!0),C=Math[s(1971)](C,c[0]),r=Math[s(1971)](r,c[1]),x[s(1708)](h.upperBound.x,h[s(2095)].y,c,!0),A=Math.min(A,c[0]+1),d=Math[s(1410)](d,c[1]+1);for(let f=C;f<A;f++)for(let B=r;B<d;B++){if(this.result[s(1981)])return;if(x[s(1591)](f,B,h),!!h[s(3567)](o)){if(x[s(400)](f,B,!1),Kt[s(1004)](t,e,x[s(2902)],er),this._intersectConvex(x[s(856)],e,er,g,n,EB),this[s(2985)][s(1981)])return;x.getConvexTrianglePillar(f,B,!0),Kt[s(1004)](t,e,x[s(2902)],er),this._intersectConvex(x.pillarConvex,e,er,g,n,EB)}}}[I(2751)](x,e,t,g,n){const s=I,o=this[s(3803)],c=this.to,C=x.radius,r=(c.x-o.x)**2+(c.y-o.y)**2+(c.z-o.z)**2,A=2*((c.x-o.x)*(o.x-t.x)+(c.y-o.y)*(o.y-t.y)+(c.z-o.z)*(o.z-t.z)),d=(o.x-t.x)**2+(o.y-t.y)**2+(o.z-t.z)**2-C**2,h=A**2-4*r*d,f=Ez,B=Uz;if(!(h<0))if(h===0)o[s(3814)](c,h,f),f[s(1727)](t,B),B[s(3762)](),this[s(1769)](B,f,n,g,-1);else{const Z=(-A-Math[s(3641)](h))/(2*r),G=(-A+Math[s(3641)](h))/(2*r);if(Z>=0&&Z<=1&&(o[s(3814)](c,Z,f),f[s(1727)](t,B),B[s(3762)](),this[s(1769)](B,f,n,g,-1)),this[s(2985)][s(1981)])return;G>=0&&G<=1&&(o.lerp(c,G,f),f[s(1727)](t,B),B[s(3762)](),this.reportIntersection(B,f,n,g,-1))}}_intersectConvex(x,e,t,g,n,s){const o=I,c=_z,C=UB,r=s&&s.faceList||null,A=x[o(857)],d=x[o(718)],h=x[o(520)],f=this.direction,B=this.from,Z=this.to,G=B[o(3708)](Z),m=r?r.length:A[o(2989)],v=this.result;for(let p=0;!v[o(1981)]&&p<m;p++){const w=r?r[p]:p,V=A[w],N=h[w],X=e,M=t;C[o(1493)](d[V[0]]),X[o(2242)](C,C),C.vadd(M,C),C[o(1727)](B,C),X.vmult(N,c);const Y=f[o(1760)](c);if(Math.abs(Y)<this.precision)continue;const S=c[o(1760)](C)/Y;if(!(S<0)){f[o(623)](S,St),St[o(3617)](B,St),Xg[o(1493)](d[V[0]]),X[o(2242)](Xg,Xg),M[o(3617)](Xg,Xg);for(let H=1;!v.shouldStop&&H<V.length-1;H++){ei[o(1493)](d[V[H]]),ti[o(1493)](d[V[H+1]]),X[o(2242)](ei,ei),X[o(2242)](ti,ti),M.vadd(ei,ei),M[o(3617)](ti,ti);const O=St.distanceTo(B);!(nt[o(518)](St,Xg,ei,ti)||nt[o(518)](St,ei,Xg,ti))||O>G||this[o(1769)](c,St,n,g,w)}}}}[I(354)](x,e,t,g,n,s){const o=I,c=Dz,C=jz,r=xM,A=UB,d=Qz,h=Pz,f=Oz,B=$z,Z=qz,G=x[o(3110)];x[o(718)];const m=this.from,v=this.to,p=this[o(2721)];r[o(2817)].copy(t),r.quaternion.copy(e),Kt[o(2617)](t,e,p,d),Kt[o(530)](t,e,m,h),Kt[o(530)](t,e,v,f),f.x*=x[o(623)].x,f.y*=x[o(623)].y,f.z*=x[o(623)].z,h.x*=x.scale.x,h.y*=x[o(623)].y,h.z*=x[o(623)].z,f[o(1727)](h,d),d.normalize();const w=h[o(1944)](f);x[o(3398)][o(422)](this,r,C);for(let V=0,N=C.length;!this[o(2985)][o(1981)]&&V!==N;V++){const X=C[V];x[o(3943)](X,c),x.getVertex(G[X*3],Xg),Xg.vsub(h,A);const M=d.dot(c),Y=c[o(1760)](A)/M;if(Y<0)continue;d[o(623)](Y,St),St[o(3617)](h,St),x[o(489)](G[X*3+1],ei),x[o(489)](G[X*3+2],ti);const S=St.distanceSquared(h);!(nt[o(518)](St,ei,Xg,ti)||nt[o(518)](St,Xg,ei,ti))||S>w||(Kt[o(1336)](e,c,Z),Kt[o(1004)](t,e,St,B),this.reportIntersection(Z,B,n,g,X))}C.length=0}reportIntersection(x,e,t,g,n){const s=I,o=this[s(3803)],c=this.to,C=o[s(3708)](e),r=this.result;if(!(this[s(1258)]&&x[s(1760)](this.direction)>0))switch(r[s(403)]=typeof n!==s(1797)?n:-1,this[s(251)]){case nt.ALL:this[s(1322)]=!0,r.set(o,c,x,e,t,g,C),r.hasHit=!0,this[s(934)](r);break;case nt[s(797)]:(C<r[s(3035)]||!r.hasHit)&&(this[s(1322)]=!0,r[s(1322)]=!0,r[s(298)](o,c,x,e,t,g,C));break;case nt[s(3063)]:this[s(1322)]=!0,r.hasHit=!0,r[s(298)](o,c,x,e,t,g,C),r[s(1981)]=!0;break}}static[I(518)](x,e,t,g){const n=I;g[n(1727)](e,mI),t.vsub(e,fc),x.vsub(e,Wu);const s=mI[n(1760)](mI),o=mI[n(1760)](fc),c=mI.dot(Wu),C=fc[n(1760)](fc),r=fc.dot(Wu);let A,d;return(A=C*c-o*r)>=0&&(d=s*r-o*c)>=0&&A+d<s*C-o*o}}nt[I(797)]=yu[I(797)],nt[I(3063)]=yu[I(3063)],nt[I(813)]=yu[I(813)];const JB=new hg,vu=[],fc=new U,Wu=new U,Lz=new U,kz=new mt,St=new U,Xg=new U,ei=new U,ti=new U;new U,new bh;const EB={faceList:[0]},er=new U,Tz=new nt,Jz=[],Ez=new U,Uz=new U,_z=new U;new U,new U;const UB=new U,Dz=new U,Qz=new U,Pz=new U,Oz=new U,qz=new U,$z=new U;new hg;const jz=[],xM=new Kt,mI=new U,tr=new U;function eM(i,x,e){const t=I;e[t(1727)](i,mI);const g=mI[t(1760)](x);return x[t(623)](g,tr),tr[t(3617)](i,tr),e[t(3708)](tr)}new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new nt,new U,new U,new U,new U(1,0,0),new U(0,1,0),new U(0,0,1),new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new hg,new U,new hg,new U,new U,new U,new U,new U,new U,new U,new hg,new U,new Kt,new hg,sx[I(909)][I(3925)],sx[I(909)].SPHERE|sx.types[I(1964)],sx[I(909)][I(235)]|sx[I(909)][I(235)],sx.types.SPHERE|sx[I(909)][I(235)],sx[I(909)][I(1964)]|sx[I(909)].BOX,sx.types[I(3995)],sx.types.SPHERE|sx[I(909)][I(3995)],sx[I(909)][I(1964)]|sx[I(909)].CONVEXPOLYHEDRON,sx[I(909)][I(235)]|sx[I(909)][I(3995)],sx[I(909)][I(3925)]|sx.types[I(2951)],sx[I(909)][I(235)]|sx[I(909)][I(2951)],sx[I(909)].CONVEXPOLYHEDRON|sx.types[I(2951)],sx[I(909)][I(1709)]|sx[I(909)][I(3925)],sx.types[I(1964)]|sx[I(909)][I(1709)],sx[I(909)][I(235)]|sx[I(909)][I(1709)],sx[I(909)][I(1709)]|sx[I(909)].CONVEXPOLYHEDRON,sx[I(909)][I(3184)],sx[I(909)][I(3925)]|sx[I(909)].CYLINDER,sx[I(909)][I(1964)]|sx.types[I(3184)],sx.types.BOX|sx[I(909)][I(3184)],sx[I(909)].CONVEXPOLYHEDRON|sx[I(909)][I(3184)],sx.types.HEIGHTFIELD|sx[I(909)][I(3184)],sx.types[I(1709)]|sx[I(909)][I(3184)],sx[I(909)][I(3925)]|sx.types[I(3145)],sx[I(909)].PLANE|sx[I(909)][I(3145)],new U,new U,new U,new U,new U,new mt,new mt,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new hg,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new U,new mt,new U,new U,new U,new U,new U,new U,new U,new U,new U,new hg,new nt;const mc=globalThis[I(932)]||{};if(!mc[I(978)]){let i=Date.now();mc[I(3260)]&&mc[I(3260)][I(1748)]&&(i=mc[I(3260)].navigationStart),mc.now=()=>Date[I(978)]()-i}new U;class Ni{constructor(x){const e=I;x===void 0&&(x=[0,0,0,0,0,0,0,0,0]),this[e(2574)]=x}[I(532)](){const x=I,e=this[x(2574)];e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}[I(2851)](){const x=I,e=this[x(2574)];e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(x){const e=this.elements;e[0]=x.x,e[4]=x.y,e[8]=x.z}getTrace(x){const e=I;x===void 0&&(x=new _);const t=this[e(2574)];return x.x=t[0],x.y=t[4],x.z=t[8],x}[I(2242)](x,e){const t=I;e===void 0&&(e=new _);const g=this[t(2574)],n=x.x,s=x.y,o=x.z;return e.x=g[0]*n+g[1]*s+g[2]*o,e.y=g[3]*n+g[4]*s+g[5]*o,e.z=g[6]*n+g[7]*s+g[8]*o,e}[I(3248)](x){const e=I;for(let t=0;t<this[e(2574)][e(2989)];t++)this.elements[t]*=x}[I(1810)](x,e){const t=I;e===void 0&&(e=new Ni);const g=this[t(2574)],n=x[t(2574)],s=e[t(2574)],o=g[0],c=g[1],C=g[2],r=g[3],A=g[4],d=g[5],h=g[6],f=g[7],B=g[8],Z=n[0],G=n[1],m=n[2],v=n[3],p=n[4],w=n[5],V=n[6],N=n[7],X=n[8];return s[0]=o*Z+c*v+C*V,s[1]=o*G+c*p+C*N,s[2]=o*m+c*w+C*X,s[3]=r*Z+A*v+d*V,s[4]=r*G+A*p+d*N,s[5]=r*m+A*w+d*X,s[6]=h*Z+f*v+B*V,s[7]=h*G+f*p+B*N,s[8]=h*m+f*w+B*X,e}scale(x,e){const t=I;e===void 0&&(e=new Ni);const g=this[t(2574)],n=e[t(2574)];for(let s=0;s!==3;s++)n[3*s+0]=x.x*g[3*s+0],n[3*s+1]=x.y*g[3*s+1],n[3*s+2]=x.z*g[3*s+2];return e}solve(x,e){const t=I;e===void 0&&(e=new _);const g=3,n=4,s=[];let o,c;for(o=0;o<g*n;o++)s[t(3330)](0);for(o=0;o<3;o++)for(c=0;c<3;c++)s[o+n*c]=this[t(2574)][o+3*c];s[3+4*0]=x.x,s[3+4*1]=x.y,s[3+4*2]=x.z;let C=3;const r=C;let A;const d=4;let h;do{if(o=r-C,s[o+n*o]===0){for(c=o+1;c<r;c++)if(s[o+n*c]!==0){A=d;do h=d-A,s[h+n*o]+=s[h+n*c];while(--A);break}}if(s[o+n*o]!==0)for(c=o+1;c<r;c++){const f=s[o+n*c]/s[o+n*o];A=d;do h=d-A,s[h+n*c]=h<=o?0:s[h+n*c]-s[h+n*o]*f;while(--A)}}while(--C);if(e.z=s[2*n+3]/s[2*n+2],e.y=(s[1*n+3]-s[1*n+2]*e.z)/s[1*n+1],e.x=(s[0*n+3]-s[0*n+2]*e.z-s[0*n+1]*e.y)/s[0*n+0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw t(3871)+e[t(2635)]()+t(1965)+x.toString()+t(3464)+this[t(2635)]()+"]";return e}e(x,e,t){const g=I;if(t===void 0)return this[g(2574)][e+3*x];this[g(2574)][e+3*x]=t}[I(1493)](x){const e=I;for(let t=0;t<x.elements[e(2989)];t++)this[e(2574)][t]=x[e(2574)][t];return this}[I(2635)](){let x="";const e=",";for(let t=0;t<9;t++)x+=this.elements[t]+e;return x}[I(3399)](x){const e=I;x===void 0&&(x=new Ni);const t=3,g=6,n=tM;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)n[s+g*o]=this[e(2574)][s+3*o];n[3+6*0]=1,n[3+6*1]=0,n[3+6*2]=0,n[4+6*0]=0,n[4+6*1]=1,n[4+6*2]=0,n[5+6*0]=0,n[5+6*1]=0,n[5+6*2]=1;let c=3;const C=c;let r;const A=g;let d;do{if(s=C-c,n[s+g*s]===0){for(o=s+1;o<C;o++)if(n[s+g*o]!==0){r=A;do d=A-r,n[d+g*s]+=n[d+g*o];while(--r);break}}if(n[s+g*s]!==0)for(o=s+1;o<C;o++){const h=n[s+g*o]/n[s+g*s];r=A;do d=A-r,n[d+g*o]=d<=s?0:n[d+g*o]-n[d+g*s]*h;while(--r)}}while(--c);s=2;do{o=s-1;do{const h=n[s+g*o]/n[s+g*s];r=g;do d=g-r,n[d+g*o]=n[d+g*o]-n[d+g*s]*h;while(--r)}while(o--)}while(--s);s=2;do{const h=1/n[s+g*s];r=g;do d=g-r,n[d+g*s]=n[d+g*s]*h;while(--r)}while(s--);s=2;do{o=2;do{if(d=n[t+o+g*s],isNaN(d)||d===1/0)throw"Could not reverse! A=["+this[e(2635)]()+"]";x.e(s,o,d)}while(o--)}while(s--);return x}[I(1106)](x){const e=I,t=x.x,g=x.y,n=x.z,s=x.w,o=t+t,c=g+g,C=n+n,r=t*o,A=t*c,d=t*C,h=g*c,f=g*C,B=n*C,Z=s*o,G=s*c,m=s*C,v=this[e(2574)];return v[3*0+0]=1-(h+B),v[3*0+1]=A-m,v[3*0+2]=d+G,v[3*1+0]=A+m,v[3*1+1]=1-(r+B),v[3*1+2]=f-Z,v[3*2+0]=d-G,v[3*2+1]=f+Z,v[3*2+2]=1-(r+h),this}[I(2795)](x){const e=I;x===void 0&&(x=new Ni);const t=this[e(2574)],g=x[e(2574)];let n;return g[0]=t[0],g[4]=t[4],g[8]=t[8],n=t[1],g[1]=t[3],g[3]=n,n=t[2],g[2]=t[6],g[6]=n,n=t[5],g[5]=t[7],g[7]=n,x}}const tM=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class _{constructor(x,e,t){x===void 0&&(x=0),e===void 0&&(e=0),t===void 0&&(t=0),this.x=x,this.y=e,this.z=t}[I(1092)](x,e){e===void 0&&(e=new _);const t=x.x,g=x.y,n=x.z,s=this.x,o=this.y,c=this.z;return e.x=o*n-c*g,e.y=c*t-s*n,e.z=s*g-o*t,e}[I(298)](x,e,t){return this.x=x,this.y=e,this.z=t,this}[I(2851)](){this.x=this.y=this.z=0}vadd(x,e){if(e)e.x=x.x+this.x,e.y=x.y+this.y,e.z=x.z+this.z;else return new _(this.x+x.x,this.y+x.y,this.z+x.z)}[I(1727)](x,e){if(e)e.x=this.x-x.x,e.y=this.y-x.y,e.z=this.z-x.z;else return new _(this.x-x.x,this.y-x.y,this.z-x.z)}[I(3861)](){return new Ni([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}[I(3762)](){const x=I,e=this.x,t=this.y,g=this.z,n=Math[x(3641)](e*e+t*t+g*g);if(n>0){const s=1/n;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return n}unit(x){const e=I;x===void 0&&(x=new _);const t=this.x,g=this.y,n=this.z;let s=Math[e(3641)](t*t+g*g+n*n);return s>0?(s=1/s,x.x=t*s,x.y=g*s,x.z=n*s):(x.x=1,x.y=0,x.z=0),x}[I(2989)](){const x=this.x,e=this.y,t=this.z;return Math.sqrt(x*x+e*e+t*t)}[I(178)](){return this[I(1760)](this)}distanceTo(x){const e=I,t=this.x,g=this.y,n=this.z,s=x.x,o=x.y,c=x.z;return Math[e(3641)]((s-t)*(s-t)+(o-g)*(o-g)+(c-n)*(c-n))}distanceSquared(x){const e=this.x,t=this.y,g=this.z,n=x.x,s=x.y,o=x.z;return(n-e)*(n-e)+(s-t)*(s-t)+(o-g)*(o-g)}[I(623)](x,e){e===void 0&&(e=new _);const t=this.x,g=this.y,n=this.z;return e.x=x*t,e.y=x*g,e.z=x*n,e}[I(3798)](x,e){return e===void 0&&(e=new _),e.x=x.x*this.x,e.y=x.y*this.y,e.z=x.z*this.z,e}[I(832)](x,e,t){return t===void 0&&(t=new _),t.x=this.x+x*e.x,t.y=this.y+x*e.y,t.z=this.z+x*e.z,t}[I(1760)](x){return this.x*x.x+this.y*x.y+this.z*x.z}[I(337)](){return this.x===0&&this.y===0&&this.z===0}negate(x){return x===void 0&&(x=new _),x.x=-this.x,x.y=-this.y,x.z=-this.z,x}tangents(x,e){const t=I,g=this[t(2989)]();if(g>0){const n=gM,s=1/g;n[t(298)](this.x*s,this.y*s,this.z*s);const o=iM;Math.abs(n.x)<.9?(o[t(298)](1,0,0),n[t(1092)](o,x)):(o[t(298)](0,1,0),n[t(1092)](o,x)),n[t(1092)](x,e)}else x[t(298)](1,0,0),e[t(298)](0,1,0)}[I(2635)](){return this.x+","+this.y+","+this.z}[I(3904)](){return[this.x,this.y,this.z]}[I(1493)](x){return this.x=x.x,this.y=x.y,this.z=x.z,this}[I(3814)](x,e,t){const g=this.x,n=this.y,s=this.z;t.x=g+(x.x-g)*e,t.y=n+(x.y-n)*e,t.z=s+(x.z-s)*e}[I(2427)](x,e){const t=I;return e===void 0&&(e=1e-6),!(Math.abs(this.x-x.x)>e||Math[t(447)](this.y-x.y)>e||Math[t(447)](this.z-x.z)>e)}[I(3076)](x){const e=I;return x===void 0&&(x=1e-6),!(Math.abs(this.x)>x||Math[e(447)](this.y)>x||Math[e(447)](this.z)>x)}[I(1824)](x,e){return this[I(3217)](_B),_B.almostEquals(x,e)}clone(){return new _(this.x,this.y,this.z)}}_[I(3583)]=new _(0,0,0),_.UNIT_X=new _(1,0,0),_[I(1851)]=new _(0,1,0),_[I(2785)]=new _(0,0,1);const gM=new _,iM=new _,_B=new _;class fg{constructor(x){const e=I;x===void 0&&(x={}),this[e(3720)]=new _,this[e(2095)]=new _,x[e(3720)]&&this[e(3720)][e(1493)](x[e(3720)]),x[e(2095)]&&this[e(2095)][e(1493)](x[e(2095)])}[I(1666)](x,e,t,g){const n=I,s=this[n(3720)],o=this[n(2095)],c=t;s[n(1493)](x[0]),c&&c[n(2242)](s,s),o[n(1493)](s);for(let C=1;C<x[n(2989)];C++){let r=x[C];c&&(c.vmult(r,DB),r=DB),r.x>o.x&&(o.x=r.x),r.x<s.x&&(s.x=r.x),r.y>o.y&&(o.y=r.y),r.y<s.y&&(s.y=r.y),r.z>o.z&&(o.z=r.z),r.z<s.z&&(s.z=r.z)}return e&&(e[n(3617)](s,s),e[n(3617)](o,o)),g&&(s.x-=g,s.y-=g,s.z-=g,o.x+=g,o.y+=g,o.z+=g),this}[I(1493)](x){const e=I;return this[e(3720)].copy(x[e(3720)]),this[e(2095)][e(1493)](x[e(2095)]),this}clone(){const x=I;return new fg()[x(1493)](this)}[I(289)](x){const e=I;this[e(3720)].x=Math.min(this.lowerBound.x,x[e(3720)].x),this[e(2095)].x=Math[e(1971)](this[e(2095)].x,x[e(2095)].x),this[e(3720)].y=Math[e(1410)](this[e(3720)].y,x.lowerBound.y),this[e(2095)].y=Math.max(this[e(2095)].y,x[e(2095)].y),this[e(3720)].z=Math.min(this[e(3720)].z,x[e(3720)].z),this[e(2095)].z=Math[e(1971)](this.upperBound.z,x[e(2095)].z)}[I(1195)](x){const e=I,t=this[e(3720)],g=this[e(2095)],n=x[e(3720)],s=x[e(2095)],o=n.x<=g.x&&g.x<=s.x||t.x<=s.x&&s.x<=g.x,c=n.y<=g.y&&g.y<=s.y||t.y<=s.y&&s.y<=g.y,C=n.z<=g.z&&g.z<=s.z||t.z<=s.z&&s.z<=g.z;return o&&c&&C}[I(3549)](){const x=I,e=this[x(3720)],t=this[x(2095)];return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}[I(1685)](x){const e=I,t=this[e(3720)],g=this[e(2095)],n=x[e(3720)],s=x[e(2095)];return t.x<=n.x&&g.x>=s.x&&t.y<=n.y&&g.y>=s.y&&t.z<=n.z&&g.z>=s.z}[I(2053)](x,e,t,g,n,s,o,c){const C=I,r=this[C(3720)],A=this[C(2095)];x[C(1493)](r),e[C(298)](A.x,r.y,r.z),t[C(298)](A.x,A.y,r.z),g.set(r.x,A.y,A.z),n[C(298)](A.x,r.y,A.z),s.set(r.x,A.y,r.z),o[C(298)](r.x,r.y,A.z),c[C(1493)](A)}[I(1006)](x,e){const t=I,g=QB,n=g[0],s=g[1],o=g[2],c=g[3],C=g[4],r=g[5],A=g[6],d=g[7];this.getCorners(n,s,o,c,C,r,A,d);for(let h=0;h!==8;h++){const f=g[h];x.pointToLocal(f,f)}return e[t(1666)](g)}[I(1156)](x,e){const t=I,g=QB,n=g[0],s=g[1],o=g[2],c=g[3],C=g[4],r=g[5],A=g[6],d=g[7];this[t(2053)](n,s,o,c,C,r,A,d);for(let h=0;h!==8;h++){const f=g[h];x[t(3173)](f,f)}return e[t(1666)](g)}overlapsRay(x){const e=I,{direction:t,from:g}=x,n=1/t.x,s=1/t.y,o=1/t.z,c=(this[e(3720)].x-g.x)*n,C=(this[e(2095)].x-g.x)*n,r=(this[e(3720)].y-g.y)*s,A=(this[e(2095)].y-g.y)*s,d=(this[e(3720)].z-g.z)*o,h=(this[e(2095)].z-g.z)*o,f=Math.max(Math[e(1971)](Math.min(c,C),Math.min(r,A)),Math.min(d,h)),B=Math[e(1410)](Math[e(1410)](Math[e(1971)](c,C),Math[e(1971)](r,A)),Math.max(d,h));return!(B<0||f>B)}}const DB=new _,QB=[new _,new _,new _,new _,new _,new _,new _,new _];class Gt{constructor(x,e,t,g){x===void 0&&(x=0),e===void 0&&(e=0),t===void 0&&(t=0),g===void 0&&(g=1),this.x=x,this.y=e,this.z=t,this.w=g}[I(298)](x,e,t,g){return this.x=x,this.y=e,this.z=t,this.w=g,this}[I(2635)](){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}[I(3405)](x,e){const t=I,g=Math[t(1996)](e*.5);return this.x=x.x*g,this.y=x.y*g,this.z=x.z*g,this.w=Math.cos(e*.5),this}[I(1916)](x){const e=I;x===void 0&&(x=new _),this[e(3762)]();const t=2*Math[e(3102)](this.w),g=Math[e(3641)](1-this.w*this.w);return g<.001?(x.x=this.x,x.y=this.y,x.z=this.z):(x.x=this.x/g,x.y=this.y/g,x.z=this.z/g),[x,t]}setFromVectors(x,e){const t=I;if(x[t(1824)](e)){const g=nM,n=IM;x[t(3781)](g,n),this[t(3405)](g,Math.PI)}else{const g=x[t(1092)](e);this.x=g.x,this.y=g.y,this.z=g.z,this.w=Math[t(3641)](x[t(2989)]()**2*e.length()**2)+x[t(1760)](e),this.normalize()}return this}[I(186)](x,e){e===void 0&&(e=new Gt);const t=this.x,g=this.y,n=this.z,s=this.w,o=x.x,c=x.y,C=x.z,r=x.w;return e.x=t*r+s*o+g*C-n*c,e.y=g*r+s*c+n*o-t*C,e.z=n*r+s*C+t*c-g*o,e.w=s*r-t*o-g*c-n*C,e}[I(2049)](x){const e=I;x===void 0&&(x=new Gt);const t=this.x,g=this.y,n=this.z,s=this.w;this[e(3597)](x);const o=1/(t*t+g*g+n*n+s*s);return x.x*=o,x.y*=o,x.z*=o,x.w*=o,x}[I(3597)](x){return x===void 0&&(x=new Gt),x.x=-this.x,x.y=-this.y,x.z=-this.z,x.w=this.w,x}normalize(){let x=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return x===0?(this.x=0,this.y=0,this.z=0,this.w=0):(x=1/x,this.x*=x,this.y*=x,this.z*=x,this.w*=x),this}[I(1101)](){const x=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return x===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=x,this.y*=x,this.z*=x,this.w*=x),this}[I(2242)](x,e){e===void 0&&(e=new _);const t=x.x,g=x.y,n=x.z,s=this.x,o=this.y,c=this.z,C=this.w,r=C*t+o*n-c*g,A=C*g+c*t-s*n,d=C*n+s*g-o*t,h=-s*t-o*g-c*n;return e.x=r*C+h*-s+A*-c-d*-o,e.y=A*C+h*-o+d*-s-r*-c,e.z=d*C+h*-c+r*-o-A*-s,e}[I(1493)](x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=x.w,this}[I(2647)](x,e){const t=I;e===void 0&&(e=t(1800));let g,n,s;const o=this.x,c=this.y,C=this.z,r=this.w;switch(e){case t(1800):const A=o*c+C*r;if(A>.499&&(g=2*Math[t(435)](o,r),n=Math.PI/2,s=0),A<-.499&&(g=-2*Math[t(435)](o,r),n=-Math.PI/2,s=0),g===void 0){const d=o*o,h=c*c,f=C*C;g=Math.atan2(2*c*r-2*o*C,1-2*h-2*f),n=Math.asin(2*A),s=Math[t(435)](2*o*r-2*c*C,1-2*d-2*f)}break;default:throw new Error(t(2514)+e+t(1282))}x.y=g,x.z=n,x.x=s}[I(2562)](x,e,t,g){const n=I;g===void 0&&(g=n(782));const s=Math.cos(x/2),o=Math[n(1563)](e/2),c=Math[n(1563)](t/2),C=Math.sin(x/2),r=Math[n(1996)](e/2),A=Math.sin(t/2);return g===n(782)?(this.x=C*o*c+s*r*A,this.y=s*r*c-C*o*A,this.z=s*o*A+C*r*c,this.w=s*o*c-C*r*A):g===n(3131)?(this.x=C*o*c+s*r*A,this.y=s*r*c-C*o*A,this.z=s*o*A-C*r*c,this.w=s*o*c+C*r*A):g===n(270)?(this.x=C*o*c-s*r*A,this.y=s*r*c+C*o*A,this.z=s*o*A+C*r*c,this.w=s*o*c-C*r*A):g==="ZYX"?(this.x=C*o*c-s*r*A,this.y=s*r*c+C*o*A,this.z=s*o*A-C*r*c,this.w=s*o*c+C*r*A):g===n(1800)?(this.x=C*o*c+s*r*A,this.y=s*r*c+C*o*A,this.z=s*o*A-C*r*c,this.w=s*o*c-C*r*A):g==="XZY"&&(this.x=C*o*c-s*r*A,this.y=s*r*c-C*o*A,this.z=s*o*A+C*r*c,this.w=s*o*c+C*r*A),this}[I(3123)](){return new Gt(this.x,this.y,this.z,this.w)}[I(3316)](x,e,t){const g=I;t===void 0&&(t=new Gt);const n=this.x,s=this.y,o=this.z,c=this.w;let C=x.x,r=x.y,A=x.z,d=x.w,h,f,B,Z,G;return f=n*C+s*r+o*A+c*d,f<0&&(f=-f,C=-C,r=-r,A=-A,d=-d),1-f>1e-6?(h=Math[g(3102)](f),B=Math[g(1996)](h),Z=Math.sin((1-e)*h)/B,G=Math[g(1996)](e*h)/B):(Z=1-e,G=e),t.x=Z*n+G*C,t.y=Z*s+G*r,t.z=Z*o+G*A,t.w=Z*c+G*d,t}[I(2745)](x,e,t,g){g===void 0&&(g=new Gt);const n=x.x*t.x,s=x.y*t.y,o=x.z*t.z,c=this.x,C=this.y,r=this.z,A=this.w,d=e*.5;return g.x+=d*(n*A+s*r-o*C),g.y+=d*(s*A+o*c-n*r),g.z+=d*(o*A+n*C-s*c),g.w+=d*(-n*c-s*C-o*r),g}}const nM=new _,IM=new _,sM={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class ox{constructor(x){const e=I;x===void 0&&(x={}),this.id=ox[e(138)]++,this[e(3505)]=x[e(3505)]||0,this[e(356)]=0,this[e(1788)]=x[e(1788)]?x[e(1788)]:!0,this[e(2276)]=x[e(2276)]!==void 0?x[e(2276)]:1,this[e(2138)]=x[e(2138)]!==void 0?x[e(2138)]:-1,this.material=x.material?x[e(3480)]:null,this[e(1153)]=null}[I(276)](){throw I(393)+this.type}[I(3549)](){const x=I;throw x(2551)+this[x(3505)]}[I(860)](x,e){const t=I;throw t(3717)+this[t(3505)]}calculateWorldAABB(x,e,t,g){const n=I;throw n(555)+this[n(3505)]}}ox[I(138)]=0,ox[I(909)]=sM;class Ht{constructor(x){const e=I;x===void 0&&(x={}),this[e(2817)]=new _,this[e(3915)]=new Gt,x[e(2817)]&&this[e(2817)][e(1493)](x.position),x.quaternion&&this[e(3915)][e(1493)](x.quaternion)}[I(1529)](x,e){const t=I;return Ht[t(530)](this[t(2817)],this[t(3915)],x,e)}pointToWorld(x,e){return Ht[I(1004)](this.position,this.quaternion,x,e)}vectorToWorldFrame(x,e){const t=I;return e===void 0&&(e=new _),this[t(3915)][t(2242)](x,e),e}static[I(530)](x,e,t,g){const n=I;return g===void 0&&(g=new _),t[n(1727)](x,g),e[n(3597)](PB),PB[n(2242)](g,g),g}static[I(1004)](x,e,t,g){const n=I;return g===void 0&&(g=new _),e[n(2242)](t,g),g[n(3617)](x,g),g}static[I(1336)](x,e,t){return t===void 0&&(t=new _),x.vmult(e,t),t}static[I(2617)](x,e,t,g){const n=I;return g===void 0&&(g=new _),e.w*=-1,e[n(2242)](t,g),e.w*=-1,g}}const PB=new Gt;new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new Gt,new fg,new Ni,new Ni,new Ni,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new Gt,new _,new _,new _,new _;class hh{constructor(){const x=I;this[x(1360)]=new _,this[x(3792)]=new _,this[x(2499)]=new _,this.hitPointWorld=new _,this[x(1322)]=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this[x(3035)]=-1,this[x(1981)]=!1}[I(1877)](){const x=I;this[x(1360)][x(2851)](),this[x(3792)].setZero(),this[x(2499)][x(2851)](),this[x(431)][x(2851)](),this[x(1322)]=!1,this[x(2934)]=null,this[x(1153)]=null,this[x(403)]=-1,this[x(3035)]=-1,this[x(1981)]=!1}[I(831)](){const x=I;this[x(1981)]=!0}[I(298)](x,e,t,g,n,s,o){const c=I;this[c(1360)][c(1493)](x),this[c(3792)][c(1493)](e),this[c(2499)][c(1493)](t),this.hitPointWorld[c(1493)](g),this[c(2934)]=n,this[c(1153)]=s,this.distance=o}}let sW,oW,cW,CW,lW,aW,rW;const wu={CLOSEST:1,ANY:2,ALL:4};sW=ox[I(909)].SPHERE,oW=ox[I(909)][I(1964)],cW=ox[I(909)][I(235)],CW=ox[I(909)][I(3184)],lW=ox[I(909)][I(3995)],aW=ox[I(909)][I(2951)],rW=ox[I(909)].TRIMESH;class It{get[sW](){return this._intersectSphere}get[oW](){return this[I(3741)]}get[cW](){return this[I(1288)]}get[CW](){return this[I(898)]}get[lW](){return this[I(898)]}get[aW](){return this[I(1250)]}get[rW](){return this._intersectTrimesh}constructor(x,e){const t=I;x===void 0&&(x=new _),e===void 0&&(e=new _),this[t(3803)]=x[t(3123)](),this.to=e.clone(),this[t(2721)]=new _,this.precision=1e-4,this[t(3486)]=!0,this[t(1258)]=!1,this.collisionFilterMask=-1,this[t(2276)]=-1,this[t(251)]=It.ANY,this[t(2985)]=new hh,this[t(1322)]=!1,this.callback=g=>{}}[I(260)](x,e){const t=I;return this[t(251)]=e[t(251)]||It.ANY,this[t(2985)]=e.result||new hh,this[t(1258)]=!!e[t(1258)],this[t(2138)]=typeof e.collisionFilterMask!==t(1797)?e[t(2138)]:-1,this[t(2276)]=typeof e[t(2276)]!==t(1797)?e[t(2276)]:-1,this[t(3486)]=typeof e.checkCollisionResponse!==t(1797)?e[t(3486)]:!0,e[t(3803)]&&this.from[t(1493)](e[t(3803)]),e.to&&this.to[t(1493)](e.to),this[t(934)]=e[t(934)]||(()=>{}),this[t(1322)]=!1,this[t(2985)].reset(),this[t(2318)](),this[t(347)](OB),Ru[t(2989)]=0,x[t(1265)][t(3946)](x,OB,Ru),this[t(881)](Ru),this.hasHit}[I(2021)](x,e){const t=I;e&&(this[t(2985)]=e,this[t(2318)]());const g=this[t(3486)];if(g&&!x[t(1788)]||!(this.collisionFilterGroup&x.collisionFilterMask)||!(x[t(2276)]&this[t(2138)]))return;const n=oM,s=cM;for(let o=0,c=x[t(2386)][t(2989)];o<c;o++){const C=x[t(2386)][o];if(!(g&&!C[t(1788)])&&(x.quaternion.mult(x.shapeOrientations[o],s),x[t(3915)][t(2242)](x[t(3114)][o],n),n[t(3617)](x[t(2817)],n),this[t(3006)](C,s,n,x),this[t(2985)][t(1981)]))break}}[I(881)](x,e){const t=I;e&&(this[t(2985)]=e,this[t(2318)]());for(let g=0,n=x[t(2989)];!this[t(2985)].shouldStop&&g<n;g++)this[t(2021)](x[g])}[I(2318)](){const x=I;this.to[x(1727)](this[x(3803)],this[x(2721)]),this[x(2721)][x(3762)]()}[I(3006)](x,e,t,g){const n=I,s=this[n(3803)];if(BM(s,this[n(2721)],t)>x[n(356)])return;const c=this[x.type];c&&c.call(this,x,e,t,g,x)}[I(1288)](x,e,t,g,n){const s=I;return this[s(898)](x[s(3335)],e,t,g,n)}[I(3741)](x,e,t,g,n){const s=I,o=this[s(3803)],c=this.to,C=this[s(2721)],r=new _(0,0,1);e[s(2242)](r,r);const A=new _;o[s(1727)](t,A);const d=A[s(1760)](r);c.vsub(t,A);const h=A.dot(r);if(d*h>0||o.distanceTo(c)<d)return;const f=r[s(1760)](C);if(Math.abs(f)<this[s(1661)])return;const B=new _,Z=new _,G=new _;o[s(1727)](t,B);const m=-r[s(1760)](B)/f;C[s(623)](m,Z),o.vadd(Z,G),this.reportIntersection(r,G,n,g,-1)}[I(347)](x){const e=I,{lowerBound:t,upperBound:g}=x,n=this.to,s=this[e(3803)];t.x=Math[e(1410)](n.x,s.x),t.y=Math.min(n.y,s.y),t.z=Math[e(1410)](n.z,s.z),g.x=Math[e(1971)](n.x,s.x),g.y=Math[e(1971)](n.y,s.y),g.z=Math[e(1971)](n.z,s.z)}[I(1250)](x,e,t,g,n){const s=I;x[s(3787)],x[s(1624)];const o=CM;o[s(3803)][s(1493)](this[s(3803)]),o.to[s(1493)](this.to),Ht[s(530)](t,e,o.from,o[s(3803)]),Ht.pointToLocalFrame(t,e,o.to,o.to),o.updateDirection();const c=lM;let C,r,A,d;C=r=0,A=d=x.data.length-1;const h=new fg;o[s(347)](h),x[s(1708)](h[s(3720)].x,h[s(3720)].y,c,!0),C=Math[s(1971)](C,c[0]),r=Math[s(1971)](r,c[1]),x[s(1708)](h.upperBound.x,h[s(2095)].y,c,!0),A=Math[s(1410)](A,c[0]+1),d=Math[s(1410)](d,c[1]+1);for(let f=C;f<A;f++)for(let B=r;B<d;B++){if(this[s(2985)][s(1981)])return;if(x[s(1591)](f,B,h),!!h.overlapsRay(o)){if(x[s(400)](f,B,!1),Ht.pointToWorldFrame(t,e,x[s(2902)],gr),this[s(898)](x[s(856)],e,gr,g,n,qB),this[s(2985)].shouldStop)return;x[s(400)](f,B,!0),Ht.pointToWorldFrame(t,e,x[s(2902)],gr),this[s(898)](x[s(856)],e,gr,g,n,qB)}}}[I(2751)](x,e,t,g,n){const s=I,o=this[s(3803)],c=this.to,C=x[s(3015)],r=(c.x-o.x)**2+(c.y-o.y)**2+(c.z-o.z)**2,A=2*((c.x-o.x)*(o.x-t.x)+(c.y-o.y)*(o.y-t.y)+(c.z-o.z)*(o.z-t.z)),d=(o.x-t.x)**2+(o.y-t.y)**2+(o.z-t.z)**2-C**2,h=A**2-4*r*d,f=aM,B=rM;if(!(h<0))if(h===0)o[s(3814)](c,h,f),f.vsub(t,B),B[s(3762)](),this[s(1769)](B,f,n,g,-1);else{const Z=(-A-Math[s(3641)](h))/(2*r),G=(-A+Math[s(3641)](h))/(2*r);if(Z>=0&&Z<=1&&(o[s(3814)](c,Z,f),f[s(1727)](t,B),B.normalize(),this[s(1769)](B,f,n,g,-1)),this[s(2985)].shouldStop)return;G>=0&&G<=1&&(o[s(3814)](c,G,f),f.vsub(t,B),B[s(3762)](),this[s(1769)](B,f,n,g,-1))}}[I(898)](x,e,t,g,n,s){const o=I,c=dM,C=$B,r=s&&s[o(3113)]||null,A=x[o(857)],d=x.vertices,h=x[o(520)],f=this[o(2721)],B=this.from,Z=this.to,G=B[o(3708)](Z),m=r?r.length:A[o(2989)],v=this[o(2985)];for(let p=0;!v.shouldStop&&p<m;p++){const w=r?r[p]:p,V=A[w],N=h[w],X=e,M=t;C[o(1493)](d[V[0]]),X[o(2242)](C,C),C.vadd(M,C),C[o(1727)](B,C),X[o(2242)](N,c);const Y=f[o(1760)](c);if(Math[o(447)](Y)<this[o(1661)])continue;const S=c.dot(C)/Y;if(!(S<0)){f.scale(S,Xt),Xt[o(3617)](B,Xt),Yg.copy(d[V[0]]),X[o(2242)](Yg,Yg),M[o(3617)](Yg,Yg);for(let H=1;!v[o(1981)]&&H<V[o(2989)]-1;H++){gi[o(1493)](d[V[H]]),ii[o(1493)](d[V[H+1]]),X[o(2242)](gi,gi),X[o(2242)](ii,ii),M[o(3617)](gi,gi),M.vadd(ii,ii);const O=Xt.distanceTo(B);!(It[o(518)](Xt,Yg,gi,ii)||It[o(518)](Xt,gi,Yg,ii))||O>G||this[o(1769)](c,Xt,n,g,w)}}}}[I(354)](x,e,t,g,n,s){const o=I,c=AM,C=GM,r=pM,A=$B,d=uM,h=bM,f=hM,B=mM,Z=fM,G=x[o(3110)];x[o(718)];const m=this[o(3803)],v=this.to,p=this.direction;r[o(2817)][o(1493)](t),r.quaternion.copy(e),Ht[o(2617)](t,e,p,d),Ht[o(530)](t,e,m,h),Ht[o(530)](t,e,v,f),f.x*=x[o(623)].x,f.y*=x[o(623)].y,f.z*=x[o(623)].z,h.x*=x[o(623)].x,h.y*=x[o(623)].y,h.z*=x[o(623)].z,f[o(1727)](h,d),d[o(3762)]();const w=h[o(1944)](f);x.tree[o(422)](this,r,C);for(let V=0,N=C.length;!this.result.shouldStop&&V!==N;V++){const X=C[V];x[o(3943)](X,c),x[o(489)](G[X*3],Yg),Yg.vsub(h,A);const M=d[o(1760)](c),Y=c.dot(A)/M;if(Y<0)continue;d[o(623)](Y,Xt),Xt.vadd(h,Xt),x[o(489)](G[X*3+1],gi),x[o(489)](G[X*3+2],ii);const S=Xt[o(1944)](h);!(It.pointInTriangle(Xt,gi,Yg,ii)||It[o(518)](Xt,Yg,gi,ii))||S>w||(Ht[o(1336)](e,c,Z),Ht[o(1004)](t,e,Xt,B),this[o(1769)](Z,B,n,g,X))}C[o(2989)]=0}reportIntersection(x,e,t,g,n){const s=I,o=this.from,c=this.to,C=o[s(3708)](e),r=this.result;if(!(this.skipBackfaces&&x[s(1760)](this[s(2721)])>0))switch(r[s(403)]=typeof n!==s(1797)?n:-1,this.mode){case It[s(813)]:this.hasHit=!0,r.set(o,c,x,e,t,g,C),r[s(1322)]=!0,this[s(934)](r);break;case It[s(797)]:(C<r[s(3035)]||!r.hasHit)&&(this[s(1322)]=!0,r[s(1322)]=!0,r[s(298)](o,c,x,e,t,g,C));break;case It[s(3063)]:this[s(1322)]=!0,r[s(1322)]=!0,r[s(298)](o,c,x,e,t,g,C),r.shouldStop=!0;break}}static[I(518)](x,e,t,g){const n=I;g[n(1727)](e,GI),t[n(1727)](e,Gc),x[n(1727)](e,Vu);const s=GI.dot(GI),o=GI[n(1760)](Gc),c=GI[n(1760)](Vu),C=Gc[n(1760)](Gc),r=Gc[n(1760)](Vu);let A,d;return(A=C*c-o*r)>=0&&(d=s*r-o*c)>=0&&A+d<s*C-o*o}}It.CLOSEST=wu.CLOSEST,It[I(3063)]=wu[I(3063)],It[I(813)]=wu[I(813)];const OB=new fg,Ru=[],Gc=new _,Vu=new _,oM=new _,cM=new Gt,Xt=new _,Yg=new _,gi=new _,ii=new _;new _,new hh;const qB={faceList:[0]},gr=new _,CM=new It,lM=[],aM=new _,rM=new _,dM=new _;new _,new _;const $B=new _,AM=new _,uM=new _,bM=new _,hM=new _,fM=new _,mM=new _;new fg;const GM=[],pM=new Ht,GI=new _,ir=new _;function BM(i,x,e){const t=I;e.vsub(i,GI);const g=GI[t(1760)](x);return x.scale(g,ir),ir.vadd(i,ir),e.distanceTo(ir)}new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new It,new _,new _,new _,new _(1,0,0),new _(0,1,0),new _(0,0,1),new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new fg,new _,new fg,new _,new _,new _,new _,new _,new _,new _,new fg,new _,new Ht,new fg,ox[I(909)][I(3925)],ox[I(909)][I(3925)]|ox[I(909)][I(1964)],ox[I(909)][I(235)]|ox[I(909)][I(235)],ox[I(909)].SPHERE|ox[I(909)][I(235)],ox[I(909)][I(1964)]|ox[I(909)][I(235)],ox.types[I(3995)],ox[I(909)][I(3925)]|ox[I(909)][I(3995)],ox[I(909)].PLANE|ox[I(909)][I(3995)],ox[I(909)][I(235)]|ox[I(909)][I(3995)],ox.types[I(3925)]|ox[I(909)][I(2951)],ox[I(909)].BOX|ox[I(909)][I(2951)],ox[I(909)][I(3995)]|ox[I(909)][I(2951)],ox.types.PARTICLE|ox.types[I(3925)],ox[I(909)][I(1964)]|ox[I(909)][I(1709)],ox[I(909)][I(235)]|ox[I(909)][I(1709)],ox.types[I(1709)]|ox[I(909)][I(3995)],ox[I(909)][I(3184)],ox.types.SPHERE|ox[I(909)][I(3184)],ox[I(909)][I(1964)]|ox[I(909)][I(3184)],ox[I(909)][I(235)]|ox.types[I(3184)],ox[I(909)][I(3995)]|ox[I(909)][I(3184)],ox[I(909)].HEIGHTFIELD|ox[I(909)][I(3184)],ox[I(909)][I(1709)]|ox.types[I(3184)],ox[I(909)][I(3925)]|ox[I(909)][I(3145)],ox[I(909)].PLANE|ox.types.TRIMESH,new _,new _,new _,new _,new _,new Gt,new Gt,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new fg,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new _,new Gt,new _,new _,new _,new _,new _,new _,new _,new _,new _,new fg,new It;const pc=globalThis[I(932)]||{};if(!pc[I(978)]){let i=Date.now();pc[I(3260)]&&pc[I(3260)].navigationStart&&(i=pc.timing[I(1748)]),pc[I(978)]=()=>Date[I(978)]()-i}new _;const ZM=_0[I(680)](null),yM=()=>_0[I(2423)](ZM),dW=_0[I(680)](null),vM=()=>{const i=I,x=_0[i(2423)](dW);if(!x)throw new Error("Physics context not found. @react-three/cannon & components can only be used within a Physics provider");return x};new E(1,1,1),new E,new dx;const jB=new Nx;function WM(i){const x=I,e=_0[x(1576)](null);return i&&typeof i!==x(1126)?i:e}function xZ(i){const x=I;return i.charAt(0).toUpperCase()+i[x(1226)](1)}function Ue(i,x){const e=I,t=x===void 0?"":"/"+x;return typeof i===e(1126)?null:i&&i.current&&""+i.current[e(296)]+t}const wM=new Tt,RM=new ot,VM=i=>{const x=I;return e=>i(wM.setFromQuaternion(RM[x(2793)](e))[x(3904)]())};let AW=0;function Su(i,x,e,t,g,n){const s=I;return n===void 0&&(n=s(3684)),o=>{const c=s,C=AW++;e[C]={[t]:o};const r=Ue(i,g);return r&&x[c(2914)]({props:{id:C,target:n,type:t},uuid:r}),()=>{const A=c;delete e[C],x[A(1148)]({props:C})}}}function eZ(i,x){const e=I;let{position:t=[0,0,0],rotation:g=[0,0,0],userData:n={}}=x;i[e(358)]=n,i.position[e(298)](...t),i.rotation[e(298)](...g),i[e(466)]()}function tZ(i,x,e){let{onCollide:t,onCollideBegin:g,onCollideEnd:n}=x;i[e]={collide:t,collideBegin:g,collideEnd:n}}function _2(i,x,e,t,g){const n=I;t===void 0&&(t=null),g===void 0&&(g=[]);const s=WM(t),{events:o,refs:c,scaleOverrides:C,subscriptions:r,worker:A}=vM(),d=yM();_0.useLayoutEffect(()=>{const f=i0;!s[f(1895)]&&(s[f(1895)]=new Nx);const B=s.current,Z=A,G=B instanceof so?(B[f(1068)][f(1504)](hv),B.count):1,m=B instanceof so?new Array(G).fill(0)[f(3879)]((p,w)=>B[f(296)]+"/"+w):[B.uuid],v=B instanceof so?m[f(3879)]((p,w)=>{const V=f,N=x(w);return eZ(jB,N),B.setMatrixAt(w,jB[V(1721)]),B[V(1068)].needsUpdate=!0,c[p]=B,d==null||d[V(3014)](p,N,i),tZ(o,N,p),{...N,args:e(N.args)}}):m[f(3879)]((p,w)=>{const V=f,N=x(w);return eZ(B,N),c[p]=B,d==null||d[V(3014)](p,N,i),tZ(o,N,p),{...N,args:e(N[V(3283)])}});return Z[f(3285)]({props:v[f(3879)](p=>{let{onCollide:w,onCollideBegin:V,onCollideEnd:N,...X}=p;return{onCollide:!!w,...X}}),type:i,uuid:m}),()=>{const p=f;m[p(1599)](w=>{const V=p;delete c[w],d==null||d[V(2208)](w),delete o[w]}),Z[p(1750)]({uuid:m})}},g);const h=_0[n(2072)](()=>{const f=(p,w)=>{const V=i0,N=V(298)+xZ(p);return{set:X=>{const M=Ue(s,w);M&&A[N]({props:X,uuid:M})},subscribe:Su(s,A,r,p,w)}},B=p=>{const w=i0,V=w(3915);return{copy:N=>{const X=w;let{w:M,x:Y,y:S,z:H}=N;const O=Ue(s,p);O&&A[X(1e3)]({props:[Y,S,H,M],uuid:O})},set:(N,X,M,Y)=>{const S=w,H=Ue(s,p);H&&A[S(1e3)]({props:[N,X,M,Y],uuid:H})},subscribe:Su(s,A,r,V,p)}},Z=p=>({copy:w=>{const V=i0;let{x:N,y:X,z:M}=w;const Y=Ue(s,p);Y&&A[V(1390)]({props:[N,X,M],uuid:Y})},set:(w,V,N)=>{const X=i0,M=Ue(s,p);M&&A[X(1390)]({props:[w,V,N],uuid:M})},subscribe:w=>{const V=i0,N=AW++,X="bodies",M=V(3915),Y=Ue(s,p);return r[N]={[M]:VM(w)},Y&&A[V(2914)]({props:{id:N,target:X,type:M},uuid:Y}),()=>{delete r[N],A.unsubscribe({props:N})}}}),G=(p,w)=>{const V=i0,N=V(298)+xZ(p);return{copy:X=>{let{x:M,y:Y,z:S}=X;const H=Ue(s,w);H&&A[N]({props:[M,Y,S],uuid:H})},set:(X,M,Y)=>{const S=Ue(s,w);S&&A[N]({props:[X,M,Y],uuid:S})},subscribe:Su(s,A,r,p,w)}};function m(p){const w=i0;return{allowSleep:f(w(232),p),angularDamping:f(w(3422),p),angularFactor:G(w(2567),p),angularVelocity:G(w(810),p),applyForce(V,N){const X=Ue(s,p);X&&A.applyForce({props:[V,N],uuid:X})},applyImpulse(V,N){const X=Ue(s,p);X&&A.applyImpulse({props:[V,N],uuid:X})},applyLocalForce(V,N){const X=w,M=Ue(s,p);M&&A[X(2634)]({props:[V,N],uuid:M})},applyLocalImpulse(V,N){const X=w,M=Ue(s,p);M&&A[X(1073)]({props:[V,N],uuid:M})},applyTorque(V){const N=w,X=Ue(s,p);X&&A[N(2862)]({props:[V],uuid:X})},collisionFilterGroup:f(w(2276),p),collisionFilterMask:f("collisionFilterMask",p),collisionResponse:f(w(1788),p),fixedRotation:f("fixedRotation",p),isTrigger:f(w(2722),p),linearDamping:f(w(3396),p),linearFactor:G(w(3967),p),mass:f(w(1885),p),material:f(w(3480),p),position:G(w(2817),p),quaternion:B(p),rotation:Z(p),scaleOverride(V){const N=Ue(s,p);N&&(C[N]=new E(...V))},sleep(){const V=w,N=Ue(s,p);N&&A[V(1118)]({uuid:N})},sleepSpeedLimit:f(w(1918),p),sleepTimeLimit:f(w(1978),p),userData:f(w(358),p),velocity:G(w(3887),p),wakeUp(){const V=w,N=Ue(s,p);N&&A[V(508)]({uuid:N})}}}const v={};return{...m(void 0),at:p=>v[p]||(v[p]=m(p))}},[]);return[s,h]}function JM(i,x,e){return _2(I(984),i,()=>[],x,e)}function EM(i,x,e){const t=I,g=[1,1,1];return _2(t(3655),i,function(n){return n===void 0&&(n=g),n},x,e)}function UM(i,x,e){return _2(I(552),i,function(g){return g===void 0&&(g=[]),g},x,e)}function _M(i,x,e){const t=I;return _2(t(3657),i,function(g){const n=t;if(g===void 0&&(g=[1]),!Array.isArray(g))throw new Error(n(3274));return[g[0]]},x,e)}const SM=new E,XM=new E(1,1,1),YM=new ot,nr=new dx;function gZ(i,x,e,t,g){const n=I;return t===void 0&&(t=XM),i!==void 0?(nr[n(1669)](SM[n(2793)](x,i*3),YM[n(2793)](e,i*4),t),g&&(g.matrixAutoUpdate=!1,g.matrix[n(1493)](nr)),nr):nr[n(532)]()}const KM=()=>{const i=I,x=[];return e=>x[i(3532)](e)?!1:!!x[i(3330)](e)};function DM(i){const x=I;let{allowSleep:e=!1,axisIndex:t=0,broadphase:g=x(736),children:n,defaultContactMaterial:s={contactEquationStiffness:1e6},frictionGravity:o=null,gravity:c=[0,-9.81,0],isPaused:C=!1,iterations:r=5,maxSubSteps:A=10,quatNormalizeFast:d=!1,quatNormalizeSkip:h=0,shouldInvalidate:f=!0,size:B=1e3,solver:Z="GS",stepSize:G=1/60,tolerance:m=.001}=i;const{invalidate:v}=xz(),[{bodies:p,events:w,refs:V,scaleOverrides:N,subscriptions:X,worker:M}]=_0[x(3533)](()=>({bodies:{},events:{},refs:{},scaleOverrides:{},subscriptions:{},worker:new Yz({allowSleep:e,axisIndex:t,broadphase:g,defaultContactMaterial:s,frictionGravity:o,gravity:c,iterations:r,quatNormalizeFast:d,quatNormalizeSkip:h,size:B,solver:Z,tolerance:m})}));let Y=0;const S=_0[x(2105)]((G0,$)=>{C||(Y+=$,M.step({maxSubSteps:A,stepSize:G,timeSinceLastCalled:Y}),Y=0)},[C,A,G]),H=G0=>{var $;let{body:j,contact:{bi:x0,bj:c0,...h0},target:X0,...n0}=G0;const g0=($=w[X0])==null?void 0:$.collide;g0&&g0({body:V[j],contact:{bi:V[x0],bj:V[c0],...h0},target:V[X0],...n0})},O=G0=>{const $=x;var j,x0;let{bodyA:c0,bodyB:h0}=G0;const X0=(j=w[c0])==null?void 0:j[$(752)];X0&&X0({body:V[h0],op:$(1751),target:V[c0],type:$(752)});const n0=(x0=w[h0])==null?void 0:x0[$(752)];n0&&n0({body:V[c0],op:$(1751),target:V[h0],type:$(752)})},I0=G0=>{const $=x;var j,x0;let{bodyA:c0,bodyB:h0}=G0;const X0=(j=w[c0])==null?void 0:j[$(2152)];X0&&X0({body:V[h0],op:$(1751),target:V[c0],type:"collideEnd"});const n0=(x0=w[h0])==null?void 0:x0.collideEnd;n0&&n0({body:V[c0],op:$(1751),target:V[h0],type:$(2152)})},z=G0=>{const $=x;let{active:j,bodies:x0=[],observations:c0,positions:h0,quaternions:X0}=G0;for(let n0=0;n0<x0[$(2989)];n0++)p[x0[n0]]=n0;if(c0[$(1599)](n0=>{let[g0,l0,m0]=n0;const M0=X[g0]||{},bx=M0[m0];bx&&bx(l0)}),!!j){for(const n0 of Object[$(2326)](V).filter(KM()))if(n0 instanceof so)for(let g0=0;g0<n0[$(3411)];g0++){const l0=n0[$(296)]+"/"+g0,m0=p[l0];m0!==void 0&&(n0.setMatrixAt(g0,gZ(m0,h0,X0,N[l0])),n0[$(1068)].needsUpdate=!0)}else{const g0=N[n0[$(296)]]||n0.scale;gZ(p[n0[$(296)]],h0,X0,g0,n0)}f&&v()}},b0=G0=>{const $=x;var j;let{body:x0,ray:{uuid:c0,...h0},...X0}=G0;const n0=(j=w[c0])==null?void 0:j[$(2097)];n0&&n0({body:x0?V[x0]:null,ray:{uuid:c0,...h0},...X0})};ez(S),_0[x(263)](()=>{const G0=x;return M[G0(1222)](),M.init(),M.on(G0(2724),H),M.on(G0(752),O),M.on(G0(2152),I0),M.on(G0(949),z),M.on(G0(2097),b0),()=>{M[G0(1319)](),M.removeAllListeners()}},[]),_0[x(263)](()=>{const G0=x;M[G0(199)]=t},[t]),_0[x(263)](()=>{const G0=x;M[G0(1265)]=g},[g]),_0[x(263)](()=>{const G0=x;M[G0(3149)]=c},[c]),_0[x(263)](()=>{const G0=x;M[G0(707)]=r},[r]),_0.useEffect(()=>{const G0=x;M[G0(1342)]=m},[m]);const f0=_0[x(2072)](()=>({bodies:p,events:w,refs:V,scaleOverrides:N,subscriptions:X,worker:M}),[p,w,V,X,M]);return dg[x(657)](dW[x(2773)],{value:f0,children:n})}export{Zt as B,Q0 as C,si as D,Tt as E,Z3 as I,Ze as L,ye as M,Wo as P,NM as R,Eg as S,ue as T,vv as U,E as V,_0 as a,f2 as b,UI as c,vf as d,yf as e,cv as f,Zx as g,Ln as h,dx as i,S0 as j,ct as k,yt as l,mo as m,px as n,Dx as o,dg as p,JM as q,FM as r,kM as s,EM as t,xz as u,_M as v,ez as w,UM as x,TM as y,DM as z};
